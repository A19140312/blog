{"meta":{"version":1,"warehouse":"2.2.0"},"models":{"Asset":[{"_id":"themes/next/source/404.html","path":"404.html","modified":1,"renderable":1},{"_id":"themes/next/source/css/main.styl","path":"css/main.styl","modified":1,"renderable":1},{"_id":"themes/next/source/images/algolia_logo.svg","path":"images/algolia_logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/apple-touch-icon-next.png","path":"images/apple-touch-icon-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.gif","path":"images/avatar.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/alipay.jpg","path":"images/alipay.jpg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","path":"images/cc-by-nc-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","path":"images/cc-by-nc-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nc.svg","path":"images/cc-by-nc.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-nd.svg","path":"images/cc-by-nd.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by-sa.svg","path":"images/cc-by-sa.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-16x16-next.png","path":"images/favicon-16x16-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-by.svg","path":"images/cc-by.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/cc-zero.svg","path":"images/cc-zero.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon-32x32-next.png","path":"images/favicon-32x32-next.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/favicon.ico","path":"images/favicon.ico","modified":1,"renderable":1},{"_id":"themes/next/source/images/loading.gif","path":"images/loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/logo.svg","path":"images/logo.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/placeholder.gif","path":"images/placeholder.gif","modified":1,"renderable":1},{"_id":"themes/next/source/images/searchicon.png","path":"images/searchicon.png","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-l.svg","path":"images/quote-l.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/quote-r.svg","path":"images/quote-r.svg","modified":1,"renderable":1},{"_id":"themes/next/source/images/wechatpay.jpg","path":"images/wechatpay.jpg","modified":1,"renderable":1},{"_id":"themes/next/source/images/avatar.png","path":"images/avatar.png","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/affix.js","path":"js/src/affix.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/algolia-search.js","path":"js/src/algolia-search.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/bootstrap.js","path":"js/src/bootstrap.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/clipboard.min.js","path":"js/src/clipboard.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/hook-duoshuo.js","path":"js/src/hook-duoshuo.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/exturl.js","path":"js/src/exturl.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/clipboard-use.js","path":"js/src/clipboard-use.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/js.cookie.js","path":"js/src/js.cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/motion.js","path":"js/src/motion.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/post-details.js","path":"js/src/post-details.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scroll-cookie.js","path":"js/src/scroll-cookie.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/scrollspy.js","path":"js/src/scrollspy.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/utils.js","path":"js/src/utils.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","path":"lib/algolia-instant-search/instantsearch.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","path":"lib/canvas-nest/canvas-nest.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","path":"lib/canvas-ribbon/canvas-ribbon.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/LICENSE","path":"lib/fastclick/LICENSE","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/bower.json","path":"lib/fastclick/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/README.md","path":"lib/fastclick/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","path":"lib/font-awesome/HELP-US-OUT.txt","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/bower.json","path":"lib/font-awesome/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","path":"lib/jquery_lazyload/CONTRIBUTING.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","path":"lib/jquery_lazyload/README.md","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","path":"lib/jquery_lazyload/jquery.lazyload.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","path":"lib/jquery_lazyload/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","path":"lib/jquery_lazyload/jquery.scrollstop.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","path":"lib/needsharebutton/font-embedded.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","path":"lib/needsharebutton/needsharebutton.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","path":"lib/pace/pace-theme-barber-shop.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","path":"lib/pace/pace-theme-big-counter.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","path":"lib/needsharebutton/needsharebutton.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","path":"lib/pace/pace-theme-bounce.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","path":"lib/pace/pace-theme-center-atom.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","path":"lib/pace/pace-theme-center-circle.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","path":"lib/pace/pace-theme-center-radar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","path":"lib/pace/pace-theme-center-simple.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","path":"lib/pace/pace-theme-corner-indicator.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","path":"lib/pace/pace-theme-fill-left.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","path":"lib/pace/pace-theme-flash.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","path":"lib/pace/pace-theme-loading-bar.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","path":"lib/pace/pace-theme-mac-osx.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","path":"lib/pace/pace-theme-minimal.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/pace/pace.min.js","path":"lib/pace/pace.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","path":"lib/three/canvas_lines.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three-waves.min.js","path":"lib/three/three-waves.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","path":"lib/three/canvas_sphere.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/bower.json","path":"lib/velocity/bower.json","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.min.js","path":"lib/velocity/velocity.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","path":"lib/velocity/velocity.ui.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","path":"lib/velocity/velocity.ui.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/jquery/index.js","path":"lib/jquery/index.js","modified":1,"renderable":1},{"_id":"themes/next/source/js/src/schemes/pisces.js","path":"js/src/schemes/pisces.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.css","path":"lib/Han/dist/han.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.css","path":"lib/Han/dist/han.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","path":"lib/fancybox/source/blank.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.min.js","path":"lib/Han/dist/han.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","path":"lib/fancybox/source/fancybox_loading.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","path":"lib/fancybox/source/fancybox_loading@2x.gif","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","path":"lib/fancybox/source/fancybox_overlay.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","path":"lib/fancybox/source/fancybox_sprite.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","path":"lib/fancybox/source/fancybox_sprite@2x.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","path":"lib/fancybox/source/jquery.fancybox.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","path":"lib/fancybox/source/jquery.fancybox.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","path":"lib/fastclick/lib/fastclick.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","path":"lib/fancybox/source/jquery.fancybox.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","path":"lib/fastclick/lib/fastclick.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","path":"lib/font-awesome/css/font-awesome.css.map","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","path":"lib/font-awesome/css/font-awesome.min.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","path":"lib/font-awesome/css/font-awesome.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","path":"lib/ua-parser-js/dist/ua-parser.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","path":"lib/ua-parser-js/dist/ua-parser.pack.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/han.js","path":"lib/Han/dist/han.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","path":"lib/font-awesome/fonts/fontawesome-webfont.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","path":"lib/font-awesome/fonts/fontawesome-webfont.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/velocity/velocity.js","path":"lib/velocity/velocity.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","path":"lib/Han/dist/font/han-space.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","path":"lib/Han/dist/font/han-space.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","path":"lib/Han/dist/font/han.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","path":"lib/Han/dist/font/han.woff","modified":1,"renderable":1},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","path":"lib/Han/dist/font/han.woff2","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","path":"lib/fancybox/source/helpers/fancybox_buttons.png","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","path":"lib/fancybox/source/helpers/jquery.fancybox-media.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","path":"lib/fancybox/source/helpers/jquery.fancybox-buttons.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","path":"lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","path":"lib/font-awesome/fonts/FontAwesome.otf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","path":"lib/font-awesome/fonts/fontawesome-webfont.eot","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","path":"lib/font-awesome/fonts/fontawesome-webfont.ttf","modified":1,"renderable":1},{"_id":"themes/next/source/lib/three/three.min.js","path":"lib/three/three.min.js","modified":1,"renderable":1},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","path":"lib/font-awesome/fonts/fontawesome-webfont.svg","modified":1,"renderable":1},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","path":"lib/algolia-instant-search/instantsearch.min.js","modified":1,"renderable":1}],"Cache":[{"_id":"source/.DS_Store","hash":"ea9ff9d4f49b950e6aa64a8bc1f7e2515829ade3","modified":1566206184393},{"_id":"themes/next/.editorconfig","hash":"792fd2bd8174ece1a75d5fd24ab16594886f3a7f","modified":1548818372000},{"_id":"themes/next/.gitignore","hash":"0b5c2ffd41f66eb1849d6426ba8cf9649eeed329","modified":1548818372000},{"_id":"themes/next/.bowerrc","hash":"3228a58ed0ece9f85e1e3136352094080b8dece1","modified":1548818372000},{"_id":"themes/next/.gitattributes","hash":"44bd4729c74ccb88110804f41746fec07bf487d4","modified":1548818372000},{"_id":"themes/next/.hound.yml","hash":"b76daa84c9ca3ad292c78412603370a367cc2bc3","modified":1548818372000},{"_id":"themes/next/.jshintrc","hash":"9928f81bd822f6a8d67fdbc909b517178533bca9","modified":1548818372000},{"_id":"themes/next/.DS_Store","hash":"ac72b298abe4fad238659b6ea52a0aa675a73a1f","modified":1566462583188},{"_id":"themes/next/.javascript_ignore","hash":"8a224b381155f10e6eb132a4d815c5b52962a9d1","modified":1548818372000},{"_id":"themes/next/.stylintrc","hash":"b28e24704a5d8de08346c45286574c8e76cc109f","modified":1548818372000},{"_id":"themes/next/.travis.yml","hash":"d60d4a5375fea23d53b2156b764a99b2e56fa660","modified":1548818372000},{"_id":"themes/next/LICENSE","hash":"f293bcfcdc06c0b77ba13570bb8af55eb5c059fd","modified":1548818372000},{"_id":"themes/next/README.cn.md","hash":"2c766b3369ed477bce134a5450dab45bef161504","modified":1548818372000},{"_id":"themes/next/README.md","hash":"8ce60ce578963eb4e1eb5e33e1efc2fc4779af9c","modified":1548818372000},{"_id":"themes/next/bower.json","hash":"0674f11d3d514e087a176da0e1d85c2286aa5fba","modified":1548818372000},{"_id":"themes/next/_config.yml","hash":"5b0155c3ecb24a50c7560f5246ac041201d89391","modified":1565683204989},{"_id":"themes/next/gulpfile.coffee","hash":"031bffc483e417b20e90eceb6cf358e7596d2e69","modified":1548818372000},{"_id":"themes/next/package.json","hash":"036d3a1346203d2f1a3958024df7f74e7ac07bfe","modified":1548818372000},{"_id":"source/_drafts/Redis.md","hash":"b7c466dce97ff94f7efcb60de711a291306982c7","modified":1553669424318},{"_id":"source/_drafts/MyBatis-01.md","hash":"0b86f1a1affa5ba8f0b4cc59d4a4434657104c2d","modified":1576135191411},{"_id":"source/_posts/.DS_Store","hash":"bbbec2a03ad7e91e1f36b0885af421c63bef2a7d","modified":1566206189431},{"_id":"source/_posts/C++-01.md","hash":"36c756700cb0d8dd5307e0445e7df60f95c9ddea","modified":1564486636769},{"_id":"source/_posts/C++-02.md","hash":"fd628fd111b89ba5e4009f6791320e73c519db91","modified":1564486636779},{"_id":"source/_posts/Design-Pattern-Strategy.md","hash":"be90c5c593f02798e60ccc0e8283c5ba988642f6","modified":1576482812391},{"_id":"source/_posts/GIt-Ignore.md","hash":"749c54729a3595fb46bb94aad3d5db6e2f3bc417","modified":1564486636767},{"_id":"source/_posts/Design-Pattern-Observer.md","hash":"c8bceaa0798b948365c8bc0aaf77a5ca3432c372","modified":1576235578271},{"_id":"source/_posts/Guava.md","hash":"3b3294314bd3e52c6e37bb47e33a0b28a29064e3","modified":1576235547363},{"_id":"source/_posts/Github-Pages-Blog.md","hash":"5ee6fa536db3f9c25602f58ec76a22f4a8f378c8","modified":1564486636785},{"_id":"source/_posts/JVM1.md","hash":"19fc14394c50c1f101ac17415db16915c793dc5c","modified":1564486636775},{"_id":"source/_posts/JVM2.md","hash":"1b6c4052d779947f9f654e9bbc683cb00aed4477","modified":1564486636772},{"_id":"source/_posts/JVM3.md","hash":"d5d5687cc2b0681915c70735cf5903e67d344f66","modified":1564486636762},{"_id":"source/_posts/Java-Cas.md","hash":"31656752505dce4603e385754dc3b0f06957f7ea","modified":1576235607636},{"_id":"source/_posts/Java-ThreadPool.md","hash":"ee138783463065ead57a4e834ca7b587cad85043","modified":1576235607644},{"_id":"source/_posts/Kafka-Background.md","hash":"5bdcdb250f731ac7c1387a0399326533c76b6999","modified":1564486672660},{"_id":"source/_posts/Kafka-Producer.md","hash":"9d099a8d9b0f857c0b19f35ca7cea66d4d5d4fc3","modified":1565060202549},{"_id":"source/_posts/Kafka-Install.md","hash":"20a9e0697c1680827d4660932c16b40848846b00","modified":1564714671036},{"_id":"source/_posts/Mysql-LSN.md","hash":"27b4c1aa1fd770b70aa413b8a7fa9806ee375437","modified":1566213910381},{"_id":"source/_posts/Mysql01.md","hash":"edb7db5495a8c4bc64633ed8da2d0c8dfd879304","modified":1566213873580},{"_id":"source/_posts/Mysql-storage.md","hash":"576ea02a03930f706759dd360a039f964e33b126","modified":1567500944349},{"_id":"source/_posts/Mysql-RedoAndUndo.md","hash":"ca165ad83fdf547473224d96f3bba60addfd6cbd","modified":1566355406002},{"_id":"source/_posts/Mysql03.md","hash":"6802745780979b82a1b1ad6393596b54565af5bc","modified":1567416270063},{"_id":"source/_posts/Mysql02.md","hash":"9b042ae630ef258cb4da6bd29150ada0f1914a22","modified":1566911323968},{"_id":"source/_posts/Mysql05.md","hash":"63fff20103f186ac89cf5d5b771f0bd95f95cd8b","modified":1571384667802},{"_id":"source/_posts/Project-Module.md","hash":"01f4ad68cbb9b0e3c8e6cf27c67aaaf30396de6f","modified":1564486636751},{"_id":"source/_posts/Redis-adlist.md","hash":"3614e9eacd3a93c0ecb76c598d063e686622f56c","modified":1564486636764},{"_id":"source/_posts/Redis-sds.md","hash":"ca08090dab47ba81c6860b27a2d15e0fe5dbe5e5","modified":1564486636777},{"_id":"source/categories/index.md","hash":"aee2c5e57dc28322f727617488ec89ca13299877","modified":1553669424318},{"_id":"source/authors/index.md","hash":"9072a029c7c9cb7050b7e98498752ab5b4f896e9","modified":1562844268842},{"_id":"source/tags/index.md","hash":"924a602ccdf829c5c1fd0faced2eb9b0f656d9d8","modified":1553669424318},{"_id":"source/_posts/Thailand-Raiders.md","hash":"7550aad1ea561765a04b5c1190295470c5749814","modified":1567407533310},{"_id":"themes/next/.github/CONTRIBUTING.md","hash":"3b5eafd32abb718e56ccf8d1cee0607ad8ce611d","modified":1548818372000},{"_id":"themes/next/.github/PULL_REQUEST_TEMPLATE.md","hash":"902f627155a65099e0a37842ff396a58d0dc306f","modified":1548818372000},{"_id":"themes/next/.github/ISSUE_TEMPLATE.md","hash":"50d48c47162817a3810a9d9ad51104e83947419a","modified":1548818372000},{"_id":"themes/next/.github/browserstack_logo.png","hash":"a6c43887f64a7f48a2814e3714eaa1215e542037","modified":1548818372000},{"_id":"themes/next/languages/de.yml","hash":"057e7df11ddeb1c8c15a5d7c5ff29430d725ec6b","modified":1548818372000},{"_id":"themes/next/languages/default.yml","hash":"44ef3f26917f467459326c2c8be2f73e4d947f35","modified":1548818372000},{"_id":"themes/next/languages/en.yml","hash":"7e680d9bb8f3a3a9d1ba1c9d312b3d257183dded","modified":1548818372000},{"_id":"themes/next/languages/fr-FR.yml","hash":"7e4eb7011b8feee641cfb11c6e73180b0ded1c0f","modified":1548818372000},{"_id":"themes/next/languages/id.yml","hash":"b5de1ea66dd9ef54cac9a1440eaa4e3f5fc011f5","modified":1548818372000},{"_id":"themes/next/languages/it.yml","hash":"aa595f2bda029f73ef7bfa104b4c55c3f4e9fb4c","modified":1548818372000},{"_id":"themes/next/languages/ja.yml","hash":"3c76e16fd19b262864475faa6854b718bc08c4d8","modified":1548818372000},{"_id":"themes/next/languages/ko.yml","hash":"ea5b46056e73ebcee121d5551627af35cbffc900","modified":1548818372000},{"_id":"themes/next/languages/nl-NL.yml","hash":"edca4f3598857dbc3cbf19ed412213329b6edd47","modified":1548818372000},{"_id":"themes/next/languages/pt-BR.yml","hash":"b1694ae766ed90277bcc4daca4b1cfa19cdcb72b","modified":1548818372000},{"_id":"themes/next/languages/pt.yml","hash":"44b61f2d085b827b507909a0b8f8ce31c6ef5d04","modified":1548818372000},{"_id":"themes/next/languages/ru.yml","hash":"98ec6f0b7183282e11cffc7ff586ceb82400dd75","modified":1548818372000},{"_id":"themes/next/languages/zh-hk.yml","hash":"9396f41ae76e4fef99b257c93c7354e661f6e0fa","modified":1548818372000},{"_id":"themes/next/languages/vi.yml","hash":"fd08d3c8d2c62965a98ac420fdaf95e54c25d97c","modified":1548818372000},{"_id":"themes/next/languages/zh-tw.yml","hash":"50b71abb3ecc0686f9739e179e2f829cd074ecd9","modified":1548818372000},{"_id":"themes/next/languages/zh-Hans.yml","hash":"c4c9569e44d28fb37c2dad564922eee1d80dc0a2","modified":1562847884700},{"_id":"themes/next/layout/.DS_Store","hash":"65f03c5fa89ebd5a8bebda1b8b329029827e19ce","modified":1566462583187},{"_id":"themes/next/layout/_layout.swig","hash":"0a817b96ab4c85961a247dad37ae9fb992e23438","modified":1564485753153},{"_id":"themes/next/layout/archive.swig","hash":"f0a8225feafd971419837cdb4bcfec98a4a59b2f","modified":1548818372000},{"_id":"themes/next/layout/author.swig","hash":"564a7e148729701e48e1ae84f5176e38adf42204","modified":1562847624044},{"_id":"themes/next/layout/category.swig","hash":"4472255f4a3e3dd6d79201523a9526dcabdfbf18","modified":1548818372000},{"_id":"themes/next/layout/index.swig","hash":"783611349c941848a0e26ee2f1dc44dd14879bd1","modified":1548818372000},{"_id":"themes/next/layout/post.swig","hash":"b3589a8e46288a10d20e41c7a5985d2493725aec","modified":1548818372000},{"_id":"themes/next/scripts/merge-configs.js","hash":"81e86717ecfb775986b945d17f0a4ba27532ef07","modified":1548818372000},{"_id":"themes/next/scripts/merge.js","hash":"9130dabe6a674c54b535f322b17d75fe6081472f","modified":1548818372000},{"_id":"themes/next/layout/schedule.swig","hash":"d86f8de4e118f8c4d778b285c140474084a271db","modified":1548818372000},{"_id":"themes/next/layout/tag.swig","hash":"7e0a7d7d832883eddb1297483ad22c184e4368de","modified":1548818372000},{"_id":"themes/next/layout/page.swig","hash":"8c9280e56c45298e829b7b1418e621772eab78a7","modified":1564545155600},{"_id":"themes/next/source/404.html","hash":"b5e6533bfe368e8ac136dde99b162c6b35ce9dc1","modified":1548922370000},{"_id":"themes/next/test/.jshintrc","hash":"19f93d13d1689fe033c82eb2d5f3ce30b6543cc0","modified":1548818372000},{"_id":"themes/next/test/helpers.js","hash":"a1f5de25154c3724ffc24a91ddc576cdbd60864f","modified":1548818372000},{"_id":"themes/next/test/intern.js","hash":"11fa8a4f5c3b4119a179ae0a2584c8187f907a73","modified":1548818372000},{"_id":"themes/next/source/fonts/.gitkeep","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"source/_posts/Github-Pages-Blog/blog-icon.png","hash":"b4198f97a457236f7c5677680634cbbff15bc837","modified":1553669424303},{"_id":"source/_posts/Github-Pages-Blog/change-theme.png","hash":"80d61b4a4f7cba6f53e903cff176b394f9b7bdfa","modified":1553669424304},{"_id":"source/_posts/Github-Pages-Blog/categories.png","hash":"9d225500581c6625ccb43c90446ea702e2ad3d27","modified":1553669424303},{"_id":"source/_posts/Github-Pages-Blog/create-project.png","hash":"8111130d13191b07f4de818e818120f8f4941c65","modified":1553669424307},{"_id":"source/_posts/Github-Pages-Blog/deploy-position.png","hash":"710e477d8ff93bdd654228e4edfaeb8419fc32cb","modified":1553669424309},{"_id":"source/_posts/Github-Pages-Blog/tags.png","hash":"ebae8e66598ef4ab1354a3f8b21f27ec29ef667f","modified":1553669424316},{"_id":"source/_posts/Kafka-Background/3.jpg","hash":"a4c2e32670e49c09a2d377caff93c8aaa1d70b09","modified":1562815622273},{"_id":"source/_posts/Kafka-Producer/producer.png","hash":"42ee01fe607e1749fa1cd1abc69cd2641456f353","modified":1565060202550},{"_id":"source/_posts/Mysql-RedoAndUndo/redo-buffer.png","hash":"a9958302114fdc34e5b637c2cf97391f1652ab6f","modified":1565085481000},{"_id":"source/_posts/Mysql-storage/640.png","hash":"6ac75230f47c0f20723ff8173a692c333791a6e6","modified":1566984483354},{"_id":"source/_posts/Mysql-RedoAndUndo/undo-Segment.png","hash":"457de2d3b2642a5f6e77eccae8551cec0d6a7a06","modified":1566185900065},{"_id":"source/_posts/Mysql02/1.png","hash":"82b40a9930154e28645f49e88edf3cd83e66dba9","modified":1564563239486},{"_id":"source/_posts/Mysql02/2.png","hash":"442f662987cf8f60dc485f28b0204af01e00eae3","modified":1564573330558},{"_id":"source/_posts/Mysql02/IO.png","hash":"bb293525c02678266360c565b887ba239a88dfcd","modified":1565690877643},{"_id":"source/_posts/Mysql02/Insert-Buffer.svg","hash":"92de2c921440df1dd4e0e80231c744089b740b07","modified":1565685023480},{"_id":"source/_posts/Mysql02/index-update.png","hash":"3ead441d30ab2d87942c80255e996af2ecbcb453","modified":1566820169323},{"_id":"source/_posts/Mysql02/innodb-buffer-pool-list.jpg","hash":"40c9f806063efd636600239d43fdb5744ba2fceb","modified":1564998692364},{"_id":"source/_posts/Mysql02/read.svg","hash":"d6742bddd10610adc113a494aa96d24578dbc24d","modified":1565683760941},{"_id":"source/_posts/Mysql02/insert-buffer.png","hash":"1e3ab488168d2be4ea0155824d7c7a685d2d5ace","modified":1566820702994},{"_id":"source/_posts/Mysql02/redo-buffer.png","hash":"a9958302114fdc34e5b637c2cf97391f1652ab6f","modified":1565085481133},{"_id":"source/_posts/Mysql02/write.svg","hash":"677a64b2ce87638d8c1d7fb86b857815e95f386b","modified":1565683849896},{"_id":"source/_posts/Mysql02/write.png","hash":"e86f979693cd53c9dc663f3d838d038f5ace0365","modified":1565941554291},{"_id":"source/_posts/Mysql05/BBT2.png","hash":"23e5828814c8e662bd0aed71dfcf9bebb35038a8","modified":1571392299317},{"_id":"source/_posts/Mysql05/BBT3.png","hash":"3bbb36e99daa5c6cac40a2f7fb5c57227e4c9181","modified":1571392299364},{"_id":"source/_posts/Mysql05/BBT1.png","hash":"645a1fe9ba706a0159bfacd5cb9bf6cd525abefb","modified":1571392299398},{"_id":"source/_posts/Mysql05/BBT4.png","hash":"e0d5a6066060e3f56c9b2a646b41f9ad267a2bf7","modified":1571392299447},{"_id":"source/_posts/Mysql05/BST_delete1.png","hash":"7a4ead2cfe4785e8a85fb667c046933ba06c3904","modified":1571392299472},{"_id":"source/_posts/Mysql05/BST_delete2.png","hash":"460deb38ed00f83ceb4e05ce05808e7b66f0dda3","modified":1571392299506},{"_id":"source/_posts/Mysql05/BST_linked.png","hash":"fa4948a5bcee882a13b10b8c2daf51ac6ca24d85","modified":1571392299543},{"_id":"source/_posts/Mysql05/BST_insert.png","hash":"b5c6e16d88546efe42b1f8b04cc678c573d20364","modified":1571392299281},{"_id":"source/_posts/Project-Module/12.png","hash":"0c0eac591fb404c7b4bf7652807cb36468b41f50","modified":1562157821438},{"_id":"source/_posts/Project-Module/17.png","hash":"78271020841f963b565f5bbadbd0fd5e4053f79e","modified":1562158155946},{"_id":"source/_posts/Project-Module/19.png","hash":"3e5db4c7a07dc0e56bd19f93ff9d6fb0002f1802","modified":1562234502599},{"_id":"source/_posts/Project-Module/24.png","hash":"9bf2ce87e94232e26d6793509c69b2a15368646f","modified":1562244649617},{"_id":"source/_posts/Project-Module/32.png","hash":"b04d5ce74316668a7034f5c6a25cea90b0825289","modified":1562590688582},{"_id":"source/_posts/Project-Module/30.2.png","hash":"4a74cb3845660e82405f5a58d6707d8952c3536a","modified":1562587657499},{"_id":"source/_posts/Project-Module/8.png","hash":"408186cdf11cf8fd9e44b01ddb300ce89853e874","modified":1562157397710},{"_id":"source/_posts/Project-Module/7.png","hash":"42eb5628fe0a2771a62be81dcab1912d28293cdd","modified":1562073686413},{"_id":"source/_posts/Project-Module/6.png","hash":"12c3edf7adc454d9d40b4cf1e06f13cd5d8ac1e7","modified":1562073502235},{"_id":"source/_posts/Redis-sds/sdshdr.png","hash":"a0297688ecc572e7a8a01e6c3d67055a34270da1","modified":1553744715067},{"_id":"source/_posts/Thailand-Raiders/10.jpeg","hash":"6d3cbf62e3ae76e9f1c0b7d83131c2285f153012","modified":1562932867627},{"_id":"source/_posts/Thailand-Raiders/5.png","hash":"fa26beabe60a86da1e11fb49f9243e3872b495bc","modified":1562926883172},{"_id":"themes/next/layout/_custom/header.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1548818372000},{"_id":"themes/next/layout/_custom/sidebar.swig","hash":"adc83b19e793491b1c6ea0fd8b46cd9f32e592fc","modified":1548818372000},{"_id":"themes/next/layout/_macro/my-copyright.swig","hash":"72c1224cd566eea28a33e93f85e4ad3cb67270b1","modified":1564485753167},{"_id":"themes/next/layout/_macro/post-collapse.swig","hash":"31322a7f57936cf2dc62e824af5490da5354cf02","modified":1548818372000},{"_id":"themes/next/layout/_macro/post-copyright.swig","hash":"665a928604f99d2ba7dc4a4a9150178229568cc6","modified":1548818372000},{"_id":"themes/next/layout/_macro/post-end-tag.swig","hash":"51118e29759de4dce54b348eb8197cd0044aa45c","modified":1548926225000},{"_id":"themes/next/layout/_macro/reward.swig","hash":"56e8d8556cf474c56ae1bef9cb7bbd26554adb07","modified":1548818372000},{"_id":"themes/next/layout/_macro/wechat-subscriber.swig","hash":"39852700e4084ecccffa6d4669168e5cc0514c9e","modified":1548818372000},{"_id":"themes/next/layout/_macro/sidebar.swig","hash":"6a54c3c85ff6b19d275827a327abbf4bd99b2ebf","modified":1548818372000},{"_id":"themes/next/layout/_macro/post.swig","hash":"37e74f7c40641840e8d5f7dc6c05d1a627850735","modified":1562844362540},{"_id":"themes/next/layout/_partials/comments.swig","hash":"4a6f5b1792b2e5262b7fdab9a716b3108e2f09c7","modified":1548818372000},{"_id":"themes/next/layout/_partials/footer.swig","hash":"6cf19e058fd5febd31bfd6bfa02bc0eda9a9c5bd","modified":1565683230513},{"_id":"themes/next/layout/_partials/header.swig","hash":"ed042be6252848058c90109236ec988e392d91d4","modified":1548818372000},{"_id":"themes/next/layout/_partials/page-header.swig","hash":"1efd925d34a5d4ba2dc0838d9c86ba911e705fc9","modified":1548818372000},{"_id":"themes/next/layout/_partials/head.swig","hash":"ef329e7b1d3890dfe541ef095a10cfdd81ebbbc9","modified":1564487114830},{"_id":"themes/next/layout/_partials/pagination.swig","hash":"9e8e21d194ef44d271b1cca0bc1448c14d7edf4f","modified":1548818372000},{"_id":"themes/next/layout/_partials/search.swig","hash":"9dbd378e94abfcb3f864a5b8dbbf18d212ca2ee0","modified":1548818372000},{"_id":"themes/next/layout/_scripts/boostrap.swig","hash":"03aaebe9d50f6acb007ec38cc04acd1cfceb404d","modified":1548818372000},{"_id":"themes/next/layout/_scripts/commons.swig","hash":"766b2bdda29523ed6cd8d7aa197f996022f8fd94","modified":1548818372000},{"_id":"themes/next/layout/_scripts/vendors.swig","hash":"a266f96ad06ee87bdeae6e105a4b53cd587bbd04","modified":1548818372000},{"_id":"themes/next/layout/_third-party/duoshuo-hot-articles.swig","hash":"5d4638c46aef65bf32a01681495b62416ccc98db","modified":1548818372000},{"_id":"themes/next/layout/_third-party/exturl.swig","hash":"7c04a42319d728be356746363aff8ea247791d24","modified":1548818372000},{"_id":"themes/next/layout/_third-party/mathjax.swig","hash":"6d25596d6a7c57700d37b607f8d9a62d89708683","modified":1548818372000},{"_id":"themes/next/layout/_third-party/needsharebutton.swig","hash":"5fe0447cc88a5a63b530cf0426f93c4634811876","modified":1548818372000},{"_id":"themes/next/layout/_third-party/rating.swig","hash":"fc93b1a7e6aed0dddb1f3910142b48d8ab61174e","modified":1548818372000},{"_id":"themes/next/layout/_third-party/schedule.swig","hash":"22369026c87fc23893c35a7f250b42f3bb1b60f1","modified":1548818372000},{"_id":"themes/next/layout/_third-party/scroll-cookie.swig","hash":"1ddb2336a1a19b47af3017047012c01ec5f54529","modified":1548818372000},{"_id":"themes/next/scripts/tags/button.js","hash":"d023f10a00077f47082b0517e2ad666e6e994f60","modified":1548818372000},{"_id":"themes/next/scripts/tags/center-quote.js","hash":"535fc542781021c4326dec24d8495cbb1387634a","modified":1548818372000},{"_id":"themes/next/scripts/tags/exturl.js","hash":"8d7e60f60779bde050d20fd76f6fdc36fc85e06d","modified":1548818372000},{"_id":"themes/next/scripts/tags/full-image.js","hash":"8eeb3fb89540299bdbb799edfdfdac3743b50596","modified":1548818372000},{"_id":"themes/next/scripts/tags/group-pictures.js","hash":"49252824cd53184dc9b97b2f2d87ff28e1b3ef27","modified":1548818372000},{"_id":"themes/next/scripts/tags/label.js","hash":"2f8f41a7316372f0d1ed6b51190dc4acd3e16fff","modified":1548818372000},{"_id":"themes/next/scripts/tags/lazy-image.js","hash":"eeeabede68cf263de9e6593ecf682f620da16f0a","modified":1548818372000},{"_id":"themes/next/scripts/tags/note.js","hash":"64de4e9d01cf3b491ffc7d53afdf148ee5ad9779","modified":1548818372000},{"_id":"themes/next/scripts/tags/tabs.js","hash":"5786545d51c38e8ca38d1bfc7dd9e946fc70a316","modified":1548818372000},{"_id":"themes/next/source/css/main.styl","hash":"20702c48d6053c92c5bcdbc68e8d0ef1369848a0","modified":1548818372000},{"_id":"themes/next/source/images/algolia_logo.svg","hash":"ec119560b382b2624e00144ae01c137186e91621","modified":1548818372000},{"_id":"themes/next/source/images/apple-touch-icon-next.png","hash":"2959dbc97f31c80283e67104fe0854e2369e40aa","modified":1548818372000},{"_id":"themes/next/source/images/avatar.gif","hash":"264082bb3a1af70d5499c7d22b0902cb454b6d12","modified":1548818372000},{"_id":"themes/next/source/images/alipay.jpg","hash":"499aab03d01ae8b1e2f2eb593bdcd6e989188b9e","modified":1548922023000},{"_id":"themes/next/source/images/cc-by-nc-nd.svg","hash":"c6524ece3f8039a5f612feaf865d21ec8a794564","modified":1548818372000},{"_id":"themes/next/source/images/cc-by-nc-sa.svg","hash":"3031be41e8753c70508aa88e84ed8f4f653f157e","modified":1548818372000},{"_id":"themes/next/source/images/cc-by-nc.svg","hash":"8d39b39d88f8501c0d27f8df9aae47136ebc59b7","modified":1548818372000},{"_id":"themes/next/source/images/cc-by-nd.svg","hash":"c563508ce9ced1e66948024ba1153400ac0e0621","modified":1548818372000},{"_id":"themes/next/source/images/cc-by-sa.svg","hash":"aa4742d733c8af8d38d4c183b8adbdcab045872e","modified":1548818372000},{"_id":"themes/next/source/images/favicon-16x16-next.png","hash":"943a0d67a9cdf8c198109b28f9dbd42f761d11c3","modified":1548818372000},{"_id":"themes/next/source/images/cc-by.svg","hash":"28a0a4fe355a974a5e42f68031652b76798d4f7e","modified":1548818372000},{"_id":"themes/next/source/images/cc-zero.svg","hash":"87669bf8ac268a91d027a0a4802c92a1473e9030","modified":1548818372000},{"_id":"themes/next/source/images/favicon-32x32-next.png","hash":"0749d7b24b0d2fae1c8eb7f671ad4646ee1894b1","modified":1548818372000},{"_id":"themes/next/source/images/favicon.ico","hash":"85da2faa392c9c975434e11a311e70fc6e8ca55e","modified":1546966292000},{"_id":"themes/next/source/images/loading.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1548818372000},{"_id":"themes/next/source/images/logo.svg","hash":"d29cacbae1bdc4bbccb542107ee0524fe55ad6de","modified":1548818372000},{"_id":"themes/next/source/images/placeholder.gif","hash":"5fbd472222feb8a22cf5b8aa5dc5b8e13af88e2b","modified":1548818372000},{"_id":"themes/next/source/images/searchicon.png","hash":"67727a6a969be0b2659b908518fa6706eed307b8","modified":1548818372000},{"_id":"themes/next/source/images/quote-l.svg","hash":"94e870b4c8c48da61d09522196d4dd40e277a98f","modified":1548818372000},{"_id":"themes/next/source/images/quote-r.svg","hash":"e60ae504f9d99b712c793c3740c6b100d057d4ec","modified":1548818372000},{"_id":"themes/next/source/images/wechatpay.jpg","hash":"a6529134a0531dda88058747a8f41f4aab5e9abe","modified":1548922040000},{"_id":"source/_posts/Kafka-Background/1.png","hash":"f970b02b874a9e4a4ae888ee84153951b6e82153","modified":1562815616709},{"_id":"source/_posts/Kafka-Background/5.jpeg","hash":"2b65edd6da76ce3d4a5e9952e443a42cc26b33b2","modified":1562815610845},{"_id":"source/_posts/Kafka-Producer/cert_override.png","hash":"c91783236434fcdc194b90089a5b1b9c1768344b","modified":1565060202549},{"_id":"source/_posts/Mysql02/doublewrite.png","hash":"f42d0c74d3eb68e0c960d90c40523918f34c5e12","modified":1565697226116},{"_id":"source/_posts/Mysql02/read.png","hash":"a8de8ff1931593ce04cd3c588dd4c29319b77546","modified":1565938985180},{"_id":"source/_posts/Mysql02/three-list2.png","hash":"59d11716ab165d813482de8b436db0b60eb6604f","modified":1565948891516},{"_id":"source/_posts/Project-Module/10.png","hash":"5db18541d543dd31c8345d1fc67cef3c0a41f755","modified":1562157481092},{"_id":"source/_posts/Project-Module/11.png","hash":"9b094ebe0fbdfd04aa207b9ce540c69a5c0c3f45","modified":1562157501724},{"_id":"source/_posts/Project-Module/3.png","hash":"be6b1ece28049a1871b51a8c184e2e1952ae6da2","modified":1562073027513},{"_id":"source/_posts/Project-Module/5.png","hash":"77180f160369fde5065dd5b6139c5e506c60671b","modified":1562073148167},{"_id":"source/_posts/Redis-adlist/list.png","hash":"8c42024153090d4e8dc85dd26313b98ae394a2fc","modified":1553762050803},{"_id":"source/_posts/Thailand-Raiders/1.png","hash":"6df75200d332aff25a8a580f74be792f9ebadebc","modified":1563367590531},{"_id":"source/_posts/Thailand-Raiders/WechatIMG39.png","hash":"9add9f7543f1a03febc8430bf4053a11ed9e6101","modified":1567407533497},{"_id":"source/_posts/Thailand-Raiders/WechatIMG40.png","hash":"433cf7251a4e330ab70046a7ddce2dc7a83fba84","modified":1567407533498},{"_id":"themes/next/layout/_scripts/schemes/mist.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"themes/next/layout/_scripts/schemes/muse.swig","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"themes/next/source/css/_mixins/Mist.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"themes/next/source/css/_mixins/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"themes/next/source/css/_mixins/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"themes/next/source/css/_variables/Muse.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"themes/next/source/css/_variables/custom.styl","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1548818372000},{"_id":"themes/next/source/images/avatar.png","hash":"2fc664b73fb0dc51c0025d6d605f70440f3712c1","modified":1538126136000},{"_id":"source/_posts/Github-Pages-Blog/comment-delete.png","hash":"e8e8f4226ffb96387f1e15a45df8e28d6fe219f2","modified":1553669424305},{"_id":"source/_posts/Github-Pages-Blog/github-pages.png","hash":"cb19bd12e2c73729f622bb439c7ca2bfc6fa1706","modified":1553669424310},{"_id":"source/_posts/Mysql02/innodb-Architecture.png","hash":"f99f6d2e919632903493f158c7573cb81238dba0","modified":1565869741439},{"_id":"source/_posts/Mysql02/three-list.png","hash":"b5cdd07f60a3fa569e61b7c6078f860f5e1441e6","modified":1565775959926},{"_id":"source/_posts/Project-Module/2.png","hash":"23d9f5a8c391d42f884d2921d3ae263f17510a41","modified":1562072968734},{"_id":"themes/next/layout/_partials/head/custom-head.swig","hash":"9e1b9666efa77f4cf8d8261bcfa445a9ac608e53","modified":1548818372000},{"_id":"themes/next/layout/_partials/head/external-fonts.swig","hash":"7ce76358411184482bb0934e70037949dd0da8ca","modified":1548818372000},{"_id":"themes/next/layout/_partials/search/localsearch.swig","hash":"957701729b85fb0c5bfcf2fb99c19d54582f91ed","modified":1548818372000},{"_id":"themes/next/layout/_partials/search/tinysou.swig","hash":"eefe2388ff3d424694045eda21346989b123977c","modified":1548818372000},{"_id":"themes/next/layout/_partials/share/add-this.swig","hash":"23e23dc0f76ef3c631f24c65277adf7ea517b383","modified":1548818372000},{"_id":"themes/next/layout/_partials/search/swiftype.swig","hash":"959b7e04a96a5596056e4009b73b6489c117597e","modified":1548818372000},{"_id":"themes/next/layout/_partials/share/baidushare.swig","hash":"1f1107468aaf03f7d0dcd7eb2b653e2813a675b4","modified":1548818372000},{"_id":"themes/next/layout/_partials/share/jiathis.swig","hash":"048fd5e98149469f8c28c21ba3561a7a67952c9b","modified":1548818372000},{"_id":"themes/next/layout/_partials/share/duoshuo_share.swig","hash":"89c5a5240ecb223acfe1d12377df5562a943fd5d","modified":1548818372000},{"_id":"themes/next/layout/_scripts/pages/post-details.swig","hash":"069d1357c717572256e5cdee09574ebce529cbae","modified":1548818372000},{"_id":"themes/next/layout/_scripts/schemes/gemini.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1548818372000},{"_id":"themes/next/layout/_scripts/schemes/pisces.swig","hash":"a44acf9b0d0f44ef3dfc767376a95c984cc127de","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/baidu-analytics.swig","hash":"deda6a814ed48debc694c4e0c466f06c127163d0","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/analytics-with-widget.swig","hash":"98df9d72e37dd071e882f2d5623c9d817815b139","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/application-insights.swig","hash":"60426bf73f8a89ba61fb1be2df3ad5398e32c4ef","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/facebook-sdk.swig","hash":"a234c5cd1f75ca5731e814d0dbb92fdcf9240d1b","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/busuanzi-counter.swig","hash":"4aa55cd424389cf5626aa019c15ef6f3e4da09f2","modified":1564714671038},{"_id":"themes/next/layout/_third-party/analytics/cnzz-analytics.swig","hash":"8160b27bee0aa372c7dc7c8476c05bae57f58d0f","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/firestore.swig","hash":"1cd01c6e92ab1913d48e556a92bb4f28b6dc4996","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/google-analytics.swig","hash":"5d9943d74cc2e0a91badcf4f755c6de77eab193a","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/index.swig","hash":"5e9bb24c750b49513d9a65799e832f07410002ac","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/lean-analytics.swig","hash":"fc65b9c98a0a8ab43a5e7aabff6c5f03838e09c8","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/tencent-analytics.swig","hash":"3658414379e0e8a34c45c40feadc3edc8dc55f88","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/vkontakte-api.swig","hash":"c3971fd154d781088e1cc665035f8561a4098f4c","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/changyan.swig","hash":"0e3378f7c39b2b0f69638290873ede6b6b6825c0","modified":1548818372000},{"_id":"themes/next/layout/_third-party/analytics/tencent-mta.swig","hash":"0ddc94ed4ba0c19627765fdf1abc4d8efbe53d5a","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/disqus.swig","hash":"c316758546dc9ba6c60cb4d852c17ca6bb6d6724","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/duoshuo.swig","hash":"a356b2185d40914447fde817eb3d358ab6b3e4c3","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/gitment.swig","hash":"10160daceaa6f1ecf632323d422ebe2caae49ddf","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/hypercomments.swig","hash":"3e8dc5c6c912628a37e3b5f886bec7b2e5ed14ea","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/index.swig","hash":"aa0629277d751c55c6d973e7691bf84af9b17a60","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/livere.swig","hash":"8a2e393d2e49f7bf560766d8a07cd461bf3fce4f","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/valine.swig","hash":"fcabbb241f894c9a6309c44e126cf3e8fea81fd4","modified":1548818372000},{"_id":"themes/next/layout/_third-party/comments/youyan.swig","hash":"8b6650f77fe0a824c8075b2659e0403e0c78a705","modified":1548818372000},{"_id":"themes/next/layout/_third-party/search/index.swig","hash":"c747fb5c6b1f500e8f0c583e44195878b66e4e29","modified":1548818372000},{"_id":"themes/next/layout/_third-party/search/tinysou.swig","hash":"cb3a5d36dbe1630bab84e03a52733a46df7c219b","modified":1548818372000},{"_id":"themes/next/layout/_third-party/search/localsearch.swig","hash":"385c066af96bee30be2459dbec8aae1f15d382f5","modified":1548818372000},{"_id":"themes/next/layout/_third-party/seo/baidu-push.swig","hash":"c057b17f79e8261680fbae8dc4e81317a127c799","modified":1548818372000},{"_id":"themes/next/source/css/_custom/custom.styl","hash":"b0952d607ead833a45199c24c99611660aa0cffd","modified":1565684246834},{"_id":"themes/next/source/css/_mixins/Gemini.styl","hash":"2aa5b7166a85a8aa34b17792ae4f58a5a96df6cc","modified":1548818372000},{"_id":"themes/next/source/css/_mixins/Pisces.styl","hash":"9ab65361ba0a12a986edd103e56492644c2db0b8","modified":1548818372000},{"_id":"themes/next/source/css/_mixins/base.styl","hash":"82f9055955920ed88a2ab6a20ab02169abb2c634","modified":1548818372000},{"_id":"themes/next/source/css/_variables/Gemini.styl","hash":"99fbb4686ea9a3e03a4726ed7cf4d8f529034452","modified":1548818372000},{"_id":"themes/next/source/css/_variables/Mist.styl","hash":"be087dcc060e8179f7e7f60ab4feb65817bd3d9f","modified":1548818372000},{"_id":"themes/next/source/css/_variables/Pisces.styl","hash":"f29165e36489a87ba32d17dddfd2720d84e3f3ec","modified":1548818372000},{"_id":"themes/next/source/css/_variables/base.styl","hash":"890cfaa4e771d2a7624389042febe40604d285cf","modified":1548926869000},{"_id":"themes/next/source/js/src/affix.js","hash":"978e0422b5bf1b560236d8d10ebc1adcf66392e3","modified":1548818372000},{"_id":"themes/next/source/js/src/algolia-search.js","hash":"b172f697ed339a24b1e80261075232978d164c35","modified":1548818372000},{"_id":"themes/next/source/js/src/bootstrap.js","hash":"034bc8113e0966fe2096ba5b56061bbf10ef0512","modified":1548818372000},{"_id":"themes/next/source/js/src/clipboard.min.js","hash":"765eed9192ea1956416508e97868f65507cc7d35","modified":1564485753163},{"_id":"themes/next/source/js/src/hook-duoshuo.js","hash":"a6119070c0119f33e08b29da7d2cce2635eb40a0","modified":1548818372000},{"_id":"themes/next/source/js/src/exturl.js","hash":"e42e2aaab7bf4c19a0c8e779140e079c6aa5c0b1","modified":1548818372000},{"_id":"themes/next/source/js/src/clipboard-use.js","hash":"f5dfecd9bf13b9d1483bf663a367c7c080aac9cc","modified":1564485865410},{"_id":"themes/next/source/js/src/js.cookie.js","hash":"9b37973a90fd50e71ea91682265715e45ae82c75","modified":1548818372000},{"_id":"themes/next/source/js/src/motion.js","hash":"6a96c556378d10ec3250850be7ba4a5b55f5b5d7","modified":1548926393000},{"_id":"themes/next/source/js/src/post-details.js","hash":"a13f45f7aa8291cf7244ec5ba93907d119c5dbdd","modified":1548818372000},{"_id":"themes/next/source/js/src/scroll-cookie.js","hash":"09dc828cbf5f31158ff6250d2bf7c3cde6365c67","modified":1548818372000},{"_id":"themes/next/source/js/src/scrollspy.js","hash":"fe4da1b9fe73518226446f5f27d2831e4426fc35","modified":1548818372000},{"_id":"themes/next/source/js/src/utils.js","hash":"9b1325801d27213083d1487a12b1a62b539ab6f8","modified":1548818372000},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.css","hash":"90ef19edc982645b118b095615838d9c5eaba0de","modified":1548818372000},{"_id":"themes/next/source/lib/canvas-nest/canvas-nest.min.js","hash":"0387e75e23b1db108a755073fe52a0d03eb391a7","modified":1548818372000},{"_id":"themes/next/source/lib/canvas-ribbon/canvas-ribbon.js","hash":"ff5915eb2596e890a2fc6697c864f861a1995ec0","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/.bower.json","hash":"cc40a9b11e52348e554c84e4a5c058056f6b7aeb","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/.gitattributes","hash":"2db21acfbd457452462f71cc4048a943ee61b8e0","modified":1548818372000},{"_id":"themes/next/source/lib/fastclick/LICENSE","hash":"dcd5b6b43095d9e90353a28b09cb269de8d4838e","modified":1548818372000},{"_id":"themes/next/source/lib/fastclick/.bower.json","hash":"93ebd5b35e632f714dcf1753e1f6db77ec74449b","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/.gitignore","hash":"69d152fa46b517141ec3b1114dd6134724494d83","modified":1548818372000},{"_id":"themes/next/source/lib/fastclick/bower.json","hash":"13379463c7463b4b96d13556b46faa4cc38d81e6","modified":1548818372000},{"_id":"themes/next/source/lib/fastclick/README.md","hash":"1decd8e1adad2cd6db0ab50cf56de6035156f4ea","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/.bower.json","hash":"a2aaaf12378db56bd10596ba3daae30950eac051","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/.npmignore","hash":"dcf470ab3a358103bb896a539cc03caeda10fa8b","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/HELP-US-OUT.txt","hash":"4f7bf961f1bed448f6ba99aeb9219fabf930ba96","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/bower.json","hash":"279a8a718ab6c930a67c41237f0aac166c1b9440","modified":1548818372000},{"_id":"themes/next/source/lib/jquery/.bower.json","hash":"91745c2cc6c946c7275f952b2b0760b880cea69e","modified":1548818372000},{"_id":"themes/next/source/lib/jquery_lazyload/.bower.json","hash":"b7638afc93e9cd350d0783565ee9a7da6805ad8e","modified":1548818372000},{"_id":"themes/next/source/lib/jquery_lazyload/CONTRIBUTING.md","hash":"4891864c24c28efecd81a6a8d3f261145190f901","modified":1548818372000},{"_id":"themes/next/source/lib/jquery_lazyload/README.md","hash":"895d50fa29759af7835256522e9dd7dac597765c","modified":1548818372000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.lazyload.js","hash":"481fd478650e12b67c201a0ea41e92743f8b45a3","modified":1548818372000},{"_id":"themes/next/source/lib/jquery_lazyload/bower.json","hash":"65bc85d12197e71c40a55c0cd7f6823995a05222","modified":1548818372000},{"_id":"themes/next/source/lib/jquery_lazyload/jquery.scrollstop.js","hash":"0e9a81785a011c98be5ea821a8ed7d411818cfd1","modified":1548818372000},{"_id":"themes/next/source/lib/needsharebutton/font-embedded.css","hash":"c39d37278c1e178838732af21bd26cd0baeddfe0","modified":1548818372000},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.css","hash":"3ef0020a1815ca6151ea4886cd0d37421ae3695c","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-barber-shop.min.css","hash":"ee0d51446cb4ffe1bb96bd7bc8c8e046dddfcf46","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-big-counter.min.css","hash":"5b561dc328af4c4d512e20a76fe964d113a32ba8","modified":1548818372000},{"_id":"themes/next/source/lib/needsharebutton/needsharebutton.js","hash":"9885fd9bea5e7ebafc5b1de9d17be5e106248d96","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-bounce.min.css","hash":"f6bdb9a785b7979dd8ec5c60e278af955ef1e585","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-center-atom.min.css","hash":"dcf79c24fe5350fb73d8038573a104e73639e9d3","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-center-circle.min.css","hash":"a4066769c78affbfbc5e30a600e2c7862cd532e0","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-center-radar.min.css","hash":"ab7cba998bf4c03b13df342bf43647fa4f419783","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-center-simple.min.css","hash":"67f44c947548bd4d77e7590d3f59e236cbf9e98a","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-corner-indicator.min.css","hash":"b3c64c973f31884e3d8145989476707333406b9a","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-fill-left.min.css","hash":"0bec1e235a4a2cccda3f993b205424e1441a44ae","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-flash.min.css","hash":"13ace22c40312d7bbd8d9c1e50eff897a7a497d8","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-loading-bar.min.css","hash":"7ee28875dfc1230d76c537f6605766e8d4011e9f","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-mac-osx.min.css","hash":"9f2e7b51b084da407863826b25265b31150b3821","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace-theme-minimal.min.css","hash":"9cd783cceb8a191f3c8b5d81f7a430ecc3e489d3","modified":1548818372000},{"_id":"themes/next/source/lib/pace/pace.min.js","hash":"9944dfb7814b911090e96446cea4d36e2b487234","modified":1548818372000},{"_id":"themes/next/source/lib/three/canvas_lines.min.js","hash":"dce4a3b65f8bf958f973690caa7ec4952f353b0c","modified":1548818372000},{"_id":"themes/next/source/lib/three/three-waves.min.js","hash":"d968cba6b3a50b3626a02d67b544f349d83b147c","modified":1548818372000},{"_id":"themes/next/source/lib/three/canvas_sphere.min.js","hash":"d8ea241a53c135a650f7335d2b6982b899fd58a9","modified":1548818372000},{"_id":"themes/next/source/lib/velocity/.bower.json","hash":"05f960846f1c7a93dab1d3f9a1121e86812e8c88","modified":1548818372000},{"_id":"themes/next/source/lib/velocity/bower.json","hash":"2ec99573e84c7117368beccb9e94b6bf35d2db03","modified":1548818372000},{"_id":"themes/next/source/lib/velocity/velocity.min.js","hash":"2f1afadc12e4cf59ef3b405308d21baa97e739c6","modified":1548818372000},{"_id":"themes/next/source/lib/velocity/velocity.ui.min.js","hash":"ed5e534cd680a25d8d14429af824f38a2c7d9908","modified":1548818372000},{"_id":"themes/next/source/lib/velocity/velocity.ui.js","hash":"6a1d101eab3de87527bb54fcc8c7b36b79d8f0df","modified":1548818372000},{"_id":"source/_posts/Github-Pages-Blog/setting.png","hash":"d78c0cf7a9a0d795e350eff8c0ab9ef0262cc01d","modified":1553669424316},{"_id":"source/_posts/Github-Pages-Blog/valine.png","hash":"b35df8378b9559765b74f7d6bb9909a1372d115e","modified":1553669424317},{"_id":"source/_posts/Kafka-Background/2.png","hash":"ab3ac1493d4e8a787578f5ad348c1164e137fa03","modified":1562815619501},{"_id":"source/_posts/MyBatis-01/1.png","hash":"793797fc5114bdb4ae634a652ade3cb7a90b7413","modified":1573808074404},{"_id":"source/_posts/Mysql01/01.jpg","hash":"6d800a31280148d6e6b796003941c74e14805fea","modified":1564470457461},{"_id":"source/_posts/Project-Module/30.1.png","hash":"8d2eb3439248383787e3593bf7fd1693efe90ea9","modified":1562587529735},{"_id":"themes/next/source/lib/jquery/index.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1548818372000},{"_id":"source/_posts/Design-Pattern-Strategy/1.png","hash":"16ed88fb9c6ebcb5a719523c85b47cf758215906","modified":1576480712153},{"_id":"source/_posts/Design-Pattern-Strategy/2.png","hash":"0adb36c4dfce45fb13b942ff508a7200a8cd4c33","modified":1576481975709},{"_id":"source/_posts/Design-Pattern-Observer/2.png","hash":"72a6fba3e46327e3632a09810b24215f763850b4","modified":1576225992904},{"_id":"source/_posts/Github-Pages-Blog/create-repository.png","hash":"9bdbb8073bb7b6f37f42577ef8843d09028cd026","modified":1553669424309},{"_id":"source/_posts/Kafka-Background/4.jpg","hash":"2f17548f83ba5831e21fca29aaed2dc64ef1a4db","modified":1562815610851},{"_id":"themes/next/layout/_third-party/search/algolia-search/assets.swig","hash":"28ff4ed6714c59124569ffcbd10f1173d53ca923","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/back-to-top-sidebar.styl","hash":"4719ce717962663c5c33ef97b1119a0b3a4ecdc3","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/back-to-top.styl","hash":"f05d6881daddfba936f7936fb7ea8b8debe07c01","modified":1548926869000},{"_id":"themes/next/layout/_third-party/search/algolia-search/dom.swig","hash":"ba698f49dd3a868c95b240d802f5b1b24ff287e4","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/comments.styl","hash":"471f1627891aca5c0e1973e09fbcb01e1510d193","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/components.styl","hash":"a6bb5256be6195e76addbda12f4ed7c662d65e7a","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/pagination.styl","hash":"c5d48863f332ff8ce7c88dec2c893f709d7331d3","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/buttons.styl","hash":"7e509c7c28c59f905b847304dd3d14d94b6f3b8e","modified":1548818372000},{"_id":"themes/next/source/css/_common/outline/outline.styl","hash":"2186be20e317505cd31886f1291429cc21f76703","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tag-cloud.styl","hash":"dd8a3b22fc2f222ac6e6c05bd8a773fb039169c0","modified":1548818372000},{"_id":"themes/next/source/css/_common/scaffolding/helpers.styl","hash":"9c25c75311e1bd4d68df031d3f2ae6d141a90766","modified":1548818372000},{"_id":"themes/next/source/css/_common/scaffolding/base.styl","hash":"6109209e94d4d06513ce194a11e05a5640927e41","modified":1548926501000},{"_id":"themes/next/source/css/_common/scaffolding/mobile.styl","hash":"47a46583a1f3731157a3f53f80ed1ed5e2753e8e","modified":1548818372000},{"_id":"themes/next/source/css/_common/scaffolding/scaffolding.styl","hash":"a280a583b7615e939aaddbf778f5c108ef8a2a6c","modified":1548818372000},{"_id":"themes/next/source/css/_common/scaffolding/tables.styl","hash":"64f5d56c08d74a338813df1265580ca0cbf0190b","modified":1548818372000},{"_id":"themes/next/source/css/_common/scaffolding/normalize.styl","hash":"ece571f38180febaf02ace8187ead8318a300ea7","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/_base.styl","hash":"c2d079788d6fc2e9a191ccdae94e50d55bf849dc","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Gemini/index.styl","hash":"18c3336ee3d09bd2da6a876e1336539f03d5a973","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/_header.styl","hash":"5ae7906dc7c1d9468c7f4b4a6feddddc555797a1","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/_logo.styl","hash":"38e5df90c8689a71c978fd83ba74af3d4e4e5386","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/_posts-expanded.styl","hash":"3b25edfa187d1bbbd0d38b50dd013cef54758abf","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/_menu.styl","hash":"b0dcca862cd0cc6e732e33d975b476d744911742","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/index.styl","hash":"9a5581a770af8964064fef7afd3e16963e45547f","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Muse/_logo.styl","hash":"8829bc556ca38bfec4add4f15a2f028092ac6d46","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Muse/_menu.styl","hash":"4aac01962520d60b03b23022ab601ad4bd19c08c","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Muse/_layout.styl","hash":"0efa036a15c18f5abb058b7c0fad1dd9ac5eed4c","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Muse/_search.styl","hash":"1452cbe674cc1d008e1e9640eb4283841058fc64","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Pisces/_brand.styl","hash":"c4ed249798296f60bda02351fe6404fb3ef2126f","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Muse/index.styl","hash":"a0e2030a606c934fb2c5c7373aaae04a1caac4c5","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Pisces/_menu.styl","hash":"215de948be49bcf14f06d500cef9f7035e406a43","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Pisces/_layout.styl","hash":"5b93958239d3d2bf9aeaede44eced2434d784462","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Pisces/index.styl","hash":"69ecd6c97e7cdfd822ac8102b45ad0ede85050db","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Pisces/_sidebar.styl","hash":"9d16fa3c14ed76b71229f022b63a02fd0f580958","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Pisces/_posts.styl","hash":"2f878213cb24c5ddc18877f6d15ec5c5f57745ac","modified":1548818372000},{"_id":"themes/next/source/js/src/schemes/pisces.js","hash":"8050a5b2683d1d77238c5762b6bd89c543daed6e","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/han.css","hash":"bd40da3fba8735df5850956814e312bd7b3193d7","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/han.min.css","hash":"a0c9e32549a8b8cf327ab9227b037f323cdb60ee","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/blank.gif","hash":"2daeaa8b5f19f0bc209d976c02bd6acb51b00b0a","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/han.min.js","hash":"f559c68a25065a14f47da954a7617d87263e409d","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading.gif","hash":"1a755fb2599f3a313cc6cfdb14df043f8c14a99c","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_loading@2x.gif","hash":"273b123496a42ba45c3416adb027cd99745058b0","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_overlay.png","hash":"b3a4ee645ba494f52840ef8412015ba0f465dbe0","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite.png","hash":"17df19f97628e77be09c352bf27425faea248251","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/fancybox_sprite@2x.png","hash":"30c58913f327e28f466a00f4c1ac8001b560aed8","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.css","hash":"5f163444617b6cf267342f06ac166a237bb62df9","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.js","hash":"1cf3d47b5ccb7cb6e9019c64f2a88d03a64853e4","modified":1548818372000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.min.js","hash":"2cae0f5a6c5d6f3cb993015e6863f9483fc4de18","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/jquery.fancybox.pack.js","hash":"53360764b429c212f424399384417ccc233bb3be","modified":1548818372000},{"_id":"themes/next/source/lib/fastclick/lib/fastclick.js","hash":"06cef196733a710e77ad7e386ced6963f092dc55","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css.map","hash":"0189d278706509412bac4745f96c83984e1d59f4","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.min.css","hash":"512c7d79033e3028a9be61b540cf1a6870c896f8","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/css/font-awesome.css","hash":"0140952c64e3f2b74ef64e050f2fe86eab6624c8","modified":1548818372000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.min.js","hash":"38628e75e4412cc6f11074e03e1c6d257aae495b","modified":1548818372000},{"_id":"themes/next/source/lib/ua-parser-js/dist/ua-parser.pack.js","hash":"214dad442a92d36af77ed0ca1d9092b16687f02f","modified":1548818372000},{"_id":"source/_posts/Github-Pages-Blog/copy-url.png","hash":"fb7edbabddfe278a5fc1db57a90a99f690daafe5","modified":1553669424307},{"_id":"source/_posts/Mysql-LSN/LOG.png","hash":"9a8feb8bfefe2de7a8401f1afebeb88577807ac6","modified":1566199006060},{"_id":"source/_posts/Project-Module/4.png","hash":"10d542aa156ac37480249b2be21cd83ee6902804","modified":1562073097537},{"_id":"themes/next/source/lib/Han/dist/han.js","hash":"e345397e0585c9fed1449e614ec13e0224acf2ab","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff","hash":"28b782240b3e76db824e12c02754a9731a167527","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.woff2","hash":"d6f48cba7d076fb6f2fd6ba993a75b9dc1ecbf0c","modified":1548818372000},{"_id":"themes/next/source/lib/velocity/velocity.js","hash":"9f08181baea0cc0e906703b7e5df9111b9ef3373","modified":1548818372000},{"_id":"source/_posts/Project-Module/1.png","hash":"0d13a4094fe66b80ad104b87698f7d95c422acf0","modified":1562072882808},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-13-11-50-782_com.xingin.xhs.png","hash":"94400f10315c8e5d2717b26181f21ec5fa89dadb","modified":1567407533468},{"_id":"source/_posts/Thailand-Raiders/tianjin-airport.png","hash":"24a3881c4494b484a15cfaa065221d05241d9ebc","modified":1562925390800},{"_id":"themes/next/source/css/_common/components/footer/footer.styl","hash":"7905a7f625702b45645d8be1268cb8af3f698c70","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/header/header.styl","hash":"ae1ca14e51de67b07dba8f61ec79ee0e2e344574","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/header/headerband.styl","hash":"d27448f199fc2f9980b601bc22b87f08b5d64dd1","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/header/menu.styl","hash":"8a2421cb9005352905fae9d41a847ae56957247e","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/header/site-meta.styl","hash":"6c00f6e0978f4d8f9a846a15579963728aaa6a17","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/header/site-nav.styl","hash":"49c2b2c14a1e7fcc810c6be4b632975d0204c281","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/highlight/highlight.styl","hash":"25dc25f61a232f03ca72472b7852f882448ec185","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/highlight/diff.styl","hash":"96f32ea6c3265a3889e6abe57587f6e2a2a40dfb","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/pages/archive.styl","hash":"f5aa2ba3bfffc15475e7e72a55b5c9d18609fdf5","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/highlight/theme.styl","hash":"b76387934fb6bb75212b23c1a194486892cc495e","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/pages/categories.styl","hash":"4eff5b252d7b614e500fc7d52c97ce325e57d3ab","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/pages/authors.styl","hash":"ebbd43658f5a054d934c9ca5abdf801449ca6559","modified":1562848358889},{"_id":"themes/next/source/css/_common/components/pages/post-detail.styl","hash":"9bf4362a4d0ae151ada84b219d39fbe5bb8c790e","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/pages/schedule.styl","hash":"a82afbb72d83ee394aedc7b37ac0008a9823b4f4","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/pages/pages.styl","hash":"646467b94ae4a78eebabb2d8635a2ac12665fa4e","modified":1562848681019},{"_id":"themes/next/source/css/_common/components/post/my-post-copyright.styl","hash":"1a510f995e665b28d85ba4d169b824276c40e4f3","modified":1548843928000},{"_id":"themes/next/source/css/_common/components/post/post-collapse.styl","hash":"0f7f522cc6bfb3401d5afd62b0fcdf48bb2d604b","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-button.styl","hash":"e72a89e0f421444453e149ba32c77a64bd8e44e8","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-copyright.styl","hash":"f54367c0feda6986c030cc4d15a0ca6ceea14bcb","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-gallery.styl","hash":"387ce23bba52b22a586b2dfb4ec618fe1ffd3926","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-eof.styl","hash":"2cdc094ecf907a02fce25ad4a607cd5c40da0f2b","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-expand.styl","hash":"535b3b4f8cb1eec2558e094320e7dfb01f94c0e7","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-nav.styl","hash":"a5d8617a24d7cb6c5ad91ea621183ca2c0917331","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-reward.styl","hash":"36332c8a91f089f545f3c3e8ea90d08aa4d6e60c","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-meta.styl","hash":"aea21141015ca8c409d8b33e3e34ec505f464e93","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-rtl.styl","hash":"017074ef58166e2d69c53bb7590a0e7a8947a1ed","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-tags.styl","hash":"a352ae5b1f8857393bf770d2e638bf15f0c9585d","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-title.styl","hash":"d5a4e4fc17f1f7e7c3a61b52d8e2e9677e139de7","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-type.styl","hash":"10251257aceecb117233c9554dcf8ecfef8e2104","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/post/post-widgets.styl","hash":"e4055a0d2cd2b0ad9dc55928e2f3e7bd4e499da3","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author.styl","hash":"8f40a758fe6dff1f45268f2dc875b4336e551335","modified":1548837748000},{"_id":"themes/next/source/css/_common/components/post/post.styl","hash":"90d78b7270739eaab5b054226b684631a319011a","modified":1548844058000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-author-links.styl","hash":"0a6c0efffdf18bddbc1d1238feaed282b09cd0fe","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-dimmer.styl","hash":"efa5e5022e205b52786ce495d4879f5e7b8f84b2","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-blogroll.styl","hash":"89dd4f8b1f1cce3ad46cf2256038472712387d02","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-feed-link.styl","hash":"9486ddd2cb255227db102d09a7df4cae0fabad72","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-nav.styl","hash":"45fa7193435a8eae9960267438750b4c9fa9587f","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toc.styl","hash":"12937cae17c96c74d5c58db6cb29de3b2dfa14a2","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar.styl","hash":"50305b6ad7d09d2ffa4854e39f41ec1f4fe984fd","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/sidebar-toggle.styl","hash":"f7784aba0c1cd20d824c918c120012d57a5eaa2a","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/sidebar/site-state.styl","hash":"3623e7fa4324ec1307370f33d8f287a9e20a5578","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/blockquote-center.styl","hash":"c2abe4d87148e23e15d49ee225bc650de60baf46","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/exturl.styl","hash":"1b3cc9f4e5a7f6e05b4100e9990b37b20d4a2005","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/label.styl","hash":"4a457d265d62f287c63d48764ce45d9bcfc9ec5a","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/full-image.styl","hash":"37e951e734a252fe8a81f452b963df2ba90bfe90","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/group-pictures.styl","hash":"4851b981020c5cbc354a1af9b831a2dcb3cf9d39","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/note-modern.styl","hash":"ee7528900578ef4753effe05b346381c40de5499","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/note.styl","hash":"32c9156bea5bac9e9ad0b4c08ffbca8b3d9aac4b","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/tabs.styl","hash":"4ab5deed8c3b0c338212380f678f8382672e1bcb","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/tags/tags.styl","hash":"ead0d0f2321dc71505788c7f689f92257cf14947","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/baidushare.styl","hash":"93b08815c4d17e2b96fef8530ec1f1064dede6ef","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/busuanzi-counter.styl","hash":"d4e6d8d7b34dc69994593c208f875ae8f7e8a3ae","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/algolia-search.styl","hash":"fd42777b9125fd8969dc39d4f15473e2b91b4142","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/duoshuo.styl","hash":"2340dd9b3202c61d73cc708b790fac5adddbfc7f","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/han.styl","hash":"cce6772e2cdb4db85d35486ae4c6c59367fbdd40","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/localsearch.styl","hash":"d89c4b562b528e4746696b2ad8935764d133bdae","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/jiathis.styl","hash":"327b5f63d55ec26f7663185c1a778440588d9803","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/gitment.styl","hash":"34935b40237c074be5f5e8818c14ccfd802b7439","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/needsharebutton.styl","hash":"a5e3e6b4b4b814a9fe40b34d784fed67d6d977fa","modified":1548818372000},{"_id":"themes/next/source/css/_common/components/third-party/third-party.styl","hash":"1ccfbd4d0f5754b2dc2719a91245c95f547a7652","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/outline/outline.styl","hash":"5dc4859c66305f871e56cba78f64bfe3bf1b5f01","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Mist/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1548818372000},{"_id":"themes/next/source/css/_schemes/Muse/sidebar/sidebar-blogroll.styl","hash":"817587e46df49e819858c8ecbafa08b53d5ff040","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.otf","hash":"07436f011b44051f61b8329c99de4bec64e86f4b","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/font/han-space.woff","hash":"7a635062b10bf5662ae1d218ba0980171005d060","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/font/han.otf","hash":"f1f6bb8f461f5672e000380195d3d2358a28494c","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff","hash":"f38ff9b2eecaa17b50b66aa2dae87e9e7436d195","modified":1548818372000},{"_id":"themes/next/source/lib/Han/dist/font/han.woff2","hash":"623af3ed5423371ac136a4fe0e8cc7bb7396037a","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/helpers/fancybox_buttons.png","hash":"e385b139516c6813dcd64b8fc431c364ceafe5f3","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.css","hash":"1a9d8e5c22b371fcc69d4dbbb823d9c39f04c0c8","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-media.js","hash":"3bdf69ed2469e4fb57f5a95f17300eef891ff90d","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.css","hash":"4ac329c16a5277592fc12a37cca3d72ca4ec292f","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-buttons.js","hash":"91e41741c2e93f732c82aaacec4cfc6e3f3ec876","modified":1548818372000},{"_id":"themes/next/source/lib/fancybox/source/helpers/jquery.fancybox-thumbs.js","hash":"53e194f4a72e649c04fb586dd57762b8c022800b","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/fonts/FontAwesome.otf","hash":"048707bc52ac4b6563aaa383bfe8660a0ddc908c","modified":1548818372000},{"_id":"source/_posts/C++-02/1.png","hash":"36cb35aebf9aff9ea22a85ce733502814cd96341","modified":1563367590248},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.eot","hash":"d980c2ce873dc43af460d4d572d441304499f400","modified":1548818372000},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.ttf","hash":"13b1eab65a983c7a73bc7997c479d66943f7c6cb","modified":1548818372000},{"_id":"source/_posts/Design-Pattern-Observer/1.png","hash":"d3bddadb077b53b79235a90930fed4a902a531d1","modified":1576223331958},{"_id":"source/_posts/Kafka-Background/6.png","hash":"95bb5f40b31f98bec90ca4eb43fa1fcb6a6d2b1d","modified":1562815610839},{"_id":"source/_posts/Thailand-Raiders/Tiffany.png","hash":"e2b3b598e4f2f77aa72c6d888de5b7c28d971dd9","modified":1562930985684},{"_id":"source/_posts/Project-Module/9.png","hash":"b7a7304228d094b97030b6a3851d60c0cd40db8c","modified":1562157438227},{"_id":"source/_posts/Thailand-Raiders/8.png","hash":"05f3c25bcbdad89508a1740b34464f33ea8132ce","modified":1562931299084},{"_id":"source/_posts/Thailand-Raiders/WechatIMG38.jpeg","hash":"b9d274ae9388be4436f54708acb8ae92a303b60a","modified":1567407533496},{"_id":"source/_posts/Thailand-Raiders/9.png","hash":"565b668726c06a9abab0bd490da907f2b3ed6e98","modified":1562931644016},{"_id":"themes/next/source/lib/three/three.min.js","hash":"73f4cdc17e51a72b9bf5b9291f65386d615c483b","modified":1548818372000},{"_id":"source/_posts/Thailand-Raiders/455.jpeg","hash":"f62028d3c728e26a58ee9a081b5a470ab114d82b","modified":1565697870935},{"_id":"source/_posts/Thailand-Raiders/455-3.jpeg","hash":"604b935a2bcd0dc10de6a3303e741a72b572dc40","modified":1565697870927},{"_id":"themes/next/source/lib/font-awesome/fonts/fontawesome-webfont.svg","hash":"98a8aa5cf7d62c2eff5f07ede8d844b874ef06ed","modified":1548818372000},{"_id":"source/_posts/Thailand-Raiders/455-2.jpeg","hash":"c6bfeb6633daa1a6250c18f91f9369626959e157","modified":1565697870923},{"_id":"source/_posts/Thailand-Raiders/6.png","hash":"3f10dab38908d094d0b909422bc19d0a17340057","modified":1562926943522},{"_id":"themes/next/source/lib/algolia-instant-search/instantsearch.min.js","hash":"9ccc6f8144f54e86df9a3fd33a18368d81cf3a4f","modified":1548818372000},{"_id":"source/_posts/Github-Pages-Blog/select-theme.png","hash":"2f05fcf89dee3dbaf7042198d28ab27c567b6a0d","modified":1553669424315},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-13-12-27-105_com.xingin.xhs.png","hash":"8cff18582c7a30d6195fbcc5d7c55267eb7453ae","modified":1567407533475},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-13-11-56-133_com.xingin.xhs.png","hash":"e6eff5392fa75f21454b10b8d5952f92e083da2d","modified":1567407533471},{"_id":"source/_posts/Thailand-Raiders/7.png","hash":"3fc9d1546cac372d29ff9b8b7d15391355ca4b7f","modified":1562930773029},{"_id":"source/_posts/Thailand-Raiders/11.png","hash":"7d4c9b3713ea0e79a64cb03a47c4b300ba2e4b70","modified":1562932642973},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-14-25-04-833_com.xingin.xhs.png","hash":"2238216e08587f3b15762c9dd3e82051358a5e51","modified":1567407533491},{"_id":"source/_posts/Thailand-Raiders/4.png","hash":"1fb34d3299621f60fb2dbf4288d8c36e6ac5e77f","modified":1562926787294},{"_id":"source/_posts/Thailand-Raiders/2.png","hash":"d6619479a7b598851ad99a36ef764acbad9aa01a","modified":1562925091977},{"_id":"source/_posts/Thailand-Raiders/3.png","hash":"371d12b9c4257b27c643c35e22ded6217d31d2f5","modified":1562926690483},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-14-05-58-003_com.xingin.xhs.png","hash":"56e1172a88c0bfd9c4c52e333611fc6595ab8c7a","modified":1567407533485},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-18-389_com.xingin.xhs.png","hash":"f928b7f7e08fbb020de4fb3c4cf528f8d856b8e3","modified":1567407533435},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-30-499_com.xingin.xhs.png","hash":"7cafaa78693a7c0b2626f1ee2210b3b57ab2ed1b","modified":1567407533465},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-20-912_com.xingin.xhs.png","hash":"2ac2f81bc4349ec9568cb5747b88893642922a67","modified":1567407533441},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-46-03-072_com.xingin.xhs.png","hash":"9e417ba24b91a347b8cbb606f8c728e2557d2a82","modified":1567407533381},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-25-297_com.xingin.xhs.png","hash":"5c7ab3a4fb6d52e1ac7a7b25ac67c5f2e3e8ae0d","modified":1567407533458},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-23-188_com.xingin.xhs.png","hash":"2c4b2f791d89c9f9fdfc9f41c1d2e59c44be9703","modified":1567407533451},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-46-00-652_com.xingin.xhs.png","hash":"e8f3537c76dc753e795914ac8ffbe4e515b5304f","modified":1567407533364},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-14-972_com.xingin.xhs.png","hash":"a252f74aae9f5fc9bafc8086362434d537b30de9","modified":1567407533419},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-45-57-687_com.xingin.xhs.png","hash":"c38ed53378b5d8b29299a543b9615d289e2679a6","modified":1567407533345},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-46-08-364_com.xingin.xhs.png","hash":"98baf6d8c995e9f2a9e366730c584219e32a3911","modified":1567407533399},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-45-53-237_com.xingin.xhs.png","hash":"724228f9d5e8d6ad4dbc4c27ad75b316650834d7","modified":1567407533325}],"Category":[{"name":"redis","_id":"ck4859y2p0004t0fyvq59ozee"},{"name":"MyBatis","_id":"ck4859y2v000at0fy97kyjs0v"},{"name":"C++","_id":"ck4859y2z000ft0fy7qa2n5cz"},{"name":"","_id":"ck4859y39000qt0fytruffvv0"},{"name":"","_id":"ck4859y3j000wt0fyc0m7pryq"},{"name":"GUAVA","_id":"ck4859y3r0014t0fyjyfuw2m7"},{"name":"JVM","_id":"ck4859y3t001at0fyfz8ufpd7"},{"name":"Kafka","_id":"ck4859y3v001ht0fy67xd10v9"},{"name":"Mysql","_id":"ck4859y3v001lt0fy1691rvmm"},{"name":"","_id":"ck4859y3z0026t0fybz4smcrg"},{"name":"blog","_id":"ck4859y97003ot0fyk2w5e503"},{"name":"JAVA","_id":"ck4859y9b003xt0fy9y6jho6y"}],"Data":[],"Page":[{"title":"categories","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: categories\ntype: \"categories\"\ncomments: false\n---\n","date":"2019-03-27T06:50:24.318Z","updated":"2019-03-27T06:50:24.318Z","path":"categories/index.html","layout":"page","_id":"ck4859y2m0001t0fy91pknl22","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"tags","type":"tags","comments":0,"_content":"","source":"tags/index.md","raw":"---\ntitle: tags\ntype: \"tags\"\ncomments: false\n---","date":"2019-03-27T06:50:24.318Z","updated":"2019-03-27T06:50:24.318Z","path":"tags/index.html","layout":"page","_id":"ck4859y2o0003t0fyf2w0tkmp","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"authors","type":"authors","comments":0,"_content":"","source":"authors/index.md","raw":"---\ntitle: authors\ntype: \"authors\"\ncomments: false\n---","date":"2019-07-11T11:24:28.845Z","updated":"2019-07-11T11:24:28.842Z","path":"authors/index.html","layout":"page","_id":"ck4859y2r0007t0fyb9xfyke0","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"redis","date":"2019-03-13T14:33:04.000Z","copyright":true,"comments":0,"_content":"#### redis?\n```bash\nRedis key-value\n```\n\n#### Redis\n``` bash\nString: set key value\nHash: hmset name  key1 value1 key2 value2\nListlpush  name  value\nSetsadd  name  value\nzset(sorted set) zadd  name score value\n```\n#### Redisredis\n```bash\nRedis\n\n    1\n    2CPU\n    3\n    4IOIO\n```\n#### RedisRedis\n```bash\nRedis :RDB AOF \nRDB:,\nAOF:Redis,RedisAOF\n```\n#### \n```bash\n512M\n```\n#### Redis\n```bash\nABC,<>.\nB5501-11000\n```\n#### Redis\n```bash\nRedishash,.\nRedis 16384 keyCRC1616384.\nhash\n```\n#### Redis\n```bash\n\n,N-1.\n```\n#### Redis\n```bash\ndiscard-,.\nexec-.\nmulti-.\nwatch-keykey.\nunwatch-watchkey.\n```\n\n#### redis\n```bash\nredis+\n\nredis100mskeykey,key\nkey\n\nkeyrediskey\n```\n#### ?\n```bash\n,key,\nCPU\nCPUkey,.\n```\n","source":"_drafts/Redis.md","raw":"---\ntitle: redis\ndate: 2019-03-13 22:33:04\ntags:\n    - redis\n    - \ncategories: redis\ncopyright: true\ncomments: false\n---\n#### redis?\n```bash\nRedis key-value\n```\n\n#### Redis\n``` bash\nString: set key value\nHash: hmset name  key1 value1 key2 value2\nListlpush  name  value\nSetsadd  name  value\nzset(sorted set) zadd  name score value\n```\n#### Redisredis\n```bash\nRedis\n\n    1\n    2CPU\n    3\n    4IOIO\n```\n#### RedisRedis\n```bash\nRedis :RDB AOF \nRDB:,\nAOF:Redis,RedisAOF\n```\n#### \n```bash\n512M\n```\n#### Redis\n```bash\nABC,<>.\nB5501-11000\n```\n#### Redis\n```bash\nRedishash,.\nRedis 16384 keyCRC1616384.\nhash\n```\n#### Redis\n```bash\n\n,N-1.\n```\n#### Redis\n```bash\ndiscard-,.\nexec-.\nmulti-.\nwatch-keykey.\nunwatch-watchkey.\n```\n\n#### redis\n```bash\nredis+\n\nredis100mskeykey,key\nkey\n\nkeyrediskey\n```\n#### ?\n```bash\n,key,\nCPU\nCPUkey,.\n```\n","slug":"Redis","published":0,"updated":"2019-03-27T06:50:24.318Z","layout":"post","photos":[],"link":"","_id":"ck4859y2a0000t0fydtstsw7o","content":"<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis?\"></a>redis?</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis key-value</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String: <span class=\"built_in\">set</span> key value</span><br><span class=\"line\">Hash: hmset name  key1 value1 key2 value2</span><br><span class=\"line\">Listlpush  name  value</span><br><span class=\"line\">Setsadd  name  value</span><br><span class=\"line\">zset(sorted <span class=\"built_in\">set</span>) zadd  name score value</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redisredis\"><a href=\"#Redisredis\" class=\"headerlink\" title=\"Redisredis\"></a>Redisredis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis</span><br><span class=\"line\"></span><br><span class=\"line\">    1</span><br><span class=\"line\">    2CPU</span><br><span class=\"line\">    3</span><br><span class=\"line\">    4IOIO</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"RedisRedis\"><a href=\"#RedisRedis\" class=\"headerlink\" title=\"RedisRedis\"></a>RedisRedis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis :RDB AOF </span><br><span class=\"line\">RDB:,</span><br><span class=\"line\">AOF:Redis,RedisAOF</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">512M</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ABC,&lt;&gt;.</span><br><span class=\"line\">B5501-11000</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis<span class=\"built_in\">hash</span>,.</span><br><span class=\"line\">Redis 16384 keyCRC1616384.</span><br><span class=\"line\"><span class=\"built_in\">hash</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">,N-1.</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">discard-,.</span><br><span class=\"line\"><span class=\"built_in\">exec</span>-.</span><br><span class=\"line\">multi-.</span><br><span class=\"line\">watch-keykey.</span><br><span class=\"line\">unwatch-watchkey.</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis+</span><br><span class=\"line\"></span><br><span class=\"line\">redis100mskeykey,key</span><br><span class=\"line\">key</span><br><span class=\"line\"></span><br><span class=\"line\">keyrediskey</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">,key,</span><br><span class=\"line\">CPU</span><br><span class=\"line\">CPUkey,.</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis?\"></a>redis?</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis key-value</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">String: <span class=\"built_in\">set</span> key value</span><br><span class=\"line\">Hash: hmset name  key1 value1 key2 value2</span><br><span class=\"line\">Listlpush  name  value</span><br><span class=\"line\">Setsadd  name  value</span><br><span class=\"line\">zset(sorted <span class=\"built_in\">set</span>) zadd  name score value</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redisredis\"><a href=\"#Redisredis\" class=\"headerlink\" title=\"Redisredis\"></a>Redisredis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis</span><br><span class=\"line\"></span><br><span class=\"line\">    1</span><br><span class=\"line\">    2CPU</span><br><span class=\"line\">    3</span><br><span class=\"line\">    4IOIO</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"RedisRedis\"><a href=\"#RedisRedis\" class=\"headerlink\" title=\"RedisRedis\"></a>RedisRedis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis :RDB AOF </span><br><span class=\"line\">RDB:,</span><br><span class=\"line\">AOF:Redis,RedisAOF</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">512M</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ABC,&lt;&gt;.</span><br><span class=\"line\">B5501-11000</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Redis<span class=\"built_in\">hash</span>,.</span><br><span class=\"line\">Redis 16384 keyCRC1616384.</span><br><span class=\"line\"><span class=\"built_in\">hash</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">,N-1.</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">discard-,.</span><br><span class=\"line\"><span class=\"built_in\">exec</span>-.</span><br><span class=\"line\">multi-.</span><br><span class=\"line\">watch-keykey.</span><br><span class=\"line\">unwatch-watchkey.</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"redis\"><a href=\"#redis\" class=\"headerlink\" title=\"redis\"></a>redis</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">redis+</span><br><span class=\"line\"></span><br><span class=\"line\">redis100mskeykey,key</span><br><span class=\"line\">key</span><br><span class=\"line\"></span><br><span class=\"line\">keyrediskey</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"?\"></a>?</h4><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">,key,</span><br><span class=\"line\">CPU</span><br><span class=\"line\">CPUkey,.</span><br></pre></td></tr></table></figure>\n\n"},{"title":"MyBatis-MyBatis","date":"2019-11-15T08:51:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"# \nMyBatis 3 \n![mysql](../_posts/MyBatis-01/1.png)\n\n## \n1. :\n    * JAVA\n2. \n    * \n3. \n    * \n4. \n    * \n5. \n    * XPathmybatis-config.xml\n    * SQL\n6. \n    * \n7. \n    * \n8. \n    * \n9. Binding\n    * Mapper\n","source":"_drafts/MyBatis-01.md","raw":"---\ntitle: MyBatis-MyBatis\ndate: 2019-11-15 16:51:04\ntags:\n    - MyBatis\n    - \n    - \ncategories: MyBatis\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n# \nMyBatis 3 \n![mysql](../_posts/MyBatis-01/1.png)\n\n## \n1. :\n    * JAVA\n2. \n    * \n3. \n    * \n4. \n    * \n5. \n    * XPathmybatis-config.xml\n    * SQL\n6. \n    * \n7. \n    * \n8. \n    * \n9. Binding\n    * Mapper\n","slug":"MyBatis-01","published":0,"updated":"2019-12-12T07:19:51.411Z","layout":"post","photos":[],"link":"","_id":"ck4859y2n0002t0fyras55fxe","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MyBatis 3 <br><img src=\"/2019/11/15/MyBatis-01/../_posts/MyBatis-01/1.png\" alt=\"mysql\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>:<ul>\n<li>JAVA</li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li>XPathmybatis-config.xml</li>\n<li>SQL</li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li>Binding<ul>\n<li>Mapper</li>\n</ul>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MyBatis 3 <br><img src=\"/2019/11/15/MyBatis-01/../_posts/MyBatis-01/1.png\" alt=\"mysql\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>:<ul>\n<li>JAVA</li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li>XPathmybatis-config.xml</li>\n<li>SQL</li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li><ul>\n<li></li>\n</ul>\n</li>\n<li>Binding<ul>\n<li>Mapper</li>\n</ul>\n</li>\n</ol>\n"},{"title":"C++","date":"2019-07-09T12:17:00.000Z","author":"zyh","copyright":true,"comments":1,"_content":"## C\nc()\n```C++\n(T)expression  // expression T\nT(expression)  // expression T\n```\n## C++\nC++\n```C++\nconst_cast<T>(expression)\ndynamic_cast<T>(expression)\nreinterpret_cast<T>(expression)\nstatic_cast<T>(expression)\n```\n<!-- more -->\n### const_cast\nconstvolatileba1a`cout << a << endl;`1\n```C++\n#include <iostream>\nusing namespace std;\nint main(int argc, char *argv[]) {\n\tconst int a = 1;\n\tint* b = const_cast<int*> (&a);\n\t*b = 2;\n\tcout << a << \" \" << *(&a) << \" \" << *b << endl;\n}\n// 1 2 2\n```\n### dynamic_cast\ndynamic_cast ****************()std::bad_cast\n3\n- expression\n- expression()\n- expression()\n   - expression\n   - \n\n\n```C++\n#include <string>\n#include <iostream>\nusing namespace std;\n\nclass Base {\npublic:\n\tBase() {}\n\tBase(string s) : str(s) {}\n\tvirtual void Print() {cout << str << endl;}\nprivate:\n\tstring str;\n};\n\nclass Derived : public Base {\npublic:\n\tDerived() {}\n\tDerived(string s, int i) : Base(s), ival(i) {}\n\tvoid Print() {\n\t\tBase::Print();\n\t\tcout << ival << endl;\n\t}\n\tvoid PrintIval() {\n\t\tcout << ival << endl;\n\t}\nprivate:\n\tint ival;\n};\n```\nexample:\n```C++\nint main(int argc, char *argv[])\n{\n\t//\n\tBase* b = new Derived(\"test\", 1);\n\t//\n\tb->PrintIval();\n\t//\n\tDerived* d = dynamic_cast<Derived*> (b);\n\td->PrintIval();\n\treturn 0;\n}\n```\n### reinterpret_cast\nreinterpret_cast ******reinterpret_castconstvolatile**\n```C++\nint main(int argc, char *argv[])\n{\n\tchar a = 1;\n\t//a\n\tlong b = reinterpret_cast<long>(&a);\n\t//\n\tlong d = reinterpret_cast<long>(NULL);\n\t// int 48\n\tint e = reinterpret_cast<int>(&a);\n\treturn 0;\n}\n```\n324648\n\n### static_cast\nstatic_cast C\n- intfloatdoublecharenumint(->)\n- voidvoid*\n- ()()\nexample():\n```C++\nint main(int argc, char *argv[])\n{\n\tchar a = 'a';\n\t// char -> int\n\tint i = static_cast<int>(a);\n\t\n\tBase* b = new Base(\"123\");\n\t// Base  void*\n\tvoid* v = static_cast<void*>(b);\n\t// *void  Base\n\tb = static_cast<Base*>(v);\n\t\n\tDerived* d = new Derived(\"123\", 123);\n\t// Derived*  Base*\n\tBase* bb = static_cast<Base*>(d);\n\t// Base*  Derived*\n\tDerived* dd = static_cast<Derived*>(b);\n\t//!!!\n\tdd->PrintIval();\n}\n```\neffective C++\n> dynamic_cast\n>\n>C++-style()","source":"_posts/C++-01.md","raw":"---\ntitle: C++\ndate: 2019-07-09 20:17:00\ntags:\n    - C++\ncategories: C++\nauthor: zyh\ncopyright: true\ncomments: true\n---\n## C\nc()\n```C++\n(T)expression  // expression T\nT(expression)  // expression T\n```\n## C++\nC++\n```C++\nconst_cast<T>(expression)\ndynamic_cast<T>(expression)\nreinterpret_cast<T>(expression)\nstatic_cast<T>(expression)\n```\n<!-- more -->\n### const_cast\nconstvolatileba1a`cout << a << endl;`1\n```C++\n#include <iostream>\nusing namespace std;\nint main(int argc, char *argv[]) {\n\tconst int a = 1;\n\tint* b = const_cast<int*> (&a);\n\t*b = 2;\n\tcout << a << \" \" << *(&a) << \" \" << *b << endl;\n}\n// 1 2 2\n```\n### dynamic_cast\ndynamic_cast ****************()std::bad_cast\n3\n- expression\n- expression()\n- expression()\n   - expression\n   - \n\n\n```C++\n#include <string>\n#include <iostream>\nusing namespace std;\n\nclass Base {\npublic:\n\tBase() {}\n\tBase(string s) : str(s) {}\n\tvirtual void Print() {cout << str << endl;}\nprivate:\n\tstring str;\n};\n\nclass Derived : public Base {\npublic:\n\tDerived() {}\n\tDerived(string s, int i) : Base(s), ival(i) {}\n\tvoid Print() {\n\t\tBase::Print();\n\t\tcout << ival << endl;\n\t}\n\tvoid PrintIval() {\n\t\tcout << ival << endl;\n\t}\nprivate:\n\tint ival;\n};\n```\nexample:\n```C++\nint main(int argc, char *argv[])\n{\n\t//\n\tBase* b = new Derived(\"test\", 1);\n\t//\n\tb->PrintIval();\n\t//\n\tDerived* d = dynamic_cast<Derived*> (b);\n\td->PrintIval();\n\treturn 0;\n}\n```\n### reinterpret_cast\nreinterpret_cast ******reinterpret_castconstvolatile**\n```C++\nint main(int argc, char *argv[])\n{\n\tchar a = 1;\n\t//a\n\tlong b = reinterpret_cast<long>(&a);\n\t//\n\tlong d = reinterpret_cast<long>(NULL);\n\t// int 48\n\tint e = reinterpret_cast<int>(&a);\n\treturn 0;\n}\n```\n324648\n\n### static_cast\nstatic_cast C\n- intfloatdoublecharenumint(->)\n- voidvoid*\n- ()()\nexample():\n```C++\nint main(int argc, char *argv[])\n{\n\tchar a = 'a';\n\t// char -> int\n\tint i = static_cast<int>(a);\n\t\n\tBase* b = new Base(\"123\");\n\t// Base  void*\n\tvoid* v = static_cast<void*>(b);\n\t// *void  Base\n\tb = static_cast<Base*>(v);\n\t\n\tDerived* d = new Derived(\"123\", 123);\n\t// Derived*  Base*\n\tBase* bb = static_cast<Base*>(d);\n\t// Base*  Derived*\n\tDerived* dd = static_cast<Derived*>(b);\n\t//!!!\n\tdd->PrintIval();\n}\n```\neffective C++\n> dynamic_cast\n>\n>C++-style()","slug":"C++-01","published":1,"updated":"2019-07-30T11:37:16.769Z","layout":"post","photos":[],"link":"","_id":"ck4859y2q0006t0fyn4wm021x","content":"<h2 id=\"C\"><a href=\"#C\" class=\"headerlink\" title=\"C\"></a>C</h2><p>c()</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(T)expression  <span class=\"comment\">// expression T</span></span><br><span class=\"line\">T(expression)  <span class=\"comment\">// expression T</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"C-\"><a href=\"#C-\" class=\"headerlink\" title=\"C++\"></a>C++</h2><p>C++</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const_cast</span>&lt;T&gt;(expression)</span><br><span class=\"line\"><span class=\"keyword\">dynamic_cast</span>&lt;T&gt;(expression)</span><br><span class=\"line\"><span class=\"keyword\">reinterpret_cast</span>&lt;T&gt;(expression)</span><br><span class=\"line\"><span class=\"keyword\">static_cast</span>&lt;T&gt;(expression)</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<h3 id=\"const-cast\"><a href=\"#const-cast\" class=\"headerlink\" title=\"const_cast\"></a>const_cast</h3><p>constvolatileba1a<code>cout &lt;&lt; a &lt;&lt; endl;</code>1</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">const</span> <span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span>* b = <span class=\"keyword\">const_cast</span>&lt;<span class=\"keyword\">int</span>*&gt; (&amp;a);</span><br><span class=\"line\">\t*b = <span class=\"number\">2</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; a &lt;&lt; <span class=\"string\">\" \"</span> &lt;&lt; *(&amp;a) &lt;&lt; <span class=\"string\">\" \"</span> &lt;&lt; *b &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 1 2 2</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dynamic-cast\"><a href=\"#dynamic-cast\" class=\"headerlink\" title=\"dynamic_cast\"></a>dynamic_cast</h3><p>dynamic_cast <strong></strong><strong></strong><strong></strong><strong></strong>()std::bad_cast<br>3</p>\n<ul>\n<li>expression</li>\n<li>expression()</li>\n<li>expression()<ul>\n<li>expression</li>\n<li></li>\n</ul>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Base</span> &#123;</span></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\tBase() &#123;&#125;</span><br><span class=\"line\">\tBase(<span class=\"built_in\">string</span> s) : str(s) &#123;&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">virtual</span> <span class=\"keyword\">void</span> <span class=\"title\">Print</span><span class=\"params\">()</span> </span>&#123;<span class=\"built_in\">cout</span> &lt;&lt; str &lt;&lt; <span class=\"built_in\">endl</span>;&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\t<span class=\"built_in\">string</span> str;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Derived</span> :</span> <span class=\"keyword\">public</span> Base &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\tDerived() &#123;&#125;</span><br><span class=\"line\">\tDerived(<span class=\"built_in\">string</span> s, <span class=\"keyword\">int</span> i) : Base(s), ival(i) &#123;&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Print</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tBase::Print();</span><br><span class=\"line\">\t\t<span class=\"built_in\">cout</span> &lt;&lt; ival &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">PrintIval</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">cout</span> &lt;&lt; ival &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> ival;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>example:</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tBase* b = <span class=\"keyword\">new</span> Derived(<span class=\"string\">\"test\"</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tb-&gt;PrintIval();</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tDerived* d = <span class=\"keyword\">dynamic_cast</span>&lt;Derived*&gt; (b);</span><br><span class=\"line\">\td-&gt;PrintIval();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"reinterpret-cast\"><a href=\"#reinterpret-cast\" class=\"headerlink\" title=\"reinterpret_cast\"></a>reinterpret_cast</h3><p>reinterpret_cast <strong></strong><strong>reinterpret_castconstvolatile</strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//a</span></span><br><span class=\"line\">\t<span class=\"keyword\">long</span> b = <span class=\"keyword\">reinterpret_cast</span>&lt;<span class=\"keyword\">long</span>&gt;(&amp;a);</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">long</span> d = <span class=\"keyword\">reinterpret_cast</span>&lt;<span class=\"keyword\">long</span>&gt;(<span class=\"literal\">NULL</span>);</span><br><span class=\"line\">\t<span class=\"comment\">// int 48</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> e = <span class=\"keyword\">reinterpret_cast</span>&lt;<span class=\"keyword\">int</span>&gt;(&amp;a);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>324648</p>\n<h3 id=\"static-cast\"><a href=\"#static-cast\" class=\"headerlink\" title=\"static_cast\"></a>static_cast</h3><p>static_cast C</p>\n<ul>\n<li>intfloatdoublecharenumint(-&gt;)</li>\n<li>voidvoid*</li>\n<li>()()<br>example():<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a = <span class=\"string\">'a'</span>;</span><br><span class=\"line\">\t<span class=\"comment\">// char -&gt; int</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i = <span class=\"keyword\">static_cast</span>&lt;<span class=\"keyword\">int</span>&gt;(a);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tBase* b = <span class=\"keyword\">new</span> Base(<span class=\"string\">\"123\"</span>);</span><br><span class=\"line\">\t<span class=\"comment\">// Base  void*</span></span><br><span class=\"line\">\t<span class=\"keyword\">void</span>* v = <span class=\"keyword\">static_cast</span>&lt;<span class=\"keyword\">void</span>*&gt;(b);</span><br><span class=\"line\">\t<span class=\"comment\">// *void  Base</span></span><br><span class=\"line\">\tb = <span class=\"keyword\">static_cast</span>&lt;Base*&gt;(v);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tDerived* d = <span class=\"keyword\">new</span> Derived(<span class=\"string\">\"123\"</span>, <span class=\"number\">123</span>);</span><br><span class=\"line\">\t<span class=\"comment\">// Derived*  Base*</span></span><br><span class=\"line\">\tBase* bb = <span class=\"keyword\">static_cast</span>&lt;Base*&gt;(d);</span><br><span class=\"line\">\t<span class=\"comment\">// Base*  Derived*</span></span><br><span class=\"line\">\tDerived* dd = <span class=\"keyword\">static_cast</span>&lt;Derived*&gt;(b);</span><br><span class=\"line\">\t<span class=\"comment\">//!!!</span></span><br><span class=\"line\">\tdd-&gt;PrintIval();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>effective C++</p>\n<blockquote>\n<p> dynamic_cast<br><br>C++-style()</p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<h2 id=\"C\"><a href=\"#C\" class=\"headerlink\" title=\"C\"></a>C</h2><p>c()</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">(T)expression  <span class=\"comment\">// expression T</span></span><br><span class=\"line\">T(expression)  <span class=\"comment\">// expression T</span></span><br></pre></td></tr></table></figure>\n\n<h2 id=\"C-\"><a href=\"#C-\" class=\"headerlink\" title=\"C++\"></a>C++</h2><p>C++</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const_cast</span>&lt;T&gt;(expression)</span><br><span class=\"line\"><span class=\"keyword\">dynamic_cast</span>&lt;T&gt;(expression)</span><br><span class=\"line\"><span class=\"keyword\">reinterpret_cast</span>&lt;T&gt;(expression)</span><br><span class=\"line\"><span class=\"keyword\">static_cast</span>&lt;T&gt;(expression)</span><br></pre></td></tr></table></figure>","more":"<h3 id=\"const-cast\"><a href=\"#const-cast\" class=\"headerlink\" title=\"const_cast\"></a>const_cast</h3><p>constvolatileba1a<code>cout &lt;&lt; a &lt;&lt; endl;</code>1</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">const</span> <span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">int</span>* b = <span class=\"keyword\">const_cast</span>&lt;<span class=\"keyword\">int</span>*&gt; (&amp;a);</span><br><span class=\"line\">\t*b = <span class=\"number\">2</span>;</span><br><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; a &lt;&lt; <span class=\"string\">\" \"</span> &lt;&lt; *(&amp;a) &lt;&lt; <span class=\"string\">\" \"</span> &lt;&lt; *b &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">// 1 2 2</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dynamic-cast\"><a href=\"#dynamic-cast\" class=\"headerlink\" title=\"dynamic_cast\"></a>dynamic_cast</h3><p>dynamic_cast <strong></strong><strong></strong><strong></strong><strong></strong>()std::bad_cast<br>3</p>\n<ul>\n<li>expression</li>\n<li>expression()</li>\n<li>expression()<ul>\n<li>expression</li>\n<li></li>\n</ul>\n</li>\n</ul>\n<p></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;string&gt;</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">&lt;iostream&gt;</span></span></span><br><span class=\"line\"><span class=\"keyword\">using</span> <span class=\"keyword\">namespace</span> <span class=\"built_in\">std</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Base</span> &#123;</span></span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\tBase() &#123;&#125;</span><br><span class=\"line\">\tBase(<span class=\"built_in\">string</span> s) : str(s) &#123;&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">virtual</span> <span class=\"keyword\">void</span> <span class=\"title\">Print</span><span class=\"params\">()</span> </span>&#123;<span class=\"built_in\">cout</span> &lt;&lt; str &lt;&lt; <span class=\"built_in\">endl</span>;&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\t<span class=\"built_in\">string</span> str;</span><br><span class=\"line\">&#125;;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Derived</span> :</span> <span class=\"keyword\">public</span> Base &#123;</span><br><span class=\"line\"><span class=\"keyword\">public</span>:</span><br><span class=\"line\">\tDerived() &#123;&#125;</span><br><span class=\"line\">\tDerived(<span class=\"built_in\">string</span> s, <span class=\"keyword\">int</span> i) : Base(s), ival(i) &#123;&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">Print</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\tBase::Print();</span><br><span class=\"line\">\t\t<span class=\"built_in\">cout</span> &lt;&lt; ival &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">PrintIval</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">cout</span> &lt;&lt; ival &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"><span class=\"keyword\">private</span>:</span><br><span class=\"line\">\t<span class=\"keyword\">int</span> ival;</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<p>example:</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tBase* b = <span class=\"keyword\">new</span> Derived(<span class=\"string\">\"test\"</span>, <span class=\"number\">1</span>);</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tb-&gt;PrintIval();</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tDerived* d = <span class=\"keyword\">dynamic_cast</span>&lt;Derived*&gt; (b);</span><br><span class=\"line\">\td-&gt;PrintIval();</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"reinterpret-cast\"><a href=\"#reinterpret-cast\" class=\"headerlink\" title=\"reinterpret_cast\"></a>reinterpret_cast</h3><p>reinterpret_cast <strong></strong><strong>reinterpret_castconstvolatile</strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//a</span></span><br><span class=\"line\">\t<span class=\"keyword\">long</span> b = <span class=\"keyword\">reinterpret_cast</span>&lt;<span class=\"keyword\">long</span>&gt;(&amp;a);</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">long</span> d = <span class=\"keyword\">reinterpret_cast</span>&lt;<span class=\"keyword\">long</span>&gt;(<span class=\"literal\">NULL</span>);</span><br><span class=\"line\">\t<span class=\"comment\">// int 48</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> e = <span class=\"keyword\">reinterpret_cast</span>&lt;<span class=\"keyword\">int</span>&gt;(&amp;a);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>324648</p>\n<h3 id=\"static-cast\"><a href=\"#static-cast\" class=\"headerlink\" title=\"static_cast\"></a>static_cast</h3><p>static_cast C</p>\n<ul>\n<li>intfloatdoublecharenumint(-&gt;)</li>\n<li>voidvoid*</li>\n<li>()()<br>example():<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">char</span> a = <span class=\"string\">'a'</span>;</span><br><span class=\"line\">\t<span class=\"comment\">// char -&gt; int</span></span><br><span class=\"line\">\t<span class=\"keyword\">int</span> i = <span class=\"keyword\">static_cast</span>&lt;<span class=\"keyword\">int</span>&gt;(a);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tBase* b = <span class=\"keyword\">new</span> Base(<span class=\"string\">\"123\"</span>);</span><br><span class=\"line\">\t<span class=\"comment\">// Base  void*</span></span><br><span class=\"line\">\t<span class=\"keyword\">void</span>* v = <span class=\"keyword\">static_cast</span>&lt;<span class=\"keyword\">void</span>*&gt;(b);</span><br><span class=\"line\">\t<span class=\"comment\">// *void  Base</span></span><br><span class=\"line\">\tb = <span class=\"keyword\">static_cast</span>&lt;Base*&gt;(v);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\tDerived* d = <span class=\"keyword\">new</span> Derived(<span class=\"string\">\"123\"</span>, <span class=\"number\">123</span>);</span><br><span class=\"line\">\t<span class=\"comment\">// Derived*  Base*</span></span><br><span class=\"line\">\tBase* bb = <span class=\"keyword\">static_cast</span>&lt;Base*&gt;(d);</span><br><span class=\"line\">\t<span class=\"comment\">// Base*  Derived*</span></span><br><span class=\"line\">\tDerived* dd = <span class=\"keyword\">static_cast</span>&lt;Derived*&gt;(b);</span><br><span class=\"line\">\t<span class=\"comment\">//!!!</span></span><br><span class=\"line\">\tdd-&gt;PrintIval();</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n<p>effective C++</p>\n<blockquote>\n<p> dynamic_cast<br><br>C++-style()</p>\n</blockquote>"},{"title":"C++","date":"2019-07-09T12:17:00.000Z","author":"zyh","copyright":true,"comments":1,"_content":"## \nC++************\n```C++\nint func() {return func;}\nint a = 1 + 2;\nint b = func();\nint c = a + b;\nint d = c;\n```\n<!-- more -->\n2 a(1 + 2)3bfunc()4c(a+b)5dca,b,c,d(1+2), func(), (a+b)\nC++11********c++11T&&std::move()\n## \nC++11\n```C++\nint b = 1;\nint &a = b;\nint &c = 2;   //!\n```\n3\nC++ && \n```C++\nint func() {return 1;}\nint && a = 1;\nint && b = (1 + 2) * 3;\nint && c = func();\nint && d = a;    //!\n```\n5\n\n****`std::move()`:\n```C++\nint a = 1;\nint &&b = std::move(a);  //\n```\n**aa**!\n****\n```C++\nvoid func(const string &str) {\n\tcout << str << endl;\n}\n\nint main(int argc, char *argv[]) {\n\tstring s1(\"1234\");\n\tconst string s2(\"1234\");\n\tfunc(s1);                  //\n\tfunc(s2);                  //\n\tfunc(string(\"1234\"));      //\n\treturn 0;\n}\n```\n()\n![1](C++-02/1.png)","source":"_posts/C++-02.md","raw":"---\ntitle: C++\ndate: 2019-07-09 20:17:00\ntags:\n    - C++\ncategories: C++\nauthor: zyh\ncopyright: true\ncomments: true\n---\n## \nC++************\n```C++\nint func() {return func;}\nint a = 1 + 2;\nint b = func();\nint c = a + b;\nint d = c;\n```\n<!-- more -->\n2 a(1 + 2)3bfunc()4c(a+b)5dca,b,c,d(1+2), func(), (a+b)\nC++11********c++11T&&std::move()\n## \nC++11\n```C++\nint b = 1;\nint &a = b;\nint &c = 2;   //!\n```\n3\nC++ && \n```C++\nint func() {return 1;}\nint && a = 1;\nint && b = (1 + 2) * 3;\nint && c = func();\nint && d = a;    //!\n```\n5\n\n****`std::move()`:\n```C++\nint a = 1;\nint &&b = std::move(a);  //\n```\n**aa**!\n****\n```C++\nvoid func(const string &str) {\n\tcout << str << endl;\n}\n\nint main(int argc, char *argv[]) {\n\tstring s1(\"1234\");\n\tconst string s2(\"1234\");\n\tfunc(s1);                  //\n\tfunc(s2);                  //\n\tfunc(string(\"1234\"));      //\n\treturn 0;\n}\n```\n()\n![1](C++-02/1.png)","slug":"C++-02","published":1,"updated":"2019-07-30T11:37:16.779Z","layout":"post","photos":[],"link":"","_id":"ck4859y2s0008t0fy3l37j2fz","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>C++<strong></strong><strong></strong><strong></strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> func;&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span> + <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = func();</span><br><span class=\"line\"><span class=\"keyword\">int</span> c = a + b;</span><br><span class=\"line\"><span class=\"keyword\">int</span> d = c;</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<p>2 a(1 + 2)3bfunc()4c(a+b)5dca,b,c,d(1+2), func(), (a+b)<br>C++11<strong></strong><strong></strong>c++11T&amp;&amp;std::move()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>C++11</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;a = b;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;c = <span class=\"number\">2</span>;   <span class=\"comment\">//!</span></span><br></pre></td></tr></table></figure>\n\n<p>3<br>C++ &amp;&amp; </p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> <span class=\"number\">1</span>;&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; b = (<span class=\"number\">1</span> + <span class=\"number\">2</span>) * <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; c = func();</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; d = a;    <span class=\"comment\">//!</span></span><br></pre></td></tr></table></figure>\n\n<p>5<br><br><strong></strong><code>std::move()</code>:</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp;b = <span class=\"built_in\">std</span>::move(a);  <span class=\"comment\">//</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>aa</strong>!<br><strong></strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">func</span><span class=\"params\">(<span class=\"keyword\">const</span> <span class=\"built_in\">string</span> &amp;str)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; str &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"built_in\">string</span> <span class=\"title\">s1</span><span class=\"params\">(<span class=\"string\">\"1234\"</span>)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">const</span> <span class=\"built_in\">string</span> <span class=\"title\">s2</span><span class=\"params\">(<span class=\"string\">\"1234\"</span>)</span></span>;</span><br><span class=\"line\">\tfunc(s1);                  <span class=\"comment\">//</span></span><br><span class=\"line\">\tfunc(s2);                  <span class=\"comment\">//</span></span><br><span class=\"line\">\tfunc(<span class=\"built_in\">string</span>(<span class=\"string\">\"1234\"</span>));      <span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>()<br><img src=\"/2019/07/09/C++-02/1.png\" alt=\"1\"></p>\n","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>C++<strong></strong><strong></strong><strong></strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> func;&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span> + <span class=\"number\">2</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> b = func();</span><br><span class=\"line\"><span class=\"keyword\">int</span> c = a + b;</span><br><span class=\"line\"><span class=\"keyword\">int</span> d = c;</span><br></pre></td></tr></table></figure>","more":"<p>2 a(1 + 2)3bfunc()4c(a+b)5dca,b,c,d(1+2), func(), (a+b)<br>C++11<strong></strong><strong></strong>c++11T&amp;&amp;std::move()</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>C++11</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> b = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;a = b;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;c = <span class=\"number\">2</span>;   <span class=\"comment\">//!</span></span><br></pre></td></tr></table></figure>\n\n<p>3<br>C++ &amp;&amp; </p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">func</span><span class=\"params\">()</span> </span>&#123;<span class=\"keyword\">return</span> <span class=\"number\">1</span>;&#125;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; b = (<span class=\"number\">1</span> + <span class=\"number\">2</span>) * <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; c = func();</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp; d = a;    <span class=\"comment\">//!</span></span><br></pre></td></tr></table></figure>\n\n<p>5<br><br><strong></strong><code>std::move()</code>:</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> a = <span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">int</span> &amp;&amp;b = <span class=\"built_in\">std</span>::move(a);  <span class=\"comment\">//</span></span><br></pre></td></tr></table></figure>\n\n<p><strong>aa</strong>!<br><strong></strong></p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">func</span><span class=\"params\">(<span class=\"keyword\">const</span> <span class=\"built_in\">string</span> &amp;str)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">cout</span> &lt;&lt; str &lt;&lt; <span class=\"built_in\">endl</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">int</span> <span class=\"title\">main</span><span class=\"params\">(<span class=\"keyword\">int</span> argc, <span class=\"keyword\">char</span> *argv[])</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"built_in\">string</span> <span class=\"title\">s1</span><span class=\"params\">(<span class=\"string\">\"1234\"</span>)</span></span>;</span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">const</span> <span class=\"built_in\">string</span> <span class=\"title\">s2</span><span class=\"params\">(<span class=\"string\">\"1234\"</span>)</span></span>;</span><br><span class=\"line\">\tfunc(s1);                  <span class=\"comment\">//</span></span><br><span class=\"line\">\tfunc(s2);                  <span class=\"comment\">//</span></span><br><span class=\"line\">\tfunc(<span class=\"built_in\">string</span>(<span class=\"string\">\"1234\"</span>));      <span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>()<br><img src=\"/2019/07/09/C++-02/1.png\" alt=\"1\"></p>"},{"title":"-","date":"2019-12-13T04:00:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"## \n\n\n10030\n\n**Strategy**\n<!-- more -->\n## \n\n### \n![](Design-Pattern-Strategy/1.png)\n```java\n\npublic abstract class Duck {\t\n    public void Quack() {\t\n        System.out.println(\"~~gaga~~\");\n    }\n    public abstract void display();\n    public void swim() {\t\n        System.out.println(\"~~im swim~~\");\n    }\n}\n\n```\nGreenHeadDuckDuck \n```java\n\npublic class GreenHeadDuck extends Duck {\t\n    @Override\t\n    public void display() {\t\n          System.out.println(\"**GreenHead**\");\n    }\n}\n```\n### \n\n\n\n```java\npublic abstract class Duck {\n        //...;\n\t public void Fly() {\t\n\t \tSystem.out.println(\"~~im fly~~\");\n\t }\n}\n```\n,FlyDuckDuck\n\nO(N^2)\n\n### \n\n\n1+\n\n2...\n\n![](Design-Pattern-Strategy/2.png)\n\n### \n\n```java\npublic abstract class Duck {\t\n    FlyBehavior mFlyBehavior;\n    QuackBehavior mQuackBehavior;\n    public Duck() { }\n    public void Fly() {\t\n        mFlyBehavior.fly();\n    }\n    public void Quack() {\t\n        mQuackBehavior.quack();\n    }\n    public abstract void display();\n}\n\n\npublic class GreenHeadDuck extends Duck {\n    public GreenHeadDuck() {\n        mFlyBehavior = new GoodFlyBehavior();\n        mQuackBehavior = new GaGaQuackBehavior();\n    }\n    @Override\n    public void display() {\n        System.out.println(\"Im a real GreenHeadDuck\");\n    }\n}\n\n```\n## \n1. >\n\n2. \n\n## \n1. Open-Closed PrincipleOCP\n    * ()()\n    * \n\n2. Liskov Substitution PrincipleLSP\n    * **** BaseDerivedDerivedBasebmethod1(Base b)dmethod1(d)\n    * \n    * \n","source":"_posts/Design-Pattern-Strategy.md","raw":"---\ntitle: -\ndate: 2019-12-13 12:00:04\ntags:\n    - \ncategories: \nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n## \n\n\n10030\n\n**Strategy**\n<!-- more -->\n## \n\n### \n![](Design-Pattern-Strategy/1.png)\n```java\n\npublic abstract class Duck {\t\n    public void Quack() {\t\n        System.out.println(\"~~gaga~~\");\n    }\n    public abstract void display();\n    public void swim() {\t\n        System.out.println(\"~~im swim~~\");\n    }\n}\n\n```\nGreenHeadDuckDuck \n```java\n\npublic class GreenHeadDuck extends Duck {\t\n    @Override\t\n    public void display() {\t\n          System.out.println(\"**GreenHead**\");\n    }\n}\n```\n### \n\n\n\n```java\npublic abstract class Duck {\n        //...;\n\t public void Fly() {\t\n\t \tSystem.out.println(\"~~im fly~~\");\n\t }\n}\n```\n,FlyDuckDuck\n\nO(N^2)\n\n### \n\n\n1+\n\n2...\n\n![](Design-Pattern-Strategy/2.png)\n\n### \n\n```java\npublic abstract class Duck {\t\n    FlyBehavior mFlyBehavior;\n    QuackBehavior mQuackBehavior;\n    public Duck() { }\n    public void Fly() {\t\n        mFlyBehavior.fly();\n    }\n    public void Quack() {\t\n        mQuackBehavior.quack();\n    }\n    public abstract void display();\n}\n\n\npublic class GreenHeadDuck extends Duck {\n    public GreenHeadDuck() {\n        mFlyBehavior = new GoodFlyBehavior();\n        mQuackBehavior = new GaGaQuackBehavior();\n    }\n    @Override\n    public void display() {\n        System.out.println(\"Im a real GreenHeadDuck\");\n    }\n}\n\n```\n## \n1. >\n\n2. \n\n## \n1. Open-Closed PrincipleOCP\n    * ()()\n    * \n\n2. Liskov Substitution PrincipleLSP\n    * **** BaseDerivedDerivedBasebmethod1(Base b)dmethod1(d)\n    * \n    * \n","slug":"Design-Pattern-Strategy","published":1,"updated":"2019-12-16T07:57:16.490Z","_id":"ck4859y2u0009t0fy5cbsap0e","layout":"post","photos":[],"link":"","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>10030</p>\n<p><strong>Strategy</strong></p>\n<a id=\"more\"></a>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/12/13/Design-Pattern-Strategy/1.png\" alt=\"\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Duck</span> </span>&#123;\t</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Quack</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"~~gaga~~\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">swim</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"~~im swim~~\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>GreenHeadDuckDuck </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GreenHeadDuck</span> <span class=\"keyword\">extends</span> <span class=\"title\">Duck</span> </span>&#123;\t</span><br><span class=\"line\">    <span class=\"meta\">@Override</span>\t</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">          System.out.println(<span class=\"string\">\"**GreenHead**\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Duck</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//...;</span></span><br><span class=\"line\">\t <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">\t \tSystem.out.println(<span class=\"string\">\"~~im fly~~\"</span>);</span><br><span class=\"line\">\t &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,FlyDuckDuck<br><br>O(N^2)</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>1+</p>\n<p>2</p>\n<p><img src=\"/2019/12/13/Design-Pattern-Strategy/2.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Duck</span> </span>&#123;\t</span><br><span class=\"line\">    FlyBehavior mFlyBehavior;</span><br><span class=\"line\">    QuackBehavior mQuackBehavior;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Duck</span><span class=\"params\">()</span> </span>&#123; &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        mFlyBehavior.fly();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Quack</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        mQuackBehavior.quack();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GreenHeadDuck</span> <span class=\"keyword\">extends</span> <span class=\"title\">Duck</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">GreenHeadDuck</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        mFlyBehavior = <span class=\"keyword\">new</span> GoodFlyBehavior();</span><br><span class=\"line\">        mQuackBehavior = <span class=\"keyword\">new</span> GaGaQuackBehavior();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Im a real GreenHeadDuck\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p>&gt;</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p>Open-Closed PrincipleOCP</p>\n<ul>\n<li>()()</li>\n<li></li>\n</ul>\n</li>\n<li><p>Liskov Substitution PrincipleLSP</p>\n<ul>\n<li><strong></strong> BaseDerivedDerivedBasebmethod1(Base b)dmethod1(d)</li>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>10030</p>\n<p><strong>Strategy</strong></p>","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/12/13/Design-Pattern-Strategy/1.png\" alt=\"\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Duck</span> </span>&#123;\t</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Quack</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"~~gaga~~\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">swim</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"~~im swim~~\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>GreenHeadDuckDuck </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GreenHeadDuck</span> <span class=\"keyword\">extends</span> <span class=\"title\">Duck</span> </span>&#123;\t</span><br><span class=\"line\">    <span class=\"meta\">@Override</span>\t</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">          System.out.println(<span class=\"string\">\"**GreenHead**\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Duck</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//...;</span></span><br><span class=\"line\">\t <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">\t \tSystem.out.println(<span class=\"string\">\"~~im fly~~\"</span>);</span><br><span class=\"line\">\t &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>,FlyDuckDuck<br><br>O(N^2)</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>1+</p>\n<p>2</p>\n<p><img src=\"/2019/12/13/Design-Pattern-Strategy/2.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Duck</span> </span>&#123;\t</span><br><span class=\"line\">    FlyBehavior mFlyBehavior;</span><br><span class=\"line\">    QuackBehavior mQuackBehavior;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Duck</span><span class=\"params\">()</span> </span>&#123; &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Fly</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        mFlyBehavior.fly();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">Quack</span><span class=\"params\">()</span> </span>&#123;\t</span><br><span class=\"line\">        mQuackBehavior.quack();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">abstract</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">GreenHeadDuck</span> <span class=\"keyword\">extends</span> <span class=\"title\">Duck</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">GreenHeadDuck</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        mFlyBehavior = <span class=\"keyword\">new</span> GoodFlyBehavior();</span><br><span class=\"line\">        mQuackBehavior = <span class=\"keyword\">new</span> GaGaQuackBehavior();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Im a real GreenHeadDuck\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p>&gt;</p>\n</li>\n<li><p></p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><p>Open-Closed PrincipleOCP</p>\n<ul>\n<li>()()</li>\n<li></li>\n</ul>\n</li>\n<li><p>Liskov Substitution PrincipleLSP</p>\n<ul>\n<li><strong></strong> BaseDerivedDerivedBasebmethod1(Base b)dmethod1(d)</li>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ol>"},{"title":"git.idea","date":"2019-07-11T03:39:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"1..ideaignore\n```bash\n$ echo '.idea' >> .gitignore\n```\n<!-- more -->\n\n2.gitidea\n```bash\n$ git rm -r --cached .idea\n```\n\n3..gitignoregit\n```bash\n$ git add .gitignore\n```\n\n4..gitignore.idea\n```bash\n$ git commit -m '.idea'\n```\n\n5PushGit\n\n```bash\n$ git push\n```","source":"_posts/GIt-Ignore.md","raw":"---\ntitle: git.idea\ndate: 2019-07-11 11:39:04\ntags:\n    - git\n    - \ncategories: \nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n1..ideaignore\n```bash\n$ echo '.idea' >> .gitignore\n```\n<!-- more -->\n\n2.gitidea\n```bash\n$ git rm -r --cached .idea\n```\n\n3..gitignoregit\n```bash\n$ git add .gitignore\n```\n\n4..gitignore.idea\n```bash\n$ git commit -m '.idea'\n```\n\n5PushGit\n\n```bash\n$ git push\n```","slug":"GIt-Ignore","published":1,"updated":"2019-07-30T11:37:16.767Z","layout":"post","photos":[],"link":"","_id":"ck4859y2v000ct0fy3uk7y04f","content":"<p>1..ideaignore</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">echo</span> <span class=\"string\">'.idea'</span> &gt;&gt; .gitignore</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<p>2.gitidea</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git rm -r --cached .idea</span><br></pre></td></tr></table></figure>\n\n<p>3..gitignoregit</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git add .gitignore</span><br></pre></td></tr></table></figure>\n\n<p>4..gitignore.idea</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git commit -m <span class=\"string\">'.idea'</span></span><br></pre></td></tr></table></figure>\n\n<p>5PushGit</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git push</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<p>1..ideaignore</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">echo</span> <span class=\"string\">'.idea'</span> &gt;&gt; .gitignore</span><br></pre></td></tr></table></figure>","more":"<p>2.gitidea</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git rm -r --cached .idea</span><br></pre></td></tr></table></figure>\n\n<p>3..gitignoregit</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git add .gitignore</span><br></pre></td></tr></table></figure>\n\n<p>4..gitignore.idea</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git commit -m <span class=\"string\">'.idea'</span></span><br></pre></td></tr></table></figure>\n\n<p>5PushGit</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git push</span><br></pre></td></tr></table></figure>"},{"title":"Guava-","date":"2019-10-24T02:55:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"### \nhttp://code.google.com/p/guava-libraries\nhttp://www.ostools.net/apidocs/apidoc?api=guava\nhttps://www.kancloud.cn/wizardforcel/java-opensource-doc/112616\n<!-- more -->\n### \n* [Guava Google Guava ](http://www.iocoder.cn/Guava/peida/intro/)\n* [Guava Optional null](http://www.iocoder.cn/Guava/peida/Optional/)\n* [GuavaPreconditions](http://www.iocoder.cn/Guava/peida/Preconditions/)\n* [GuavaObject](http://www.iocoder.cn/Guava/peida/Object/)\n* [GuavaOrdering](https://www.cnblogs.com/peida/p/Guava_Ordering.html)\n* [GuavaThrowables](http://www.iocoder.cn/Guava/peida/Throwables/)\n* [GuavaImmutable()](http://www.iocoder.cn/Guava/peida/Immutable_Collections/)\n* [GuavaGuava-Multiset](http://www.iocoder.cn/Guava/peida/Multiset/)\n* [Guava Guava   Multimap](http://www.iocoder.cn/Guava/peida/Multimap/)\n* [GuavaGuava-Bimap](http://www.iocoder.cn/Guava/peida/Bimap/)\n* [GuavaGuava-Table](http://www.iocoder.cn/Guava/peida/Table/)\n* [GuavaGuava cache](http://www.iocoder.cn/Guava/peida/Cache/)\n* [GuavaEventBus](http://www.iocoder.cn/Guava/peida/EventBus/)\n* [GuavaRange](http://www.iocoder.cn/Guava/peida/Range/)\n","source":"_posts/Guava.md","raw":"---\ntitle: Guava-\ndate: 2019-10-24 10:55:04\ntags:\n    - JAVA\n    - GUAVA\ncategories: GUAVA\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n### \nhttp://code.google.com/p/guava-libraries\nhttp://www.ostools.net/apidocs/apidoc?api=guava\nhttps://www.kancloud.cn/wizardforcel/java-opensource-doc/112616\n<!-- more -->\n### \n* [Guava Google Guava ](http://www.iocoder.cn/Guava/peida/intro/)\n* [Guava Optional null](http://www.iocoder.cn/Guava/peida/Optional/)\n* [GuavaPreconditions](http://www.iocoder.cn/Guava/peida/Preconditions/)\n* [GuavaObject](http://www.iocoder.cn/Guava/peida/Object/)\n* [GuavaOrdering](https://www.cnblogs.com/peida/p/Guava_Ordering.html)\n* [GuavaThrowables](http://www.iocoder.cn/Guava/peida/Throwables/)\n* [GuavaImmutable()](http://www.iocoder.cn/Guava/peida/Immutable_Collections/)\n* [GuavaGuava-Multiset](http://www.iocoder.cn/Guava/peida/Multiset/)\n* [Guava Guava   Multimap](http://www.iocoder.cn/Guava/peida/Multimap/)\n* [GuavaGuava-Bimap](http://www.iocoder.cn/Guava/peida/Bimap/)\n* [GuavaGuava-Table](http://www.iocoder.cn/Guava/peida/Table/)\n* [GuavaGuava cache](http://www.iocoder.cn/Guava/peida/Cache/)\n* [GuavaEventBus](http://www.iocoder.cn/Guava/peida/EventBus/)\n* [GuavaRange](http://www.iocoder.cn/Guava/peida/Range/)\n","slug":"Guava","published":1,"updated":"2019-12-13T11:12:27.363Z","layout":"post","photos":[],"link":"","_id":"ck4859y2w000dt0fyewnpn50g","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://code.google.com/p/guava-libraries\" target=\"_blank\" rel=\"noopener\">http://code.google.com/p/guava-libraries</a><br><a href=\"http://www.ostools.net/apidocs/apidoc?api=guava\" target=\"_blank\" rel=\"noopener\">http://www.ostools.net/apidocs/apidoc?api=guava</a><br><a href=\"https://www.kancloud.cn/wizardforcel/java-opensource-doc/112616\" target=\"_blank\" rel=\"noopener\">https://www.kancloud.cn/wizardforcel/java-opensource-doc/112616</a></p>\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/intro/\" target=\"_blank\" rel=\"noopener\">Guava Google Guava </a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Optional/\" target=\"_blank\" rel=\"noopener\">Guava Optional null</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Preconditions/\" target=\"_blank\" rel=\"noopener\">GuavaPreconditions</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Object/\" target=\"_blank\" rel=\"noopener\">GuavaObject</a></li>\n<li><a href=\"https://www.cnblogs.com/peida/p/Guava_Ordering.html\" target=\"_blank\" rel=\"noopener\">GuavaOrdering</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Throwables/\" target=\"_blank\" rel=\"noopener\">GuavaThrowables</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Immutable_Collections/\" target=\"_blank\" rel=\"noopener\">GuavaImmutable()</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Multiset/\" target=\"_blank\" rel=\"noopener\">GuavaGuava-Multiset</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Multimap/\" target=\"_blank\" rel=\"noopener\">Guava Guava   Multimap</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Bimap/\" target=\"_blank\" rel=\"noopener\">GuavaGuava-Bimap</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Table/\" target=\"_blank\" rel=\"noopener\">GuavaGuava-Table</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Cache/\" target=\"_blank\" rel=\"noopener\">GuavaGuava cache</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/EventBus/\" target=\"_blank\" rel=\"noopener\">GuavaEventBus</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Range/\" target=\"_blank\" rel=\"noopener\">GuavaRange</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"http://code.google.com/p/guava-libraries\" target=\"_blank\" rel=\"noopener\">http://code.google.com/p/guava-libraries</a><br><a href=\"http://www.ostools.net/apidocs/apidoc?api=guava\" target=\"_blank\" rel=\"noopener\">http://www.ostools.net/apidocs/apidoc?api=guava</a><br><a href=\"https://www.kancloud.cn/wizardforcel/java-opensource-doc/112616\" target=\"_blank\" rel=\"noopener\">https://www.kancloud.cn/wizardforcel/java-opensource-doc/112616</a></p>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/intro/\" target=\"_blank\" rel=\"noopener\">Guava Google Guava </a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Optional/\" target=\"_blank\" rel=\"noopener\">Guava Optional null</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Preconditions/\" target=\"_blank\" rel=\"noopener\">GuavaPreconditions</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Object/\" target=\"_blank\" rel=\"noopener\">GuavaObject</a></li>\n<li><a href=\"https://www.cnblogs.com/peida/p/Guava_Ordering.html\" target=\"_blank\" rel=\"noopener\">GuavaOrdering</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Throwables/\" target=\"_blank\" rel=\"noopener\">GuavaThrowables</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Immutable_Collections/\" target=\"_blank\" rel=\"noopener\">GuavaImmutable()</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Multiset/\" target=\"_blank\" rel=\"noopener\">GuavaGuava-Multiset</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Multimap/\" target=\"_blank\" rel=\"noopener\">Guava Guava   Multimap</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Bimap/\" target=\"_blank\" rel=\"noopener\">GuavaGuava-Bimap</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Table/\" target=\"_blank\" rel=\"noopener\">GuavaGuava-Table</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Cache/\" target=\"_blank\" rel=\"noopener\">GuavaGuava cache</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/EventBus/\" target=\"_blank\" rel=\"noopener\">GuavaEventBus</a></li>\n<li><a href=\"http://www.iocoder.cn/Guava/peida/Range/\" target=\"_blank\" rel=\"noopener\">GuavaRange</a></li>\n</ul>"},{"title":"JAVA","date":"2019-02-11T09:23:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"Javajavago\n\n## \n\n### JDK\nOracleJDK1.8.0_161\n\n### GO\n[GO](https://golang.org/dl/)GO,1.11.2\nGo\n``` bash\n$ go version\ngo version go1.11.2 darwin/amd64\n```\n<!-- more -->\n\n```bash\n#Go\nexport PATH=$PATH:/usr/local/go/bin\n#Go,\nexport GOPATH=/home/XXX/XXX/jvmgo/go\n```\nGOPATH,\n```base\n$ go env\n```\n## JAVA\n\njava\n\n|  |  |\n| :------ | :------ | \n| -version |  | \n| -?/-help\t |  |\n| -cp/-classpath |  |\n| -Dproperty=value | Java |\n| -Xms |  |\n| -Xmx |  |\n| -Xss |  |\n\n### \n\n\n```base\n|-jvmgo\n    |-ch01\n```\nch01cmd.go\n```go\npackage main\n\nimport \"flag\"\nimport \"fmt\"\nimport \"os\"\n\n\n//: java [-options] class [args...] ()\n//  java [-options] -jar jarfile [args...] ( jar )\ntype Cmd struct {\n\thelpFlag bool\n\tversionFlag bool\n\tcpOption string\n\tclass string\n\targs []string\n}\n\n\n//\nfunc printUsage()  {\n\tfmt.Printf(\"Usage%s [-options] class [args...]\\n\",os.Args[0])\n}\n\n//\nfunc parseCmd() *Cmd {\n\t\n\t//cmdCmd\n\tcmd := &Cmd{}\n\n\t//flag\n\t//Usage\n\tflag.Usage = printUsage\n\tflag.BoolVar(&cmd.helpFlag,\"help\",false,\"print help message\")\n\tflag.BoolVar(&cmd.helpFlag,\"?\",false,\"print help message\")\n\tflag.BoolVar(&cmd.versionFlag,\"version\",false,\"print version and exit\")\n\tflag.StringVar(&cmd.cpOption,\"classpath\",\"\",\"classpath\")\n\tflag.StringVar(&cmd.cpOption,\"cp\",\"\",\"classpath\")\n\t//flagflag.Parse()\n\tflag.Parse()\n\t//flag.Args()\n\targs := flag.Args()\n\tif len(args) > 0{\n\t\tcmd.class = args[0]\n\t\tcmd.args = args[1:]\n\t}\n\n\treturn cmd\n}\n\n```\n### \n\nch01main.go\n```go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n\tcmd := parseCmd()\n\tif cmd.versionFlag {\n\t\tfmt.Println(\"version 0.0.1\")\n\t}else if cmd.helpFlag || cmd.class == \"\"{\n\t\tprintUsage()\n\t}else {\n\t\tstartJVM(cmd)\n\t}\n}\n//jvm\nfunc startJVM(cmd *Cmd)  {\n\t//\n\tfmt.Printf(\"classpath:%s class:%s args:%v\\n\",cmd.cpOption,cmd.class,cmd.args)\n}\n```\n\nmain.go-version\n```bash\n$ go install jvmgo/ch01 \n$ ch01 -version\nversion 0.0.1\n```\n","source":"_posts/JVM1.md","raw":"---\ntitle: JAVA\ndate: 2019-02-11 17:23:04\ntags:\n    - JVM\n    - JAVA\n    - GO\n    - \ncategories: JVM\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\nJavajavago\n\n## \n\n### JDK\nOracleJDK1.8.0_161\n\n### GO\n[GO](https://golang.org/dl/)GO,1.11.2\nGo\n``` bash\n$ go version\ngo version go1.11.2 darwin/amd64\n```\n<!-- more -->\n\n```bash\n#Go\nexport PATH=$PATH:/usr/local/go/bin\n#Go,\nexport GOPATH=/home/XXX/XXX/jvmgo/go\n```\nGOPATH,\n```base\n$ go env\n```\n## JAVA\n\njava\n\n|  |  |\n| :------ | :------ | \n| -version |  | \n| -?/-help\t |  |\n| -cp/-classpath |  |\n| -Dproperty=value | Java |\n| -Xms |  |\n| -Xmx |  |\n| -Xss |  |\n\n### \n\n\n```base\n|-jvmgo\n    |-ch01\n```\nch01cmd.go\n```go\npackage main\n\nimport \"flag\"\nimport \"fmt\"\nimport \"os\"\n\n\n//: java [-options] class [args...] ()\n//  java [-options] -jar jarfile [args...] ( jar )\ntype Cmd struct {\n\thelpFlag bool\n\tversionFlag bool\n\tcpOption string\n\tclass string\n\targs []string\n}\n\n\n//\nfunc printUsage()  {\n\tfmt.Printf(\"Usage%s [-options] class [args...]\\n\",os.Args[0])\n}\n\n//\nfunc parseCmd() *Cmd {\n\t\n\t//cmdCmd\n\tcmd := &Cmd{}\n\n\t//flag\n\t//Usage\n\tflag.Usage = printUsage\n\tflag.BoolVar(&cmd.helpFlag,\"help\",false,\"print help message\")\n\tflag.BoolVar(&cmd.helpFlag,\"?\",false,\"print help message\")\n\tflag.BoolVar(&cmd.versionFlag,\"version\",false,\"print version and exit\")\n\tflag.StringVar(&cmd.cpOption,\"classpath\",\"\",\"classpath\")\n\tflag.StringVar(&cmd.cpOption,\"cp\",\"\",\"classpath\")\n\t//flagflag.Parse()\n\tflag.Parse()\n\t//flag.Args()\n\targs := flag.Args()\n\tif len(args) > 0{\n\t\tcmd.class = args[0]\n\t\tcmd.args = args[1:]\n\t}\n\n\treturn cmd\n}\n\n```\n### \n\nch01main.go\n```go\npackage main\n\nimport \"fmt\"\n\nfunc main() {\n\tcmd := parseCmd()\n\tif cmd.versionFlag {\n\t\tfmt.Println(\"version 0.0.1\")\n\t}else if cmd.helpFlag || cmd.class == \"\"{\n\t\tprintUsage()\n\t}else {\n\t\tstartJVM(cmd)\n\t}\n}\n//jvm\nfunc startJVM(cmd *Cmd)  {\n\t//\n\tfmt.Printf(\"classpath:%s class:%s args:%v\\n\",cmd.cpOption,cmd.class,cmd.args)\n}\n```\n\nmain.go-version\n```bash\n$ go install jvmgo/ch01 \n$ ch01 -version\nversion 0.0.1\n```\n","slug":"JVM1","published":1,"updated":"2019-07-30T11:37:16.775Z","layout":"post","photos":[],"link":"","_id":"ck4859y30000ht0fyhsbmm1di","content":"<p>Javajavago</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"JDK\"><a href=\"#JDK\" class=\"headerlink\" title=\"JDK\"></a>JDK</h3><p>OracleJDK1.8.0_161</p>\n<h3 id=\"GO\"><a href=\"#GO\" class=\"headerlink\" title=\"GO\"></a>GO</h3><p><a href=\"https://golang.org/dl/\" target=\"_blank\" rel=\"noopener\">GO</a>GO,1.11.2<br>Go</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go version</span><br><span class=\"line\">go version go1.11.2 darwin/amd64</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Go</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:/usr/<span class=\"built_in\">local</span>/go/bin</span><br><span class=\"line\"><span class=\"comment\">#Go,</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> GOPATH=/home/XXX/XXX/jvmgo/go</span><br></pre></td></tr></table></figure>\n\n<p>GOPATH,</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go env</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h2><p>java</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">-version</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-?/-help</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-cp/-classpath</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-Dproperty=value</td>\n<td align=\"left\">Java</td>\n</tr>\n<tr>\n<td align=\"left\">-Xms</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-Xmx</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-Xss</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|-jvmgo</span><br><span class=\"line\">    |-ch01</span><br></pre></td></tr></table></figure>\n\n<p>ch01cmd.go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"flag\"</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"os\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//: java [-options] class [args...] ()</span></span><br><span class=\"line\"><span class=\"comment\">//  java [-options] -jar jarfile [args...] ( jar )</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Cmd <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\thelpFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tversionFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tcpOption <span class=\"keyword\">string</span></span><br><span class=\"line\">\tclass <span class=\"keyword\">string</span></span><br><span class=\"line\">\targs []<span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">printUsage</span><span class=\"params\">()</span></span>  &#123;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"Usage%s [-options] class [args...]\\n\"</span>,os.Args[<span class=\"number\">0</span>])</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parseCmd</span><span class=\"params\">()</span> *<span class=\"title\">Cmd</span></span> &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//cmdCmd</span></span><br><span class=\"line\">\tcmd := &amp;Cmd&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//flag</span></span><br><span class=\"line\">\t<span class=\"comment\">//Usage</span></span><br><span class=\"line\">\tflag.Usage = printUsage</span><br><span class=\"line\">\tflag.BoolVar(&amp;cmd.helpFlag,<span class=\"string\">\"help\"</span>,<span class=\"literal\">false</span>,<span class=\"string\">\"print help message\"</span>)</span><br><span class=\"line\">\tflag.BoolVar(&amp;cmd.helpFlag,<span class=\"string\">\"?\"</span>,<span class=\"literal\">false</span>,<span class=\"string\">\"print help message\"</span>)</span><br><span class=\"line\">\tflag.BoolVar(&amp;cmd.versionFlag,<span class=\"string\">\"version\"</span>,<span class=\"literal\">false</span>,<span class=\"string\">\"print version and exit\"</span>)</span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.cpOption,<span class=\"string\">\"classpath\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"classpath\"</span>)</span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.cpOption,<span class=\"string\">\"cp\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"classpath\"</span>)</span><br><span class=\"line\">\t<span class=\"comment\">//flagflag.Parse()</span></span><br><span class=\"line\">\tflag.Parse()</span><br><span class=\"line\">\t<span class=\"comment\">//flag.Args()</span></span><br><span class=\"line\">\targs := flag.Args()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(args) &gt; <span class=\"number\">0</span>&#123;</span><br><span class=\"line\">\t\tcmd.class = args[<span class=\"number\">0</span>]</span><br><span class=\"line\">\t\tcmd.args = args[<span class=\"number\">1</span>:]</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> cmd</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ch01main.go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tcmd := parseCmd()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> cmd.versionFlag &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"version 0.0.1\"</span>)</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> cmd.helpFlag || cmd.class == <span class=\"string\">\"\"</span>&#123;</span><br><span class=\"line\">\t\tprintUsage()</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tstartJVM(cmd)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//jvm</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">startJVM</span><span class=\"params\">(cmd *Cmd)</span></span>  &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"classpath:%s class:%s args:%v\\n\"</span>,cmd.cpOption,cmd.class,cmd.args)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>main.go-version</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go install jvmgo/ch01 </span><br><span class=\"line\">$ ch01 -version</span><br><span class=\"line\">version 0.0.1</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"<p>Javajavago</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"JDK\"><a href=\"#JDK\" class=\"headerlink\" title=\"JDK\"></a>JDK</h3><p>OracleJDK1.8.0_161</p>\n<h3 id=\"GO\"><a href=\"#GO\" class=\"headerlink\" title=\"GO\"></a>GO</h3><p><a href=\"https://golang.org/dl/\" target=\"_blank\" rel=\"noopener\">GO</a>GO,1.11.2<br>Go</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go version</span><br><span class=\"line\">go version go1.11.2 darwin/amd64</span><br></pre></td></tr></table></figure>","more":"<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">#Go</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> PATH=<span class=\"variable\">$PATH</span>:/usr/<span class=\"built_in\">local</span>/go/bin</span><br><span class=\"line\"><span class=\"comment\">#Go,</span></span><br><span class=\"line\"><span class=\"built_in\">export</span> GOPATH=/home/XXX/XXX/jvmgo/go</span><br></pre></td></tr></table></figure>\n\n<p>GOPATH,</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go env</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h2><p>java</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\"></th>\n<th align=\"left\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">-version</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-?/-help</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-cp/-classpath</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-Dproperty=value</td>\n<td align=\"left\">Java</td>\n</tr>\n<tr>\n<td align=\"left\">-Xms</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-Xmx</td>\n<td align=\"left\"></td>\n</tr>\n<tr>\n<td align=\"left\">-Xss</td>\n<td align=\"left\"></td>\n</tr>\n</tbody></table>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|-jvmgo</span><br><span class=\"line\">    |-ch01</span><br></pre></td></tr></table></figure>\n\n<p>ch01cmd.go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"flag\"</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"os\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//: java [-options] class [args...] ()</span></span><br><span class=\"line\"><span class=\"comment\">//  java [-options] -jar jarfile [args...] ( jar )</span></span><br><span class=\"line\"><span class=\"keyword\">type</span> Cmd <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\thelpFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tversionFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tcpOption <span class=\"keyword\">string</span></span><br><span class=\"line\">\tclass <span class=\"keyword\">string</span></span><br><span class=\"line\">\targs []<span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">printUsage</span><span class=\"params\">()</span></span>  &#123;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"Usage%s [-options] class [args...]\\n\"</span>,os.Args[<span class=\"number\">0</span>])</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parseCmd</span><span class=\"params\">()</span> *<span class=\"title\">Cmd</span></span> &#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//cmdCmd</span></span><br><span class=\"line\">\tcmd := &amp;Cmd&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//flag</span></span><br><span class=\"line\">\t<span class=\"comment\">//Usage</span></span><br><span class=\"line\">\tflag.Usage = printUsage</span><br><span class=\"line\">\tflag.BoolVar(&amp;cmd.helpFlag,<span class=\"string\">\"help\"</span>,<span class=\"literal\">false</span>,<span class=\"string\">\"print help message\"</span>)</span><br><span class=\"line\">\tflag.BoolVar(&amp;cmd.helpFlag,<span class=\"string\">\"?\"</span>,<span class=\"literal\">false</span>,<span class=\"string\">\"print help message\"</span>)</span><br><span class=\"line\">\tflag.BoolVar(&amp;cmd.versionFlag,<span class=\"string\">\"version\"</span>,<span class=\"literal\">false</span>,<span class=\"string\">\"print version and exit\"</span>)</span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.cpOption,<span class=\"string\">\"classpath\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"classpath\"</span>)</span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.cpOption,<span class=\"string\">\"cp\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"classpath\"</span>)</span><br><span class=\"line\">\t<span class=\"comment\">//flagflag.Parse()</span></span><br><span class=\"line\">\tflag.Parse()</span><br><span class=\"line\">\t<span class=\"comment\">//flag.Args()</span></span><br><span class=\"line\">\targs := flag.Args()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(args) &gt; <span class=\"number\">0</span>&#123;</span><br><span class=\"line\">\t\tcmd.class = args[<span class=\"number\">0</span>]</span><br><span class=\"line\">\t\tcmd.args = args[<span class=\"number\">1</span>:]</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> cmd</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ch01main.go</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> main</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> <span class=\"string\">\"fmt\"</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">main</span><span class=\"params\">()</span></span> &#123;</span><br><span class=\"line\">\tcmd := parseCmd()</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> cmd.versionFlag &#123;</span><br><span class=\"line\">\t\tfmt.Println(<span class=\"string\">\"version 0.0.1\"</span>)</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> cmd.helpFlag || cmd.class == <span class=\"string\">\"\"</span>&#123;</span><br><span class=\"line\">\t\tprintUsage()</span><br><span class=\"line\">\t&#125;<span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tstartJVM(cmd)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//jvm</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">startJVM</span><span class=\"params\">(cmd *Cmd)</span></span>  &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"classpath:%s class:%s args:%v\\n\"</span>,cmd.cpOption,cmd.class,cmd.args)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>main.go-version</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go install jvmgo/ch01 </span><br><span class=\"line\">$ ch01 -version</span><br><span class=\"line\">version 0.0.1</span><br></pre></td></tr></table></figure>"},{"title":"JAVAclass","date":"2019-02-14T03:38:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"javaCClass\n```java\nClassFile {\n     u4             magic;//\n     u2             minor_version;//\n     u2             major_version;//\n     u2             constant_pool_count;//\n     cp_info        constant_pool[constant_pool_count-1];//\n     u2             access_flags;//\n     u2             this_class;//\n     u2             super_class;//\n     u2             interfaces_count;//\n     u2             interfaces[interfaces_count];//\n     u2             fields_count;//\n     field_info     fields[fields_count];//\n     u2             methods_count;//\n     method_info    methods[methods_count];//\n     u2             attributes_count;//\n     attribute_info attributes[attributes_count];//\n}\n```\n<!-- more -->\n### \n\nch02ch03ch03classfile\n```base\n|-jvmgo\n    |-ch01\n    |-ch01\n    |-ch03\n        |-classfile\n        |-classpath\n        |-cmd.go\n        |-main.go\n```\nclassclassFileTest.java\n```java\npublic class ClassFileTest {\n    public static final boolean FLAG = true;\n    public static final byte BYTE = 123;\n    public static final char X = 'X';\n    public static final short SHORT = 12345;\n    public static final int INT = 123456789;\n    public static final long LONG = 12345678901L;\n    public static final float PI = 3.14f;\n    public static final double E = 2.71828;\n    public static void main(String[] args) throws RuntimeException {\n        System.out.println(\"Hello, World!\");\n    }\n}\n```\n[classpy](https://github.com/zxh0/classpy)class","source":"_posts/JVM3.md","raw":"---\ntitle: JAVAclass\ndate: 2019-02-14 11:38:04\ntags:\n    - JVM\n    - JAVA\n    - GO\n    - \ncategories: JVM\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\njavaCClass\n```java\nClassFile {\n     u4             magic;//\n     u2             minor_version;//\n     u2             major_version;//\n     u2             constant_pool_count;//\n     cp_info        constant_pool[constant_pool_count-1];//\n     u2             access_flags;//\n     u2             this_class;//\n     u2             super_class;//\n     u2             interfaces_count;//\n     u2             interfaces[interfaces_count];//\n     u2             fields_count;//\n     field_info     fields[fields_count];//\n     u2             methods_count;//\n     method_info    methods[methods_count];//\n     u2             attributes_count;//\n     attribute_info attributes[attributes_count];//\n}\n```\n<!-- more -->\n### \n\nch02ch03ch03classfile\n```base\n|-jvmgo\n    |-ch01\n    |-ch01\n    |-ch03\n        |-classfile\n        |-classpath\n        |-cmd.go\n        |-main.go\n```\nclassclassFileTest.java\n```java\npublic class ClassFileTest {\n    public static final boolean FLAG = true;\n    public static final byte BYTE = 123;\n    public static final char X = 'X';\n    public static final short SHORT = 12345;\n    public static final int INT = 123456789;\n    public static final long LONG = 12345678901L;\n    public static final float PI = 3.14f;\n    public static final double E = 2.71828;\n    public static void main(String[] args) throws RuntimeException {\n        System.out.println(\"Hello, World!\");\n    }\n}\n```\n[classpy](https://github.com/zxh0/classpy)class","slug":"JVM3","published":1,"updated":"2019-07-30T11:37:16.762Z","layout":"post","photos":[],"link":"","_id":"ck4859y31000jt0fymae8x1as","content":"<p>javaCClass</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ClassFile &#123;</span><br><span class=\"line\">     u4             magic;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             minor_version;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             major_version;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             constant_pool_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     cp_info        constant_pool[constant_pool_count-<span class=\"number\">1</span>];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             access_flags;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             this_class;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             super_class;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             interfaces_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             interfaces[interfaces_count];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             fields_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     field_info     fields[fields_count];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             methods_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     method_info    methods[methods_count];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             attributes_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     attribute_info attributes[attributes_count];<span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ch02ch03ch03classfile</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|-jvmgo</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">    |-ch03</span><br><span class=\"line\">        |-classfile</span><br><span class=\"line\">        |-classpath</span><br><span class=\"line\">        |-cmd.go</span><br><span class=\"line\">        |-main.go</span><br></pre></td></tr></table></figure>\n\n<p>classclassFileTest.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ClassFileTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> FLAG = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">byte</span> BYTE = <span class=\"number\">123</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">char</span> X = <span class=\"string\">'X'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">short</span> SHORT = <span class=\"number\">12345</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> INT = <span class=\"number\">123456789</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> LONG = <span class=\"number\">12345678901L</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">float</span> PI = <span class=\"number\">3.14f</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">double</span> E = <span class=\"number\">2.71828</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> RuntimeException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Hello, World!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://github.com/zxh0/classpy\" target=\"_blank\" rel=\"noopener\">classpy</a>class</p>\n","site":{"data":{}},"excerpt":"<p>javaCClass</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ClassFile &#123;</span><br><span class=\"line\">     u4             magic;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             minor_version;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             major_version;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             constant_pool_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     cp_info        constant_pool[constant_pool_count-<span class=\"number\">1</span>];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             access_flags;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             this_class;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             super_class;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             interfaces_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             interfaces[interfaces_count];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             fields_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     field_info     fields[fields_count];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             methods_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     method_info    methods[methods_count];<span class=\"comment\">//</span></span><br><span class=\"line\">     u2             attributes_count;<span class=\"comment\">//</span></span><br><span class=\"line\">     attribute_info attributes[attributes_count];<span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ch02ch03ch03classfile</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|-jvmgo</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">    |-ch03</span><br><span class=\"line\">        |-classfile</span><br><span class=\"line\">        |-classpath</span><br><span class=\"line\">        |-cmd.go</span><br><span class=\"line\">        |-main.go</span><br></pre></td></tr></table></figure>\n\n<p>classclassFileTest.java</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ClassFileTest</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">boolean</span> FLAG = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">byte</span> BYTE = <span class=\"number\">123</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">char</span> X = <span class=\"string\">'X'</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">short</span> SHORT = <span class=\"number\">12345</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> INT = <span class=\"number\">123456789</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> LONG = <span class=\"number\">12345678901L</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">float</span> PI = <span class=\"number\">3.14f</span>;</span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">double</span> E = <span class=\"number\">2.71828</span>;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> RuntimeException </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Hello, World!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://github.com/zxh0/classpy\" target=\"_blank\" rel=\"noopener\">classpy</a>class</p>"},{"title":"Kafka-","date":"2019-06-10T03:38:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"## Kafka\nkafka\n![](Kafka-Producer/cert_override.png)\n<!-- more -->\n1.  ProducerRecord ,\n2. \n3. \n    * partition -> \n    * key ->  key  hash  topic \n    * key -> \n4. \n5. \n    *  ->  RecordMetaData\n    *  -> \n","source":"_posts/Kafka-Producer.md","raw":"---\ntitle: Kafka-\ndate: 2019-06-10 11:38:04\ntags:\n    - Kafka\n    - JAVA\n    - \ncategories: Kafka\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n## Kafka\nkafka\n![](Kafka-Producer/cert_override.png)\n<!-- more -->\n1.  ProducerRecord ,\n2. \n3. \n    * partition -> \n    * key ->  key  hash  topic \n    * key -> \n4. \n5. \n    *  ->  RecordMetaData\n    *  -> \n","slug":"Kafka-Producer","published":1,"updated":"2019-08-06T02:56:42.549Z","layout":"post","photos":[],"link":"","_id":"ck4859y34000ot0fynih21mp8","content":"<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><p>kafka<br><img src=\"/2019/06/10/Kafka-Producer/cert_override.png\" alt=\"\"></p>\n<a id=\"more\"></a>\n<ol>\n<li> ProducerRecord ,</li>\n<li></li>\n<li><ul>\n<li>partition -&gt; </li>\n<li>key -&gt;  key  hash  topic </li>\n<li>key -&gt; </li>\n</ul>\n</li>\n<li></li>\n<li><ul>\n<li> -&gt;  RecordMetaData</li>\n<li> -&gt; </li>\n</ul>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><p>kafka<br><img src=\"/2019/06/10/Kafka-Producer/cert_override.png\" alt=\"\"></p>","more":"<ol>\n<li> ProducerRecord ,</li>\n<li></li>\n<li><ul>\n<li>partition -&gt; </li>\n<li>key -&gt;  key  hash  topic </li>\n<li>key -&gt; </li>\n</ul>\n</li>\n<li></li>\n<li><ul>\n<li> -&gt;  RecordMetaData</li>\n<li> -&gt; </li>\n</ul>\n</li>\n</ol>"},{"title":"Mysql-LSN","author":"Guyuqing","copyright":true,"comments":0,"date":"2019-08-17T09:42:00.000Z","_content":"LSN(log sequence number)8\n# LSN\n\n```bash\n---\nLOG\n---\nLog sequence number 15151135824   -- redo log buffer  lsnredo log buffer  redo_mem_lsn\nLog flushed up to   15151135824   -- redo log file  lsnredo log  redo_log_lsn\nPages flushed up to 15151135824   --  lsn  \nLast checkpoint at  15151135815   --  , checkpoint  lsn, redo log cp_lsn\n```\n![log](Mysql-LSN/LOG.png)\n\n# LSN \nMySQL  \n\n# \n redo_log_lsn = 15000 , cp_lsn=10000 , MySQL crash\n1. cp_lsn = 10000 redo  checkpoint  \n2.  10000 <=  redo_log_LSN <= 15000 page_lsn  \n    * redo_log_LSN page redo_log_LSN <= page_lsn   , page  \n    * redo_log_LSN page , redo_log_LSN >= page_lsn   , page . \n","source":"_posts/Mysql-LSN.md","raw":"title: Mysql-LSN\ntags:\n  - \n  - MySql\ncategories:\n  - Mysql\nauthor: Guyuqing\ncopyright: true\ncomments: false\ndate: 2019-08-17 17:42:00\n---\nLSN(log sequence number)8\n# LSN\n\n```bash\n---\nLOG\n---\nLog sequence number 15151135824   -- redo log buffer  lsnredo log buffer  redo_mem_lsn\nLog flushed up to   15151135824   -- redo log file  lsnredo log  redo_log_lsn\nPages flushed up to 15151135824   --  lsn  \nLast checkpoint at  15151135815   --  , checkpoint  lsn, redo log cp_lsn\n```\n![log](Mysql-LSN/LOG.png)\n\n# LSN \nMySQL  \n\n# \n redo_log_lsn = 15000 , cp_lsn=10000 , MySQL crash\n1. cp_lsn = 10000 redo  checkpoint  \n2.  10000 <=  redo_log_LSN <= 15000 page_lsn  \n    * redo_log_LSN page redo_log_LSN <= page_lsn   , page  \n    * redo_log_LSN page , redo_log_LSN >= page_lsn   , page . \n","slug":"Mysql-LSN","published":1,"updated":"2019-08-19T11:25:10.381Z","layout":"post","photos":[],"link":"","_id":"ck4859y35000pt0fyylafrkhm","content":"<p>LSN(log sequence number)8</p>\n<h1 id=\"LSN\"><a href=\"#LSN\" class=\"headerlink\" title=\"LSN\"></a>LSN</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">LOG</span><br><span class=\"line\">---</span><br><span class=\"line\">Log sequence number 15151135824   -- redo <span class=\"built_in\">log</span> buffer  lsnredo <span class=\"built_in\">log</span> buffer  redo_mem_lsn</span><br><span class=\"line\">Log flushed up to   15151135824   -- redo <span class=\"built_in\">log</span> file  lsnredo <span class=\"built_in\">log</span>  redo_log_lsn</span><br><span class=\"line\">Pages flushed up to 15151135824   --  lsn  </span><br><span class=\"line\">Last checkpoint at  15151135815   --  , checkpoint  lsn, redo <span class=\"built_in\">log</span> cp_lsn</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/08/17/Mysql-LSN/LOG.png\" alt=\"log\"></p>\n<h1 id=\"LSN-\"><a href=\"#LSN-\" class=\"headerlink\" title=\"LSN \"></a>LSN </h1><p>MySQL  </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> redo_log_lsn = 15000 , cp_lsn=10000 , MySQL crash</p>\n<ol>\n<li>cp_lsn = 10000 redo  checkpoint  </li>\n<li> 10000 &lt;=  redo_log_LSN &lt;= 15000 page_lsn  <ul>\n<li>redo_log_LSN page redo_log_LSN &lt;= page_lsn   , page  </li>\n<li>redo_log_LSN page , redo_log_LSN &gt;= page_lsn   , page . </li>\n</ul>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<p>LSN(log sequence number)8</p>\n<h1 id=\"LSN\"><a href=\"#LSN\" class=\"headerlink\" title=\"LSN\"></a>LSN</h1><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">---</span><br><span class=\"line\">LOG</span><br><span class=\"line\">---</span><br><span class=\"line\">Log sequence number 15151135824   -- redo <span class=\"built_in\">log</span> buffer  lsnredo <span class=\"built_in\">log</span> buffer  redo_mem_lsn</span><br><span class=\"line\">Log flushed up to   15151135824   -- redo <span class=\"built_in\">log</span> file  lsnredo <span class=\"built_in\">log</span>  redo_log_lsn</span><br><span class=\"line\">Pages flushed up to 15151135824   --  lsn  </span><br><span class=\"line\">Last checkpoint at  15151135815   --  , checkpoint  lsn, redo <span class=\"built_in\">log</span> cp_lsn</span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/08/17/Mysql-LSN/LOG.png\" alt=\"log\"></p>\n<h1 id=\"LSN-\"><a href=\"#LSN-\" class=\"headerlink\" title=\"LSN \"></a>LSN </h1><p>MySQL  </p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p> redo_log_lsn = 15000 , cp_lsn=10000 , MySQL crash</p>\n<ol>\n<li>cp_lsn = 10000 redo  checkpoint  </li>\n<li> 10000 &lt;=  redo_log_LSN &lt;= 15000 page_lsn  <ul>\n<li>redo_log_LSN page redo_log_LSN &lt;= page_lsn   , page  </li>\n<li>redo_log_LSN page , redo_log_LSN &gt;= page_lsn   , page . </li>\n</ul>\n</li>\n</ol>\n"},{"title":"Kafka-MacOs","date":"2019-06-05T13:38:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"### MacOS Docker \n\n<a href=\"https://www.runoob.com/docker/macos-docker-install.html\">docker</a>\n\n### Docker Zookeeper  kafka \n```bash\n~  docker pull zookeeper:latest\n~  docker pull wurstmeister/kafka:latest\n~  docker pull sheepkiller/kafka-manager\n```\n<!-- more -->\n### \n1zookeeperkafkadocker\n```bash\n~  docker network create app\n\nd481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874\n```\n docker network ls\n```bash\n~  docker network ls                  \n\nNETWORK ID          NAME                DRIVER              SCOPE\nd481270a0523        app                 bridge              local\n0ab6b1467267        bridge              bridge              local\ncd08298f526b        host                host                local\n86a734066770        none                null                local\n```\ndocker network inspect app\n```bash\n~  docker network inspect app                        \n[\n    {\n        \"Name\": \"app\",\n        \"Id\": \"d481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874\",\n        \"Created\": \"2019-07-19T06:57:10.768655482Z\",\n        \"Scope\": \"local\",\n        \"Driver\": \"bridge\",\n        \"EnableIPv6\": false,\n        \"IPAM\": {\n            \"Driver\": \"default\",\n            \"Options\": {},\n            \"Config\": [\n                {\n                    \"Subnet\": \"172.18.0.0/16\",\n                    \"Gateway\": \"172.18.0.1\"\n                }\n            ]\n        },\n        \"Internal\": false,\n        \"Attachable\": false,\n        \"Ingress\": false,\n        \"ConfigFrom\": {\n            \"Network\": \"\"\n        },\n        \"ConfigOnly\": false,\n        \"Containers\": {},\n        \"Options\": {},\n        \"Labels\": {}\n    }\n]\n```\ncontainers\n2Zookeeper\n```bash\n~  docker run --net=app --name zookeeper -p 2181 -t zookeeper\n```\n\n\n```bash\ndocker: Error response from daemon: Conflict. The container name \"/zookeeper\" is already in use by container \"26ffbd391e8c6e5e90b8f593e354f80768f179741e1de35640efacc6303fdad0\". You have to remove (or rename) that container to be able to reuse that name.\nSee 'docker run --help'.\n```\ndocker ps -l zookeeper docker rm \n```bash\n~  docker ps -l                                       \nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\n26ffbd391e8c        zookeeper           \"/docker-entrypoint.\"   8 minutes ago       Created                                 zookeeper\n\n~  docker rm 26ffbd391e8c\n```\n\n\n{% note info %}\nrun\n\n-ttty\n\n-i\n\n-d\n\n--name\n\n-p:\n\n\n{% endnote %}\n\n3Kafka\n```bash\n~  docker run --net=app --name kafka -p 9092 \\\n--env HOST_IP=127.0.0.1 \\\n--env KAFKA_ADVERTISED_HOST_NAME=localhost  \\\n--env KAFKA_ADVERTISED_PORT=9092 \\\n--env KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\\n--link zookeeper \\\nwurstmeister/kafka:latest\n```\n{% note info %}\n\n-e\n\n--link:\n\nKafkaserver.properties\n\n{% endnote %}\n\n4kafka-manager\n```bash\n~  docker run --net=app \\\n--name kafka-manager \\\n-p 9000:9000 \\\n-e ZK_HOSTS=zookeeper:2181 \\\nsheepkiller/kafka-manager\n```\nip:9000\n\n5Kafka\nkafka\n```bash\n~  docker exec -it kafka /bin/bash\n```\n\n```bash\nbash-4.4# kafka-console-producer.sh --broker-list localhost:9092 --topic test\n>hello\n>AAAA\n>BBBB\n>hey\n```\n()\n```bash                             \nbash-4.4# kafka-console-consumer.sh \\\n> --bootstrap-server localhost:9092 \\\n> --topic test --from-beginning\nhello\nAAAA\nBBBB\nhey\n```\n()V\n\n> https://cloud.tencent.com/developer/news/371290","source":"_posts/Kafka-Install.md","raw":"---\ntitle: Kafka-MacOs\ndate: 2019-06-05 21:38:04\ntags:\n    - Kafka\n    - JAVA\n    - \ncategories: Kafka\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n### MacOS Docker \n\n<a href=\"https://www.runoob.com/docker/macos-docker-install.html\">docker</a>\n\n### Docker Zookeeper  kafka \n```bash\n~  docker pull zookeeper:latest\n~  docker pull wurstmeister/kafka:latest\n~  docker pull sheepkiller/kafka-manager\n```\n<!-- more -->\n### \n1zookeeperkafkadocker\n```bash\n~  docker network create app\n\nd481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874\n```\n docker network ls\n```bash\n~  docker network ls                  \n\nNETWORK ID          NAME                DRIVER              SCOPE\nd481270a0523        app                 bridge              local\n0ab6b1467267        bridge              bridge              local\ncd08298f526b        host                host                local\n86a734066770        none                null                local\n```\ndocker network inspect app\n```bash\n~  docker network inspect app                        \n[\n    {\n        \"Name\": \"app\",\n        \"Id\": \"d481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874\",\n        \"Created\": \"2019-07-19T06:57:10.768655482Z\",\n        \"Scope\": \"local\",\n        \"Driver\": \"bridge\",\n        \"EnableIPv6\": false,\n        \"IPAM\": {\n            \"Driver\": \"default\",\n            \"Options\": {},\n            \"Config\": [\n                {\n                    \"Subnet\": \"172.18.0.0/16\",\n                    \"Gateway\": \"172.18.0.1\"\n                }\n            ]\n        },\n        \"Internal\": false,\n        \"Attachable\": false,\n        \"Ingress\": false,\n        \"ConfigFrom\": {\n            \"Network\": \"\"\n        },\n        \"ConfigOnly\": false,\n        \"Containers\": {},\n        \"Options\": {},\n        \"Labels\": {}\n    }\n]\n```\ncontainers\n2Zookeeper\n```bash\n~  docker run --net=app --name zookeeper -p 2181 -t zookeeper\n```\n\n\n```bash\ndocker: Error response from daemon: Conflict. The container name \"/zookeeper\" is already in use by container \"26ffbd391e8c6e5e90b8f593e354f80768f179741e1de35640efacc6303fdad0\". You have to remove (or rename) that container to be able to reuse that name.\nSee 'docker run --help'.\n```\ndocker ps -l zookeeper docker rm \n```bash\n~  docker ps -l                                       \nCONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES\n26ffbd391e8c        zookeeper           \"/docker-entrypoint.\"   8 minutes ago       Created                                 zookeeper\n\n~  docker rm 26ffbd391e8c\n```\n\n\n{% note info %}\nrun\n\n-ttty\n\n-i\n\n-d\n\n--name\n\n-p:\n\n\n{% endnote %}\n\n3Kafka\n```bash\n~  docker run --net=app --name kafka -p 9092 \\\n--env HOST_IP=127.0.0.1 \\\n--env KAFKA_ADVERTISED_HOST_NAME=localhost  \\\n--env KAFKA_ADVERTISED_PORT=9092 \\\n--env KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\\n--link zookeeper \\\nwurstmeister/kafka:latest\n```\n{% note info %}\n\n-e\n\n--link:\n\nKafkaserver.properties\n\n{% endnote %}\n\n4kafka-manager\n```bash\n~  docker run --net=app \\\n--name kafka-manager \\\n-p 9000:9000 \\\n-e ZK_HOSTS=zookeeper:2181 \\\nsheepkiller/kafka-manager\n```\nip:9000\n\n5Kafka\nkafka\n```bash\n~  docker exec -it kafka /bin/bash\n```\n\n```bash\nbash-4.4# kafka-console-producer.sh --broker-list localhost:9092 --topic test\n>hello\n>AAAA\n>BBBB\n>hey\n```\n()\n```bash                             \nbash-4.4# kafka-console-consumer.sh \\\n> --bootstrap-server localhost:9092 \\\n> --topic test --from-beginning\nhello\nAAAA\nBBBB\nhey\n```\n()V\n\n> https://cloud.tencent.com/developer/news/371290","slug":"Kafka-Install","published":1,"updated":"2019-08-02T02:57:51.036Z","layout":"post","photos":[],"link":"","_id":"ck4859y3a000tt0fycscho9bt","content":"<h3 id=\"MacOS-Docker-\"><a href=\"#MacOS-Docker-\" class=\"headerlink\" title=\"MacOS Docker \"></a>MacOS Docker </h3><p><a href=\"https://www.runoob.com/docker/macos-docker-install.html\" target=\"_blank\" rel=\"noopener\">docker</a></p>\n<h3 id=\"Docker-Zookeeper--kafka-\"><a href=\"#Docker-Zookeeper--kafka-\" class=\"headerlink\" title=\"Docker Zookeeper  kafka \"></a>Docker Zookeeper  kafka </h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker pull zookeeper:latest</span><br><span class=\"line\">~  docker pull wurstmeister/kafka:latest</span><br><span class=\"line\">~  docker pull sheepkiller/kafka-manager</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1zookeeperkafkadocker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker network create app</span><br><span class=\"line\"></span><br><span class=\"line\">d481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874</span><br></pre></td></tr></table></figure>\n\n<p> docker network ls</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker network ls                  </span><br><span class=\"line\"></span><br><span class=\"line\">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class=\"line\">d481270a0523        app                 bridge              <span class=\"built_in\">local</span></span><br><span class=\"line\">0ab6b1467267        bridge              bridge              <span class=\"built_in\">local</span></span><br><span class=\"line\">cd08298f526b        host                host                <span class=\"built_in\">local</span></span><br><span class=\"line\">86a734066770        none                null                <span class=\"built_in\">local</span></span><br></pre></td></tr></table></figure>\n\n<p>docker network inspect app</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker network inspect app                        </span><br><span class=\"line\">[</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">\"Name\"</span>: <span class=\"string\">\"app\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Id\"</span>: <span class=\"string\">\"d481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Created\"</span>: <span class=\"string\">\"2019-07-19T06:57:10.768655482Z\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Scope\"</span>: <span class=\"string\">\"local\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Driver\"</span>: <span class=\"string\">\"bridge\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"EnableIPv6\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"IPAM\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">\"Driver\"</span>: <span class=\"string\">\"default\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"Options\"</span>: &#123;&#125;,</span><br><span class=\"line\">            <span class=\"string\">\"Config\"</span>: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"string\">\"Subnet\"</span>: <span class=\"string\">\"172.18.0.0/16\"</span>,</span><br><span class=\"line\">                    <span class=\"string\">\"Gateway\"</span>: <span class=\"string\">\"172.18.0.1\"</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">\"Internal\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Attachable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Ingress\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"ConfigFrom\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">\"Network\"</span>: <span class=\"string\">\"\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">\"ConfigOnly\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Containers\"</span>: &#123;&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"Options\"</span>: &#123;&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"Labels\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<p>containers<br>2Zookeeper</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker run --net=app --name zookeeper -p 2181 -t zookeeper</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker: Error response from daemon: Conflict. The container name <span class=\"string\">\"/zookeeper\"</span> is already <span class=\"keyword\">in</span> use by container <span class=\"string\">\"26ffbd391e8c6e5e90b8f593e354f80768f179741e1de35640efacc6303fdad0\"</span>. You have to remove (or rename) that container to be able to reuse that name.</span><br><span class=\"line\">See <span class=\"string\">'docker run --help'</span>.</span><br></pre></td></tr></table></figure>\n\n<p>docker ps -l zookeeper docker rm </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker ps -l                                       </span><br><span class=\"line\">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class=\"line\">26ffbd391e8c        zookeeper           <span class=\"string\">\"/docker-entrypoint.\"</span>   8 minutes ago       Created                                 zookeeper</span><br><span class=\"line\"></span><br><span class=\"line\">~  docker rm 26ffbd391e8c</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<div class=\"note info\"><p>run</p>\n<p>-ttty</p>\n<p>-i</p>\n<p>-d</p>\n<p>name</p>\n<p>-p:</p>\n<p></p></div>\n\n<p>3Kafka</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker run --net=app --name kafka -p 9092 \\</span><br><span class=\"line\">--env HOST_IP=127.0.0.1 \\</span><br><span class=\"line\">--env KAFKA_ADVERTISED_HOST_NAME=localhost  \\</span><br><span class=\"line\">--env KAFKA_ADVERTISED_PORT=9092 \\</span><br><span class=\"line\">--env KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\</span><br><span class=\"line\">--link zookeeper \\</span><br><span class=\"line\">wurstmeister/kafka:latest</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\"><p>-e</p>\n<p>link:</p>\n<p>Kafkaserver.properties</p></div>\n\n<p>4kafka-manager</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker run --net=app \\</span><br><span class=\"line\">--name kafka-manager \\</span><br><span class=\"line\">-p 9000:9000 \\</span><br><span class=\"line\">-e ZK_HOSTS=zookeeper:2181 \\</span><br><span class=\"line\">sheepkiller/kafka-manager</span><br></pre></td></tr></table></figure>\n\n<p>ip:9000</p>\n<p>5Kafka<br>kafka</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker <span class=\"built_in\">exec</span> -it kafka /bin/bash</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash-4.4<span class=\"comment\"># kafka-console-producer.sh --broker-list localhost:9092 --topic test</span></span><br><span class=\"line\">&gt;hello</span><br><span class=\"line\">&gt;AAAA</span><br><span class=\"line\">&gt;BBBB</span><br><span class=\"line\">&gt;hey</span><br></pre></td></tr></table></figure>\n\n<p>()</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash-4.4<span class=\"comment\"># kafka-console-consumer.sh \\</span></span><br><span class=\"line\">&gt; --bootstrap-server localhost:9092 \\</span><br><span class=\"line\">&gt; --topic <span class=\"built_in\">test</span> --from-beginning</span><br><span class=\"line\">hello</span><br><span class=\"line\">AAAA</span><br><span class=\"line\">BBBB</span><br><span class=\"line\">hey</span><br></pre></td></tr></table></figure>\n\n<p>()V</p>\n<blockquote>\n<p><a href=\"https://cloud.tencent.com/developer/news/371290\" target=\"_blank\" rel=\"noopener\">https://cloud.tencent.com/developer/news/371290</a></p>\n</blockquote>\n","site":{"data":{}},"excerpt":"<h3 id=\"MacOS-Docker-\"><a href=\"#MacOS-Docker-\" class=\"headerlink\" title=\"MacOS Docker \"></a>MacOS Docker </h3><p><a href=\"https://www.runoob.com/docker/macos-docker-install.html\" target=\"_blank\" rel=\"noopener\">docker</a></p>\n<h3 id=\"Docker-Zookeeper--kafka-\"><a href=\"#Docker-Zookeeper--kafka-\" class=\"headerlink\" title=\"Docker Zookeeper  kafka \"></a>Docker Zookeeper  kafka </h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker pull zookeeper:latest</span><br><span class=\"line\">~  docker pull wurstmeister/kafka:latest</span><br><span class=\"line\">~  docker pull sheepkiller/kafka-manager</span><br></pre></td></tr></table></figure>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>1zookeeperkafkadocker</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker network create app</span><br><span class=\"line\"></span><br><span class=\"line\">d481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874</span><br></pre></td></tr></table></figure>\n\n<p> docker network ls</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker network ls                  </span><br><span class=\"line\"></span><br><span class=\"line\">NETWORK ID          NAME                DRIVER              SCOPE</span><br><span class=\"line\">d481270a0523        app                 bridge              <span class=\"built_in\">local</span></span><br><span class=\"line\">0ab6b1467267        bridge              bridge              <span class=\"built_in\">local</span></span><br><span class=\"line\">cd08298f526b        host                host                <span class=\"built_in\">local</span></span><br><span class=\"line\">86a734066770        none                null                <span class=\"built_in\">local</span></span><br></pre></td></tr></table></figure>\n\n<p>docker network inspect app</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker network inspect app                        </span><br><span class=\"line\">[</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        <span class=\"string\">\"Name\"</span>: <span class=\"string\">\"app\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Id\"</span>: <span class=\"string\">\"d481270a05236007178e6ed0ce4b775c9d2aebb6c13bc050bb852bc46ca0b874\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Created\"</span>: <span class=\"string\">\"2019-07-19T06:57:10.768655482Z\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Scope\"</span>: <span class=\"string\">\"local\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Driver\"</span>: <span class=\"string\">\"bridge\"</span>,</span><br><span class=\"line\">        <span class=\"string\">\"EnableIPv6\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"IPAM\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">\"Driver\"</span>: <span class=\"string\">\"default\"</span>,</span><br><span class=\"line\">            <span class=\"string\">\"Options\"</span>: &#123;&#125;,</span><br><span class=\"line\">            <span class=\"string\">\"Config\"</span>: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    <span class=\"string\">\"Subnet\"</span>: <span class=\"string\">\"172.18.0.0/16\"</span>,</span><br><span class=\"line\">                    <span class=\"string\">\"Gateway\"</span>: <span class=\"string\">\"172.18.0.1\"</span></span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            ]</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">\"Internal\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Attachable\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Ingress\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"ConfigFrom\"</span>: &#123;</span><br><span class=\"line\">            <span class=\"string\">\"Network\"</span>: <span class=\"string\">\"\"</span></span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        <span class=\"string\">\"ConfigOnly\"</span>: <span class=\"literal\">false</span>,</span><br><span class=\"line\">        <span class=\"string\">\"Containers\"</span>: &#123;&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"Options\"</span>: &#123;&#125;,</span><br><span class=\"line\">        <span class=\"string\">\"Labels\"</span>: &#123;&#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n\n<p>containers<br>2Zookeeper</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker run --net=app --name zookeeper -p 2181 -t zookeeper</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker: Error response from daemon: Conflict. The container name <span class=\"string\">\"/zookeeper\"</span> is already <span class=\"keyword\">in</span> use by container <span class=\"string\">\"26ffbd391e8c6e5e90b8f593e354f80768f179741e1de35640efacc6303fdad0\"</span>. You have to remove (or rename) that container to be able to reuse that name.</span><br><span class=\"line\">See <span class=\"string\">'docker run --help'</span>.</span><br></pre></td></tr></table></figure>\n\n<p>docker ps -l zookeeper docker rm </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker ps -l                                       </span><br><span class=\"line\">CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS               NAMES</span><br><span class=\"line\">26ffbd391e8c        zookeeper           <span class=\"string\">\"/docker-entrypoint.\"</span>   8 minutes ago       Created                                 zookeeper</span><br><span class=\"line\"></span><br><span class=\"line\">~  docker rm 26ffbd391e8c</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<div class=\"note info\"><p>run</p>\n<p>-ttty</p>\n<p>-i</p>\n<p>-d</p>\n<p>name</p>\n<p>-p:</p>\n<p></p></div>\n\n<p>3Kafka</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker run --net=app --name kafka -p 9092 \\</span><br><span class=\"line\">--env HOST_IP=127.0.0.1 \\</span><br><span class=\"line\">--env KAFKA_ADVERTISED_HOST_NAME=localhost  \\</span><br><span class=\"line\">--env KAFKA_ADVERTISED_PORT=9092 \\</span><br><span class=\"line\">--env KAFKA_ZOOKEEPER_CONNECT=zookeeper:2181 \\</span><br><span class=\"line\">--link zookeeper \\</span><br><span class=\"line\">wurstmeister/kafka:latest</span><br></pre></td></tr></table></figure>\n\n<div class=\"note info\"><p>-e</p>\n<p>link:</p>\n<p>Kafkaserver.properties</p></div>\n\n<p>4kafka-manager</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker run --net=app \\</span><br><span class=\"line\">--name kafka-manager \\</span><br><span class=\"line\">-p 9000:9000 \\</span><br><span class=\"line\">-e ZK_HOSTS=zookeeper:2181 \\</span><br><span class=\"line\">sheepkiller/kafka-manager</span><br></pre></td></tr></table></figure>\n\n<p>ip:9000</p>\n<p>5Kafka<br>kafka</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">~  docker <span class=\"built_in\">exec</span> -it kafka /bin/bash</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash-4.4<span class=\"comment\"># kafka-console-producer.sh --broker-list localhost:9092 --topic test</span></span><br><span class=\"line\">&gt;hello</span><br><span class=\"line\">&gt;AAAA</span><br><span class=\"line\">&gt;BBBB</span><br><span class=\"line\">&gt;hey</span><br></pre></td></tr></table></figure>\n\n<p>()</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">bash-4.4<span class=\"comment\"># kafka-console-consumer.sh \\</span></span><br><span class=\"line\">&gt; --bootstrap-server localhost:9092 \\</span><br><span class=\"line\">&gt; --topic <span class=\"built_in\">test</span> --from-beginning</span><br><span class=\"line\">hello</span><br><span class=\"line\">AAAA</span><br><span class=\"line\">BBBB</span><br><span class=\"line\">hey</span><br></pre></td></tr></table></figure>\n\n<p>()V</p>\n<blockquote>\n<p><a href=\"https://cloud.tencent.com/developer/news/371290\" target=\"_blank\" rel=\"noopener\">https://cloud.tencent.com/developer/news/371290</a></p>\n</blockquote>"},{"title":"Mysql-MySql","date":"2019-07-29T18:40:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"#### \n> \n> MySQLfrmMYDMYIibd\n\n<!-- more -->\n#### \n> ``\n> \n\n#### MySql\n![mysql](Mysql01/01.jpg)\n\nMySQLSQLCache\nMySQL``\n\n#### MySql\nMySqlInnoDBMyISAMNDBMemory(HEAP)ArchiveBDB(BerkeleyDB)FederatedMaria\n\n||InnoDB|MyISAM|NDB|Memory|Archive|BDB|\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n||64TB|No|Yes|Yes|No|No|\n||Yes|||||Yes|\n||Row|Table|Row|Table|Row|Page|\n|MVCC|Yes||Yes||Yes||\n|B|Yes|Yes|Yes|Yes||Yes|\n||Yes||Yes|Yes|||\n||5.6|Yes|||||\n||Yes||||||\n||Yes||Yes|Yes|||\n||Yes|Yes|Yes|Yes|||\n|||Yes|||Yes||\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||||||||\n||||||||\n|||||N/A|||\n||Yes||||||\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||Yes|Yes|Yes|Yes|Yes|Yes|\n|/|Yes|Yes|Yes|Yes|Yes|Yes|\n||||Yes|||||\n\n","source":"_posts/Mysql01.md","raw":"---\ntitle: Mysql-MySql\ndate: 2019-07-30 02:40:04\ntags:\n    - MySql\n    - \ncategories: Mysql\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n#### \n> \n> MySQLfrmMYDMYIibd\n\n<!-- more -->\n#### \n> ``\n> \n\n#### MySql\n![mysql](Mysql01/01.jpg)\n\nMySQLSQLCache\nMySQL``\n\n#### MySql\nMySqlInnoDBMyISAMNDBMemory(HEAP)ArchiveBDB(BerkeleyDB)FederatedMaria\n\n||InnoDB|MyISAM|NDB|Memory|Archive|BDB|\n|:---:|:---:|:---:|:---:|:---:|:---:|:---:|\n||64TB|No|Yes|Yes|No|No|\n||Yes|||||Yes|\n||Row|Table|Row|Table|Row|Page|\n|MVCC|Yes||Yes||Yes||\n|B|Yes|Yes|Yes|Yes||Yes|\n||Yes||Yes|Yes|||\n||5.6|Yes|||||\n||Yes||||||\n||Yes||Yes|Yes|||\n||Yes|Yes|Yes|Yes|||\n|||Yes|||Yes||\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||||||||\n||||||||\n|||||N/A|||\n||Yes||||||\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||Yes|Yes|Yes|Yes|Yes|Yes|\n||Yes|Yes|Yes|Yes|Yes|Yes|\n|/|Yes|Yes|Yes|Yes|Yes|Yes|\n||||Yes|||||\n\n","slug":"Mysql01","published":1,"updated":"2019-08-19T11:24:33.580Z","layout":"post","photos":[],"link":"","_id":"ck4859y3e000ut0fyts0xzyjh","content":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<p><br>MySQLfrmMYDMYIibd</p>\n</blockquote>\n<a id=\"more\"></a>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<p><code></code><br></p>\n</blockquote>\n<h4 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h4><p><img src=\"/2019/07/30/Mysql01/01.jpg\" alt=\"mysql\"></p>\n<p>MySQLSQLCache<br>MySQL<code></code></p>\n<h4 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h4><p>MySqlInnoDBMyISAMNDBMemory(HEAP)ArchiveBDB(BerkeleyDB)FederatedMaria</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">InnoDB</th>\n<th align=\"center\">MyISAM</th>\n<th align=\"center\">NDB</th>\n<th align=\"center\">Memory</th>\n<th align=\"center\">Archive</th>\n<th align=\"center\">BDB</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\">64TB</td>\n<td align=\"center\">No</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">No</td>\n<td align=\"center\">No</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Row</td>\n<td align=\"center\">Table</td>\n<td align=\"center\">Row</td>\n<td align=\"center\">Table</td>\n<td align=\"center\">Row</td>\n<td align=\"center\">Page</td>\n</tr>\n<tr>\n<td align=\"center\">MVCC</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">5.6</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">N/A</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\">/</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>\n","site":{"data":{}},"excerpt":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<p><br>MySQLfrmMYDMYIibd</p>\n</blockquote>","more":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><blockquote>\n<p><code></code><br></p>\n</blockquote>\n<h4 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h4><p><img src=\"/2019/07/30/Mysql01/01.jpg\" alt=\"mysql\"></p>\n<p>MySQLSQLCache<br>MySQL<code></code></p>\n<h4 id=\"MySql\"><a href=\"#MySql\" class=\"headerlink\" title=\"MySql\"></a>MySql</h4><p>MySqlInnoDBMyISAMNDBMemory(HEAP)ArchiveBDB(BerkeleyDB)FederatedMaria</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">InnoDB</th>\n<th align=\"center\">MyISAM</th>\n<th align=\"center\">NDB</th>\n<th align=\"center\">Memory</th>\n<th align=\"center\">Archive</th>\n<th align=\"center\">BDB</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\">64TB</td>\n<td align=\"center\">No</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">No</td>\n<td align=\"center\">No</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Row</td>\n<td align=\"center\">Table</td>\n<td align=\"center\">Row</td>\n<td align=\"center\">Table</td>\n<td align=\"center\">Row</td>\n<td align=\"center\">Page</td>\n</tr>\n<tr>\n<td align=\"center\">MVCC</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\">B</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">5.6</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">N/A</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\">/</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n<td align=\"center\">Yes</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Yes</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n</tbody></table>"},{"title":"Mysql-RedoUndo","author":"Guyuqing","copyright":true,"comments":0,"date":"2019-08-16T11:09:00.000Z","_content":"# redo log\n## redo \n(redo log)InnoDB Redo ``\n## redo \nRedo log\n<!-- more -->\n1.  (redo log buffer),\n    * redo log buffer redo log file\n    * log block  \n    * log block 512 [double write](http://123.56.47.170:8080/2019/07/31/Mysql02/#%E4%B8%A4%E6%AC%A1%E5%86%99)  \n2.  (redo log file)\t\n\t* redo log2,  \n\n## redo \n* redo****\n* redo\n* undoRedo\n\n## redo \n![redo](Mysql-RedoAndUndo/redo-buffer.png)\n\n## redo\nInnoDB  **Force Log at Commit**  redo log buffer  redo log file commit\n **Write-Ahead Log**()\n\nredo log fileredo bufferredo log fileInnoDB fsync, O_DIRECT fsyncfsync fsync\n(O_DIRECTLinuxIO)\n\n# undo log\n## undo \nundo log\n\n## undo \nInnoDBundo(Rollback Segment),1024undo log segmentundo log segmentundo 5.6Rollback Segment5.6.3 innodb_undo_tablespaceundo\n\n## undo \n* DMLundo\n* ****undo\n\n## undo \n![undo](Mysql-RedoAndUndo/undo-Segment.png)\nundo log IO\n\n## undo \n* insert undo loginsert undo loginsertundo logpurge\n* update undo logdelete updateundo logundo logMVCCundo logpurge\n\n<div style='display: none'>\n## DML\n* \n```text\n1. delete   --undodelete mark  \n2. update  --undo  \n\t*  delete(delete,delete mark)  + insert \n\t* update    \n ```\n* \n```text\n1. delete  --undo\n\tdelete mark    \n2. update  --undo\n\tdelete mark + insert\n```\n</div>\n\n# redo & undo\n## undo log  redo log \nundo log\nredo logundo logredo log\n\n## \nBA13B24redo\n```text\nAB1,2.\n1. B\n2. A=1undo log\n3. A=3\n4. A=3 redo log\n5. B=2 undo log\n6. B=4\n7. B=4redo log\n8. redo log\n9. \n10.B\n\n```\ninsert/update/deleteredoundoInnoDB\n1. undoredo\n2. undo\n3. \n4. Redo\n\nBCredo\n```text\n1. C\n2. A=1undo log\n3. A=3\n4. A=3 redo log\n5. B=2 undo log\n6. B=4\n7. B=4redo log\n   <!---->\n8. B=2\n9. B=2redo log\n10.A=1\n11.A=1redo log\n12.redo log\n13.\n14.C\n```\n\nredoundo\n redo log  redo log  undo log \n\nBredoA=3&B=4undoA=1&B=2\n\n<div style='display: none'>\n# \n* https://keithlan.github.io/2017/06/12/innodb_locks_redo/\n* https://juejin.im/post/5c3c5c0451882525487c498d\n* https://t.hao0.me/mysql/2016/11/05/mysql-innodb-05-tablespaces.html\n</div>","source":"_posts/Mysql-RedoAndUndo.md","raw":"title: Mysql-RedoUndo\ntags:\n  - \n  - MySql\ncategories:\n  - Mysql\nauthor: Guyuqing\ncopyright: true\ncomments: false\ndate: 2019-08-16 19:09:00\n---\n# redo log\n## redo \n(redo log)InnoDB Redo ``\n## redo \nRedo log\n<!-- more -->\n1.  (redo log buffer),\n    * redo log buffer redo log file\n    * log block  \n    * log block 512 [double write](http://123.56.47.170:8080/2019/07/31/Mysql02/#%E4%B8%A4%E6%AC%A1%E5%86%99)  \n2.  (redo log file)\t\n\t* redo log2,  \n\n## redo \n* redo****\n* redo\n* undoRedo\n\n## redo \n![redo](Mysql-RedoAndUndo/redo-buffer.png)\n\n## redo\nInnoDB  **Force Log at Commit**  redo log buffer  redo log file commit\n **Write-Ahead Log**()\n\nredo log fileredo bufferredo log fileInnoDB fsync, O_DIRECT fsyncfsync fsync\n(O_DIRECTLinuxIO)\n\n# undo log\n## undo \nundo log\n\n## undo \nInnoDBundo(Rollback Segment),1024undo log segmentundo log segmentundo 5.6Rollback Segment5.6.3 innodb_undo_tablespaceundo\n\n## undo \n* DMLundo\n* ****undo\n\n## undo \n![undo](Mysql-RedoAndUndo/undo-Segment.png)\nundo log IO\n\n## undo \n* insert undo loginsert undo loginsertundo logpurge\n* update undo logdelete updateundo logundo logMVCCundo logpurge\n\n<div style='display: none'>\n## DML\n* \n```text\n1. delete   --undodelete mark  \n2. update  --undo  \n\t*  delete(delete,delete mark)  + insert \n\t* update    \n ```\n* \n```text\n1. delete  --undo\n\tdelete mark    \n2. update  --undo\n\tdelete mark + insert\n```\n</div>\n\n# redo & undo\n## undo log  redo log \nundo log\nredo logundo logredo log\n\n## \nBA13B24redo\n```text\nAB1,2.\n1. B\n2. A=1undo log\n3. A=3\n4. A=3 redo log\n5. B=2 undo log\n6. B=4\n7. B=4redo log\n8. redo log\n9. \n10.B\n\n```\ninsert/update/deleteredoundoInnoDB\n1. undoredo\n2. undo\n3. \n4. Redo\n\nBCredo\n```text\n1. C\n2. A=1undo log\n3. A=3\n4. A=3 redo log\n5. B=2 undo log\n6. B=4\n7. B=4redo log\n   <!---->\n8. B=2\n9. B=2redo log\n10.A=1\n11.A=1redo log\n12.redo log\n13.\n14.C\n```\n\nredoundo\n redo log  redo log  undo log \n\nBredoA=3&B=4undoA=1&B=2\n\n<div style='display: none'>\n# \n* https://keithlan.github.io/2017/06/12/innodb_locks_redo/\n* https://juejin.im/post/5c3c5c0451882525487c498d\n* https://t.hao0.me/mysql/2016/11/05/mysql-innodb-05-tablespaces.html\n</div>","slug":"Mysql-RedoAndUndo","published":1,"updated":"2019-08-21T02:43:26.002Z","layout":"post","photos":[],"link":"","_id":"ck4859y3j000xt0fy4lky1513","content":"<h1 id=\"redo-log\"><a href=\"#redo-log\" class=\"headerlink\" title=\"redo log\"></a>redo log</h1><h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><p>(redo log)InnoDB Redo <code></code></p>\n<h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><p>Redo log</p>\n<a id=\"more\"></a>\n<ol>\n<li> (redo log buffer),<ul>\n<li>redo log buffer redo log file</li>\n<li>log block  </li>\n<li>log block 512 <a href=\"http://123.56.47.170:8080/2019/07/31/Mysql02/#%E4%B8%A4%E6%AC%A1%E5%86%99\" target=\"_blank\" rel=\"noopener\">double write</a>  </li>\n</ul>\n</li>\n<li> (redo log file)    <ul>\n<li>redo log2,  </li>\n</ul>\n</li>\n</ol>\n<h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><ul>\n<li>redo<strong></strong></li>\n<li>redo</li>\n<li>undoRedo</li>\n</ul>\n<h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><p><img src=\"/2019/08/16/Mysql-RedoAndUndo/redo-buffer.png\" alt=\"redo\"></p>\n<h2 id=\"redo\"><a href=\"#redo\" class=\"headerlink\" title=\"redo\"></a>redo</h2><p>InnoDB  <strong>Force Log at Commit</strong>  redo log buffer  redo log file commit<br> <strong>Write-Ahead Log</strong>()</p>\n<p>redo log fileredo bufferredo log fileInnoDB fsync, O_DIRECT fsyncfsync fsync<br>(O_DIRECTLinuxIO)</p>\n<h1 id=\"undo-log\"><a href=\"#undo-log\" class=\"headerlink\" title=\"undo log\"></a>undo log</h1><h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><p>undo log</p>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><p>InnoDBundo(Rollback Segment),1024undo log segmentundo log segmentundo 5.6Rollback Segment5.6.3 innodb_undo_tablespaceundo</p>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><ul>\n<li>DMLundo</li>\n<li><strong></strong>undo</li>\n</ul>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><p><img src=\"/2019/08/16/Mysql-RedoAndUndo/undo-Segment.png\" alt=\"undo\"><br>undo log IO</p>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><ul>\n<li>insert undo loginsert undo loginsertundo logpurge</li>\n<li>update undo logdelete updateundo logundo logMVCCundo logpurge</li>\n</ul>\n<div style=\"display: none\">\n## DML\n* \n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. delete   --undodelete mark  </span><br><span class=\"line\">2. update  --undo  </span><br><span class=\"line\">\t*  delete(delete,delete mark)  + insert </span><br><span class=\"line\">\t* update</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. delete  --undo</span><br><span class=\"line\">\tdelete mark    </span><br><span class=\"line\">2. update  --undo</span><br><span class=\"line\">\tdelete mark + insert</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n</div>\n\n<h1 id=\"redo-amp-undo\"><a href=\"#redo-amp-undo\" class=\"headerlink\" title=\"redo &amp; undo\"></a>redo &amp; undo</h1><h2 id=\"undo-log--redo-log-\"><a href=\"#undo-log--redo-log-\" class=\"headerlink\" title=\"undo log  redo log \"></a>undo log  redo log </h2><p>undo log<br>redo logundo logredo log</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>BA13B24redo</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AB1,2.</span><br><span class=\"line\">1. B</span><br><span class=\"line\">2. A=1undo log</span><br><span class=\"line\">3. A=3</span><br><span class=\"line\">4. A=3 redo log</span><br><span class=\"line\">5. B=2 undo log</span><br><span class=\"line\">6. B=4</span><br><span class=\"line\">7. B=4redo log</span><br><span class=\"line\">8. redo log</span><br><span class=\"line\">9. </span><br><span class=\"line\">10.B</span><br></pre></td></tr></table></figure>\n\n<p>insert/update/deleteredoundoInnoDB</p>\n<ol>\n<li>undoredo</li>\n<li>undo</li>\n<li></li>\n<li>Redo</li>\n</ol>\n<p>BCredo</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. C</span><br><span class=\"line\">2. A=1undo log</span><br><span class=\"line\">3. A=3</span><br><span class=\"line\">4. A=3 redo log</span><br><span class=\"line\">5. B=2 undo log</span><br><span class=\"line\">6. B=4</span><br><span class=\"line\">7. B=4redo log</span><br><span class=\"line\">   &lt;!----&gt;</span><br><span class=\"line\">8. B=2</span><br><span class=\"line\">9. B=2redo log</span><br><span class=\"line\">10.A=1</span><br><span class=\"line\">11.A=1redo log</span><br><span class=\"line\">12.redo log</span><br><span class=\"line\">13.</span><br><span class=\"line\">14.C</span><br></pre></td></tr></table></figure>\n\n<p>redoundo<br> redo log  redo log  undo log </p>\n<p>BredoA=3&amp;B=4undoA=1&amp;B=2</p>\n<div style=\"display: none\">\n# \n* https://keithlan.github.io/2017/06/12/innodb_locks_redo/\n* https://juejin.im/post/5c3c5c0451882525487c498d\n* https://t.hao0.me/mysql/2016/11/05/mysql-innodb-05-tablespaces.html\n</div>","site":{"data":{}},"excerpt":"<h1 id=\"redo-log\"><a href=\"#redo-log\" class=\"headerlink\" title=\"redo log\"></a>redo log</h1><h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><p>(redo log)InnoDB Redo <code></code></p>\n<h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><p>Redo log</p>","more":"<ol>\n<li> (redo log buffer),<ul>\n<li>redo log buffer redo log file</li>\n<li>log block  </li>\n<li>log block 512 <a href=\"http://123.56.47.170:8080/2019/07/31/Mysql02/#%E4%B8%A4%E6%AC%A1%E5%86%99\" target=\"_blank\" rel=\"noopener\">double write</a>  </li>\n</ul>\n</li>\n<li> (redo log file)    <ul>\n<li>redo log2,  </li>\n</ul>\n</li>\n</ol>\n<h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><ul>\n<li>redo<strong></strong></li>\n<li>redo</li>\n<li>undoRedo</li>\n</ul>\n<h2 id=\"redo-\"><a href=\"#redo-\" class=\"headerlink\" title=\"redo \"></a>redo </h2><p><img src=\"/2019/08/16/Mysql-RedoAndUndo/redo-buffer.png\" alt=\"redo\"></p>\n<h2 id=\"redo\"><a href=\"#redo\" class=\"headerlink\" title=\"redo\"></a>redo</h2><p>InnoDB  <strong>Force Log at Commit</strong>  redo log buffer  redo log file commit<br> <strong>Write-Ahead Log</strong>()</p>\n<p>redo log fileredo bufferredo log fileInnoDB fsync, O_DIRECT fsyncfsync fsync<br>(O_DIRECTLinuxIO)</p>\n<h1 id=\"undo-log\"><a href=\"#undo-log\" class=\"headerlink\" title=\"undo log\"></a>undo log</h1><h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><p>undo log</p>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><p>InnoDBundo(Rollback Segment),1024undo log segmentundo log segmentundo 5.6Rollback Segment5.6.3 innodb_undo_tablespaceundo</p>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><ul>\n<li>DMLundo</li>\n<li><strong></strong>undo</li>\n</ul>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><p><img src=\"/2019/08/16/Mysql-RedoAndUndo/undo-Segment.png\" alt=\"undo\"><br>undo log IO</p>\n<h2 id=\"undo-\"><a href=\"#undo-\" class=\"headerlink\" title=\"undo \"></a>undo </h2><ul>\n<li>insert undo loginsert undo loginsertundo logpurge</li>\n<li>update undo logdelete updateundo logundo logMVCCundo logpurge</li>\n</ul>\n<div style=\"display: none\">\n## DML\n* \n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. delete   --undodelete mark  </span><br><span class=\"line\">2. update  --undo  </span><br><span class=\"line\">\t*  delete(delete,delete mark)  + insert </span><br><span class=\"line\">\t* update</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. delete  --undo</span><br><span class=\"line\">\tdelete mark    </span><br><span class=\"line\">2. update  --undo</span><br><span class=\"line\">\tdelete mark + insert</span><br></pre></td></tr></table></figure>\n\n</li>\n</ul>\n</div>\n\n<h1 id=\"redo-amp-undo\"><a href=\"#redo-amp-undo\" class=\"headerlink\" title=\"redo &amp; undo\"></a>redo &amp; undo</h1><h2 id=\"undo-log--redo-log-\"><a href=\"#undo-log--redo-log-\" class=\"headerlink\" title=\"undo log  redo log \"></a>undo log  redo log </h2><p>undo log<br>redo logundo logredo log</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>BA13B24redo</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">AB1,2.</span><br><span class=\"line\">1. B</span><br><span class=\"line\">2. A=1undo log</span><br><span class=\"line\">3. A=3</span><br><span class=\"line\">4. A=3 redo log</span><br><span class=\"line\">5. B=2 undo log</span><br><span class=\"line\">6. B=4</span><br><span class=\"line\">7. B=4redo log</span><br><span class=\"line\">8. redo log</span><br><span class=\"line\">9. </span><br><span class=\"line\">10.B</span><br></pre></td></tr></table></figure>\n\n<p>insert/update/deleteredoundoInnoDB</p>\n<ol>\n<li>undoredo</li>\n<li>undo</li>\n<li></li>\n<li>Redo</li>\n</ol>\n<p>BCredo</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">1. C</span><br><span class=\"line\">2. A=1undo log</span><br><span class=\"line\">3. A=3</span><br><span class=\"line\">4. A=3 redo log</span><br><span class=\"line\">5. B=2 undo log</span><br><span class=\"line\">6. B=4</span><br><span class=\"line\">7. B=4redo log</span><br><span class=\"line\">   &lt;!----&gt;</span><br><span class=\"line\">8. B=2</span><br><span class=\"line\">9. B=2redo log</span><br><span class=\"line\">10.A=1</span><br><span class=\"line\">11.A=1redo log</span><br><span class=\"line\">12.redo log</span><br><span class=\"line\">13.</span><br><span class=\"line\">14.C</span><br></pre></td></tr></table></figure>\n\n<p>redoundo<br> redo log  redo log  undo log </p>\n<p>BredoA=3&amp;B=4undoA=1&amp;B=2</p>\n<div style=\"display: none\">\n# \n* https://keithlan.github.io/2017/06/12/innodb_locks_redo/\n* https://juejin.im/post/5c3c5c0451882525487c498d\n* https://t.hao0.me/mysql/2016/11/05/mysql-innodb-05-tablespaces.html\n</div>"},{"title":"Mysql-Mysql","author":"Guyuqing","copyright":true,"comments":0,"date":"2019-08-19T11:23:00.000Z","_content":"# \n\n* [](#)MySQL\n\n* [](#)MySQL\n\n* [socket](#)UNIX\n\n* [pid](#pid)MySQLID\n\n* [MySQL](#)MySQL\n\n* [](#innoDB)MySQLInnoDB\n\n# \n\n*  Mysql \n* \n\n\n```sql\nSET\n| [global | session] system_var_name=expr\n| [@@global. | @@session. | @@] system_var_name = expr\n\n# \nSET read_buffer_size = 524288\n\n# \nSET @@global.read_buffer_size = 1048576;\n\n# \nSELECT @@session.read_buffer_size;\n\n# \nSELECT @@global.read_buffer_size;\n\n```\n`global``session` \nmy.cnf\n\n# \nMySQL\n* error logMySQL\n* slow query log\n* bin log\n* log\n\n## \nMySQLSQL\n\n<table>\n     <tr>\n         <th colspan=\"4\"></th>\n         <th colspan=\"4\"></th>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_slow_queries = on;</th>\n         <td colspan=\"4\"></td>\n     </tr>\n     <tr>\n         <th colspan=\"4\" >set global long_query_time = 1;</th>\n         <td colspan=\"4\">1s10s</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_queries_not_using_indeces = on;</th>\n         <td colspan=\"4\">SQL</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_throttle_queries_not_using_indexs = on;</th>\n         <td colspan=\"4\">slow logSQL0</td>\n     </tr>\n</table> \n\n# \n\n# pid\n\n# \n\n# innoDB\n\n# \n* MySQLInnoDB(2)\n* https://www.jianshu.com/p/c1ffd6956e6a\n* https://www.cnblogs.com/BlueMountain-HaggenDazs/p/9297883.html","source":"_posts/Mysql03.md","raw":"title: Mysql-Mysql\ntags:\n  - \n  - MySql\n  - InnoDB\ncategories:\n  - Mysql\nauthor: Guyuqing\ncopyright: true\ncomments: false\ndate: 2019-08-19 19:23:00\n---\n# \n\n* [](#)MySQL\n\n* [](#)MySQL\n\n* [socket](#)UNIX\n\n* [pid](#pid)MySQLID\n\n* [MySQL](#)MySQL\n\n* [](#innoDB)MySQLInnoDB\n\n# \n\n*  Mysql \n* \n\n\n```sql\nSET\n| [global | session] system_var_name=expr\n| [@@global. | @@session. | @@] system_var_name = expr\n\n# \nSET read_buffer_size = 524288\n\n# \nSET @@global.read_buffer_size = 1048576;\n\n# \nSELECT @@session.read_buffer_size;\n\n# \nSELECT @@global.read_buffer_size;\n\n```\n`global``session` \nmy.cnf\n\n# \nMySQL\n* error logMySQL\n* slow query log\n* bin log\n* log\n\n## \nMySQLSQL\n\n<table>\n     <tr>\n         <th colspan=\"4\"></th>\n         <th colspan=\"4\"></th>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_slow_queries = on;</th>\n         <td colspan=\"4\"></td>\n     </tr>\n     <tr>\n         <th colspan=\"4\" >set global long_query_time = 1;</th>\n         <td colspan=\"4\">1s10s</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_queries_not_using_indeces = on;</th>\n         <td colspan=\"4\">SQL</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_throttle_queries_not_using_indexs = on;</th>\n         <td colspan=\"4\">slow logSQL0</td>\n     </tr>\n</table> \n\n# \n\n# pid\n\n# \n\n# innoDB\n\n# \n* MySQLInnoDB(2)\n* https://www.jianshu.com/p/c1ffd6956e6a\n* https://www.cnblogs.com/BlueMountain-HaggenDazs/p/9297883.html","slug":"Mysql03","published":1,"updated":"2019-09-02T09:24:30.063Z","layout":"post","photos":[],"link":"","_id":"ck4859y3m0010t0fyihbt1gcj","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><p><a href=\"#\"></a>MySQL</p>\n</li>\n<li><p><a href=\"#\"></a>MySQL</p>\n</li>\n<li><p><a href=\"#\">socket</a>UNIX</p>\n</li>\n<li><p><a href=\"#pid\">pid</a>MySQLID</p>\n</li>\n<li><p><a href=\"#\">MySQL</a>MySQL</p>\n</li>\n<li><p><a href=\"#innoDB\"></a>MySQLInnoDB</p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li> Mysql </li>\n<li></li>\n</ul>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SET</span></span><br><span class=\"line\">| [<span class=\"keyword\">global</span> | <span class=\"keyword\">session</span>] system_var_name=expr</span><br><span class=\"line\">| [@@global. | @@session. | @@] system_var_name = expr</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SET</span> read_buffer_size = <span class=\"number\">524288</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SET</span> @@global.read_buffer_size = <span class=\"number\">1048576</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> @@session.read_buffer_size;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> @@global.read_buffer_size;</span><br></pre></td></tr></table></figure>\n\n<p><code>global</code><code>session</code><br>my.cnf</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySQL</p>\n<ul>\n<li>error logMySQL</li>\n<li>slow query log</li>\n<li>bin log</li>\n<li>log</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>MySQLSQL</p>\n<table>\n     <tr>\n         <th colspan=\"4\"></th>\n         <th colspan=\"4\"></th>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_slow_queries = on;</th>\n         <td colspan=\"4\"></td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global long_query_time = 1;</th>\n         <td colspan=\"4\">1s10s</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_queries_not_using_indeces = on;</th>\n         <td colspan=\"4\">SQL</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_throttle_queries_not_using_indexs = on;</th>\n         <td colspan=\"4\">slow logSQL0</td>\n     </tr>\n</table> \n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"pid\"><a href=\"#pid\" class=\"headerlink\" title=\"pid\"></a>pid</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"innoDB\"><a href=\"#innoDB\" class=\"headerlink\" title=\"innoDB\"></a>innoDB</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>MySQLInnoDB(2)</li>\n<li><a href=\"https://www.jianshu.com/p/c1ffd6956e6a\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/c1ffd6956e6a</a></li>\n<li><a href=\"https://www.cnblogs.com/BlueMountain-HaggenDazs/p/9297883.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/BlueMountain-HaggenDazs/p/9297883.html</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><p><a href=\"#\"></a>MySQL</p>\n</li>\n<li><p><a href=\"#\"></a>MySQL</p>\n</li>\n<li><p><a href=\"#\">socket</a>UNIX</p>\n</li>\n<li><p><a href=\"#pid\">pid</a>MySQLID</p>\n</li>\n<li><p><a href=\"#\">MySQL</a>MySQL</p>\n</li>\n<li><p><a href=\"#innoDB\"></a>MySQLInnoDB</p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<ul>\n<li> Mysql </li>\n<li></li>\n</ul>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SET</span></span><br><span class=\"line\">| [<span class=\"keyword\">global</span> | <span class=\"keyword\">session</span>] system_var_name=expr</span><br><span class=\"line\">| [@@global. | @@session. | @@] system_var_name = expr</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SET</span> read_buffer_size = <span class=\"number\">524288</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SET</span> @@global.read_buffer_size = <span class=\"number\">1048576</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> @@session.read_buffer_size;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"keyword\">SELECT</span> @@global.read_buffer_size;</span><br></pre></td></tr></table></figure>\n\n<p><code>global</code><code>session</code><br>my.cnf</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySQL</p>\n<ul>\n<li>error logMySQL</li>\n<li>slow query log</li>\n<li>bin log</li>\n<li>log</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>MySQLSQL</p>\n<table>\n     <tr>\n         <th colspan=\"4\"></th>\n         <th colspan=\"4\"></th>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_slow_queries = on;</th>\n         <td colspan=\"4\"></td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global long_query_time = 1;</th>\n         <td colspan=\"4\">1s10s</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_queries_not_using_indeces = on;</th>\n         <td colspan=\"4\">SQL</td>\n     </tr>\n     <tr>\n         <th colspan=\"4\">set global log_throttle_queries_not_using_indexs = on;</th>\n         <td colspan=\"4\">slow logSQL0</td>\n     </tr>\n</table> \n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"pid\"><a href=\"#pid\" class=\"headerlink\" title=\"pid\"></a>pid</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h1 id=\"innoDB\"><a href=\"#innoDB\" class=\"headerlink\" title=\"innoDB\"></a>innoDB</h1><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>MySQLInnoDB(2)</li>\n<li><a href=\"https://www.jianshu.com/p/c1ffd6956e6a\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/c1ffd6956e6a</a></li>\n<li><a href=\"https://www.cnblogs.com/BlueMountain-HaggenDazs/p/9297883.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/BlueMountain-HaggenDazs/p/9297883.html</a></li>\n</ul>\n"},{"title":"Mysql-","author":"Guyuqing","copyright":true,"comments":0,"date":"2019-10-17T08:25:00.000Z","_content":"InnoDB\n\nB+\n\n# \n\nB+B+B\n\n## \n\n\n\n## \n![BST_insert](Mysql05/BST_insert.png)\n\n## \n\n![BST_delete](Mysql05/BST_delete1.png)\n\n\n````\n![BST_delete](Mysql05/BST_delete2.png)\n\n## \nlog(N)``O(N)\n![BST_delete](Mysql05/BST_linked.png)\n\n# \n\n``O(logN)\n\n## \n\n1\n\n## \n4\n\n### \n\n![BBT1](Mysql05/BBT1.png)\n\n### \n\n![BBT2](Mysql05/BBT2.png)\n\n### \n\n![BBT3](Mysql05/BBT3.png)\n``[](#)[](#)\n\n### \n\n![BBT4](Mysql05/BBT4.png)\n\n## &\n\n[](#)[](#)\n\n\n# B+","source":"_posts/Mysql05.md","raw":"title: Mysql-\ntags:\n  - \n  - MySql\n  - InnoDB\ncategories:\n  - Mysql\nauthor: Guyuqing\ncopyright: true\ncomments: false\ndate: 2019-10-17 16:25:00\n---\nInnoDB\n\nB+\n\n# \n\nB+B+B\n\n## \n\n\n\n## \n![BST_insert](Mysql05/BST_insert.png)\n\n## \n\n![BST_delete](Mysql05/BST_delete1.png)\n\n\n````\n![BST_delete](Mysql05/BST_delete2.png)\n\n## \nlog(N)``O(N)\n![BST_delete](Mysql05/BST_linked.png)\n\n# \n\n``O(logN)\n\n## \n\n1\n\n## \n4\n\n### \n\n![BBT1](Mysql05/BBT1.png)\n\n### \n\n![BBT2](Mysql05/BBT2.png)\n\n### \n\n![BBT3](Mysql05/BBT3.png)\n``[](#)[](#)\n\n### \n\n![BBT4](Mysql05/BBT4.png)\n\n## &\n\n[](#)[](#)\n\n\n# B+","slug":"Mysql05","published":1,"updated":"2019-10-18T07:44:27.802Z","layout":"post","photos":[],"link":"","_id":"ck4859y3q0013t0fyyxk4qmtl","content":"<p>InnoDB</p>\n<p>B+</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>B+B+B</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2019/10/17/Mysql05/BST_insert.png\" alt=\"BST_insert\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><img src=\"/2019/10/17/Mysql05/BST_delete1.png\" alt=\"BST_delete\"></p>\n<p><br><code></code><code></code><br><img src=\"/2019/10/17/Mysql05/BST_delete2.png\" alt=\"BST_delete\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>log(N)<code></code>O(N)<br><img src=\"/2019/10/17/Mysql05/BST_linked.png\" alt=\"BST_delete\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code></code>O(logN)</p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>1</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>4</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT1.png\" alt=\"BBT1\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT2.png\" alt=\"BBT2\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT3.png\" alt=\"BBT3\"><br><code></code><a href=\"#\"></a><a href=\"#\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT4.png\" alt=\"BBT4\"></p>\n<h2 id=\"-amp-\"><a href=\"#-amp-\" class=\"headerlink\" title=\"&amp;\"></a>&amp;</h2><p><a href=\"#\"></a><a href=\"#\"></a></p>\n<h1 id=\"B-\"><a href=\"#B-\" class=\"headerlink\" title=\"B+\"></a>B+</h1>","site":{"data":{}},"excerpt":"","more":"<p>InnoDB</p>\n<p>B+</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>B+B+B</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2019/10/17/Mysql05/BST_insert.png\" alt=\"BST_insert\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><img src=\"/2019/10/17/Mysql05/BST_delete1.png\" alt=\"BST_delete\"></p>\n<p><br><code></code><code></code><br><img src=\"/2019/10/17/Mysql05/BST_delete2.png\" alt=\"BST_delete\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>log(N)<code></code>O(N)<br><img src=\"/2019/10/17/Mysql05/BST_linked.png\" alt=\"BST_delete\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code></code>O(logN)</p>\n<h2 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h2><p>1</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>4</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT1.png\" alt=\"BBT1\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT2.png\" alt=\"BBT2\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT3.png\" alt=\"BBT3\"><br><code></code><a href=\"#\"></a><a href=\"#\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/10/17/Mysql05/BBT4.png\" alt=\"BBT4\"></p>\n<h2 id=\"-amp-\"><a href=\"#-amp-\" class=\"headerlink\" title=\"&amp;\"></a>&amp;</h2><p><a href=\"#\"></a><a href=\"#\"></a></p>\n<h1 id=\"B-\"><a href=\"#B-\" class=\"headerlink\" title=\"B+\"></a>B+</h1>"},{"title":"","date":"2019-07-12T09:49:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"password":12345,"_content":"## \n### \n* \n    1. 180\n    2. \n    3. 20,0003700-4000\n    4. 12100\n<!-- more -->\n* \n    1. 1000\n    2. 100\n    3. (15\n\n* \n    1. `Visa on Arrival` \n    2. ``\n    3. \n    4. \n    5. `For Visa-on-Arrival Only`\n    6. 1515\n\n## 9.10\n\n\n-> `C2077 2050-2120  54.5`\n![](Thailand-Raiders/1.png)\n\n### \n\n->T1   `45min` `3`\n![](Thailand-Raiders/tianjin-airport.png)\n\n10\n\nT1 ->T1\n`SL963  23:50-03:35 +1  `\n\n### 9.11\n\n`455/4 Maha Chai Road`, Bangkok, Krung Thep Maha Nakhon 10200, Thailand\n![](Thailand-Raiders/2.png)\n![](Thailand-Raiders/455.jpeg)\n![](Thailand-Raiders/455-2.jpeg)\n![](Thailand-Raiders/455-3.jpeg)\n\nT1 -> `455/4 Maha Chai Road`\n2\n\n\n#### 9.11 10:00\n\n\n   `3h  500 111.5` \n  `0.5h  200 44`\n 3\n  `0.5h  30  7`\n `2h` \n\n### 9.12 \n****\n\n->\nbegin\n![](Thailand-Raiders/3.png)\n1 `50`\n![](Thailand-Raiders/4.png)\n2\n![](Thailand-Raiders/5.png)\n3BST\n![](Thailand-Raiders/6.png)\n4BST8Ekkamai 2100m\nend\n\n`Pattaya``108` `3`\n700-2000 `2h`\n\n### 9.12 \n88/999,Moo.10 Building B Room No.999, Pattayasaisong Rd, Muang Pattaya, Amphoe Bang Lamung, Chang Wat Chon Buri 20150\n#### \n\n![](Thailand-Raiders/10.jpeg)\n![](Thailand-Raiders/11.png)\n10/\n\n#### \n\nNorth Pattaya Road Bus Terminal\n2.6\n![](Thailand-Raiders/7.png)\n\n 900-1800 `800   178` \n![](Thailand-Raiders/8.png)\n\n 900-2000\n![](Thailand-Raiders/9.png)\n\n  180019302100  `800vip1000vip1200   178` 10 \n![](Thailand-Raiders/Tiffany.png)\n\n \n\n### 9.13\n\n\n\n### 9.14\n\n\nBus Terminal`Ekkamai`11\n\n### 9.14\nRatchaprarop Road Ratchaprarop Road indraCondo/177/209 soi saengkran/ratchprarop road, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand\n\n![](Thailand-Raiders/WechatIMG38.jpeg)\n![](Thailand-Raiders/WechatIMG39.png)\n![](Thailand-Raiders/WechatIMG40.png)\n\n#### 9.15\n\n\n## \nBIG-C\n![](Thailand-Raiders/Screenshot_2019-08-31-11-46-03-072_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-46-08-364_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-46-00-652_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-45-53-237_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-45-57-687_com.xingin.xhs.png)\n711\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-14-972_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-18-389_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-20-912_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-23-188_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-25-297_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-30-499_com.xingin.xhs.png)\n\n### \n![](Thailand-Raiders/Screenshot_2019-08-31-13-11-50-782_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-13-11-56-133_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-13-12-27-105_com.xingin.xhs.png)\n\n### \n\nONLY \nN7\n\n### \nWacoalcentral world /\nLee\nLeVI'S\neveryandboy\ncentral world \n![](Thailand-Raiders/Screenshot_2019-08-31-14-05-58-003_com.xingin.xhs.png)\n\n## \n\n![](Thailand-Raiders/Screenshot_2019-08-31-14-25-04-833_com.xingin.xhs.png)\n\n\n\n","source":"_posts/Thailand-Raiders.md","raw":"---\ntitle: \ndate: 2019-07-12 17:49:04\ntags:\n    - \ncategories: \nauthor: Guyuqing\ncopyright: true\ncomments: false\npassword: 12345\n---\n## \n### \n* \n    1. 180\n    2. \n    3. 20,0003700-4000\n    4. 12100\n<!-- more -->\n* \n    1. 1000\n    2. 100\n    3. (15\n\n* \n    1. `Visa on Arrival` \n    2. ``\n    3. \n    4. \n    5. `For Visa-on-Arrival Only`\n    6. 1515\n\n## 9.10\n\n\n-> `C2077 2050-2120  54.5`\n![](Thailand-Raiders/1.png)\n\n### \n\n->T1   `45min` `3`\n![](Thailand-Raiders/tianjin-airport.png)\n\n10\n\nT1 ->T1\n`SL963  23:50-03:35 +1  `\n\n### 9.11\n\n`455/4 Maha Chai Road`, Bangkok, Krung Thep Maha Nakhon 10200, Thailand\n![](Thailand-Raiders/2.png)\n![](Thailand-Raiders/455.jpeg)\n![](Thailand-Raiders/455-2.jpeg)\n![](Thailand-Raiders/455-3.jpeg)\n\nT1 -> `455/4 Maha Chai Road`\n2\n\n\n#### 9.11 10:00\n\n\n   `3h  500 111.5` \n  `0.5h  200 44`\n 3\n  `0.5h  30  7`\n `2h` \n\n### 9.12 \n****\n\n->\nbegin\n![](Thailand-Raiders/3.png)\n1 `50`\n![](Thailand-Raiders/4.png)\n2\n![](Thailand-Raiders/5.png)\n3BST\n![](Thailand-Raiders/6.png)\n4BST8Ekkamai 2100m\nend\n\n`Pattaya``108` `3`\n700-2000 `2h`\n\n### 9.12 \n88/999,Moo.10 Building B Room No.999, Pattayasaisong Rd, Muang Pattaya, Amphoe Bang Lamung, Chang Wat Chon Buri 20150\n#### \n\n![](Thailand-Raiders/10.jpeg)\n![](Thailand-Raiders/11.png)\n10/\n\n#### \n\nNorth Pattaya Road Bus Terminal\n2.6\n![](Thailand-Raiders/7.png)\n\n 900-1800 `800   178` \n![](Thailand-Raiders/8.png)\n\n 900-2000\n![](Thailand-Raiders/9.png)\n\n  180019302100  `800vip1000vip1200   178` 10 \n![](Thailand-Raiders/Tiffany.png)\n\n \n\n### 9.13\n\n\n\n### 9.14\n\n\nBus Terminal`Ekkamai`11\n\n### 9.14\nRatchaprarop Road Ratchaprarop Road indraCondo/177/209 soi saengkran/ratchprarop road, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand\n\n![](Thailand-Raiders/WechatIMG38.jpeg)\n![](Thailand-Raiders/WechatIMG39.png)\n![](Thailand-Raiders/WechatIMG40.png)\n\n#### 9.15\n\n\n## \nBIG-C\n![](Thailand-Raiders/Screenshot_2019-08-31-11-46-03-072_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-46-08-364_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-46-00-652_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-45-53-237_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-11-45-57-687_com.xingin.xhs.png)\n711\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-14-972_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-18-389_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-20-912_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-23-188_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-25-297_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-12-05-30-499_com.xingin.xhs.png)\n\n### \n![](Thailand-Raiders/Screenshot_2019-08-31-13-11-50-782_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-13-11-56-133_com.xingin.xhs.png)\n![](Thailand-Raiders/Screenshot_2019-08-31-13-12-27-105_com.xingin.xhs.png)\n\n### \n\nONLY \nN7\n\n### \nWacoalcentral world /\nLee\nLeVI'S\neveryandboy\ncentral world \n![](Thailand-Raiders/Screenshot_2019-08-31-14-05-58-003_com.xingin.xhs.png)\n\n## \n\n![](Thailand-Raiders/Screenshot_2019-08-31-14-25-04-833_com.xingin.xhs.png)\n\n\n\n","slug":"Thailand-Raiders","published":1,"updated":"2019-09-02T06:58:53.310Z","layout":"post","photos":[],"link":"","_id":"ck4859y3s0017t0fyzc60sa62","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n<ol>\n<li>180</li>\n<li></li>\n<li>20,0003700-4000</li>\n<li>12100<a id=\"more\"></a></li>\n</ol>\n</li>\n<li><p></p>\n<ol>\n<li>1000</li>\n<li>100</li>\n<li>(15</li>\n</ol>\n</li>\n<li><p></p>\n<ol>\n<li><code>Visa on Arrival</code> </li>\n<li><code></code></li>\n<li></li>\n<li></li>\n<li><code>For Visa-on-Arrival Only</code></li>\n<li>1515</li>\n</ol>\n</li>\n</ul>\n<h2 id=\"9-10\"><a href=\"#9-10\" class=\"headerlink\" title=\"9.10\"></a>9.10</h2><p>-&gt; <code>C2077 2050-2120  54.5</code><br><img src=\"/2019/07/12/Thailand-Raiders/1.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>-&gt;T1   <code>45min</code> <code>3</code><br><img src=\"/2019/07/12/Thailand-Raiders/tianjin-airport.png\" alt=\"\"></p>\n<p>10</p>\n<p>T1 -&gt;T1<br><code>SL963  23:50-03:35 +1 </code></p>\n<h3 id=\"9-11\"><a href=\"#9-11\" class=\"headerlink\" title=\"9.11\"></a>9.11</h3><p><code>455/4 Maha Chai Road</code>, Bangkok, Krung Thep Maha Nakhon 10200, Thailand<br><img src=\"/2019/07/12/Thailand-Raiders/2.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/455.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/455-2.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/455-3.jpeg\" alt=\"\"></p>\n<p>T1 -&gt; <code>455/4 Maha Chai Road</code><br>2<br></p>\n<h4 id=\"9-11-10-00\"><a href=\"#9-11-10-00\" class=\"headerlink\" title=\"9.11 10:00\"></a>9.11 10:00</h4><p></p>\n<p>   <code>3h  500 111.5</code> <br>  <code>0.5h  200 44</code><br> 3<br>  <code>0.5h  30  7</code><br> <code>2h</code> </p>\n<h3 id=\"9-12-\"><a href=\"#9-12-\" class=\"headerlink\" title=\"9.12 \"></a>9.12 </h3><p><strong></strong></p>\n<p>-&gt;<br>begin<br><img src=\"/2019/07/12/Thailand-Raiders/3.png\" alt=\"\"><br>1 <code>50</code><br><img src=\"/2019/07/12/Thailand-Raiders/4.png\" alt=\"\"><br>2<br><img src=\"/2019/07/12/Thailand-Raiders/5.png\" alt=\"\"><br>3BST<br><img src=\"/2019/07/12/Thailand-Raiders/6.png\" alt=\"\"><br>4BST8Ekkamai 2100m<br>end</p>\n<p><code>Pattaya</code><code>108</code> <code>3</code><br>700-2000 <code>2h</code></p>\n<h3 id=\"9-12-\"><a href=\"#9-12-\" class=\"headerlink\" title=\"9.12 \"></a>9.12 </h3><p>88/999,Moo.10 Building B Room No.999, Pattayasaisong Rd, Muang Pattaya, Amphoe Bang Lamung, Chang Wat Chon Buri 20150</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><img src=\"/2019/07/12/Thailand-Raiders/10.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/11.png\" alt=\"\"><br>10/</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>North Pattaya Road Bus Terminal<br>2.6<br><img src=\"/2019/07/12/Thailand-Raiders/7.png\" alt=\"\"></p>\n<p> 900-1800 <code>800   178</code> <br><img src=\"/2019/07/12/Thailand-Raiders/8.png\" alt=\"\"></p>\n<p> 900-2000<br><img src=\"/2019/07/12/Thailand-Raiders/9.png\" alt=\"\"></p>\n<p>  180019302100  <code>800vip1000vip1200   178</code> 10 <br><img src=\"/2019/07/12/Thailand-Raiders/Tiffany.png\" alt=\"\"></p>\n<p> </p>\n<h3 id=\"9-13\"><a href=\"#9-13\" class=\"headerlink\" title=\"9.13\"></a>9.13</h3><p><br></p>\n<h3 id=\"9-14\"><a href=\"#9-14\" class=\"headerlink\" title=\"9.14\"></a>9.14</h3><p></p>\n<p>Bus Terminal<code>Ekkamai</code>11</p>\n<h3 id=\"9-14\"><a href=\"#9-14\" class=\"headerlink\" title=\"9.14\"></a>9.14</h3><p>Ratchaprarop Road Ratchaprarop Road indraCondo/177/209 soi saengkran/ratchprarop road, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand</p>\n<p><img src=\"/2019/07/12/Thailand-Raiders/WechatIMG38.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/WechatIMG39.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/WechatIMG40.png\" alt=\"\"></p>\n<h4 id=\"9-15\"><a href=\"#9-15\" class=\"headerlink\" title=\"9.15\"></a>9.15</h4><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>BIG-C<br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-46-03-072_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-46-08-364_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-46-00-652_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-45-53-237_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-45-57-687_com.xingin.xhs.png\" alt=\"\"><br>711<br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-14-972_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-18-389_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-20-912_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-23-188_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-25-297_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-30-499_com.xingin.xhs.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-13-11-50-782_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-13-11-56-133_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-13-12-27-105_com.xingin.xhs.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>ONLY <br>N7</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Wacoalcentral world /<br>Lee<br>LeVIS<br>everyandboy<br>central world <br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-14-05-58-003_com.xingin.xhs.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-14-25-04-833_com.xingin.xhs.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n<ol>\n<li>180</li>\n<li></li>\n<li>20,0003700-4000</li>\n<li>12100</li></ol></li></ul>","more":"\n\n\n<li><p></p>\n<ol>\n<li>1000</li>\n<li>100</li>\n<li>(15</li>\n</ol>\n</li>\n<li><p></p>\n<ol>\n<li><code>Visa on Arrival</code> </li>\n<li><code></code></li>\n<li></li>\n<li></li>\n<li><code>For Visa-on-Arrival Only</code></li>\n<li>1515</li>\n</ol>\n</li>\n\n<h2 id=\"9-10\"><a href=\"#9-10\" class=\"headerlink\" title=\"9.10\"></a>9.10</h2><p>-&gt; <code>C2077 2050-2120  54.5</code><br><img src=\"/2019/07/12/Thailand-Raiders/1.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>-&gt;T1   <code>45min</code> <code>3</code><br><img src=\"/2019/07/12/Thailand-Raiders/tianjin-airport.png\" alt=\"\"></p>\n<p>10</p>\n<p>T1 -&gt;T1<br><code>SL963  23:50-03:35 +1 </code></p>\n<h3 id=\"9-11\"><a href=\"#9-11\" class=\"headerlink\" title=\"9.11\"></a>9.11</h3><p><code>455/4 Maha Chai Road</code>, Bangkok, Krung Thep Maha Nakhon 10200, Thailand<br><img src=\"/2019/07/12/Thailand-Raiders/2.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/455.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/455-2.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/455-3.jpeg\" alt=\"\"></p>\n<p>T1 -&gt; <code>455/4 Maha Chai Road</code><br>2<br></p>\n<h4 id=\"9-11-10-00\"><a href=\"#9-11-10-00\" class=\"headerlink\" title=\"9.11 10:00\"></a>9.11 10:00</h4><p></p>\n<p>   <code>3h  500 111.5</code> <br>  <code>0.5h  200 44</code><br> 3<br>  <code>0.5h  30  7</code><br> <code>2h</code> </p>\n<h3 id=\"9-12-\"><a href=\"#9-12-\" class=\"headerlink\" title=\"9.12 \"></a>9.12 </h3><p><strong></strong></p>\n<p>-&gt;<br>begin<br><img src=\"/2019/07/12/Thailand-Raiders/3.png\" alt=\"\"><br>1 <code>50</code><br><img src=\"/2019/07/12/Thailand-Raiders/4.png\" alt=\"\"><br>2<br><img src=\"/2019/07/12/Thailand-Raiders/5.png\" alt=\"\"><br>3BST<br><img src=\"/2019/07/12/Thailand-Raiders/6.png\" alt=\"\"><br>4BST8Ekkamai 2100m<br>end</p>\n<p><code>Pattaya</code><code>108</code> <code>3</code><br>700-2000 <code>2h</code></p>\n<h3 id=\"9-12-\"><a href=\"#9-12-\" class=\"headerlink\" title=\"9.12 \"></a>9.12 </h3><p>88/999,Moo.10 Building B Room No.999, Pattayasaisong Rd, Muang Pattaya, Amphoe Bang Lamung, Chang Wat Chon Buri 20150</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><br><img src=\"/2019/07/12/Thailand-Raiders/10.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/11.png\" alt=\"\"><br>10/</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>North Pattaya Road Bus Terminal<br>2.6<br><img src=\"/2019/07/12/Thailand-Raiders/7.png\" alt=\"\"></p>\n<p> 900-1800 <code>800   178</code> <br><img src=\"/2019/07/12/Thailand-Raiders/8.png\" alt=\"\"></p>\n<p> 900-2000<br><img src=\"/2019/07/12/Thailand-Raiders/9.png\" alt=\"\"></p>\n<p>  180019302100  <code>800vip1000vip1200   178</code> 10 <br><img src=\"/2019/07/12/Thailand-Raiders/Tiffany.png\" alt=\"\"></p>\n<p> </p>\n<h3 id=\"9-13\"><a href=\"#9-13\" class=\"headerlink\" title=\"9.13\"></a>9.13</h3><p><br></p>\n<h3 id=\"9-14\"><a href=\"#9-14\" class=\"headerlink\" title=\"9.14\"></a>9.14</h3><p></p>\n<p>Bus Terminal<code>Ekkamai</code>11</p>\n<h3 id=\"9-14\"><a href=\"#9-14\" class=\"headerlink\" title=\"9.14\"></a>9.14</h3><p>Ratchaprarop Road Ratchaprarop Road indraCondo/177/209 soi saengkran/ratchprarop road, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand, Khet Ratchathewi, Krung Thep Maha Nakhon 10400, Thailand</p>\n<p><img src=\"/2019/07/12/Thailand-Raiders/WechatIMG38.jpeg\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/WechatIMG39.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/WechatIMG40.png\" alt=\"\"></p>\n<h4 id=\"9-15\"><a href=\"#9-15\" class=\"headerlink\" title=\"9.15\"></a>9.15</h4><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>BIG-C<br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-46-03-072_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-46-08-364_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-46-00-652_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-45-53-237_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-11-45-57-687_com.xingin.xhs.png\" alt=\"\"><br>711<br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-14-972_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-18-389_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-20-912_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-23-188_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-25-297_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-12-05-30-499_com.xingin.xhs.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-13-11-50-782_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-13-11-56-133_com.xingin.xhs.png\" alt=\"\"><br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-13-12-27-105_com.xingin.xhs.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>ONLY <br>N7</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>Wacoalcentral world /<br>Lee<br>LeVIS<br>everyandboy<br>central world <br><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-14-05-58-003_com.xingin.xhs.png\" alt=\"\"></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"/2019/07/12/Thailand-Raiders/Screenshot_2019-08-31-14-25-04-833_com.xingin.xhs.png\" alt=\"\"></p>"},{"title":"-","date":"2019-12-13T11:39:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"## \n:\n1. \n2. \n<!-- more -->\n3. \n4. () \n\n## \n+=\n(Subject)(Observer)\n\n\n## \n\n\nWeatherDataWeatherData(\n) \nWeatherObject \nWeather-O-Rama API\n![](Design-Pattern-Observer/1.png)\n\n```java\npublic interface Subject {\n    // \n    public void registerObserver(Observer o);\n    // \n    public void removeObserver(Observer o);\n    // \n    public void notifyObservers();\n}\n```\n\n```java\npublic interface Observer {\n    public void update(float temp, float humidity, float pressure);\n}\n```\n\n```java\npublic interface DisplayElement {\n    // \n    public void display();\n}\n```\n\n```java\nimport java.util.ArrayList;\n\n\npublic class WeatherData implements Subject{\n    private ArrayList observers;\n    // \n    private float temperature;\n    // \n    private float humidity;\n    // \n    private float pressure;\n\n    public WeatherData() {\n        observers = new ArrayList();\n    }\n\n    @Override\n    public void registerObserver(Observer o) {\n        observers.add(o);\n    }\n\n    @Override\n    public void removeObserver(Observer o) {\n        int i = observers.indexOf(o);\n        if (i >= 0) {\n            observers.remove(i);\n        }\n    }\n\n    @Override\n    public void notifyObservers() {\n        for (int i = 0; i < observers.size(); i++) {\n            Observer observer = (Observer)observers.get(i);\n            observer.update(temperature, humidity, pressure);\n        }\n\n    }\n    // \n    public void measurementsChanged() {\n        notifyObservers();\n    }\n\n    public void setMeasurements(float temperature, float humidity, float pressure) {\n        this.temperature = temperature;\n        this.humidity = humidity;\n        this.pressure = pressure;\n        measurementsChanged();\n    }\n\n    //\n}\n```\n\n\n```java\n\npublic class CurrentConditionsDisplay implements Observer, DisplayElement{\n    private float temperature;\n\n    private float humidity;\n\n    private Subject weatherData;\n\n    public CurrentConditionsDisplay(Subject weatherData) {\n        this.weatherData = weatherData;\n        weatherData.registerObserver(this);\n    }\n\n    @Override\n    public void display() {\n        System.out.println(\"Current conditions: \" + temperature + \"F degrees and \" + humidity + \"% humidity\");\n    }\n\n    @Override\n    public void update(float temp, float humidity, float pressure) {\n        this.temperature = temp;\n        this.humidity = humidity;\n        display();\n    }\n}\n```\n\n\n```java\npublic class WeatherStation {\n    public static void main(String[] args) {\n        WeatherData weatherData = new WeatherData();\n        CurrentConditionsDisplay currentDisplay = new CurrentConditionsDisplay(weatherData);\n//        StatisticsDisplay statisticsDisplay = new StatisticsDisplay(weatherData);\n//        ForecastDisplay forecastDisplay = new ForecastDisplay(weatherData);\n        weatherData.setMeasurements(80, 65, 30.4f);\n        weatherData.setMeasurements(82, 70, 29.2f);\n        weatherData.setMeasurements(78, 90, 29.2f);\n    }\n}\n```\n\n\n\n```bash\nCurrent conditions: 80.0F degrees and 65.0% humidity\nCurrent conditions: 82.0F degrees and 70.0% humidity\nCurrent conditions: 78.0F degrees and 90.0% humidity\n```\n\n## JAVA\nJava APIjava.util(package)ObserverObservable\n![](Design-Pattern-Observer/2.png)\n\nObserver\n```java\npackage java.util;\n\npublic interface Observer {\n\n    void update(Observable o, Object arg);\n}\n\n```\n\nObservable\n```java\n\npackage java.util;\n\npublic class Observable {\n    private boolean changed = false;// \n    private Vector<Observer> obs; // \n\n    //\n    public Observable() {\n        obs = new Vector<>();\n    }\n    \n    //\n    public synchronized void addObserver(Observer o) {\n        if (o == null)\n            throw new NullPointerException();\n        if (!obs.contains(o)) {\n            obs.addElement(o);\n        }\n    }\n\n    // \n    public synchronized void deleteObserver(Observer o) {\n        obs.removeElement(o);\n    }\n\n    // \n    public void notifyObservers() {\n        notifyObservers(null);\n    }\n\n    // changed = true \n    public void notifyObservers(Object arg) {\n        Object[] arrLocal;\n\n        synchronized (this) {\n            if (!changed)\n                return;\n            arrLocal = obs.toArray();\n            clearChanged();\n        }\n\n        for (int i = arrLocal.length-1; i>=0; i--)\n            ((Observer)arrLocal[i]).update(this, arg);\n    }\n\n    // \n    public synchronized void deleteObservers() {\n        obs.removeAllElements();\n    }\n\n    // changed\n    protected synchronized void setChanged() {\n        changed = true;\n    }\n\n    // changed\n    protected synchronized void clearChanged() {\n        changed = false;\n    }\n\n    // changed\n    public synchronized boolean hasChanged() {\n        return changed;\n    }\n\n    // \n    public synchronized int countObservers() {\n        return obs.size();\n    }\n}\n\n```\n\n```java\nimport java.util.Observable;\n\npublic class WeatherData extends Observable {\n    // \n    private float temperature;\n    // \n    private float humidity;\n    // \n    private float pressure;\n\n    public WeatherData() {\n    }\n\n    // \n    public void measurementsChanged() {\n        setChanged();\n        notifyObservers();\n    }\n\n    public void setMeasurements(float temperature, float humidity, float pressure) {\n        this.temperature = temperature;\n        this.humidity = humidity;\n        this.pressure = pressure;\n        measurementsChanged();\n    }\n\n    //\n    public float getTemperature() {\n        return temperature;\n    }\n\n    public float getHumidity() {\n        return humidity;\n    }\n\n    public float getPressure() {\n        return pressure;\n    }\n\n    //\n}\n```\n\n```java\nimport java.util.Observable;\nimport java.util.Observer;\n\npublic class CurrentConditionsDisplay implements Observer, DisplayElement{\n    private float temperature;\n\n    private float humidity;\n\n    Observable observable;\n\n    public CurrentConditionsDisplay(Observable observable) {\n        this.observable = observable;\n        observable.addObserver(this);\n    }\n\n    @Override\n    public void display() {\n        System.out.println(\"Current conditions: \" + temperature + \"F degrees and \" + humidity + \"% humidity\");\n    }\n\n\n    @Override\n    public void update(Observable o, Object arg) {\n        if (o instanceof WeatherData) {\n            WeatherData weatherData = (WeatherData)o;\n            this.temperature = weatherData.getTemperature();\n            this.humidity = weatherData.getHumidity();\n            display();\n        }\n    }\n}\n```\n\n\n\n### java.util.Observable\njava.util.Observable \n*  \n    *  ObservableJava\n* Observable\n    * setChanged()( protected):ObservableObservable :\n\n## \n* \n* ()\n* (loosecoupl- ing)\n* (push)(pull)()\n* \n* Javajava.util.Observable\n* java.util.Observable\n* Observable\n* SwingGUI\n* :JavaBeansRMI\n\n\n","source":"_posts/Design-Pattern-Observer.md","raw":"---\ntitle: -\ndate: 2019-12-13 19:39:04\ntags:\n    - \ncategories: \nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n## \n:\n1. \n2. \n<!-- more -->\n3. \n4. () \n\n## \n+=\n(Subject)(Observer)\n\n\n## \n\n\nWeatherDataWeatherData(\n) \nWeatherObject \nWeather-O-Rama API\n![](Design-Pattern-Observer/1.png)\n\n```java\npublic interface Subject {\n    // \n    public void registerObserver(Observer o);\n    // \n    public void removeObserver(Observer o);\n    // \n    public void notifyObservers();\n}\n```\n\n```java\npublic interface Observer {\n    public void update(float temp, float humidity, float pressure);\n}\n```\n\n```java\npublic interface DisplayElement {\n    // \n    public void display();\n}\n```\n\n```java\nimport java.util.ArrayList;\n\n\npublic class WeatherData implements Subject{\n    private ArrayList observers;\n    // \n    private float temperature;\n    // \n    private float humidity;\n    // \n    private float pressure;\n\n    public WeatherData() {\n        observers = new ArrayList();\n    }\n\n    @Override\n    public void registerObserver(Observer o) {\n        observers.add(o);\n    }\n\n    @Override\n    public void removeObserver(Observer o) {\n        int i = observers.indexOf(o);\n        if (i >= 0) {\n            observers.remove(i);\n        }\n    }\n\n    @Override\n    public void notifyObservers() {\n        for (int i = 0; i < observers.size(); i++) {\n            Observer observer = (Observer)observers.get(i);\n            observer.update(temperature, humidity, pressure);\n        }\n\n    }\n    // \n    public void measurementsChanged() {\n        notifyObservers();\n    }\n\n    public void setMeasurements(float temperature, float humidity, float pressure) {\n        this.temperature = temperature;\n        this.humidity = humidity;\n        this.pressure = pressure;\n        measurementsChanged();\n    }\n\n    //\n}\n```\n\n\n```java\n\npublic class CurrentConditionsDisplay implements Observer, DisplayElement{\n    private float temperature;\n\n    private float humidity;\n\n    private Subject weatherData;\n\n    public CurrentConditionsDisplay(Subject weatherData) {\n        this.weatherData = weatherData;\n        weatherData.registerObserver(this);\n    }\n\n    @Override\n    public void display() {\n        System.out.println(\"Current conditions: \" + temperature + \"F degrees and \" + humidity + \"% humidity\");\n    }\n\n    @Override\n    public void update(float temp, float humidity, float pressure) {\n        this.temperature = temp;\n        this.humidity = humidity;\n        display();\n    }\n}\n```\n\n\n```java\npublic class WeatherStation {\n    public static void main(String[] args) {\n        WeatherData weatherData = new WeatherData();\n        CurrentConditionsDisplay currentDisplay = new CurrentConditionsDisplay(weatherData);\n//        StatisticsDisplay statisticsDisplay = new StatisticsDisplay(weatherData);\n//        ForecastDisplay forecastDisplay = new ForecastDisplay(weatherData);\n        weatherData.setMeasurements(80, 65, 30.4f);\n        weatherData.setMeasurements(82, 70, 29.2f);\n        weatherData.setMeasurements(78, 90, 29.2f);\n    }\n}\n```\n\n\n\n```bash\nCurrent conditions: 80.0F degrees and 65.0% humidity\nCurrent conditions: 82.0F degrees and 70.0% humidity\nCurrent conditions: 78.0F degrees and 90.0% humidity\n```\n\n## JAVA\nJava APIjava.util(package)ObserverObservable\n![](Design-Pattern-Observer/2.png)\n\nObserver\n```java\npackage java.util;\n\npublic interface Observer {\n\n    void update(Observable o, Object arg);\n}\n\n```\n\nObservable\n```java\n\npackage java.util;\n\npublic class Observable {\n    private boolean changed = false;// \n    private Vector<Observer> obs; // \n\n    //\n    public Observable() {\n        obs = new Vector<>();\n    }\n    \n    //\n    public synchronized void addObserver(Observer o) {\n        if (o == null)\n            throw new NullPointerException();\n        if (!obs.contains(o)) {\n            obs.addElement(o);\n        }\n    }\n\n    // \n    public synchronized void deleteObserver(Observer o) {\n        obs.removeElement(o);\n    }\n\n    // \n    public void notifyObservers() {\n        notifyObservers(null);\n    }\n\n    // changed = true \n    public void notifyObservers(Object arg) {\n        Object[] arrLocal;\n\n        synchronized (this) {\n            if (!changed)\n                return;\n            arrLocal = obs.toArray();\n            clearChanged();\n        }\n\n        for (int i = arrLocal.length-1; i>=0; i--)\n            ((Observer)arrLocal[i]).update(this, arg);\n    }\n\n    // \n    public synchronized void deleteObservers() {\n        obs.removeAllElements();\n    }\n\n    // changed\n    protected synchronized void setChanged() {\n        changed = true;\n    }\n\n    // changed\n    protected synchronized void clearChanged() {\n        changed = false;\n    }\n\n    // changed\n    public synchronized boolean hasChanged() {\n        return changed;\n    }\n\n    // \n    public synchronized int countObservers() {\n        return obs.size();\n    }\n}\n\n```\n\n```java\nimport java.util.Observable;\n\npublic class WeatherData extends Observable {\n    // \n    private float temperature;\n    // \n    private float humidity;\n    // \n    private float pressure;\n\n    public WeatherData() {\n    }\n\n    // \n    public void measurementsChanged() {\n        setChanged();\n        notifyObservers();\n    }\n\n    public void setMeasurements(float temperature, float humidity, float pressure) {\n        this.temperature = temperature;\n        this.humidity = humidity;\n        this.pressure = pressure;\n        measurementsChanged();\n    }\n\n    //\n    public float getTemperature() {\n        return temperature;\n    }\n\n    public float getHumidity() {\n        return humidity;\n    }\n\n    public float getPressure() {\n        return pressure;\n    }\n\n    //\n}\n```\n\n```java\nimport java.util.Observable;\nimport java.util.Observer;\n\npublic class CurrentConditionsDisplay implements Observer, DisplayElement{\n    private float temperature;\n\n    private float humidity;\n\n    Observable observable;\n\n    public CurrentConditionsDisplay(Observable observable) {\n        this.observable = observable;\n        observable.addObserver(this);\n    }\n\n    @Override\n    public void display() {\n        System.out.println(\"Current conditions: \" + temperature + \"F degrees and \" + humidity + \"% humidity\");\n    }\n\n\n    @Override\n    public void update(Observable o, Object arg) {\n        if (o instanceof WeatherData) {\n            WeatherData weatherData = (WeatherData)o;\n            this.temperature = weatherData.getTemperature();\n            this.humidity = weatherData.getHumidity();\n            display();\n        }\n    }\n}\n```\n\n\n\n### java.util.Observable\njava.util.Observable \n*  \n    *  ObservableJava\n* Observable\n    * setChanged()( protected):ObservableObservable :\n\n## \n* \n* ()\n* (loosecoupl- ing)\n* (push)(pull)()\n* \n* Javajava.util.Observable\n* java.util.Observable\n* Observable\n* SwingGUI\n* :JavaBeansRMI\n\n\n","slug":"Design-Pattern-Observer","published":1,"updated":"2019-12-13T11:12:58.271Z","layout":"post","photos":[],"link":"","_id":"ck4859y92003kt0fym8za61n9","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<ol>\n<li></li>\n<li><a id=\"more\"></a></li>\n<li></li>\n<li>() </li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>+=<br>(Subject)(Observer)<br></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br>WeatherDataWeatherData(<br>)<br>WeatherObject <br>Weather-O-Rama API<br><img src=\"/2019/12/13/Design-Pattern-Observer/1.png\" alt=\"\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Subject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">registerObserver</span><span class=\"params\">(Observer o)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">removeObserver</span><span class=\"params\">(Observer o)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Observer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">float</span> temp, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">DisplayElement</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WeatherData</span> <span class=\"keyword\">implements</span> <span class=\"title\">Subject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList observers;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> pressure;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">WeatherData</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        observers = <span class=\"keyword\">new</span> ArrayList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">registerObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        observers.add(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">removeObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i = observers.indexOf(o);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            observers.remove(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; observers.size(); i++) &#123;</span><br><span class=\"line\">            Observer observer = (Observer)observers.get(i);</span><br><span class=\"line\">            observer.update(temperature, humidity, pressure);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measurementsChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMeasurements</span><span class=\"params\">(<span class=\"keyword\">float</span> temperature, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.temperature = temperature;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.humidity = humidity;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pressure = pressure;</span><br><span class=\"line\">        measurementsChanged();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CurrentConditionsDisplay</span> <span class=\"keyword\">implements</span> <span class=\"title\">Observer</span>, <span class=\"title\">DisplayElement</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Subject weatherData;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Subject weatherData)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.weatherData = weatherData;</span><br><span class=\"line\">        weatherData.registerObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Current conditions: \"</span> + temperature + <span class=\"string\">\"F degrees and \"</span> + humidity + <span class=\"string\">\"% humidity\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">float</span> temp, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.temperature = temp;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.humidity = humidity;</span><br><span class=\"line\">        display();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WeatherStation</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        WeatherData weatherData = <span class=\"keyword\">new</span> WeatherData();</span><br><span class=\"line\">        CurrentConditionsDisplay currentDisplay = <span class=\"keyword\">new</span> CurrentConditionsDisplay(weatherData);</span><br><span class=\"line\"><span class=\"comment\">//        StatisticsDisplay statisticsDisplay = new StatisticsDisplay(weatherData);</span></span><br><span class=\"line\"><span class=\"comment\">//        ForecastDisplay forecastDisplay = new ForecastDisplay(weatherData);</span></span><br><span class=\"line\">        weatherData.setMeasurements(<span class=\"number\">80</span>, <span class=\"number\">65</span>, <span class=\"number\">30.4f</span>);</span><br><span class=\"line\">        weatherData.setMeasurements(<span class=\"number\">82</span>, <span class=\"number\">70</span>, <span class=\"number\">29.2f</span>);</span><br><span class=\"line\">        weatherData.setMeasurements(<span class=\"number\">78</span>, <span class=\"number\">90</span>, <span class=\"number\">29.2f</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Current conditions: 80.0F degrees and 65.0% humidity</span><br><span class=\"line\">Current conditions: 82.0F degrees and 70.0% humidity</span><br><span class=\"line\">Current conditions: 78.0F degrees and 90.0% humidity</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h2><p>Java APIjava.util(package)ObserverObservable<br><img src=\"/2019/12/13/Design-Pattern-Observer/2.png\" alt=\"\"></p>\n<p>Observer</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> java.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Observer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(Observable o, Object arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Observable</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> java.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Observable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> changed = <span class=\"keyword\">false</span>;<span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Vector&lt;Observer&gt; obs; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Observable</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        obs = <span class=\"keyword\">new</span> Vector&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">addObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (o == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!obs.contains(o)) &#123;</span><br><span class=\"line\">            obs.addElement(o);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        obs.removeElement(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        notifyObservers(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed = true </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">(Object arg)</span> </span>&#123;</span><br><span class=\"line\">        Object[] arrLocal;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!changed)</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            arrLocal = obs.toArray();</span><br><span class=\"line\">            clearChanged();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = arrLocal.length-<span class=\"number\">1</span>; i&gt;=<span class=\"number\">0</span>; i--)</span><br><span class=\"line\">            ((Observer)arrLocal[i]).update(<span class=\"keyword\">this</span>, arg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        obs.removeAllElements();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">setChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        changed = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">clearChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        changed = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">boolean</span> <span class=\"title\">hasChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> changed;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">int</span> <span class=\"title\">countObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> obs.size();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WeatherData</span> <span class=\"keyword\">extends</span> <span class=\"title\">Observable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> pressure;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">WeatherData</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measurementsChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        setChanged();</span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMeasurements</span><span class=\"params\">(<span class=\"keyword\">float</span> temperature, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.temperature = temperature;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.humidity = humidity;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pressure = pressure;</span><br><span class=\"line\">        measurementsChanged();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">float</span> <span class=\"title\">getTemperature</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> temperature;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">float</span> <span class=\"title\">getHumidity</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> humidity;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">float</span> <span class=\"title\">getPressure</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> pressure;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CurrentConditionsDisplay</span> <span class=\"keyword\">implements</span> <span class=\"title\">Observer</span>, <span class=\"title\">DisplayElement</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\"></span><br><span class=\"line\">    Observable observable;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Observable observable)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.observable = observable;</span><br><span class=\"line\">        observable.addObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Current conditions: \"</span> + temperature + <span class=\"string\">\"F degrees and \"</span> + humidity + <span class=\"string\">\"% humidity\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(Observable o, Object arg)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (o <span class=\"keyword\">instanceof</span> WeatherData) &#123;</span><br><span class=\"line\">            WeatherData weatherData = (WeatherData)o;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.temperature = weatherData.getTemperature();</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.humidity = weatherData.getHumidity();</span><br><span class=\"line\">            display();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"java-util-Observable\"><a href=\"#java-util-Observable\" class=\"headerlink\" title=\"java.util.Observable\"></a>java.util.Observable</h3><p>java.util.Observable </p>\n<ul>\n<li> <ul>\n<li> ObservableJava</li>\n</ul>\n</li>\n<li>Observable<ul>\n<li>setChanged()( protected):ObservableObservable :</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>()</li>\n<li>(loosecoupl- ing)</li>\n<li>(push)(pull)()</li>\n<li></li>\n<li>Javajava.util.Observable</li>\n<li>java.util.Observable</li>\n<li>Observable</li>\n<li>SwingGUI</li>\n<li>:JavaBeansRMI</li>\n</ul>\n","site":{"data":{}},"excerpt":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<ol>\n<li></li>\n<li></li></ol>","more":"\n<li></li>\n<li>() </li>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>+=<br>(Subject)(Observer)<br></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br>WeatherDataWeatherData(<br>)<br>WeatherObject <br>Weather-O-Rama API<br><img src=\"/2019/12/13/Design-Pattern-Observer/1.png\" alt=\"\"></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Subject</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">registerObserver</span><span class=\"params\">(Observer o)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">removeObserver</span><span class=\"params\">(Observer o)</span></span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Observer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">float</span> temp, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">DisplayElement</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WeatherData</span> <span class=\"keyword\">implements</span> <span class=\"title\">Subject</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> ArrayList observers;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> pressure;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">WeatherData</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        observers = <span class=\"keyword\">new</span> ArrayList();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">registerObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        observers.add(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">removeObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> i = observers.indexOf(o);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (i &gt;= <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            observers.remove(i);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; observers.size(); i++) &#123;</span><br><span class=\"line\">            Observer observer = (Observer)observers.get(i);</span><br><span class=\"line\">            observer.update(temperature, humidity, pressure);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measurementsChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMeasurements</span><span class=\"params\">(<span class=\"keyword\">float</span> temperature, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.temperature = temperature;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.humidity = humidity;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pressure = pressure;</span><br><span class=\"line\">        measurementsChanged();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CurrentConditionsDisplay</span> <span class=\"keyword\">implements</span> <span class=\"title\">Observer</span>, <span class=\"title\">DisplayElement</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Subject weatherData;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Subject weatherData)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.weatherData = weatherData;</span><br><span class=\"line\">        weatherData.registerObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Current conditions: \"</span> + temperature + <span class=\"string\">\"F degrees and \"</span> + humidity + <span class=\"string\">\"% humidity\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">float</span> temp, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.temperature = temp;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.humidity = humidity;</span><br><span class=\"line\">        display();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WeatherStation</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        WeatherData weatherData = <span class=\"keyword\">new</span> WeatherData();</span><br><span class=\"line\">        CurrentConditionsDisplay currentDisplay = <span class=\"keyword\">new</span> CurrentConditionsDisplay(weatherData);</span><br><span class=\"line\"><span class=\"comment\">//        StatisticsDisplay statisticsDisplay = new StatisticsDisplay(weatherData);</span></span><br><span class=\"line\"><span class=\"comment\">//        ForecastDisplay forecastDisplay = new ForecastDisplay(weatherData);</span></span><br><span class=\"line\">        weatherData.setMeasurements(<span class=\"number\">80</span>, <span class=\"number\">65</span>, <span class=\"number\">30.4f</span>);</span><br><span class=\"line\">        weatherData.setMeasurements(<span class=\"number\">82</span>, <span class=\"number\">70</span>, <span class=\"number\">29.2f</span>);</span><br><span class=\"line\">        weatherData.setMeasurements(<span class=\"number\">78</span>, <span class=\"number\">90</span>, <span class=\"number\">29.2f</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Current conditions: 80.0F degrees and 65.0% humidity</span><br><span class=\"line\">Current conditions: 82.0F degrees and 70.0% humidity</span><br><span class=\"line\">Current conditions: 78.0F degrees and 90.0% humidity</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"JAVA\"><a href=\"#JAVA\" class=\"headerlink\" title=\"JAVA\"></a>JAVA</h2><p>Java APIjava.util(package)ObserverObservable<br><img src=\"/2019/12/13/Design-Pattern-Observer/2.png\" alt=\"\"></p>\n<p>Observer</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> java.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">Observer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(Observable o, Object arg)</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>Observable</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> java.util;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Observable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> changed = <span class=\"keyword\">false</span>;<span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Vector&lt;Observer&gt; obs; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Observable</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        obs = <span class=\"keyword\">new</span> Vector&lt;&gt;();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">addObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (o == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!obs.contains(o)) &#123;</span><br><span class=\"line\">            obs.addElement(o);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteObserver</span><span class=\"params\">(Observer o)</span> </span>&#123;</span><br><span class=\"line\">        obs.removeElement(o);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        notifyObservers(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed = true </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">notifyObservers</span><span class=\"params\">(Object arg)</span> </span>&#123;</span><br><span class=\"line\">        Object[] arrLocal;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">synchronized</span> (<span class=\"keyword\">this</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (!changed)</span><br><span class=\"line\">                <span class=\"keyword\">return</span>;</span><br><span class=\"line\">            arrLocal = obs.toArray();</span><br><span class=\"line\">            clearChanged();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = arrLocal.length-<span class=\"number\">1</span>; i&gt;=<span class=\"number\">0</span>; i--)</span><br><span class=\"line\">            ((Observer)arrLocal[i]).update(<span class=\"keyword\">this</span>, arg);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">deleteObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        obs.removeAllElements();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">setChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        changed = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">clearChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        changed = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// changed</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">boolean</span> <span class=\"title\">hasChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> changed;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">int</span> <span class=\"title\">countObservers</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> obs.size();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WeatherData</span> <span class=\"keyword\">extends</span> <span class=\"title\">Observable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> pressure;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">WeatherData</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">measurementsChanged</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        setChanged();</span><br><span class=\"line\">        notifyObservers();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">setMeasurements</span><span class=\"params\">(<span class=\"keyword\">float</span> temperature, <span class=\"keyword\">float</span> humidity, <span class=\"keyword\">float</span> pressure)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.temperature = temperature;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.humidity = humidity;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.pressure = pressure;</span><br><span class=\"line\">        measurementsChanged();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">float</span> <span class=\"title\">getTemperature</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> temperature;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">float</span> <span class=\"title\">getHumidity</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> humidity;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">float</span> <span class=\"title\">getPressure</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> pressure;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observable;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Observer;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">CurrentConditionsDisplay</span> <span class=\"keyword\">implements</span> <span class=\"title\">Observer</span>, <span class=\"title\">DisplayElement</span></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> temperature;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">float</span> humidity;</span><br><span class=\"line\"></span><br><span class=\"line\">    Observable observable;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">CurrentConditionsDisplay</span><span class=\"params\">(Observable observable)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.observable = observable;</span><br><span class=\"line\">        observable.addObserver(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">display</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Current conditions: \"</span> + temperature + <span class=\"string\">\"F degrees and \"</span> + humidity + <span class=\"string\">\"% humidity\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(Observable o, Object arg)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (o <span class=\"keyword\">instanceof</span> WeatherData) &#123;</span><br><span class=\"line\">            WeatherData weatherData = (WeatherData)o;</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.temperature = weatherData.getTemperature();</span><br><span class=\"line\">            <span class=\"keyword\">this</span>.humidity = weatherData.getHumidity();</span><br><span class=\"line\">            display();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h3 id=\"java-util-Observable\"><a href=\"#java-util-Observable\" class=\"headerlink\" title=\"java.util.Observable\"></a>java.util.Observable</h3><p>java.util.Observable </p>\n<ul>\n<li> <ul>\n<li> ObservableJava</li>\n</ul>\n</li>\n<li>Observable<ul>\n<li>setChanged()( protected):ObservableObservable :</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li></li>\n<li>()</li>\n<li>(loosecoupl- ing)</li>\n<li>(push)(pull)()</li>\n<li></li>\n<li>Javajava.util.Observable</li>\n<li>java.util.Observable</li>\n<li>Observable</li>\n<li>SwingGUI</li>\n<li>:JavaBeansRMI</li>\n</ul>"},{"title":"MacGithub Pages","date":"2019-01-30T11:30:04.000Z","author":"Guyuqing","copyright":true,"comments":1,"_content":"Hexo + Next + GitHubPages \n\n## \n\n### node.js\n\n``` bash\n$ brew install node\n```\n\n###  git\n\n``` bash\n$ brew install git\n```\n<!-- more -->\n\n### yarn\n\n``` bash\n$ npm install yarn\n```\n\n\n\n``` bash\n$ brew install yarn\n```\n\n### hexo\n\nblog\n\n``` bash\n$ cd blog\n```\n\n yarn  hexo\n\n``` bash\n$ yarn add hexo -S\n```\n\n\n\n``` bash\n$ npm install hexo-cli -g\n$ npm install hexo-server --save\n```\n[](https://hexo.io/zh-cn/docs/)\n\n## \n\n### \n\n,hexo\n\n``` bash\n$ cd blog\n$ hexo init\n```\n### \n\n``` bash\n$ yarn install\n```\n### \n\n``` bash\n$ hexo server\n```\n `localhost:4000` \n\n##  GitHub\n### \n\n![](Github-Pages-Blog/create-project.png)\n\n `[].github.io`\n![](Github-Pages-Blog/create-repository.png)\n\n### \n\n![](Github-Pages-Blog/setting.png)\n\nGitHub Pages masterchoose a theme\n\n![github-pages](Github-Pages-Blog/github-pages.png)\n\nselect theme\n![](Github-Pages-Blog/select-theme.png)\n\n  `https://[].github.io/`,\n\n![](Github-Pages-Blog/copy-url.png)\n\n `_config.yml` \n\n![hexogit](Github-Pages-Blog/deploy-position.png)\n\n### \n[](https://hexo.io/zh-cn/docs/configuration)\n\n### \n\n hexo-deployer-git \n``` bash\n$ yarn add hexo-deployer-git -S\n```\n\n``` bash\n$ npm install--save hexo-deployer-git\n```\n hexo d -g  GitHub  git push ,sudo\n``` bash\n$  hexo d -g\n```\ngithub`https://[].github.io/`\n\n## NexT\nNexT Hexo \n[](https://github.com/iissnan/hexo-theme-next/blob/master/README.cn.md)\n\n### NexT\nNexT\n``` bash\n$ git clone https://github.com/iissnan/hexo-theme-next.git themes/next\n```\n`_config.yml` \n![](Github-Pages-Blog/change-theme.png)\n\ngithub\n``` bash\n$  hexo d -g\n```\ngithub`https://[].github.io/`\n\n### \n\n`themes/next``_config.yml`\nnext4\n```yaml\n# ---------------------------------------------------------------\n# Scheme Settings\n# ---------------------------------------------------------------\n\n# Schemes\n#scheme: Muse\nscheme: Mist\n#scheme: Pisces\n#scheme: Gemini\n```\nMenu Settings\n```yaml\n# ---------------------------------------------------------------\n# Menu Settings\n# ---------------------------------------------------------------\nmenu:\n  home: / || home\n#  about: /about/ || user\n  tags: /tags/ || tags\n  categories: /categories/ || th\n#  archives: /archives/ || archive\n#  schedule: /schedule/ || calendar\n#  sitemap: /sitemap.xml || sitemap\n#  commonweal: /404.html || heartbeat\n```\n![](Github-Pages-Blog/blog-icon.png)\n[](http://theme-next.iissnan.com/getting-started.html#install-next-theme),[](http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html),[](http://yearito.cn/posts/hexo-theme-beautify.html)\n\n\n``` bash\n$  hexo clean\n$  hexo d -g\n```\n `localhost:4000` \n``` bash\n$ hexo server\n```\n## \n\n### \n\n\n``` bash\n$ hexo new page tags\n```\n source/tags  index.md \n``` markdown\ntitle: tags\ntype: \"tags\"\ncomments: false\n---\n```\n`themes/next``_config.yml`  `tags: /tags/ || tags` \n\n``` bash\n$ hexo new 'test'\n```\ntags\n``` markdown\ntitle: \ntags:\n  - Testing\n  - Another Tag\n---\n```\n  \n![](Github-Pages-Blog/tags.png)\n\n### \n\n``` bash\n$ hexo new page categories\n```\n source/tags  index.md \n``` markdown\ntitle: categories\ntype: \"categories\"\ncomments: false\n---\n```\n`themes/next``_config.yml`  `categories: /categories/ || th` \ncategories\n``` markdown\ntitle: \ntags:\n  - Testing\n  - Another Tag\n---\ncategories: Testing\n```\n  \n![](Github-Pages-Blog/categories.png)\n\n### \n\n\n``` bash\n$ npm install hexo-asset-image --save\n```\n\nmd_post\n``` bash\n$ hexo new ''\n```\nmarkdown\n``` markdown\n ![](xxxx/.jpg)\n```\nxxxx\n\n### Valine\n\n[Leancloud](https://leancloud.cn/),\n`appid``appkey`\n![](Github-Pages-Blog/valine.png)\n\n`themes/next``_config.yml`\n``` yaml\n # Valine.\n # You can get your appid and appkey from https://leancloud.cn\n # more info please open https://valine.js.org\n valine:\n   enable: true\n   appid: your appid  # your leancloud application appid\n   appkey: your appkey # your leancloud application appkey\n   notify: false # mail notifier , https://github.com/xCss/Valine/wiki\n   verify: false # Verification code\n   placeholder:   # comment box placeholder\n   avatar: monsterid # gravatar style\n   guest_info: nick,mail # custom comment header\n   pageSize: 10 # pagination size\n```\n[Leancloud](https://leancloud.cn/)\n![](Github-Pages-Blog/comment-delete.png)\n\n### hexo\n\n\n``` bash\n$ npm install hexo-generator-author --save\n```\n\nauthor\n``` markdown\ntitle: \ntags:\n  - Testing\n  - Another Tag\n---\nauthor: Alice\n```\n\n/layout/_macro/post.swig +\n```swig\n         <div class=\"post-meta\">\n+          <span itemprop=\"about\" itemscope itemtype=\"https://schema.org/Thing\">\n+            <a href=\"/authors/{{ post.author }}\" itemprop=\"url\" rel=\"index\">\n+              <span itemprop=\"name\">{{ post.author }}</span>\n+            </a>\n+          </span>\n           <span class=\"post-time\">\n             <span class=\"post-meta-item-icon\">\n               <i class=\"fa fa-calendar-o\"></i>\n\n```\n/layoutauthor.swig\n```swig\n\n{% extends '_layout.swig' %}\n{% import '_macro/post-collapse.swig' as post_template %}\n{% import '_macro/sidebar.swig' as sidebar_template %}\n\n{% block title %} {{ __('title.author') }}: {{ page.author }} | {{ config.title }} {% endblock %}\n\n{% block content %}\n\n  <div class=\"post-block category\">\n\n    <div id=\"posts\" class=\"posts-collapse\">\n      <div class=\"collection-title\">\n\n        <{% if theme.seo %}h2{% else %}h1{% endif %}>{#\n        #}{{ page.author }}{#\n        #}<small>{{  __('title.author')  }}</small>\n        </{% if theme.seo %}h2{% else %}h1{% endif %}>\n      </div>\n\n      {% for post in page.posts %}\n        {{ post_template.render(post) }}\n      {% endfor %}\n    </div>\n\n  </div>\n\n  {% include '_partials/pagination.swig' %}\n\n{% endblock %}\n\n{% block sidebar %}\n  {{ sidebar_template.render(false) }}\n{% endblock %}\n\n```\n\n/layoutpage.swig\n```swig\n\n     {{ __('title.category') + page_title_suffix }}\n   {% elif page.type === \"tags\" %}\n     {{ __('title.tag') + page_title_suffix }}\n+  {% elif page.type === \"authors\" %}\n+    {{ __('title.author') + page_title_suffix }}\n   {% else %}\n     {{ page.title + page_title_suffix }}\n   {% endif %}\n\n\n           {{ list_categories() }}\n         </div>\n       </div>\n+    {% elif page.type === 'authors' %}\n+      <div class=\"author-all-page\">\n+        <div class=\"author-all-title\">\n+            {{ _p('counter.authors', site.authors.length) }}\n+        </div>\n+        <div class=\"author-all\">\n+          {{ list_authors() }}\n+        </div>\n+      </div>\n     {% else %}\n       {{ page.content }}\n     {% endif %}\n```\n{}/themes/nextzh-Hans.yml\n```yml\ntitle:\n  archive: \n  category: \n  tag: \n  schedule: \n  author : \n  \n\n\ncounter:\n\n  authors:\n    zero: \n    one:  1 \n    other: \" %d \"\n\n```\n\n{}/themes/next/source/css/_common/components/pages/authors.stylcategories.stylcategorieauthor\n\npages.styl@import \"authors\";\n\n\n``` bash\n$  hexo clean\n$  hexo d -g\n```\n\n###\n```bash\n$ npm install gulp -g\n$ npm install gulp-minify-css gulp-uglify gulp-htmlmin gulp-htmlclean gulp --save\n```\n`gulpfile.js`\n```js\nvar gulp = require('gulp');\nvar minifycss = require('gulp-minify-css');\nvar uglify = require('gulp-uglify');\nvar htmlmin = require('gulp-htmlmin');\nvar htmlclean = require('gulp-htmlclean');\n//  public  css\ngulp.task('minify-css', function() {\n    return gulp.src('./public/**/*.css')\n        .pipe(minifycss())\n        .pipe(gulp.dest('./public'));\n});\n//  public  html\ngulp.task('minify-html', function() {\n  return gulp.src('./public/**/*.html')\n    .pipe(htmlclean())\n    .pipe(htmlmin({\n         removeComments: true,\n         minifyJS: true,\n         minifyCSS: true,\n         minifyURLs: true,\n    }))\n    .pipe(gulp.dest('./public'))\n});\n//  public/js  js\ngulp.task('minify-js', function() {\n    return gulp.src('./public/**/*.js')\n        .pipe(uglify())\n        .pipe(gulp.dest('./public'));\n});\n//  gulp \ngulp.task('default', [\n    'minify-html','minify-css','minify-js'\n]);\n```\n\n hexo g && gulp  gulpfile.js  public ","source":"_posts/Github-Pages-Blog.md","raw":"---\ntitle: MacGithub Pages\ndate: 2019-01-30 19:30:04\ntags:\n    - github\n    - hexo\n    - \n    - blog\ncategories: blog\nauthor: Guyuqing\ncopyright: true\ncomments: true\n---\nHexo + Next + GitHubPages \n\n## \n\n### node.js\n\n``` bash\n$ brew install node\n```\n\n###  git\n\n``` bash\n$ brew install git\n```\n<!-- more -->\n\n### yarn\n\n``` bash\n$ npm install yarn\n```\n\n\n\n``` bash\n$ brew install yarn\n```\n\n### hexo\n\nblog\n\n``` bash\n$ cd blog\n```\n\n yarn  hexo\n\n``` bash\n$ yarn add hexo -S\n```\n\n\n\n``` bash\n$ npm install hexo-cli -g\n$ npm install hexo-server --save\n```\n[](https://hexo.io/zh-cn/docs/)\n\n## \n\n### \n\n,hexo\n\n``` bash\n$ cd blog\n$ hexo init\n```\n### \n\n``` bash\n$ yarn install\n```\n### \n\n``` bash\n$ hexo server\n```\n `localhost:4000` \n\n##  GitHub\n### \n\n![](Github-Pages-Blog/create-project.png)\n\n `[].github.io`\n![](Github-Pages-Blog/create-repository.png)\n\n### \n\n![](Github-Pages-Blog/setting.png)\n\nGitHub Pages masterchoose a theme\n\n![github-pages](Github-Pages-Blog/github-pages.png)\n\nselect theme\n![](Github-Pages-Blog/select-theme.png)\n\n  `https://[].github.io/`,\n\n![](Github-Pages-Blog/copy-url.png)\n\n `_config.yml` \n\n![hexogit](Github-Pages-Blog/deploy-position.png)\n\n### \n[](https://hexo.io/zh-cn/docs/configuration)\n\n### \n\n hexo-deployer-git \n``` bash\n$ yarn add hexo-deployer-git -S\n```\n\n``` bash\n$ npm install--save hexo-deployer-git\n```\n hexo d -g  GitHub  git push ,sudo\n``` bash\n$  hexo d -g\n```\ngithub`https://[].github.io/`\n\n## NexT\nNexT Hexo \n[](https://github.com/iissnan/hexo-theme-next/blob/master/README.cn.md)\n\n### NexT\nNexT\n``` bash\n$ git clone https://github.com/iissnan/hexo-theme-next.git themes/next\n```\n`_config.yml` \n![](Github-Pages-Blog/change-theme.png)\n\ngithub\n``` bash\n$  hexo d -g\n```\ngithub`https://[].github.io/`\n\n### \n\n`themes/next``_config.yml`\nnext4\n```yaml\n# ---------------------------------------------------------------\n# Scheme Settings\n# ---------------------------------------------------------------\n\n# Schemes\n#scheme: Muse\nscheme: Mist\n#scheme: Pisces\n#scheme: Gemini\n```\nMenu Settings\n```yaml\n# ---------------------------------------------------------------\n# Menu Settings\n# ---------------------------------------------------------------\nmenu:\n  home: / || home\n#  about: /about/ || user\n  tags: /tags/ || tags\n  categories: /categories/ || th\n#  archives: /archives/ || archive\n#  schedule: /schedule/ || calendar\n#  sitemap: /sitemap.xml || sitemap\n#  commonweal: /404.html || heartbeat\n```\n![](Github-Pages-Blog/blog-icon.png)\n[](http://theme-next.iissnan.com/getting-started.html#install-next-theme),[](http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html),[](http://yearito.cn/posts/hexo-theme-beautify.html)\n\n\n``` bash\n$  hexo clean\n$  hexo d -g\n```\n `localhost:4000` \n``` bash\n$ hexo server\n```\n## \n\n### \n\n\n``` bash\n$ hexo new page tags\n```\n source/tags  index.md \n``` markdown\ntitle: tags\ntype: \"tags\"\ncomments: false\n---\n```\n`themes/next``_config.yml`  `tags: /tags/ || tags` \n\n``` bash\n$ hexo new 'test'\n```\ntags\n``` markdown\ntitle: \ntags:\n  - Testing\n  - Another Tag\n---\n```\n  \n![](Github-Pages-Blog/tags.png)\n\n### \n\n``` bash\n$ hexo new page categories\n```\n source/tags  index.md \n``` markdown\ntitle: categories\ntype: \"categories\"\ncomments: false\n---\n```\n`themes/next``_config.yml`  `categories: /categories/ || th` \ncategories\n``` markdown\ntitle: \ntags:\n  - Testing\n  - Another Tag\n---\ncategories: Testing\n```\n  \n![](Github-Pages-Blog/categories.png)\n\n### \n\n\n``` bash\n$ npm install hexo-asset-image --save\n```\n\nmd_post\n``` bash\n$ hexo new ''\n```\nmarkdown\n``` markdown\n ![](xxxx/.jpg)\n```\nxxxx\n\n### Valine\n\n[Leancloud](https://leancloud.cn/),\n`appid``appkey`\n![](Github-Pages-Blog/valine.png)\n\n`themes/next``_config.yml`\n``` yaml\n # Valine.\n # You can get your appid and appkey from https://leancloud.cn\n # more info please open https://valine.js.org\n valine:\n   enable: true\n   appid: your appid  # your leancloud application appid\n   appkey: your appkey # your leancloud application appkey\n   notify: false # mail notifier , https://github.com/xCss/Valine/wiki\n   verify: false # Verification code\n   placeholder:   # comment box placeholder\n   avatar: monsterid # gravatar style\n   guest_info: nick,mail # custom comment header\n   pageSize: 10 # pagination size\n```\n[Leancloud](https://leancloud.cn/)\n![](Github-Pages-Blog/comment-delete.png)\n\n### hexo\n\n\n``` bash\n$ npm install hexo-generator-author --save\n```\n\nauthor\n``` markdown\ntitle: \ntags:\n  - Testing\n  - Another Tag\n---\nauthor: Alice\n```\n\n/layout/_macro/post.swig +\n```swig\n         <div class=\"post-meta\">\n+          <span itemprop=\"about\" itemscope itemtype=\"https://schema.org/Thing\">\n+            <a href=\"/authors/{{ post.author }}\" itemprop=\"url\" rel=\"index\">\n+              <span itemprop=\"name\">{{ post.author }}</span>\n+            </a>\n+          </span>\n           <span class=\"post-time\">\n             <span class=\"post-meta-item-icon\">\n               <i class=\"fa fa-calendar-o\"></i>\n\n```\n/layoutauthor.swig\n```swig\n\n{% extends '_layout.swig' %}\n{% import '_macro/post-collapse.swig' as post_template %}\n{% import '_macro/sidebar.swig' as sidebar_template %}\n\n{% block title %} {{ __('title.author') }}: {{ page.author }} | {{ config.title }} {% endblock %}\n\n{% block content %}\n\n  <div class=\"post-block category\">\n\n    <div id=\"posts\" class=\"posts-collapse\">\n      <div class=\"collection-title\">\n\n        <{% if theme.seo %}h2{% else %}h1{% endif %}>{#\n        #}{{ page.author }}{#\n        #}<small>{{  __('title.author')  }}</small>\n        </{% if theme.seo %}h2{% else %}h1{% endif %}>\n      </div>\n\n      {% for post in page.posts %}\n        {{ post_template.render(post) }}\n      {% endfor %}\n    </div>\n\n  </div>\n\n  {% include '_partials/pagination.swig' %}\n\n{% endblock %}\n\n{% block sidebar %}\n  {{ sidebar_template.render(false) }}\n{% endblock %}\n\n```\n\n/layoutpage.swig\n```swig\n\n     {{ __('title.category') + page_title_suffix }}\n   {% elif page.type === \"tags\" %}\n     {{ __('title.tag') + page_title_suffix }}\n+  {% elif page.type === \"authors\" %}\n+    {{ __('title.author') + page_title_suffix }}\n   {% else %}\n     {{ page.title + page_title_suffix }}\n   {% endif %}\n\n\n           {{ list_categories() }}\n         </div>\n       </div>\n+    {% elif page.type === 'authors' %}\n+      <div class=\"author-all-page\">\n+        <div class=\"author-all-title\">\n+            {{ _p('counter.authors', site.authors.length) }}\n+        </div>\n+        <div class=\"author-all\">\n+          {{ list_authors() }}\n+        </div>\n+      </div>\n     {% else %}\n       {{ page.content }}\n     {% endif %}\n```\n{}/themes/nextzh-Hans.yml\n```yml\ntitle:\n  archive: \n  category: \n  tag: \n  schedule: \n  author : \n  \n\n\ncounter:\n\n  authors:\n    zero: \n    one:  1 \n    other: \" %d \"\n\n```\n\n{}/themes/next/source/css/_common/components/pages/authors.stylcategories.stylcategorieauthor\n\npages.styl@import \"authors\";\n\n\n``` bash\n$  hexo clean\n$  hexo d -g\n```\n\n###\n```bash\n$ npm install gulp -g\n$ npm install gulp-minify-css gulp-uglify gulp-htmlmin gulp-htmlclean gulp --save\n```\n`gulpfile.js`\n```js\nvar gulp = require('gulp');\nvar minifycss = require('gulp-minify-css');\nvar uglify = require('gulp-uglify');\nvar htmlmin = require('gulp-htmlmin');\nvar htmlclean = require('gulp-htmlclean');\n//  public  css\ngulp.task('minify-css', function() {\n    return gulp.src('./public/**/*.css')\n        .pipe(minifycss())\n        .pipe(gulp.dest('./public'));\n});\n//  public  html\ngulp.task('minify-html', function() {\n  return gulp.src('./public/**/*.html')\n    .pipe(htmlclean())\n    .pipe(htmlmin({\n         removeComments: true,\n         minifyJS: true,\n         minifyCSS: true,\n         minifyURLs: true,\n    }))\n    .pipe(gulp.dest('./public'))\n});\n//  public/js  js\ngulp.task('minify-js', function() {\n    return gulp.src('./public/**/*.js')\n        .pipe(uglify())\n        .pipe(gulp.dest('./public'));\n});\n//  gulp \ngulp.task('default', [\n    'minify-html','minify-css','minify-js'\n]);\n```\n\n hexo g && gulp  gulpfile.js  public ","slug":"Github-Pages-Blog","published":1,"updated":"2019-07-30T11:37:16.785Z","layout":"post","photos":[],"link":"","_id":"ck4859y93003lt0fyvlndcm24","content":"<p>Hexo + Next + GitHubPages </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"node-js\"><a href=\"#node-js\" class=\"headerlink\" title=\"node.js\"></a>node.js</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ brew install node</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-git\"><a href=\"#-git\" class=\"headerlink\" title=\" git\"></a> git</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ brew install git</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n\n<h3 id=\"yarn\"><a href=\"#yarn\" class=\"headerlink\" title=\"yarn\"></a>yarn</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install yarn</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ brew install yarn</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"hexo\"><a href=\"#hexo\" class=\"headerlink\" title=\"hexo\"></a>hexo</h3><p>blog</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> blog</span><br></pre></td></tr></table></figure>\n\n<p> yarn  hexo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yarn add hexo -S</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-cli -g</span><br><span class=\"line\">$ npm install hexo-server --save</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,hexo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">$ hexo init</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yarn install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p> <code>localhost:4000</code> </p>\n<h2 id=\"-GitHub\"><a href=\"#-GitHub\" class=\"headerlink\" title=\" GitHub\"></a> GitHub</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/01/30/Github-Pages-Blog/create-project.png\" alt=\"\"></p>\n<p> <code>[].github.io</code><br><img src=\"/2019/01/30/Github-Pages-Blog/create-repository.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/01/30/Github-Pages-Blog/setting.png\" alt=\"\"></p>\n<p>GitHub Pages masterchoose a theme</p>\n<p><img src=\"/2019/01/30/Github-Pages-Blog/github-pages.png\" alt=\"github-pages\"></p>\n<p>select theme<br><img src=\"/2019/01/30/Github-Pages-Blog/select-theme.png\" alt=\"\"></p>\n<p>  <code>https://[].github.io/</code>,</p>\n<p><img src=\"/2019/01/30/Github-Pages-Blog/copy-url.png\" alt=\"\"></p>\n<p> <code>_config.yml</code> </p>\n<p><img src=\"/2019/01/30/Github-Pages-Blog/deploy-position.png\" alt=\"hexogit\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://hexo.io/zh-cn/docs/configuration\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> hexo-deployer-git </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yarn add hexo-deployer-git -S</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install--save hexo-deployer-git</span><br></pre></td></tr></table></figure>\n\n<p> hexo d -g  GitHub  git push ,sudo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p>github<code>https://[].github.io/</code></p>\n<h2 id=\"NexT\"><a href=\"#NexT\" class=\"headerlink\" title=\"NexT\"></a>NexT</h2><p>NexT Hexo <br><a href=\"https://github.com/iissnan/hexo-theme-next/blob/master/README.cn.md\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h3 id=\"NexT\"><a href=\"#NexT\" class=\"headerlink\" title=\"NexT\"></a>NexT</h3><p>NexT</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git <span class=\"built_in\">clone</span> https://github.com/iissnan/hexo-theme-next.git themes/next</span><br></pre></td></tr></table></figure>\n\n<p><code>_config.yml</code> <br><img src=\"/2019/01/30/Github-Pages-Blog/change-theme.png\" alt=\"\"></p>\n<p>github</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p>github<code>https://[].github.io/</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>themes/next</code><code>_config.yml</code><br>next4</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Scheme Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Schemes</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Muse</span></span><br><span class=\"line\"><span class=\"attr\">scheme:</span> <span class=\"string\">Mist</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Pisces</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Gemini</span></span><br></pre></td></tr></table></figure>\n\n<p>Menu Settings</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Menu Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\"><span class=\"attr\">  home:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">home</span></span><br><span class=\"line\"><span class=\"comment\">#  about: /about/ || user</span></span><br><span class=\"line\"><span class=\"attr\">  tags:</span> <span class=\"string\">/tags/</span> <span class=\"string\">||</span> <span class=\"string\">tags</span></span><br><span class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\"><span class=\"comment\">#  archives: /archives/ || archive</span></span><br><span class=\"line\"><span class=\"comment\">#  schedule: /schedule/ || calendar</span></span><br><span class=\"line\"><span class=\"comment\">#  sitemap: /sitemap.xml || sitemap</span></span><br><span class=\"line\"><span class=\"comment\">#  commonweal: /404.html || heartbeat</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/01/30/Github-Pages-Blog/blog-icon.png\" alt=\"\"><br><a href=\"http://theme-next.iissnan.com/getting-started.html#install-next-theme\" target=\"_blank\" rel=\"noopener\"></a>,<a href=\"http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html\" target=\"_blank\" rel=\"noopener\"></a>,<a href=\"http://yearito.cn/posts/hexo-theme-beautify.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo clean</span><br><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p> <code>localhost:4000</code> </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new page tags</span><br></pre></td></tr></table></figure>\n\n<p> source/tags  index.md </p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: tags</span><br><span class=\"line\">type: \"tags\"</span><br><span class=\"line\">comments: false</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p><code>themes/next</code><code>_config.yml</code>  <code>tags: /tags/ || tags</code> <br></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">'test'</span></span><br></pre></td></tr></table></figure>\n\n<p>tags</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: </span><br><span class=\"line\">tags:</span><br><span class=\"line\">  - Testing</span><br><span class=\"line\">  - Another Tag</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p>  <br><img src=\"/2019/01/30/Github-Pages-Blog/tags.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new page categories</span><br></pre></td></tr></table></figure>\n\n<p> source/tags  index.md </p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: categories</span><br><span class=\"line\">type: \"categories\"</span><br><span class=\"line\">comments: false</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p><code>themes/next</code><code>_config.yml</code>  <code>categories: /categories/ || th</code> <br>categories</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: </span><br><span class=\"line\">tags:</span><br><span class=\"line\">  - Testing</span><br><span class=\"line\">  - Another Tag</span><br><span class=\"line\">---</span><br><span class=\"line\">categories: Testing</span><br></pre></td></tr></table></figure>\n\n<p>  <br><img src=\"/2019/01/30/Github-Pages-Blog/categories.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>\n\n<p>md_post</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">''</span></span><br></pre></td></tr></table></figure>\n\n<p>markdown</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![<span class=\"string\"></span>](<span class=\"link\">xxxx/.jpg</span>)</span><br></pre></td></tr></table></figure>\n\n<p>xxxx</p>\n<h3 id=\"Valine\"><a href=\"#Valine\" class=\"headerlink\" title=\"Valine\"></a>Valine</h3><p><a href=\"https://leancloud.cn/\" target=\"_blank\" rel=\"noopener\">Leancloud</a>,<br><code>appid</code><code>appkey</code><br><img src=\"/2019/01/30/Github-Pages-Blog/valine.png\" alt=\"\"></p>\n<p><code>themes/next</code><code>_config.yml</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Valine.</span></span><br><span class=\"line\"><span class=\"comment\"># You can get your appid and appkey from https://leancloud.cn</span></span><br><span class=\"line\"><span class=\"comment\"># more info please open https://valine.js.org</span></span><br><span class=\"line\"><span class=\"attr\">valine:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  appid:</span> <span class=\"string\">your</span> <span class=\"string\">appid</span>  <span class=\"comment\"># your leancloud application appid</span></span><br><span class=\"line\"><span class=\"attr\">  appkey:</span> <span class=\"string\">your</span> <span class=\"string\">appkey</span> <span class=\"comment\"># your leancloud application appkey</span></span><br><span class=\"line\"><span class=\"attr\">  notify:</span> <span class=\"literal\">false</span> <span class=\"comment\"># mail notifier , https://github.com/xCss/Valine/wiki</span></span><br><span class=\"line\"><span class=\"attr\">  verify:</span> <span class=\"literal\">false</span> <span class=\"comment\"># Verification code</span></span><br><span class=\"line\"><span class=\"attr\">  placeholder:</span> <span class=\"string\"></span>  <span class=\"comment\"># comment box placeholder</span></span><br><span class=\"line\"><span class=\"attr\">  avatar:</span> <span class=\"string\">monsterid</span> <span class=\"comment\"># gravatar style</span></span><br><span class=\"line\"><span class=\"attr\">  guest_info:</span> <span class=\"string\">nick,mail</span> <span class=\"comment\"># custom comment header</span></span><br><span class=\"line\"><span class=\"attr\">  pageSize:</span> <span class=\"number\">10</span> <span class=\"comment\"># pagination size</span></span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://leancloud.cn/\" target=\"_blank\" rel=\"noopener\">Leancloud</a><br><img src=\"/2019/01/30/Github-Pages-Blog/comment-delete.png\" alt=\"\"></p>\n<h3 id=\"hexo\"><a href=\"#hexo\" class=\"headerlink\" title=\"hexo\"></a>hexo</h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-generator-author --save</span><br></pre></td></tr></table></figure>\n\n<p>author</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: </span><br><span class=\"line\">tags:</span><br><span class=\"line\">  - Testing</span><br><span class=\"line\">  - Another Tag</span><br><span class=\"line\">---</span><br><span class=\"line\">author: Alice</span><br></pre></td></tr></table></figure>\n\n<p>/layout/_macro/post.swig +</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">         &lt;div class=&quot;post-meta&quot;&gt;</span><br><span class=\"line\">+          &lt;span itemprop=&quot;about&quot; itemscope itemtype=&quot;https://schema.org/Thing&quot;&gt;</span><br><span class=\"line\">+            &lt;a href=&quot;/authors/&#123;&#123; post.author &#125;&#125;&quot; itemprop=&quot;url&quot; rel=&quot;index&quot;&gt;</span><br><span class=\"line\">+              &lt;span itemprop=&quot;name&quot;&gt;&#123;&#123; post.author &#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">+            &lt;/a&gt;</span><br><span class=\"line\">+          &lt;/span&gt;</span><br><span class=\"line\">           &lt;span class=&quot;post-time&quot;&gt;</span><br><span class=\"line\">             &lt;span class=&quot;post-meta-item-icon&quot;&gt;</span><br><span class=\"line\">               &lt;i class=&quot;fa fa-calendar-o&quot;&gt;&lt;/i&gt;</span><br></pre></td></tr></table></figure>\n\n<p>/layoutauthor.swig</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">&#123;% extends &apos;_layout.swig&apos; %&#125;</span><br><span class=\"line\">&#123;% import &apos;_macro/post-collapse.swig&apos; as post_template %&#125;</span><br><span class=\"line\">&#123;% import &apos;_macro/sidebar.swig&apos; as sidebar_template %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% block title %&#125; &#123;&#123; __(&apos;title.author&apos;) &#125;&#125;: &#123;&#123; page.author &#125;&#125; | &#123;&#123; config.title &#125;&#125; &#123;% endblock %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% block content %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;div class=&quot;post-block category&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;div id=&quot;posts&quot; class=&quot;posts-collapse&quot;&gt;</span><br><span class=\"line\">      &lt;div class=&quot;collection-title&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;&#123;% if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;% endif %&#125;&gt;&#123;#</span><br><span class=\"line\">        #&#125;&#123;&#123; page.author &#125;&#125;&#123;#</span><br><span class=\"line\">        #&#125;&lt;small&gt;&#123;&#123;  __(&apos;title.author&apos;)  &#125;&#125;&lt;/small&gt;</span><br><span class=\"line\">        &lt;/&#123;% if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;% endif %&#125;&gt;</span><br><span class=\"line\">      &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;% for post in page.posts %&#125;</span><br><span class=\"line\">        &#123;&#123; post_template.render(post) &#125;&#125;</span><br><span class=\"line\">      &#123;% endfor %&#125;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;% include &apos;_partials/pagination.swig&apos; %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% endblock %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% block sidebar %&#125;</span><br><span class=\"line\">  &#123;&#123; sidebar_template.render(false) &#125;&#125;</span><br><span class=\"line\">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>\n\n<p>/layoutpage.swig</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">     &#123;&#123; __(&apos;title.category&apos;) + page_title_suffix &#125;&#125;</span><br><span class=\"line\">   &#123;% elif page.type === &quot;tags&quot; %&#125;</span><br><span class=\"line\">     &#123;&#123; __(&apos;title.tag&apos;) + page_title_suffix &#125;&#125;</span><br><span class=\"line\">+  &#123;% elif page.type === &quot;authors&quot; %&#125;</span><br><span class=\"line\">+    &#123;&#123; __(&apos;title.author&apos;) + page_title_suffix &#125;&#125;</span><br><span class=\"line\">   &#123;% else %&#125;</span><br><span class=\"line\">     &#123;&#123; page.title + page_title_suffix &#125;&#125;</span><br><span class=\"line\">   &#123;% endif %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">           &#123;&#123; list_categories() &#125;&#125;</span><br><span class=\"line\">         &lt;/div&gt;</span><br><span class=\"line\">       &lt;/div&gt;</span><br><span class=\"line\">+    &#123;% elif page.type === &apos;authors&apos; %&#125;</span><br><span class=\"line\">+      &lt;div class=&quot;author-all-page&quot;&gt;</span><br><span class=\"line\">+        &lt;div class=&quot;author-all-title&quot;&gt;</span><br><span class=\"line\">+            &#123;&#123; _p(&apos;counter.authors&apos;, site.authors.length) &#125;&#125;</span><br><span class=\"line\">+        &lt;/div&gt;</span><br><span class=\"line\">+        &lt;div class=&quot;author-all&quot;&gt;</span><br><span class=\"line\">+          &#123;&#123; list_authors() &#125;&#125;</span><br><span class=\"line\">+        &lt;/div&gt;</span><br><span class=\"line\">+      &lt;/div&gt;</span><br><span class=\"line\">     &#123;% else %&#125;</span><br><span class=\"line\">       &#123;&#123; page.content &#125;&#125;</span><br><span class=\"line\">     &#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n\n<p>{}/themes/nextzh-Hans.yml</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">title:</span></span><br><span class=\"line\"><span class=\"attr\">  archive:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">  category:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">  tag:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">  schedule:</span> <span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"string\">author</span> <span class=\"string\">:</span> <span class=\"string\"></span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">counter:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">  authors:</span></span><br><span class=\"line\"><span class=\"attr\">    zero:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">    one:</span> <span class=\"string\"></span> <span class=\"number\">1</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">    other:</span> <span class=\"string\">\" %d \"</span></span><br></pre></td></tr></table></figure>\n\n<p>{}/themes/next/source/css/_common/components/pages/authors.stylcategories.stylcategorieauthor</p>\n<p>pages.styl@import authors;</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo clean</span><br><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p>###</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install gulp -g</span><br><span class=\"line\">$ npm install gulp-minify-css gulp-uglify gulp-htmlmin gulp-htmlclean gulp --save</span><br></pre></td></tr></table></figure>\n\n<p><code>gulpfile.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> gulp = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> minifycss = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-minify-css'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> uglify = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-uglify'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> htmlmin = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-htmlmin'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> htmlclean = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-htmlclean'</span>);</span><br><span class=\"line\"><span class=\"comment\">//  public  css</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'minify-css'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> gulp.src(<span class=\"string\">'./public/**/*.css'</span>)</span><br><span class=\"line\">        .pipe(minifycss())</span><br><span class=\"line\">        .pipe(gulp.dest(<span class=\"string\">'./public'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//  public  html</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'minify-html'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> gulp.src(<span class=\"string\">'./public/**/*.html'</span>)</span><br><span class=\"line\">    .pipe(htmlclean())</span><br><span class=\"line\">    .pipe(htmlmin(&#123;</span><br><span class=\"line\">         removeComments: <span class=\"literal\">true</span>,</span><br><span class=\"line\">         minifyJS: <span class=\"literal\">true</span>,</span><br><span class=\"line\">         minifyCSS: <span class=\"literal\">true</span>,</span><br><span class=\"line\">         minifyURLs: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;))</span><br><span class=\"line\">    .pipe(gulp.dest(<span class=\"string\">'./public'</span>))</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//  public/js  js</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'minify-js'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> gulp.src(<span class=\"string\">'./public/**/*.js'</span>)</span><br><span class=\"line\">        .pipe(uglify())</span><br><span class=\"line\">        .pipe(gulp.dest(<span class=\"string\">'./public'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//  gulp </span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'default'</span>, [</span><br><span class=\"line\">    <span class=\"string\">'minify-html'</span>,<span class=\"string\">'minify-css'</span>,<span class=\"string\">'minify-js'</span></span><br><span class=\"line\">]);</span><br></pre></td></tr></table></figure>\n\n<p> hexo g &amp;&amp; gulp  gulpfile.js  public </p>\n","site":{"data":{}},"excerpt":"<p>Hexo + Next + GitHubPages </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"node-js\"><a href=\"#node-js\" class=\"headerlink\" title=\"node.js\"></a>node.js</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ brew install node</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"-git\"><a href=\"#-git\" class=\"headerlink\" title=\" git\"></a> git</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ brew install git</span><br></pre></td></tr></table></figure>","more":"<h3 id=\"yarn\"><a href=\"#yarn\" class=\"headerlink\" title=\"yarn\"></a>yarn</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install yarn</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ brew install yarn</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"hexo\"><a href=\"#hexo\" class=\"headerlink\" title=\"hexo\"></a>hexo</h3><p>blog</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> blog</span><br></pre></td></tr></table></figure>\n\n<p> yarn  hexo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yarn add hexo -S</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-cli -g</span><br><span class=\"line\">$ npm install hexo-server --save</span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://hexo.io/zh-cn/docs/\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>,hexo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ <span class=\"built_in\">cd</span> blog</span><br><span class=\"line\">$ hexo init</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yarn install</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<p> <code>localhost:4000</code> </p>\n<h2 id=\"-GitHub\"><a href=\"#-GitHub\" class=\"headerlink\" title=\" GitHub\"></a> GitHub</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/01/30/Github-Pages-Blog/create-project.png\" alt=\"\"></p>\n<p> <code>[].github.io</code><br><img src=\"/2019/01/30/Github-Pages-Blog/create-repository.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/01/30/Github-Pages-Blog/setting.png\" alt=\"\"></p>\n<p>GitHub Pages masterchoose a theme</p>\n<p><img src=\"/2019/01/30/Github-Pages-Blog/github-pages.png\" alt=\"github-pages\"></p>\n<p>select theme<br><img src=\"/2019/01/30/Github-Pages-Blog/select-theme.png\" alt=\"\"></p>\n<p>  <code>https://[].github.io/</code>,</p>\n<p><img src=\"/2019/01/30/Github-Pages-Blog/copy-url.png\" alt=\"\"></p>\n<p> <code>_config.yml</code> </p>\n<p><img src=\"/2019/01/30/Github-Pages-Blog/deploy-position.png\" alt=\"hexogit\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><a href=\"https://hexo.io/zh-cn/docs/configuration\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> hexo-deployer-git </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ yarn add hexo-deployer-git -S</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install--save hexo-deployer-git</span><br></pre></td></tr></table></figure>\n\n<p> hexo d -g  GitHub  git push ,sudo</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p>github<code>https://[].github.io/</code></p>\n<h2 id=\"NexT\"><a href=\"#NexT\" class=\"headerlink\" title=\"NexT\"></a>NexT</h2><p>NexT Hexo <br><a href=\"https://github.com/iissnan/hexo-theme-next/blob/master/README.cn.md\" target=\"_blank\" rel=\"noopener\"></a></p>\n<h3 id=\"NexT\"><a href=\"#NexT\" class=\"headerlink\" title=\"NexT\"></a>NexT</h3><p>NexT</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ git <span class=\"built_in\">clone</span> https://github.com/iissnan/hexo-theme-next.git themes/next</span><br></pre></td></tr></table></figure>\n\n<p><code>_config.yml</code> <br><img src=\"/2019/01/30/Github-Pages-Blog/change-theme.png\" alt=\"\"></p>\n<p>github</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p>github<code>https://[].github.io/</code></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>themes/next</code><code>_config.yml</code><br>next4</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Scheme Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Schemes</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Muse</span></span><br><span class=\"line\"><span class=\"attr\">scheme:</span> <span class=\"string\">Mist</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Pisces</span></span><br><span class=\"line\"><span class=\"comment\">#scheme: Gemini</span></span><br></pre></td></tr></table></figure>\n\n<p>Menu Settings</p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># Menu Settings</span></span><br><span class=\"line\"><span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\"><span class=\"attr\">menu:</span></span><br><span class=\"line\"><span class=\"attr\">  home:</span> <span class=\"string\">/</span> <span class=\"string\">||</span> <span class=\"string\">home</span></span><br><span class=\"line\"><span class=\"comment\">#  about: /about/ || user</span></span><br><span class=\"line\"><span class=\"attr\">  tags:</span> <span class=\"string\">/tags/</span> <span class=\"string\">||</span> <span class=\"string\">tags</span></span><br><span class=\"line\"><span class=\"attr\">  categories:</span> <span class=\"string\">/categories/</span> <span class=\"string\">||</span> <span class=\"string\">th</span></span><br><span class=\"line\"><span class=\"comment\">#  archives: /archives/ || archive</span></span><br><span class=\"line\"><span class=\"comment\">#  schedule: /schedule/ || calendar</span></span><br><span class=\"line\"><span class=\"comment\">#  sitemap: /sitemap.xml || sitemap</span></span><br><span class=\"line\"><span class=\"comment\">#  commonweal: /404.html || heartbeat</span></span><br></pre></td></tr></table></figure>\n\n<p><img src=\"/2019/01/30/Github-Pages-Blog/blog-icon.png\" alt=\"\"><br><a href=\"http://theme-next.iissnan.com/getting-started.html#install-next-theme\" target=\"_blank\" rel=\"noopener\"></a>,<a href=\"http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html\" target=\"_blank\" rel=\"noopener\"></a>,<a href=\"http://yearito.cn/posts/hexo-theme-beautify.html\" target=\"_blank\" rel=\"noopener\"></a></p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo clean</span><br><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p> <code>localhost:4000</code> </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo server</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new page tags</span><br></pre></td></tr></table></figure>\n\n<p> source/tags  index.md </p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: tags</span><br><span class=\"line\">type: \"tags\"</span><br><span class=\"line\">comments: false</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p><code>themes/next</code><code>_config.yml</code>  <code>tags: /tags/ || tags</code> <br></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">'test'</span></span><br></pre></td></tr></table></figure>\n\n<p>tags</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: </span><br><span class=\"line\">tags:</span><br><span class=\"line\">  - Testing</span><br><span class=\"line\">  - Another Tag</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p>  <br><img src=\"/2019/01/30/Github-Pages-Blog/tags.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new page categories</span><br></pre></td></tr></table></figure>\n\n<p> source/tags  index.md </p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: categories</span><br><span class=\"line\">type: \"categories\"</span><br><span class=\"line\">comments: false</span><br><span class=\"line\">---</span><br></pre></td></tr></table></figure>\n\n<p><code>themes/next</code><code>_config.yml</code>  <code>categories: /categories/ || th</code> <br>categories</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: </span><br><span class=\"line\">tags:</span><br><span class=\"line\">  - Testing</span><br><span class=\"line\">  - Another Tag</span><br><span class=\"line\">---</span><br><span class=\"line\">categories: Testing</span><br></pre></td></tr></table></figure>\n\n<p>  <br><img src=\"/2019/01/30/Github-Pages-Blog/categories.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>\n\n<p>md_post</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ hexo new <span class=\"string\">''</span></span><br></pre></td></tr></table></figure>\n\n<p>markdown</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">![<span class=\"string\"></span>](<span class=\"link\">xxxx/.jpg</span>)</span><br></pre></td></tr></table></figure>\n\n<p>xxxx</p>\n<h3 id=\"Valine\"><a href=\"#Valine\" class=\"headerlink\" title=\"Valine\"></a>Valine</h3><p><a href=\"https://leancloud.cn/\" target=\"_blank\" rel=\"noopener\">Leancloud</a>,<br><code>appid</code><code>appkey</code><br><img src=\"/2019/01/30/Github-Pages-Blog/valine.png\" alt=\"\"></p>\n<p><code>themes/next</code><code>_config.yml</code></p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Valine.</span></span><br><span class=\"line\"><span class=\"comment\"># You can get your appid and appkey from https://leancloud.cn</span></span><br><span class=\"line\"><span class=\"comment\"># more info please open https://valine.js.org</span></span><br><span class=\"line\"><span class=\"attr\">valine:</span></span><br><span class=\"line\"><span class=\"attr\">  enable:</span> <span class=\"literal\">true</span></span><br><span class=\"line\"><span class=\"attr\">  appid:</span> <span class=\"string\">your</span> <span class=\"string\">appid</span>  <span class=\"comment\"># your leancloud application appid</span></span><br><span class=\"line\"><span class=\"attr\">  appkey:</span> <span class=\"string\">your</span> <span class=\"string\">appkey</span> <span class=\"comment\"># your leancloud application appkey</span></span><br><span class=\"line\"><span class=\"attr\">  notify:</span> <span class=\"literal\">false</span> <span class=\"comment\"># mail notifier , https://github.com/xCss/Valine/wiki</span></span><br><span class=\"line\"><span class=\"attr\">  verify:</span> <span class=\"literal\">false</span> <span class=\"comment\"># Verification code</span></span><br><span class=\"line\"><span class=\"attr\">  placeholder:</span> <span class=\"string\"></span>  <span class=\"comment\"># comment box placeholder</span></span><br><span class=\"line\"><span class=\"attr\">  avatar:</span> <span class=\"string\">monsterid</span> <span class=\"comment\"># gravatar style</span></span><br><span class=\"line\"><span class=\"attr\">  guest_info:</span> <span class=\"string\">nick,mail</span> <span class=\"comment\"># custom comment header</span></span><br><span class=\"line\"><span class=\"attr\">  pageSize:</span> <span class=\"number\">10</span> <span class=\"comment\"># pagination size</span></span><br></pre></td></tr></table></figure>\n\n<p><a href=\"https://leancloud.cn/\" target=\"_blank\" rel=\"noopener\">Leancloud</a><br><img src=\"/2019/01/30/Github-Pages-Blog/comment-delete.png\" alt=\"\"></p>\n<h3 id=\"hexo\"><a href=\"#hexo\" class=\"headerlink\" title=\"hexo\"></a>hexo</h3><p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install hexo-generator-author --save</span><br></pre></td></tr></table></figure>\n\n<p>author</p>\n<figure class=\"highlight markdown\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">title: </span><br><span class=\"line\">tags:</span><br><span class=\"line\">  - Testing</span><br><span class=\"line\">  - Another Tag</span><br><span class=\"line\">---</span><br><span class=\"line\">author: Alice</span><br></pre></td></tr></table></figure>\n\n<p>/layout/_macro/post.swig +</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">         &lt;div class=&quot;post-meta&quot;&gt;</span><br><span class=\"line\">+          &lt;span itemprop=&quot;about&quot; itemscope itemtype=&quot;https://schema.org/Thing&quot;&gt;</span><br><span class=\"line\">+            &lt;a href=&quot;/authors/&#123;&#123; post.author &#125;&#125;&quot; itemprop=&quot;url&quot; rel=&quot;index&quot;&gt;</span><br><span class=\"line\">+              &lt;span itemprop=&quot;name&quot;&gt;&#123;&#123; post.author &#125;&#125;&lt;/span&gt;</span><br><span class=\"line\">+            &lt;/a&gt;</span><br><span class=\"line\">+          &lt;/span&gt;</span><br><span class=\"line\">           &lt;span class=&quot;post-time&quot;&gt;</span><br><span class=\"line\">             &lt;span class=&quot;post-meta-item-icon&quot;&gt;</span><br><span class=\"line\">               &lt;i class=&quot;fa fa-calendar-o&quot;&gt;&lt;/i&gt;</span><br></pre></td></tr></table></figure>\n\n<p>/layoutauthor.swig</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">&#123;% extends &apos;_layout.swig&apos; %&#125;</span><br><span class=\"line\">&#123;% import &apos;_macro/post-collapse.swig&apos; as post_template %&#125;</span><br><span class=\"line\">&#123;% import &apos;_macro/sidebar.swig&apos; as sidebar_template %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% block title %&#125; &#123;&#123; __(&apos;title.author&apos;) &#125;&#125;: &#123;&#123; page.author &#125;&#125; | &#123;&#123; config.title &#125;&#125; &#123;% endblock %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% block content %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;div class=&quot;post-block category&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;div id=&quot;posts&quot; class=&quot;posts-collapse&quot;&gt;</span><br><span class=\"line\">      &lt;div class=&quot;collection-title&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">        &lt;&#123;% if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;% endif %&#125;&gt;&#123;#</span><br><span class=\"line\">        #&#125;&#123;&#123; page.author &#125;&#125;&#123;#</span><br><span class=\"line\">        #&#125;&lt;small&gt;&#123;&#123;  __(&apos;title.author&apos;)  &#125;&#125;&lt;/small&gt;</span><br><span class=\"line\">        &lt;/&#123;% if theme.seo %&#125;h2&#123;% else %&#125;h1&#123;% endif %&#125;&gt;</span><br><span class=\"line\">      &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">      &#123;% for post in page.posts %&#125;</span><br><span class=\"line\">        &#123;&#123; post_template.render(post) &#125;&#125;</span><br><span class=\"line\">      &#123;% endfor %&#125;</span><br><span class=\"line\">    &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &lt;/div&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">  &#123;% include &apos;_partials/pagination.swig&apos; %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% endblock %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#123;% block sidebar %&#125;</span><br><span class=\"line\">  &#123;&#123; sidebar_template.render(false) &#125;&#125;</span><br><span class=\"line\">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure>\n\n<p>/layoutpage.swig</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">     &#123;&#123; __(&apos;title.category&apos;) + page_title_suffix &#125;&#125;</span><br><span class=\"line\">   &#123;% elif page.type === &quot;tags&quot; %&#125;</span><br><span class=\"line\">     &#123;&#123; __(&apos;title.tag&apos;) + page_title_suffix &#125;&#125;</span><br><span class=\"line\">+  &#123;% elif page.type === &quot;authors&quot; %&#125;</span><br><span class=\"line\">+    &#123;&#123; __(&apos;title.author&apos;) + page_title_suffix &#125;&#125;</span><br><span class=\"line\">   &#123;% else %&#125;</span><br><span class=\"line\">     &#123;&#123; page.title + page_title_suffix &#125;&#125;</span><br><span class=\"line\">   &#123;% endif %&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">           &#123;&#123; list_categories() &#125;&#125;</span><br><span class=\"line\">         &lt;/div&gt;</span><br><span class=\"line\">       &lt;/div&gt;</span><br><span class=\"line\">+    &#123;% elif page.type === &apos;authors&apos; %&#125;</span><br><span class=\"line\">+      &lt;div class=&quot;author-all-page&quot;&gt;</span><br><span class=\"line\">+        &lt;div class=&quot;author-all-title&quot;&gt;</span><br><span class=\"line\">+            &#123;&#123; _p(&apos;counter.authors&apos;, site.authors.length) &#125;&#125;</span><br><span class=\"line\">+        &lt;/div&gt;</span><br><span class=\"line\">+        &lt;div class=&quot;author-all&quot;&gt;</span><br><span class=\"line\">+          &#123;&#123; list_authors() &#125;&#125;</span><br><span class=\"line\">+        &lt;/div&gt;</span><br><span class=\"line\">+      &lt;/div&gt;</span><br><span class=\"line\">     &#123;% else %&#125;</span><br><span class=\"line\">       &#123;&#123; page.content &#125;&#125;</span><br><span class=\"line\">     &#123;% endif %&#125;</span><br></pre></td></tr></table></figure>\n\n<p>{}/themes/nextzh-Hans.yml</p>\n<figure class=\"highlight yml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">title:</span></span><br><span class=\"line\"><span class=\"attr\">  archive:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">  category:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">  tag:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">  schedule:</span> <span class=\"string\"></span></span><br><span class=\"line\">  <span class=\"string\">author</span> <span class=\"string\">:</span> <span class=\"string\"></span></span><br><span class=\"line\">  </span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">counter:</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attr\">  authors:</span></span><br><span class=\"line\"><span class=\"attr\">    zero:</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">    one:</span> <span class=\"string\"></span> <span class=\"number\">1</span> <span class=\"string\"></span></span><br><span class=\"line\"><span class=\"attr\">    other:</span> <span class=\"string\">\" %d \"</span></span><br></pre></td></tr></table></figure>\n\n<p>{}/themes/next/source/css/_common/components/pages/authors.stylcategories.stylcategorieauthor</p>\n<p>pages.styl@import authors;</p>\n<p></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$  hexo clean</span><br><span class=\"line\">$  hexo d -g</span><br></pre></td></tr></table></figure>\n\n<p>###</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ npm install gulp -g</span><br><span class=\"line\">$ npm install gulp-minify-css gulp-uglify gulp-htmlmin gulp-htmlclean gulp --save</span><br></pre></td></tr></table></figure>\n\n<p><code>gulpfile.js</code></p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">var</span> gulp = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> minifycss = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-minify-css'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> uglify = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-uglify'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> htmlmin = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-htmlmin'</span>);</span><br><span class=\"line\"><span class=\"keyword\">var</span> htmlclean = <span class=\"built_in\">require</span>(<span class=\"string\">'gulp-htmlclean'</span>);</span><br><span class=\"line\"><span class=\"comment\">//  public  css</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'minify-css'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> gulp.src(<span class=\"string\">'./public/**/*.css'</span>)</span><br><span class=\"line\">        .pipe(minifycss())</span><br><span class=\"line\">        .pipe(gulp.dest(<span class=\"string\">'./public'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//  public  html</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'minify-html'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> gulp.src(<span class=\"string\">'./public/**/*.html'</span>)</span><br><span class=\"line\">    .pipe(htmlclean())</span><br><span class=\"line\">    .pipe(htmlmin(&#123;</span><br><span class=\"line\">         removeComments: <span class=\"literal\">true</span>,</span><br><span class=\"line\">         minifyJS: <span class=\"literal\">true</span>,</span><br><span class=\"line\">         minifyCSS: <span class=\"literal\">true</span>,</span><br><span class=\"line\">         minifyURLs: <span class=\"literal\">true</span>,</span><br><span class=\"line\">    &#125;))</span><br><span class=\"line\">    .pipe(gulp.dest(<span class=\"string\">'./public'</span>))</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//  public/js  js</span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'minify-js'</span>, <span class=\"function\"><span class=\"keyword\">function</span>(<span class=\"params\"></span>) </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> gulp.src(<span class=\"string\">'./public/**/*.js'</span>)</span><br><span class=\"line\">        .pipe(uglify())</span><br><span class=\"line\">        .pipe(gulp.dest(<span class=\"string\">'./public'</span>));</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"><span class=\"comment\">//  gulp </span></span><br><span class=\"line\">gulp.task(<span class=\"string\">'default'</span>, [</span><br><span class=\"line\">    <span class=\"string\">'minify-html'</span>,<span class=\"string\">'minify-css'</span>,<span class=\"string\">'minify-js'</span></span><br><span class=\"line\">]);</span><br></pre></td></tr></table></figure>\n\n<p> hexo g &amp;&amp; gulp  gulpfile.js  public </p>"},{"title":"JAVAclass","date":"2019-02-12T08:14:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"```java\npublic class HelloWorld {\n    public static void main(String[] args){\n        System.out.println(\"Hello, world!\");\n    }\n}\n```\njavajavamainHelloWorldjava.lang.Objectmain()java.lang.Stringjava.lang.String[]java.lang.Systemjava\n\n## \n\n * (bootstrap classpath)jre/libJava\n * (extention classpath)jre/lib/extJava\n * (user classpath).java-classpath\n\n<!-- more -->\n### \n\nch01ch02ch02classpath\n```base\n|-jvmgo\n    |-ch01\n    |-ch01\n        |-classpath\n        |-cmd.go\n        |-main.go\n```\ncmdXjreOption\n```go\ntype Cmd struct {\n\thelpFlag bool\n\tversionFlag bool\n\tcpOption string\n\tXjreOption string\n\tclass string\n\targs []string\n}\n```\nparseCmd()Xjre\n```go\n//\nfunc parseCmd() *Cmd {\n    ...//\n\tflag.StringVar(&cmd.cpOption,\"cp\",\"\",\"classpath\")\n\tflag.StringVar(&cmd.XjreOption,\"Xjre\",\"\",\"path to jre\")\n\t//flag\n\tflag.Parse()\n\t...//\n}\n```\n###  \n\n\n\nEntry\n```go\n//windows;UNIX:\nconst pathListSeparator = string(os.PathListSeparator)\n\ntype Entry interface {\n\t//class  class/.class\n\t//java.lang.Objectjava/lang/Object.class\n\treadClass(classname string) ([]byte, Entry, error)\n\n\t//toString\n\tString() string\n}\n```\nEntryCompositeEntryWildcardEntryZipEntryDirEntry\n#### DirEntry\nDirEntry\n```go\npackage classpath\n\nimport (\n\t\"path/filepath\"\n\t\"io/ioutil\"\n)\n\ntype DirEntry struct {\n\t//\n\tabsDir string\n}\n\n//\nfunc newDirEntry(path string) *DirEntry {\n\t//\n\tabsDir, err := filepath.Abs(path)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\treturn &DirEntry{absDir}\n}\n//class\nfunc (self *DirEntry) readClass (className string) ([]byte, Entry, error) {\n\t//class\n\tfileName := filepath.Join(self.absDir,className)\n\t//class\n\tdata, err := ioutil.ReadFile(fileName)\n\treturn data,self,err\n}\n\n//\nfunc (self *DirEntry) String() string{\n\treturn self.absDir\n}\n```\n#### ZipEntry\nZipEntryZIPJAR\n```go\npackage classpath\n\nimport (\n\t\"path/filepath\"\n\t\"archive/zip\"\n\t\"io/ioutil\"\n\t\"errors\"\n)\n\ntype ZipEntry struct {\n\t//\n\tabsPath string\n}\n\n//\nfunc newZipEntry(path string) *ZipEntry {\n\t//\n\tabsPath, err := filepath.Abs(path)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\treturn &ZipEntry{absPath}\n}\n\n//class\nfunc (self *ZipEntry) readClass(classname string) ([]byte, Entry, error) {\n\t//zip\n\tr, err := zip.OpenReader(self.absPath)\n\tif err != nil {\n\t\treturn nil,nil,err\n\t}\n\tdefer r.Close()\n\n\t//zip\n\tfor _, f := range r.File {\n\t\t//class\n\t\tif f.Name == classname {\n\t\t\t//class\n\t\t\trc , err := f.Open()\n\t\t\tif err != nil {\n\t\t\t\treturn nil,nil,err\n\t\t\t}\n\t\t\tdefer rc.Close()\n\t\t\t//class\n\t\t\tdata, err := ioutil.ReadAll(rc)\n\t\t\tif err != nil {\n\t\t\t\treturn nil,nil,err\n\t\t\t}\n\t\t\treturn data,self,err\n\t\t}\n\t}\n\t//class\n\treturn nil,nil,errors.New(\"class not found :\" +classname)\n}\n\n//\nfunc (self *ZipEntry) String() string {\n\treturn self.absPath\n}\n```\n#### CompositeEntry\nCompositeEntryCompositeEntryEntry[]Entrygoslice\n\n```go\npackage classpath\n\nimport (\n\t\"strings\"\n\t\"errors\"\n)\n\ntype CompositeEntry []Entry\n\n\n//Entry\nfunc newCompositeEntry(pathList string) CompositeEntry {\n\tvar compositeEntry []Entry\n\t//\n\tfor _, path := range strings.Split(pathList,pathListSeparator){\n\t\tentry := newEntry(path)\n\t\tcompositeEntry = append(compositeEntry,entry)\n\t}\n\treturn compositeEntry\n}\n\nfunc (self CompositeEntry) readClass(classname string) ([]byte, Entry, error) {\n\t//entry\n\tfor _, entry := range self{\n\t\t//classreadClass\n\t\tdata, from, err := entry.readClass(classname)\n\t\tif err == nil{\n\t\t\treturn data,from,err\n\t\t}\n\t}\n\treturn nil,nil,errors.New(\"class not found :\" +classname)\n}\n//String\nfunc (self CompositeEntry) String() string {\n\tstrs := make([]string,len(self))\n\tfor i, entry := range self{\n\t\tstrs[i] = entry.String()\n\t}\n\treturn strings.Join(strs,pathListSeparator)\n}\n```\n#### WildcardEntry\nWildcardEntry*CompositeEntry\n```go\npackage classpath\n\nimport (\n\t\"strings\"\n\t\"os\"\n\t\"path/filepath\"\n)\n\nfunc newWildcardEntry(path string) CompositeEntry {\n\t//*\n\tbaseDir := path[:len(path)-1]\n\tvar compositeEntry []Entry\n\twalkFn := func(path string, info os.FileInfo, err error) error{\n\t\tif err != nil{\n\t\t\treturn err\n\t\t}\n\t\t//\n\t\tif info.IsDir() && path != baseDir {\n\t\t\treturn filepath.SkipDir\n\t\t}\n\t\t//jar\n\t\tif strings.HasSuffix(path,\".jar\") || strings.HasSuffix(path,\".JAR\"){\n\t\t\tjarEntry := newZipEntry(path)\n\t\t\tcompositeEntry = append(compositeEntry,jarEntry)\n\t\t}\n\t\treturn nil\n\t}\n\t//baseDirzipEntry\n\tfilepath.Walk(baseDir,walkFn)\n\t//fmt.Printf(\"compositeEntry : %s\\n\",compositeEntry)\n\treturn compositeEntry\n}\n```\n#### Entry\nEntryEntry\n````go\nfunc newEntry(path string) Entry {\n\t//\n\tif strings.Contains(path,pathListSeparator){\n\t\treturn newCompositeEntry(path)\n\t}\n\t//*\n\tif strings.HasSuffix(path,\"*\"){\n\t\treturn newWildcardEntry(path)\n\t}\n\t//jarzip\n\tif strings.HasSuffix(path,\".jar\") || strings.HasSuffix(path,\".JAR\")||\n\t\tstrings.HasSuffix(path,\".zip\") || strings.HasSuffix(path,\".ZIP\"){\n\t\t\treturn newZipEntry(path)\n\t}\n\treturn newDirEntry(path)\n}\n````\n#### Classpath\n```go\npackage classpath\n\nimport (\n\t\"path/filepath\"\n\t\"os\"\n\t\"fmt\"\n)\n\ntype Classpath struct {\n\tbootClasspath Entry\n\textClasspath Entry\n\tuserClasspath Entry\n}\n//-Xjre-classpath/-cp\nfunc Parse(jreOption,cpOption string) *Classpath  {\n\tcp := &Classpath{}\n\t//\n\tcp.parseBootAndExtClasspath(jreOption)\n\n\t//\n\tcp.parseUserClasspath(cpOption)\n\treturn cp\n}\n\nfunc getJreDir(jreOption string) string {\n\t//-Xjre\n\tif jreOption != \"\" && exists(jreOption){\n\t\treturn jreOption\n\t}\n\t//jre\n\tif exists(\"./jre\") {\n\t\treturn \"./jre\"\n\t}\n\t//JAVA_HOME\n\tif jh := os.Getenv(\"JAVA_HOME\"); jh != \"\"{\n\t\treturn filepath.Join(jh,\"jre\")\n\t}\n\tpanic(\"Can not find jre folder\")\n}\n\n//\nfunc exists(path string) bool {\n\tif _, err := os.Stat(path); err != nil{\n\t\tif os.IsNotExist(err){\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}\n\nfunc (self *Classpath) parseBootAndExtClasspath(jreOption string) {\n\t// jre\n\tjreDir := getJreDir(jreOption)\n\t//jre/lib/*\n\tjreLibPath := filepath.Join(jreDir,\"lib\",\"*\")\n\tself.bootClasspath = newWildcardEntry(jreLibPath)\n\t//jre/lib/ext/*\n\tjreExtPath := filepath.Join(jreDir,\"lib\",\"ext\",\"*\")\n\tself.extClasspath = newWildcardEntry(jreExtPath)\n}\n\n//\nfunc (self *Classpath) parseUserClasspath(cpOption string) {\n\t// -classpath/-cp\n\tif cpOption == \"\"{\n\t\tcpOption = \".\"\n\t}\n\tself.userClasspath = newEntry(cpOption)\n}\n\n//class\nfunc (self *Classpath) ReadClass(classname string) ([]byte, Entry, error) {\n\t//ReadClass\".class\"\n\tclassname = classname + \".class\"\n\t// bootClasspathclass\n\tif data, entry, err := self.bootClasspath.readClass(classname); err == nil{\n\t\treturn data, entry, err\n\t}\n\t// extClasspathclass\n\tif data, entry, err := self.extClasspath.readClass(classname); err == nil{\n\t\treturn data, entry, err\n\t}\n\t// userClasspathclass\n\treturn self.userClasspath.readClass(classname)\n}\n\nfunc (self *Classpath) String() string {\n\treturn self.userClasspath.String()\n}\n```\n### \n\nmain.gostartJVM\n```go\n//jvm\nfunc startJVM(cmd *Cmd)  {\n\t// Classpath\n\tcp := classpath.Parse(cmd.XjreOption,cmd.cpOption)\n\tfmt.Printf(\"classpath:%s class:%s args:%v\\n\",cp,cmd.class,cmd.args)\n\t// ./(java.lang.String -> java/lang/String)\n\tclassName := strings.Replace(cmd.class,\".\",\"/\",-1)\n\t// class\n\tclassData, _, err := cp.ReadClass(className)\n\tif err != nil {\n\t\tfmt.Printf(\"Could not find or load main class %s\\n\",cmd.class)\n\t\treturn\n\t}\n\tfmt.Printf(\"class data : %v\\n\",classData)\n}\n```\n\nmain.go-version\n```bash\n$ go install jvmgo/ch02 \n$ ch02 java.lang.String\n# -Xjre$JAVA_HOMEString.class\n$ ch02 -Xjre /opt  java.lang.Object \n# -XjreCould not find or load main class java.lang.Object\n```\n","source":"_posts/JVM2.md","raw":"---\ntitle: JAVAclass\ndate: 2019-02-12 16:14:04\ntags:\n    - JVM\n    - JAVA\n    - GO\n    - \ncategories: JVM\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n```java\npublic class HelloWorld {\n    public static void main(String[] args){\n        System.out.println(\"Hello, world!\");\n    }\n}\n```\njavajavamainHelloWorldjava.lang.Objectmain()java.lang.Stringjava.lang.String[]java.lang.Systemjava\n\n## \n\n * (bootstrap classpath)jre/libJava\n * (extention classpath)jre/lib/extJava\n * (user classpath).java-classpath\n\n<!-- more -->\n### \n\nch01ch02ch02classpath\n```base\n|-jvmgo\n    |-ch01\n    |-ch01\n        |-classpath\n        |-cmd.go\n        |-main.go\n```\ncmdXjreOption\n```go\ntype Cmd struct {\n\thelpFlag bool\n\tversionFlag bool\n\tcpOption string\n\tXjreOption string\n\tclass string\n\targs []string\n}\n```\nparseCmd()Xjre\n```go\n//\nfunc parseCmd() *Cmd {\n    ...//\n\tflag.StringVar(&cmd.cpOption,\"cp\",\"\",\"classpath\")\n\tflag.StringVar(&cmd.XjreOption,\"Xjre\",\"\",\"path to jre\")\n\t//flag\n\tflag.Parse()\n\t...//\n}\n```\n###  \n\n\n\nEntry\n```go\n//windows;UNIX:\nconst pathListSeparator = string(os.PathListSeparator)\n\ntype Entry interface {\n\t//class  class/.class\n\t//java.lang.Objectjava/lang/Object.class\n\treadClass(classname string) ([]byte, Entry, error)\n\n\t//toString\n\tString() string\n}\n```\nEntryCompositeEntryWildcardEntryZipEntryDirEntry\n#### DirEntry\nDirEntry\n```go\npackage classpath\n\nimport (\n\t\"path/filepath\"\n\t\"io/ioutil\"\n)\n\ntype DirEntry struct {\n\t//\n\tabsDir string\n}\n\n//\nfunc newDirEntry(path string) *DirEntry {\n\t//\n\tabsDir, err := filepath.Abs(path)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\treturn &DirEntry{absDir}\n}\n//class\nfunc (self *DirEntry) readClass (className string) ([]byte, Entry, error) {\n\t//class\n\tfileName := filepath.Join(self.absDir,className)\n\t//class\n\tdata, err := ioutil.ReadFile(fileName)\n\treturn data,self,err\n}\n\n//\nfunc (self *DirEntry) String() string{\n\treturn self.absDir\n}\n```\n#### ZipEntry\nZipEntryZIPJAR\n```go\npackage classpath\n\nimport (\n\t\"path/filepath\"\n\t\"archive/zip\"\n\t\"io/ioutil\"\n\t\"errors\"\n)\n\ntype ZipEntry struct {\n\t//\n\tabsPath string\n}\n\n//\nfunc newZipEntry(path string) *ZipEntry {\n\t//\n\tabsPath, err := filepath.Abs(path)\n\tif err != nil {\n\t\tpanic(err)\n\t}\n\treturn &ZipEntry{absPath}\n}\n\n//class\nfunc (self *ZipEntry) readClass(classname string) ([]byte, Entry, error) {\n\t//zip\n\tr, err := zip.OpenReader(self.absPath)\n\tif err != nil {\n\t\treturn nil,nil,err\n\t}\n\tdefer r.Close()\n\n\t//zip\n\tfor _, f := range r.File {\n\t\t//class\n\t\tif f.Name == classname {\n\t\t\t//class\n\t\t\trc , err := f.Open()\n\t\t\tif err != nil {\n\t\t\t\treturn nil,nil,err\n\t\t\t}\n\t\t\tdefer rc.Close()\n\t\t\t//class\n\t\t\tdata, err := ioutil.ReadAll(rc)\n\t\t\tif err != nil {\n\t\t\t\treturn nil,nil,err\n\t\t\t}\n\t\t\treturn data,self,err\n\t\t}\n\t}\n\t//class\n\treturn nil,nil,errors.New(\"class not found :\" +classname)\n}\n\n//\nfunc (self *ZipEntry) String() string {\n\treturn self.absPath\n}\n```\n#### CompositeEntry\nCompositeEntryCompositeEntryEntry[]Entrygoslice\n\n```go\npackage classpath\n\nimport (\n\t\"strings\"\n\t\"errors\"\n)\n\ntype CompositeEntry []Entry\n\n\n//Entry\nfunc newCompositeEntry(pathList string) CompositeEntry {\n\tvar compositeEntry []Entry\n\t//\n\tfor _, path := range strings.Split(pathList,pathListSeparator){\n\t\tentry := newEntry(path)\n\t\tcompositeEntry = append(compositeEntry,entry)\n\t}\n\treturn compositeEntry\n}\n\nfunc (self CompositeEntry) readClass(classname string) ([]byte, Entry, error) {\n\t//entry\n\tfor _, entry := range self{\n\t\t//classreadClass\n\t\tdata, from, err := entry.readClass(classname)\n\t\tif err == nil{\n\t\t\treturn data,from,err\n\t\t}\n\t}\n\treturn nil,nil,errors.New(\"class not found :\" +classname)\n}\n//String\nfunc (self CompositeEntry) String() string {\n\tstrs := make([]string,len(self))\n\tfor i, entry := range self{\n\t\tstrs[i] = entry.String()\n\t}\n\treturn strings.Join(strs,pathListSeparator)\n}\n```\n#### WildcardEntry\nWildcardEntry*CompositeEntry\n```go\npackage classpath\n\nimport (\n\t\"strings\"\n\t\"os\"\n\t\"path/filepath\"\n)\n\nfunc newWildcardEntry(path string) CompositeEntry {\n\t//*\n\tbaseDir := path[:len(path)-1]\n\tvar compositeEntry []Entry\n\twalkFn := func(path string, info os.FileInfo, err error) error{\n\t\tif err != nil{\n\t\t\treturn err\n\t\t}\n\t\t//\n\t\tif info.IsDir() && path != baseDir {\n\t\t\treturn filepath.SkipDir\n\t\t}\n\t\t//jar\n\t\tif strings.HasSuffix(path,\".jar\") || strings.HasSuffix(path,\".JAR\"){\n\t\t\tjarEntry := newZipEntry(path)\n\t\t\tcompositeEntry = append(compositeEntry,jarEntry)\n\t\t}\n\t\treturn nil\n\t}\n\t//baseDirzipEntry\n\tfilepath.Walk(baseDir,walkFn)\n\t//fmt.Printf(\"compositeEntry : %s\\n\",compositeEntry)\n\treturn compositeEntry\n}\n```\n#### Entry\nEntryEntry\n````go\nfunc newEntry(path string) Entry {\n\t//\n\tif strings.Contains(path,pathListSeparator){\n\t\treturn newCompositeEntry(path)\n\t}\n\t//*\n\tif strings.HasSuffix(path,\"*\"){\n\t\treturn newWildcardEntry(path)\n\t}\n\t//jarzip\n\tif strings.HasSuffix(path,\".jar\") || strings.HasSuffix(path,\".JAR\")||\n\t\tstrings.HasSuffix(path,\".zip\") || strings.HasSuffix(path,\".ZIP\"){\n\t\t\treturn newZipEntry(path)\n\t}\n\treturn newDirEntry(path)\n}\n````\n#### Classpath\n```go\npackage classpath\n\nimport (\n\t\"path/filepath\"\n\t\"os\"\n\t\"fmt\"\n)\n\ntype Classpath struct {\n\tbootClasspath Entry\n\textClasspath Entry\n\tuserClasspath Entry\n}\n//-Xjre-classpath/-cp\nfunc Parse(jreOption,cpOption string) *Classpath  {\n\tcp := &Classpath{}\n\t//\n\tcp.parseBootAndExtClasspath(jreOption)\n\n\t//\n\tcp.parseUserClasspath(cpOption)\n\treturn cp\n}\n\nfunc getJreDir(jreOption string) string {\n\t//-Xjre\n\tif jreOption != \"\" && exists(jreOption){\n\t\treturn jreOption\n\t}\n\t//jre\n\tif exists(\"./jre\") {\n\t\treturn \"./jre\"\n\t}\n\t//JAVA_HOME\n\tif jh := os.Getenv(\"JAVA_HOME\"); jh != \"\"{\n\t\treturn filepath.Join(jh,\"jre\")\n\t}\n\tpanic(\"Can not find jre folder\")\n}\n\n//\nfunc exists(path string) bool {\n\tif _, err := os.Stat(path); err != nil{\n\t\tif os.IsNotExist(err){\n\t\t\treturn false\n\t\t}\n\t}\n\treturn true\n}\n\nfunc (self *Classpath) parseBootAndExtClasspath(jreOption string) {\n\t// jre\n\tjreDir := getJreDir(jreOption)\n\t//jre/lib/*\n\tjreLibPath := filepath.Join(jreDir,\"lib\",\"*\")\n\tself.bootClasspath = newWildcardEntry(jreLibPath)\n\t//jre/lib/ext/*\n\tjreExtPath := filepath.Join(jreDir,\"lib\",\"ext\",\"*\")\n\tself.extClasspath = newWildcardEntry(jreExtPath)\n}\n\n//\nfunc (self *Classpath) parseUserClasspath(cpOption string) {\n\t// -classpath/-cp\n\tif cpOption == \"\"{\n\t\tcpOption = \".\"\n\t}\n\tself.userClasspath = newEntry(cpOption)\n}\n\n//class\nfunc (self *Classpath) ReadClass(classname string) ([]byte, Entry, error) {\n\t//ReadClass\".class\"\n\tclassname = classname + \".class\"\n\t// bootClasspathclass\n\tif data, entry, err := self.bootClasspath.readClass(classname); err == nil{\n\t\treturn data, entry, err\n\t}\n\t// extClasspathclass\n\tif data, entry, err := self.extClasspath.readClass(classname); err == nil{\n\t\treturn data, entry, err\n\t}\n\t// userClasspathclass\n\treturn self.userClasspath.readClass(classname)\n}\n\nfunc (self *Classpath) String() string {\n\treturn self.userClasspath.String()\n}\n```\n### \n\nmain.gostartJVM\n```go\n//jvm\nfunc startJVM(cmd *Cmd)  {\n\t// Classpath\n\tcp := classpath.Parse(cmd.XjreOption,cmd.cpOption)\n\tfmt.Printf(\"classpath:%s class:%s args:%v\\n\",cp,cmd.class,cmd.args)\n\t// ./(java.lang.String -> java/lang/String)\n\tclassName := strings.Replace(cmd.class,\".\",\"/\",-1)\n\t// class\n\tclassData, _, err := cp.ReadClass(className)\n\tif err != nil {\n\t\tfmt.Printf(\"Could not find or load main class %s\\n\",cmd.class)\n\t\treturn\n\t}\n\tfmt.Printf(\"class data : %v\\n\",classData)\n}\n```\n\nmain.go-version\n```bash\n$ go install jvmgo/ch02 \n$ ch02 java.lang.String\n# -Xjre$JAVA_HOMEString.class\n$ ch02 -Xjre /opt  java.lang.Object \n# -XjreCould not find or load main class java.lang.Object\n```\n","slug":"JVM2","published":1,"updated":"2019-07-30T11:37:16.772Z","layout":"post","photos":[],"link":"","_id":"ck4859y95003nt0fy0uoxgqzp","content":"<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HelloWorld</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Hello, world!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>javajavamainHelloWorldjava.lang.Objectmain()java.lang.Stringjava.lang.String[]java.lang.Systemjava</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li>(bootstrap classpath)jre/libJava</li>\n<li>(extention classpath)jre/lib/extJava</li>\n<li>(user classpath).java-classpath</li>\n</ul>\n<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ch01ch02ch02classpath</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|-jvmgo</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">        |-classpath</span><br><span class=\"line\">        |-cmd.go</span><br><span class=\"line\">        |-main.go</span><br></pre></td></tr></table></figure>\n\n<p>cmdXjreOption</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Cmd <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\thelpFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tversionFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tcpOption <span class=\"keyword\">string</span></span><br><span class=\"line\">\tXjreOption <span class=\"keyword\">string</span></span><br><span class=\"line\">\tclass <span class=\"keyword\">string</span></span><br><span class=\"line\">\targs []<span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>parseCmd()Xjre</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parseCmd</span><span class=\"params\">()</span> *<span class=\"title\">Cmd</span></span> &#123;</span><br><span class=\"line\">    ...<span class=\"comment\">//</span></span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.cpOption,<span class=\"string\">\"cp\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"classpath\"</span>)</span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.XjreOption,<span class=\"string\">\"Xjre\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"path to jre\"</span>)</span><br><span class=\"line\">\t<span class=\"comment\">//flag</span></span><br><span class=\"line\">\tflag.Parse()</span><br><span class=\"line\">\t...<span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Entry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//windows;UNIX:</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> pathListSeparator = <span class=\"keyword\">string</span>(os.PathListSeparator)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Entry <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//class  class/.class</span></span><br><span class=\"line\">\t<span class=\"comment\">//java.lang.Objectjava/lang/Object.class</span></span><br><span class=\"line\">\treadClass(classname <span class=\"keyword\">string</span>) ([]<span class=\"keyword\">byte</span>, Entry, error)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//toString</span></span><br><span class=\"line\">\tString() <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>EntryCompositeEntryWildcardEntryZipEntryDirEntry</p>\n<h4 id=\"DirEntry\"><a href=\"#DirEntry\" class=\"headerlink\" title=\"DirEntry\"></a>DirEntry</h4><p>DirEntry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> DirEntry <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsDir <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newDirEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> *<span class=\"title\">DirEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsDir, err := filepath.Abs(path)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &amp;DirEntry&#123;absDir&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//class</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *DirEntry)</span> <span class=\"title\">readClass</span> <span class=\"params\">(className <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\tfileName := filepath.Join(self.absDir,className)</span><br><span class=\"line\">\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\tdata, err := ioutil.ReadFile(fileName)</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> data,self,err</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *DirEntry)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.absDir</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ZipEntry\"><a href=\"#ZipEntry\" class=\"headerlink\" title=\"ZipEntry\"></a>ZipEntry</h4><p>ZipEntryZIPJAR</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"archive/zip\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"errors\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ZipEntry <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsPath <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newZipEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> *<span class=\"title\">ZipEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsPath, err := filepath.Abs(path)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &amp;ZipEntry&#123;absPath&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//class</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *ZipEntry)</span> <span class=\"title\">readClass</span><span class=\"params\">(classname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//zip</span></span><br><span class=\"line\">\tr, err := zip.OpenReader(self.absPath)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> r.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//zip</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, f := <span class=\"keyword\">range</span> r.File &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> f.Name == classname &#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t\t\trc , err := f.Open()</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,err</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">defer</span> rc.Close()</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t\t\tdata, err := ioutil.ReadAll(rc)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,err</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> data,self,err</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,errors.New(<span class=\"string\">\"class not found :\"</span> +classname)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *ZipEntry)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.absPath</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"CompositeEntry\"><a href=\"#CompositeEntry\" class=\"headerlink\" title=\"CompositeEntry\"></a>CompositeEntry</h4><p>CompositeEntryCompositeEntryEntry[]Entrygoslice</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"strings\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"errors\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> CompositeEntry []Entry</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Entry</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newCompositeEntry</span><span class=\"params\">(pathList <span class=\"keyword\">string</span>)</span> <span class=\"title\">CompositeEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> compositeEntry []Entry</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, path := <span class=\"keyword\">range</span> strings.Split(pathList,pathListSeparator)&#123;</span><br><span class=\"line\">\t\tentry := newEntry(path)</span><br><span class=\"line\">\t\tcompositeEntry = <span class=\"built_in\">append</span>(compositeEntry,entry)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> compositeEntry</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self CompositeEntry)</span> <span class=\"title\">readClass</span><span class=\"params\">(classname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//entry</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, entry := <span class=\"keyword\">range</span> self&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//classreadClass</span></span><br><span class=\"line\">\t\tdata, from, err := entry.readClass(classname)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err == <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> data,from,err</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,errors.New(<span class=\"string\">\"class not found :\"</span> +classname)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//String</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self CompositeEntry)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\tstrs := <span class=\"built_in\">make</span>([]<span class=\"keyword\">string</span>,<span class=\"built_in\">len</span>(self))</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i, entry := <span class=\"keyword\">range</span> self&#123;</span><br><span class=\"line\">\t\tstrs[i] = entry.String()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> strings.Join(strs,pathListSeparator)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"WildcardEntry\"><a href=\"#WildcardEntry\" class=\"headerlink\" title=\"WildcardEntry\"></a>WildcardEntry</h4><p>WildcardEntry*CompositeEntry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"strings\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newWildcardEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">CompositeEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//*</span></span><br><span class=\"line\">\tbaseDir := path[:<span class=\"built_in\">len</span>(path)<span class=\"number\">-1</span>]</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> compositeEntry []Entry</span><br><span class=\"line\">\twalkFn := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(path <span class=\"keyword\">string</span>, info os.FileInfo, err error)</span> <span class=\"title\">error</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> err</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> info.IsDir() &amp;&amp; path != baseDir &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> filepath.SkipDir</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//jar</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> strings.HasSuffix(path,<span class=\"string\">\".jar\"</span>) || strings.HasSuffix(path,<span class=\"string\">\".JAR\"</span>)&#123;</span><br><span class=\"line\">\t\t\tjarEntry := newZipEntry(path)</span><br><span class=\"line\">\t\t\tcompositeEntry = <span class=\"built_in\">append</span>(compositeEntry,jarEntry)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//baseDirzipEntry</span></span><br><span class=\"line\">\tfilepath.Walk(baseDir,walkFn)</span><br><span class=\"line\">\t<span class=\"comment\">//fmt.Printf(\"compositeEntry : %s\\n\",compositeEntry)</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> compositeEntry</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Entry\"><a href=\"#Entry\" class=\"headerlink\" title=\"Entry\"></a>Entry</h4><p>EntryEntry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">Entry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> strings.Contains(path,pathListSeparator)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> newCompositeEntry(path)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//*</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> strings.HasSuffix(path,<span class=\"string\">\"*\"</span>)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> newWildcardEntry(path)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//jarzip</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> strings.HasSuffix(path,<span class=\"string\">\".jar\"</span>) || strings.HasSuffix(path,<span class=\"string\">\".JAR\"</span>)||</span><br><span class=\"line\">\t\tstrings.HasSuffix(path,<span class=\"string\">\".zip\"</span>) || strings.HasSuffix(path,<span class=\"string\">\".ZIP\"</span>)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> newZipEntry(path)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> newDirEntry(path)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Classpath\"><a href=\"#Classpath\" class=\"headerlink\" title=\"Classpath\"></a>Classpath</h4><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Classpath <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tbootClasspath Entry</span><br><span class=\"line\">\textClasspath Entry</span><br><span class=\"line\">\tuserClasspath Entry</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//-Xjre-classpath/-cp</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Parse</span><span class=\"params\">(jreOption,cpOption <span class=\"keyword\">string</span>)</span> *<span class=\"title\">Classpath</span></span>  &#123;</span><br><span class=\"line\">\tcp := &amp;Classpath&#123;&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tcp.parseBootAndExtClasspath(jreOption)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tcp.parseUserClasspath(cpOption)</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> cp</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getJreDir</span><span class=\"params\">(jreOption <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//-Xjre</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> jreOption != <span class=\"string\">\"\"</span> &amp;&amp; exists(jreOption)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> jreOption</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//jre</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> exists(<span class=\"string\">\"./jre\"</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"./jre\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//JAVA_HOME</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> jh := os.Getenv(<span class=\"string\">\"JAVA_HOME\"</span>); jh != <span class=\"string\">\"\"</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> filepath.Join(jh,<span class=\"string\">\"jre\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">panic</span>(<span class=\"string\">\"Can not find jre folder\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">exists</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> _, err := os.Stat(path); err != <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> os.IsNotExist(err)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">parseBootAndExtClasspath</span><span class=\"params\">(jreOption <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// jre</span></span><br><span class=\"line\">\tjreDir := getJreDir(jreOption)</span><br><span class=\"line\">\t<span class=\"comment\">//jre/lib/*</span></span><br><span class=\"line\">\tjreLibPath := filepath.Join(jreDir,<span class=\"string\">\"lib\"</span>,<span class=\"string\">\"*\"</span>)</span><br><span class=\"line\">\tself.bootClasspath = newWildcardEntry(jreLibPath)</span><br><span class=\"line\">\t<span class=\"comment\">//jre/lib/ext/*</span></span><br><span class=\"line\">\tjreExtPath := filepath.Join(jreDir,<span class=\"string\">\"lib\"</span>,<span class=\"string\">\"ext\"</span>,<span class=\"string\">\"*\"</span>)</span><br><span class=\"line\">\tself.extClasspath = newWildcardEntry(jreExtPath)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">parseUserClasspath</span><span class=\"params\">(cpOption <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// -classpath/-cp</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> cpOption == <span class=\"string\">\"\"</span>&#123;</span><br><span class=\"line\">\t\tcpOption = <span class=\"string\">\".\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tself.userClasspath = newEntry(cpOption)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//class</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">ReadClass</span><span class=\"params\">(classname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//ReadClass\".class\"</span></span><br><span class=\"line\">\tclassname = classname + <span class=\"string\">\".class\"</span></span><br><span class=\"line\">\t<span class=\"comment\">// bootClasspathclass</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> data, entry, err := self.bootClasspath.readClass(classname); err == <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> data, entry, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// extClasspathclass</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> data, entry, err := self.extClasspath.readClass(classname); err == <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> data, entry, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// userClasspathclass</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.userClasspath.readClass(classname)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.userClasspath.String()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>main.gostartJVM</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//jvm</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">startJVM</span><span class=\"params\">(cmd *Cmd)</span></span>  &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// Classpath</span></span><br><span class=\"line\">\tcp := classpath.Parse(cmd.XjreOption,cmd.cpOption)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"classpath:%s class:%s args:%v\\n\"</span>,cp,cmd.class,cmd.args)</span><br><span class=\"line\">\t<span class=\"comment\">// ./(java.lang.String -&gt; java/lang/String)</span></span><br><span class=\"line\">\tclassName := strings.Replace(cmd.class,<span class=\"string\">\".\"</span>,<span class=\"string\">\"/\"</span>,<span class=\"number\">-1</span>)</span><br><span class=\"line\">\t<span class=\"comment\">// class</span></span><br><span class=\"line\">\tclassData, _, err := cp.ReadClass(className)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"Could not find or load main class %s\\n\"</span>,cmd.class)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"class data : %v\\n\"</span>,classData)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>main.go-version</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go install jvmgo/ch02 </span><br><span class=\"line\">$ ch02 java.lang.String</span><br><span class=\"line\"><span class=\"comment\"># -Xjre$JAVA_HOMEString.class</span></span><br><span class=\"line\">$ ch02 -Xjre /opt  java.lang.Object </span><br><span class=\"line\"><span class=\"comment\"># -XjreCould not find or load main class java.lang.Object</span></span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">HelloWorld</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span></span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"Hello, world!\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>javajavamainHelloWorldjava.lang.Objectmain()java.lang.Stringjava.lang.String[]java.lang.Systemjava</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li>(bootstrap classpath)jre/libJava</li>\n<li>(extention classpath)jre/lib/extJava</li>\n<li>(user classpath).java-classpath</li>\n</ul>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>ch01ch02ch02classpath</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">|-jvmgo</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">    |-ch01</span><br><span class=\"line\">        |-classpath</span><br><span class=\"line\">        |-cmd.go</span><br><span class=\"line\">        |-main.go</span><br></pre></td></tr></table></figure>\n\n<p>cmdXjreOption</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">type</span> Cmd <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\thelpFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tversionFlag <span class=\"keyword\">bool</span></span><br><span class=\"line\">\tcpOption <span class=\"keyword\">string</span></span><br><span class=\"line\">\tXjreOption <span class=\"keyword\">string</span></span><br><span class=\"line\">\tclass <span class=\"keyword\">string</span></span><br><span class=\"line\">\targs []<span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>parseCmd()Xjre</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">parseCmd</span><span class=\"params\">()</span> *<span class=\"title\">Cmd</span></span> &#123;</span><br><span class=\"line\">    ...<span class=\"comment\">//</span></span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.cpOption,<span class=\"string\">\"cp\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"classpath\"</span>)</span><br><span class=\"line\">\tflag.StringVar(&amp;cmd.XjreOption,<span class=\"string\">\"Xjre\"</span>,<span class=\"string\">\"\"</span>,<span class=\"string\">\"path to jre\"</span>)</span><br><span class=\"line\">\t<span class=\"comment\">//flag</span></span><br><span class=\"line\">\tflag.Parse()</span><br><span class=\"line\">\t...<span class=\"comment\">//</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p></p>\n<p>Entry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//windows;UNIX:</span></span><br><span class=\"line\"><span class=\"keyword\">const</span> pathListSeparator = <span class=\"keyword\">string</span>(os.PathListSeparator)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Entry <span class=\"keyword\">interface</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//class  class/.class</span></span><br><span class=\"line\">\t<span class=\"comment\">//java.lang.Objectjava/lang/Object.class</span></span><br><span class=\"line\">\treadClass(classname <span class=\"keyword\">string</span>) ([]<span class=\"keyword\">byte</span>, Entry, error)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//toString</span></span><br><span class=\"line\">\tString() <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>EntryCompositeEntryWildcardEntryZipEntryDirEntry</p>\n<h4 id=\"DirEntry\"><a href=\"#DirEntry\" class=\"headerlink\" title=\"DirEntry\"></a>DirEntry</h4><p>DirEntry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> DirEntry <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsDir <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newDirEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> *<span class=\"title\">DirEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsDir, err := filepath.Abs(path)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &amp;DirEntry&#123;absDir&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//class</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *DirEntry)</span> <span class=\"title\">readClass</span> <span class=\"params\">(className <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\tfileName := filepath.Join(self.absDir,className)</span><br><span class=\"line\">\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\tdata, err := ioutil.ReadFile(fileName)</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> data,self,err</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *DirEntry)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.absDir</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"ZipEntry\"><a href=\"#ZipEntry\" class=\"headerlink\" title=\"ZipEntry\"></a>ZipEntry</h4><p>ZipEntryZIPJAR</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"archive/zip\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"io/ioutil\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"errors\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> ZipEntry <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsPath <span class=\"keyword\">string</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newZipEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> *<span class=\"title\">ZipEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tabsPath, err := filepath.Abs(path)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">panic</span>(err)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> &amp;ZipEntry&#123;absPath&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//class</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *ZipEntry)</span> <span class=\"title\">readClass</span><span class=\"params\">(classname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//zip</span></span><br><span class=\"line\">\tr, err := zip.OpenReader(self.absPath)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">defer</span> r.Close()</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//zip</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, f := <span class=\"keyword\">range</span> r.File &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> f.Name == classname &#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t\t\trc , err := f.Open()</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,err</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">defer</span> rc.Close()</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t\t\tdata, err := ioutil.ReadAll(rc)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,err</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> data,self,err</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//class</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,errors.New(<span class=\"string\">\"class not found :\"</span> +classname)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *ZipEntry)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.absPath</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"CompositeEntry\"><a href=\"#CompositeEntry\" class=\"headerlink\" title=\"CompositeEntry\"></a>CompositeEntry</h4><p>CompositeEntryCompositeEntryEntry[]Entrygoslice</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"strings\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"errors\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> CompositeEntry []Entry</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//Entry</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newCompositeEntry</span><span class=\"params\">(pathList <span class=\"keyword\">string</span>)</span> <span class=\"title\">CompositeEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> compositeEntry []Entry</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, path := <span class=\"keyword\">range</span> strings.Split(pathList,pathListSeparator)&#123;</span><br><span class=\"line\">\t\tentry := newEntry(path)</span><br><span class=\"line\">\t\tcompositeEntry = <span class=\"built_in\">append</span>(compositeEntry,entry)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> compositeEntry</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self CompositeEntry)</span> <span class=\"title\">readClass</span><span class=\"params\">(classname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//entry</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> _, entry := <span class=\"keyword\">range</span> self&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//classreadClass</span></span><br><span class=\"line\">\t\tdata, from, err := entry.readClass(classname)</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err == <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> data,from,err</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span>,<span class=\"literal\">nil</span>,errors.New(<span class=\"string\">\"class not found :\"</span> +classname)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//String</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self CompositeEntry)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\tstrs := <span class=\"built_in\">make</span>([]<span class=\"keyword\">string</span>,<span class=\"built_in\">len</span>(self))</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> i, entry := <span class=\"keyword\">range</span> self&#123;</span><br><span class=\"line\">\t\tstrs[i] = entry.String()</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> strings.Join(strs,pathListSeparator)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"WildcardEntry\"><a href=\"#WildcardEntry\" class=\"headerlink\" title=\"WildcardEntry\"></a>WildcardEntry</h4><p>WildcardEntry*CompositeEntry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"strings\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newWildcardEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">CompositeEntry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//*</span></span><br><span class=\"line\">\tbaseDir := path[:<span class=\"built_in\">len</span>(path)<span class=\"number\">-1</span>]</span><br><span class=\"line\">\t<span class=\"keyword\">var</span> compositeEntry []Entry</span><br><span class=\"line\">\twalkFn := <span class=\"function\"><span class=\"keyword\">func</span><span class=\"params\">(path <span class=\"keyword\">string</span>, info os.FileInfo, err error)</span> <span class=\"title\">error</span></span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> err</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> info.IsDir() &amp;&amp; path != baseDir &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> filepath.SkipDir</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//jar</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> strings.HasSuffix(path,<span class=\"string\">\".jar\"</span>) || strings.HasSuffix(path,<span class=\"string\">\".JAR\"</span>)&#123;</span><br><span class=\"line\">\t\t\tjarEntry := newZipEntry(path)</span><br><span class=\"line\">\t\t\tcompositeEntry = <span class=\"built_in\">append</span>(compositeEntry,jarEntry)</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"literal\">nil</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//baseDirzipEntry</span></span><br><span class=\"line\">\tfilepath.Walk(baseDir,walkFn)</span><br><span class=\"line\">\t<span class=\"comment\">//fmt.Printf(\"compositeEntry : %s\\n\",compositeEntry)</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> compositeEntry</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Entry\"><a href=\"#Entry\" class=\"headerlink\" title=\"Entry\"></a>Entry</h4><p>EntryEntry</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">newEntry</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">Entry</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> strings.Contains(path,pathListSeparator)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> newCompositeEntry(path)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//*</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> strings.HasSuffix(path,<span class=\"string\">\"*\"</span>)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> newWildcardEntry(path)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//jarzip</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> strings.HasSuffix(path,<span class=\"string\">\".jar\"</span>) || strings.HasSuffix(path,<span class=\"string\">\".JAR\"</span>)||</span><br><span class=\"line\">\t\tstrings.HasSuffix(path,<span class=\"string\">\".zip\"</span>) || strings.HasSuffix(path,<span class=\"string\">\".ZIP\"</span>)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> newZipEntry(path)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> newDirEntry(path)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"Classpath\"><a href=\"#Classpath\" class=\"headerlink\" title=\"Classpath\"></a>Classpath</h4><figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> classpath</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> (</span><br><span class=\"line\">\t<span class=\"string\">\"path/filepath\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"os\"</span></span><br><span class=\"line\">\t<span class=\"string\">\"fmt\"</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">type</span> Classpath <span class=\"keyword\">struct</span> &#123;</span><br><span class=\"line\">\tbootClasspath Entry</span><br><span class=\"line\">\textClasspath Entry</span><br><span class=\"line\">\tuserClasspath Entry</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//-Xjre-classpath/-cp</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">Parse</span><span class=\"params\">(jreOption,cpOption <span class=\"keyword\">string</span>)</span> *<span class=\"title\">Classpath</span></span>  &#123;</span><br><span class=\"line\">\tcp := &amp;Classpath&#123;&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tcp.parseBootAndExtClasspath(jreOption)</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tcp.parseUserClasspath(cpOption)</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> cp</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">getJreDir</span><span class=\"params\">(jreOption <span class=\"keyword\">string</span>)</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//-Xjre</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> jreOption != <span class=\"string\">\"\"</span> &amp;&amp; exists(jreOption)&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> jreOption</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//jre</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> exists(<span class=\"string\">\"./jre\"</span>) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">\"./jre\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//JAVA_HOME</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> jh := os.Getenv(<span class=\"string\">\"JAVA_HOME\"</span>); jh != <span class=\"string\">\"\"</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> filepath.Join(jh,<span class=\"string\">\"jre\"</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"built_in\">panic</span>(<span class=\"string\">\"Can not find jre folder\"</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">exists</span><span class=\"params\">(path <span class=\"keyword\">string</span>)</span> <span class=\"title\">bool</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> _, err := os.Stat(path); err != <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> os.IsNotExist(err)&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"literal\">false</span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">parseBootAndExtClasspath</span><span class=\"params\">(jreOption <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// jre</span></span><br><span class=\"line\">\tjreDir := getJreDir(jreOption)</span><br><span class=\"line\">\t<span class=\"comment\">//jre/lib/*</span></span><br><span class=\"line\">\tjreLibPath := filepath.Join(jreDir,<span class=\"string\">\"lib\"</span>,<span class=\"string\">\"*\"</span>)</span><br><span class=\"line\">\tself.bootClasspath = newWildcardEntry(jreLibPath)</span><br><span class=\"line\">\t<span class=\"comment\">//jre/lib/ext/*</span></span><br><span class=\"line\">\tjreExtPath := filepath.Join(jreDir,<span class=\"string\">\"lib\"</span>,<span class=\"string\">\"ext\"</span>,<span class=\"string\">\"*\"</span>)</span><br><span class=\"line\">\tself.extClasspath = newWildcardEntry(jreExtPath)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">parseUserClasspath</span><span class=\"params\">(cpOption <span class=\"keyword\">string</span>)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// -classpath/-cp</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> cpOption == <span class=\"string\">\"\"</span>&#123;</span><br><span class=\"line\">\t\tcpOption = <span class=\"string\">\".\"</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tself.userClasspath = newEntry(cpOption)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//class</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">ReadClass</span><span class=\"params\">(classname <span class=\"keyword\">string</span>)</span> <span class=\"params\">([]<span class=\"keyword\">byte</span>, Entry, error)</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"comment\">//ReadClass\".class\"</span></span><br><span class=\"line\">\tclassname = classname + <span class=\"string\">\".class\"</span></span><br><span class=\"line\">\t<span class=\"comment\">// bootClasspathclass</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> data, entry, err := self.bootClasspath.readClass(classname); err == <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> data, entry, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// extClasspathclass</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> data, entry, err := self.extClasspath.readClass(classname); err == <span class=\"literal\">nil</span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> data, entry, err</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">// userClasspathclass</span></span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.userClasspath.readClass(classname)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"params\">(self *Classpath)</span> <span class=\"title\">String</span><span class=\"params\">()</span> <span class=\"title\">string</span></span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> self.userClasspath.String()</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>main.gostartJVM</p>\n<figure class=\"highlight go\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//jvm</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">startJVM</span><span class=\"params\">(cmd *Cmd)</span></span>  &#123;</span><br><span class=\"line\">\t<span class=\"comment\">// Classpath</span></span><br><span class=\"line\">\tcp := classpath.Parse(cmd.XjreOption,cmd.cpOption)</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"classpath:%s class:%s args:%v\\n\"</span>,cp,cmd.class,cmd.args)</span><br><span class=\"line\">\t<span class=\"comment\">// ./(java.lang.String -&gt; java/lang/String)</span></span><br><span class=\"line\">\tclassName := strings.Replace(cmd.class,<span class=\"string\">\".\"</span>,<span class=\"string\">\"/\"</span>,<span class=\"number\">-1</span>)</span><br><span class=\"line\">\t<span class=\"comment\">// class</span></span><br><span class=\"line\">\tclassData, _, err := cp.ReadClass(className)</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> err != <span class=\"literal\">nil</span> &#123;</span><br><span class=\"line\">\t\tfmt.Printf(<span class=\"string\">\"Could not find or load main class %s\\n\"</span>,cmd.class)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tfmt.Printf(<span class=\"string\">\"class data : %v\\n\"</span>,classData)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>main.go-version</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$ go install jvmgo/ch02 </span><br><span class=\"line\">$ ch02 java.lang.String</span><br><span class=\"line\"><span class=\"comment\"># -Xjre$JAVA_HOMEString.class</span></span><br><span class=\"line\">$ ch02 -Xjre /opt  java.lang.Object </span><br><span class=\"line\"><span class=\"comment\"># -XjreCould not find or load main class java.lang.Object</span></span><br></pre></td></tr></table></figure>"},{"title":"JAVA-CAS","date":"2019-10-23T06:41:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"# CAS\n\nCASCAS\n<!-- more -->\n## \nCAS Compare And Swap  CAS \njava.util.concurrent  CAS  ReenterLock  AQS CAS\n\n## \n CAS \nvolatile \nsynchronized  JVM \n\n```java\npublic class Test {\n  public volatile int i;\n  public void add() {\n    i++;\n  }\n}\n```\n `javap -c Test.class` add\n```java\npublic void add();\n    Code:\n       0: aload_0\n       1: dup\n       2: getfield      #2                  // Field n:I\n       5: iconst_1\n       6: iadd\n       7: putfield      #2                  // Field n:I\n      10: return\n\n```\ni++\n    1. getfieldi\n    2. iadd1\n    3. putfieldi\n\n 1  1 \n 2  2 1 2 \n\n\n add  synchronized \n\n```java\npublic class Test {\n  public volatile int i;\n  public synchronized void add() {\n    i++;\n  }\n}\n```\n\n\n## CAS\nCAS3VAB\nAV B  true false\n\n### \n\n`AtomicInteger`CAS\n\n```java\npublic class AtomicInteger extends Number implements java.io.Serializable {\n    private static final long serialVersionUID = 6214790243416807050L;\n\n    // setup to use Unsafe.compareAndSwapInt for updates\n    private static final Unsafe unsafe = Unsafe.getUnsafe();\n    private static final long valueOffset;\n\n    static {\n        try {\n            valueOffset = unsafe.objectFieldOffset\n                (AtomicInteger.class.getDeclaredField(\"value\"));\n        } catch (Exception ex) { throw new Error(ex); }\n    }\n\n    private volatile int value;\n    // \n}\n\n```\n**Unsafe**CAS C/C++ \n**valueOffset**Unsafe\n**value**volatile\n\n\n`AtomicInteger`\n```java\n    // AtomicInteger.getAndAdd\n    public final int getAndAdd(int delta) {\n        return unsafe.getAndAddInt(this, valueOffset, delta);\n    }\n    \n    // unsafe.getAndAddInt\n    public final int getAndAddInt(Object var1, long var2, int var4) {\n        int var5;\n        do {\n            var5 = this.getIntVolatile(var1, var2);\n        } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n        return var5;\n    }\n```\nABgetAndAddCPU\n\nAtomicIntegervalue nJavaABvaluen\n1. A`getIntVolatile(var1, var2)`value nA\n2. B`getIntVolatile(var1, var2)`value nBcompareAndSwapInt n m\n3. A`compareAndSwapInt`(n)(m)\n4. valuevaluevolatileAA`compareAndSwapInt`\n\nUnsafecompareAndSwapInt\n```java\npublic final native boolean compareAndSwapInt(Object var1, long var2, int var4, int var5);\n```\nJava  CASCAS  C++ Java  JNI  unsafe.cpp\nOpenJDK8: openjdk/hotspot/src/share/vm/prims/unsafe.cpp\n```C\nUNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))\n  UnsafeWrapper(\"Unsafe_CompareAndSwapInt\");\n  oop p = JNIHandles::resolve(obj);\n  jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);\n  return (jint)(Atomic::cmpxchg(x, addr, e)) == e;\nUNSAFE_END\n```\n\n1. objAtomicInteger JNIHandles::resolve() objOOPp\n2. valueoffsetaddr\n3. xaddreAtomic::cmpxchg(x, addr, e)\n4. Atomic::cmpxchg(x, addr, e)CAS\nOpenJDK8: openjdk/hotspot/src/share/vm/runtime/atomic.cpp\n\n\n```C\njbyte Atomic::cmpxchg(jbyte exchange_value, volatile jbyte* dest, jbyte compare_value) {\n  assert(sizeof(jbyte) == 1, \"assumption.\");\n  uintptr_t dest_addr = (uintptr_t)dest;\n  uintptr_t offset = dest_addr % sizeof(jint);\n  volatile jint* dest_int = (volatile jint*)(dest_addr - offset);\n  jint cur = *dest_int;\n  jbyte* cur_as_bytes = (jbyte*)(&cur);\n  jint new_val = cur;\n  jbyte* new_val_as_bytes = (jbyte*)(&new_val);\n  new_val_as_bytes[offset] = exchange_value;\n  while (cur_as_bytes[offset] == compare_value) {\n    jint res = cmpxchg(new_val, dest_int, cur);\n    if (res == cur) break;\n    cur = res;\n    new_val = cur;\n    new_val_as_bytes[offset] = exchange_value;\n  }\n  return cur_as_bytes[offset];\n}\n```\n\ncmpxchg. , . \n\n```C\n#include \"runtime/atomic.inline.hpp\"\n```\n\natomic.inline.hpp, , cmpxchg().\n\n```C\n#include \"runtime/atomic.hpp\"\n\n// Linux\n#ifdef TARGET_OS_ARCH_linux_x86\n# include \"atomic_linux_x86.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_sparc\n# include \"atomic_linux_sparc.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_zero\n# include \"atomic_linux_zero.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_arm\n# include \"atomic_linux_arm.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_ppc\n# include \"atomic_linux_ppc.inline.hpp\"\n#endif\n\n// Solaris\n#ifdef TARGET_OS_ARCH_solaris_x86\n# include \"atomic_solaris_x86.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_solaris_sparc\n# include \"atomic_solaris_sparc.inline.hpp\"\n#endif\n\n// Windows\n#ifdef TARGET_OS_ARCH_windows_x86\n# include \"atomic_windows_x86.inline.hpp\"\n#endif\n\n// ..\n```\nlinux x86, atomic_linux_x86.inline.hpp\nOpenJDK: openjdk/hotspot/src/os_cpu/linux_x86/vm/atomic_linux_x86.inline.hpp\n\n```C\n#define LOCK_IF_MP(mp) \"cmp $0, \" #mp \"; je 1f; lock; 1: \"\n\ninline jint     Atomic::cmpxchg    (jint     exchange_value, volatile jint*     dest, jint     compare_value) {\n  int mp = os::is_MP();\n  __asm__ volatile (LOCK_IF_MP(%4) \"cmpxchgl %1,(%3)\"\n                    : \"=a\" (exchange_value)\n                    : \"r\" (exchange_value), \"a\" (compare_value), \"r\" (dest), \"r\" (mp)\n                    : \"cc\", \"memory\");\n  return exchange_value;\n}\n```\n\n\n`__asm__`\n`volatile`\n`cmpxchgl`x86\n`LOCK_IF_MP`cmpxchg1lock\n\n\nC\n```C\n__asm__ volatile(\"Instruction List\"\n \n: Output\n \n: Input\n \n: Clobber/Modify);\n```\n**instruction list**\n**Clobber/Modify**/,GCC,GCC;Clobber/Modify\n\n\n%0%0%1%9eax%0exchange_valuecompare_valuedestmp%1%2%3%4\nasm**cmpxchgl %1,(%3)**eax(compare_valueeax)dest**exchange_value**destdesteax\n: \"=a\" (**exchange_value**) eax(compare_value)**exchange_value**\n        \n`Atomic::cmpxchg`exchange_value\n1. cmpxchglcompare_valuedestdest**exchange_value**eaxcompare_value**exchange_value**compare_value\n   Unsafe_CompareAndSwapInt(jint)(Atomic::cmpxchg(x, addr, e)) == etrueCAS\n\n2. cmpxchglcompare_value(dest)desteax**exchange_value**\n   (jint)(Atomic::cmpxchg(x, addr, e)) == efalseCAS\n\n\n### lock\nlock\n,\n\n X86 CPU  LOCK  LOCK  CPU  LOCK# \n\n## \n1. CPUCPU\n2. CASSynchronized\n3. ABACAS\n\n## ABA\n 1  V  A 2  V  A 1  2  V  B A\n 1  V  1 VA->B->A\n\n\nCAS10050\n10050\n\n110050250\n2350100\n2100compare10010050\n50\n\nCASCompareAV\nJava`AtomicStampedReference`CAS\n\n```java\n    private static class Pair<T> {\n        final T reference;\n        final int stamp;\n        private Pair(T reference, int stamp) {\n            this.reference = reference;\n            this.stamp = stamp;\n        }\n        static <T> Pair<T> of(T reference, int stamp) {\n            return new Pair<T>(reference, stamp);\n        }\n    }\n```\nAtomicStampedReference  Pair, reference stamp \n\n```java\n    public boolean compareAndSet(V   expectedReference,\n                                 V   newReference,\n                                 int expectedStamp,\n                                 int newStamp) {\n        Pair<V> current = pair;\n        return\n            expectedReference == current.reference &&\n            expectedStamp == current.stamp &&\n            ((newReference == current.reference &&\n              newStamp == current.stamp) ||\n             casPair(current, Pair.of(newReference, newStamp)));\n    }\n```\n compareAndSet \n\n\n## \n* https://www.jianshu.com/p/0e312402f6ca\n* https://blog.csdn.net/dlh0313/article/details/52172833\n* https://www.cnblogs.com/noKing/p/9094983.html\n* https://www.jianshu.com/p/fb6e91b013cc\n* https://objcoding.com/2018/11/29/cas/\n* https://mp.weixin.qq.com/s/nRnQKhiSUrDKu3mz3vItWg\n","source":"_posts/Java-Cas.md","raw":"---\ntitle: JAVA-CAS\ndate: 2019-10-23 14:41:04\ntags:\n    - JAVA\n    - CAS\n    - \ncategories: JAVA\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n# CAS\n\nCASCAS\n<!-- more -->\n## \nCAS Compare And Swap  CAS \njava.util.concurrent  CAS  ReenterLock  AQS CAS\n\n## \n CAS \nvolatile \nsynchronized  JVM \n\n```java\npublic class Test {\n  public volatile int i;\n  public void add() {\n    i++;\n  }\n}\n```\n `javap -c Test.class` add\n```java\npublic void add();\n    Code:\n       0: aload_0\n       1: dup\n       2: getfield      #2                  // Field n:I\n       5: iconst_1\n       6: iadd\n       7: putfield      #2                  // Field n:I\n      10: return\n\n```\ni++\n    1. getfieldi\n    2. iadd1\n    3. putfieldi\n\n 1  1 \n 2  2 1 2 \n\n\n add  synchronized \n\n```java\npublic class Test {\n  public volatile int i;\n  public synchronized void add() {\n    i++;\n  }\n}\n```\n\n\n## CAS\nCAS3VAB\nAV B  true false\n\n### \n\n`AtomicInteger`CAS\n\n```java\npublic class AtomicInteger extends Number implements java.io.Serializable {\n    private static final long serialVersionUID = 6214790243416807050L;\n\n    // setup to use Unsafe.compareAndSwapInt for updates\n    private static final Unsafe unsafe = Unsafe.getUnsafe();\n    private static final long valueOffset;\n\n    static {\n        try {\n            valueOffset = unsafe.objectFieldOffset\n                (AtomicInteger.class.getDeclaredField(\"value\"));\n        } catch (Exception ex) { throw new Error(ex); }\n    }\n\n    private volatile int value;\n    // \n}\n\n```\n**Unsafe**CAS C/C++ \n**valueOffset**Unsafe\n**value**volatile\n\n\n`AtomicInteger`\n```java\n    // AtomicInteger.getAndAdd\n    public final int getAndAdd(int delta) {\n        return unsafe.getAndAddInt(this, valueOffset, delta);\n    }\n    \n    // unsafe.getAndAddInt\n    public final int getAndAddInt(Object var1, long var2, int var4) {\n        int var5;\n        do {\n            var5 = this.getIntVolatile(var1, var2);\n        } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n\n        return var5;\n    }\n```\nABgetAndAddCPU\n\nAtomicIntegervalue nJavaABvaluen\n1. A`getIntVolatile(var1, var2)`value nA\n2. B`getIntVolatile(var1, var2)`value nBcompareAndSwapInt n m\n3. A`compareAndSwapInt`(n)(m)\n4. valuevaluevolatileAA`compareAndSwapInt`\n\nUnsafecompareAndSwapInt\n```java\npublic final native boolean compareAndSwapInt(Object var1, long var2, int var4, int var5);\n```\nJava  CASCAS  C++ Java  JNI  unsafe.cpp\nOpenJDK8: openjdk/hotspot/src/share/vm/prims/unsafe.cpp\n```C\nUNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))\n  UnsafeWrapper(\"Unsafe_CompareAndSwapInt\");\n  oop p = JNIHandles::resolve(obj);\n  jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);\n  return (jint)(Atomic::cmpxchg(x, addr, e)) == e;\nUNSAFE_END\n```\n\n1. objAtomicInteger JNIHandles::resolve() objOOPp\n2. valueoffsetaddr\n3. xaddreAtomic::cmpxchg(x, addr, e)\n4. Atomic::cmpxchg(x, addr, e)CAS\nOpenJDK8: openjdk/hotspot/src/share/vm/runtime/atomic.cpp\n\n\n```C\njbyte Atomic::cmpxchg(jbyte exchange_value, volatile jbyte* dest, jbyte compare_value) {\n  assert(sizeof(jbyte) == 1, \"assumption.\");\n  uintptr_t dest_addr = (uintptr_t)dest;\n  uintptr_t offset = dest_addr % sizeof(jint);\n  volatile jint* dest_int = (volatile jint*)(dest_addr - offset);\n  jint cur = *dest_int;\n  jbyte* cur_as_bytes = (jbyte*)(&cur);\n  jint new_val = cur;\n  jbyte* new_val_as_bytes = (jbyte*)(&new_val);\n  new_val_as_bytes[offset] = exchange_value;\n  while (cur_as_bytes[offset] == compare_value) {\n    jint res = cmpxchg(new_val, dest_int, cur);\n    if (res == cur) break;\n    cur = res;\n    new_val = cur;\n    new_val_as_bytes[offset] = exchange_value;\n  }\n  return cur_as_bytes[offset];\n}\n```\n\ncmpxchg. , . \n\n```C\n#include \"runtime/atomic.inline.hpp\"\n```\n\natomic.inline.hpp, , cmpxchg().\n\n```C\n#include \"runtime/atomic.hpp\"\n\n// Linux\n#ifdef TARGET_OS_ARCH_linux_x86\n# include \"atomic_linux_x86.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_sparc\n# include \"atomic_linux_sparc.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_zero\n# include \"atomic_linux_zero.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_arm\n# include \"atomic_linux_arm.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_linux_ppc\n# include \"atomic_linux_ppc.inline.hpp\"\n#endif\n\n// Solaris\n#ifdef TARGET_OS_ARCH_solaris_x86\n# include \"atomic_solaris_x86.inline.hpp\"\n#endif\n#ifdef TARGET_OS_ARCH_solaris_sparc\n# include \"atomic_solaris_sparc.inline.hpp\"\n#endif\n\n// Windows\n#ifdef TARGET_OS_ARCH_windows_x86\n# include \"atomic_windows_x86.inline.hpp\"\n#endif\n\n// ..\n```\nlinux x86, atomic_linux_x86.inline.hpp\nOpenJDK: openjdk/hotspot/src/os_cpu/linux_x86/vm/atomic_linux_x86.inline.hpp\n\n```C\n#define LOCK_IF_MP(mp) \"cmp $0, \" #mp \"; je 1f; lock; 1: \"\n\ninline jint     Atomic::cmpxchg    (jint     exchange_value, volatile jint*     dest, jint     compare_value) {\n  int mp = os::is_MP();\n  __asm__ volatile (LOCK_IF_MP(%4) \"cmpxchgl %1,(%3)\"\n                    : \"=a\" (exchange_value)\n                    : \"r\" (exchange_value), \"a\" (compare_value), \"r\" (dest), \"r\" (mp)\n                    : \"cc\", \"memory\");\n  return exchange_value;\n}\n```\n\n\n`__asm__`\n`volatile`\n`cmpxchgl`x86\n`LOCK_IF_MP`cmpxchg1lock\n\n\nC\n```C\n__asm__ volatile(\"Instruction List\"\n \n: Output\n \n: Input\n \n: Clobber/Modify);\n```\n**instruction list**\n**Clobber/Modify**/,GCC,GCC;Clobber/Modify\n\n\n%0%0%1%9eax%0exchange_valuecompare_valuedestmp%1%2%3%4\nasm**cmpxchgl %1,(%3)**eax(compare_valueeax)dest**exchange_value**destdesteax\n: \"=a\" (**exchange_value**) eax(compare_value)**exchange_value**\n        \n`Atomic::cmpxchg`exchange_value\n1. cmpxchglcompare_valuedestdest**exchange_value**eaxcompare_value**exchange_value**compare_value\n   Unsafe_CompareAndSwapInt(jint)(Atomic::cmpxchg(x, addr, e)) == etrueCAS\n\n2. cmpxchglcompare_value(dest)desteax**exchange_value**\n   (jint)(Atomic::cmpxchg(x, addr, e)) == efalseCAS\n\n\n### lock\nlock\n,\n\n X86 CPU  LOCK  LOCK  CPU  LOCK# \n\n## \n1. CPUCPU\n2. CASSynchronized\n3. ABACAS\n\n## ABA\n 1  V  A 2  V  A 1  2  V  B A\n 1  V  1 VA->B->A\n\n\nCAS10050\n10050\n\n110050250\n2350100\n2100compare10010050\n50\n\nCASCompareAV\nJava`AtomicStampedReference`CAS\n\n```java\n    private static class Pair<T> {\n        final T reference;\n        final int stamp;\n        private Pair(T reference, int stamp) {\n            this.reference = reference;\n            this.stamp = stamp;\n        }\n        static <T> Pair<T> of(T reference, int stamp) {\n            return new Pair<T>(reference, stamp);\n        }\n    }\n```\nAtomicStampedReference  Pair, reference stamp \n\n```java\n    public boolean compareAndSet(V   expectedReference,\n                                 V   newReference,\n                                 int expectedStamp,\n                                 int newStamp) {\n        Pair<V> current = pair;\n        return\n            expectedReference == current.reference &&\n            expectedStamp == current.stamp &&\n            ((newReference == current.reference &&\n              newStamp == current.stamp) ||\n             casPair(current, Pair.of(newReference, newStamp)));\n    }\n```\n compareAndSet \n\n\n## \n* https://www.jianshu.com/p/0e312402f6ca\n* https://blog.csdn.net/dlh0313/article/details/52172833\n* https://www.cnblogs.com/noKing/p/9094983.html\n* https://www.jianshu.com/p/fb6e91b013cc\n* https://objcoding.com/2018/11/29/cas/\n* https://mp.weixin.qq.com/s/nRnQKhiSUrDKu3mz3vItWg\n","slug":"Java-Cas","published":1,"updated":"2019-12-13T11:13:27.636Z","layout":"post","photos":[],"link":"","_id":"ck4859y97003qt0fyx99lwk3g","content":"<h1 id=\"CAS\"><a href=\"#CAS\" class=\"headerlink\" title=\"CAS\"></a>CAS</h1><p>CASCAS</p>\n<a id=\"more\"></a>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>CAS Compare And Swap  CAS <br>java.util.concurrent  CAS  ReenterLock  AQS CAS</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> CAS <br>volatile <br>synchronized  JVM </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> i;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>javap -c Test.class</code> add</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    Code:</span><br><span class=\"line\">       <span class=\"number\">0</span>: aload_0</span><br><span class=\"line\">       <span class=\"number\">1</span>: dup</span><br><span class=\"line\">       2: getfield      #2                  // Field n:I</span><br><span class=\"line\">       <span class=\"number\">5</span>: iconst_1</span><br><span class=\"line\">       <span class=\"number\">6</span>: iadd</span><br><span class=\"line\">       7: putfield      #2                  // Field n:I</span><br><span class=\"line\">      <span class=\"number\">10</span>: <span class=\"keyword\">return</span></span><br></pre></td></tr></table></figure>\n\n<p>i++<br>    1. getfieldi<br>    2. iadd1<br>    3. putfieldi</p>\n<p> 1  1 <br> 2  2 1 2 </p>\n<p><br> add  synchronized </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> i;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"CAS\"><a href=\"#CAS\" class=\"headerlink\" title=\"CAS\"></a>CAS</h2><p>CAS3VAB<br>AV B  true false</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>AtomicInteger</code>CAS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AtomicInteger</span> <span class=\"keyword\">extends</span> <span class=\"title\">Number</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6214790243416807050L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> valueOffset;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            valueOffset = unsafe.objectFieldOffset</span><br><span class=\"line\">                (AtomicInteger.class.getDeclaredField(<span class=\"string\">\"value\"</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(ex); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> value;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Unsafe</strong>CAS C/C++<br><strong>valueOffset</strong>Unsafe<br><strong>value</strong>volatile</p>\n<p><code>AtomicInteger</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AtomicInteger.getAndAdd</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAdd</span><span class=\"params\">(<span class=\"keyword\">int</span> delta)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.getAndAddInt(<span class=\"keyword\">this</span>, valueOffset, delta);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// unsafe.getAndAddInt</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAddInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> var5;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        var5 = <span class=\"keyword\">this</span>.getIntVolatile(var1, var2);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span>(!<span class=\"keyword\">this</span>.compareAndSwapInt(var1, var2, var5, var5 + var4));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> var5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ABgetAndAddCPU</p>\n<p>AtomicIntegervalue nJavaABvaluen</p>\n<ol>\n<li>A<code>getIntVolatile(var1, var2)</code>value nA</li>\n<li>B<code>getIntVolatile(var1, var2)</code>value nBcompareAndSwapInt n m</li>\n<li>A<code>compareAndSwapInt</code>(n)(m)</li>\n<li>valuevaluevolatileAA<code>compareAndSwapInt</code></li>\n</ol>\n<p>UnsafecompareAndSwapInt</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSwapInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4, <span class=\"keyword\">int</span> var5)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>Java  CASCAS  C++ Java  JNI  unsafe.cpp<br>OpenJDK8: openjdk/hotspot/src/share/vm/prims/unsafe.cpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))</span><br><span class=\"line\">  UnsafeWrapper(<span class=\"string\">\"Unsafe_CompareAndSwapInt\"</span>);</span><br><span class=\"line\">  oop p = JNIHandles::resolve(obj);</span><br><span class=\"line\">  jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (jint)(Atomic::cmpxchg(x, addr, e)) == e;</span><br><span class=\"line\">UNSAFE_END</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li>objAtomicInteger JNIHandles::resolve() objOOPp</li>\n<li>valueoffsetaddr</li>\n<li>xaddreAtomic::cmpxchg(x, addr, e)</li>\n<li>Atomic::cmpxchg(x, addr, e)CAS<br>OpenJDK8: openjdk/hotspot/src/share/vm/runtime/atomic.cpp</li>\n</ol>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jbyte Atomic::cmpxchg(jbyte exchange_value, <span class=\"keyword\">volatile</span> jbyte* dest, jbyte compare_value) &#123;</span><br><span class=\"line\">  assert(<span class=\"keyword\">sizeof</span>(jbyte) == <span class=\"number\">1</span>, <span class=\"string\">\"assumption.\"</span>);</span><br><span class=\"line\">  <span class=\"keyword\">uintptr_t</span> dest_addr = (<span class=\"keyword\">uintptr_t</span>)dest;</span><br><span class=\"line\">  <span class=\"keyword\">uintptr_t</span> offset = dest_addr % <span class=\"keyword\">sizeof</span>(jint);</span><br><span class=\"line\">  <span class=\"keyword\">volatile</span> jint* dest_int = (<span class=\"keyword\">volatile</span> jint*)(dest_addr - offset);</span><br><span class=\"line\">  jint cur = *dest_int;</span><br><span class=\"line\">  jbyte* cur_as_bytes = (jbyte*)(&amp;cur);</span><br><span class=\"line\">  jint new_val = cur;</span><br><span class=\"line\">  jbyte* new_val_as_bytes = (jbyte*)(&amp;new_val);</span><br><span class=\"line\">  new_val_as_bytes[offset] = exchange_value;</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (cur_as_bytes[offset] == compare_value) &#123;</span><br><span class=\"line\">    jint res = cmpxchg(new_val, dest_int, cur);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (res == cur) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    cur = res;</span><br><span class=\"line\">    new_val = cur;</span><br><span class=\"line\">    new_val_as_bytes[offset] = exchange_value;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> cur_as_bytes[offset];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>cmpxchg. , . </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"runtime/atomic.inline.hpp\"</span></span></span><br></pre></td></tr></table></figure>\n\n<p>atomic.inline.hpp, , cmpxchg().</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"runtime/atomic.hpp\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Linux</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_x86</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_x86.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_sparc</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_sparc.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_zero</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_zero.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_arm</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_arm.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_ppc</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_ppc.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Solaris</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_solaris_x86</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_solaris_x86.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_solaris_sparc</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_solaris_sparc.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Windows</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_windows_x86</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_windows_x86.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ..</span></span><br></pre></td></tr></table></figure>\n\n<p>linux x86, atomic_linux_x86.inline.hpp<br>OpenJDK: openjdk/hotspot/src/os_cpu/linux_x86/vm/atomic_linux_x86.inline.hpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> LOCK_IF_MP(mp) <span class=\"meta-string\">\"cmp $0, \"</span> #mp <span class=\"meta-string\">\"; je 1f; lock; 1: \"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> jint     Atomic::cmpxchg    (jint     exchange_value, <span class=\"keyword\">volatile</span> jint*     dest, jint     compare_value) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> mp = os::is_MP();</span><br><span class=\"line\">  __<span class=\"function\">asm__ <span class=\"title\">volatile</span> <span class=\"params\">(LOCK_IF_MP(%<span class=\"number\">4</span>) <span class=\"string\">\"cmpxchgl %1,(%3)\"</span></span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                    : <span class=\"string\">\"=a\"</span> (exchange_value)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                    : <span class=\"string\">\"r\"</span> (exchange_value), <span class=\"string\">\"a\"</span> (compare_value), <span class=\"string\">\"r\"</span> (dest), <span class=\"string\">\"r\"</span> (mp)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                    : <span class=\"string\">\"cc\"</span>, <span class=\"string\">\"memory\"</span>)</span></span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> exchange_value;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>__asm__</code><br><code>volatile</code><br><code>cmpxchgl</code>x86<br><code>LOCK_IF_MP</code>cmpxchg1lock</p>\n<p>C</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__<span class=\"function\">asm__ <span class=\"title\">volatile</span><span class=\"params\">(<span class=\"string\">\"Instruction List\"</span></span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\"> </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">: Output</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\"> </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">: Input</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\"> </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">: Clobber/Modify)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>instruction list</strong><br><strong>Clobber/Modify</strong>/,GCC,GCC;Clobber/Modify</p>\n<p><br>%0%0%1%9eax%0exchange_valuecompare_valuedestmp%1%2%3%4<br>asm<strong>cmpxchgl %1,(%3)</strong>eax(compare_valueeax)dest<strong>exchange_value</strong>destdesteax<br>: =a (<strong>exchange_value</strong>) eax(compare_value)<strong>exchange_value</strong></p>\n<p><code>Atomic::cmpxchg</code>exchange_value</p>\n<ol>\n<li><p>cmpxchglcompare_valuedestdest<strong>exchange_value</strong>eaxcompare_value<strong>exchange_value</strong>compare_value<br>Unsafe_CompareAndSwapInt(jint)(Atomic::cmpxchg(x, addr, e)) == etrueCAS</p>\n</li>\n<li><p>cmpxchglcompare_value(dest)desteax<strong>exchange_value</strong><br>(jint)(Atomic::cmpxchg(x, addr, e)) == efalseCAS</p>\n</li>\n</ol>\n<h3 id=\"lock\"><a href=\"#lock\" class=\"headerlink\" title=\"lock\"></a>lock</h3><p>lock<br>,</p>\n<p> X86 CPU  LOCK  LOCK  CPU  LOCK# </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>CPUCPU</li>\n<li>CASSynchronized</li>\n<li>ABACAS</li>\n</ol>\n<h2 id=\"ABA\"><a href=\"#ABA\" class=\"headerlink\" title=\"ABA\"></a>ABA</h2><p> 1  V  A 2  V  A 1  2  V  B A<br> 1  V  1 VA-&gt;B-&gt;A</p>\n<p><br>CAS10050<br>10050<br><br>110050250<br>2350100<br>2100compare10010050<br>50</p>\n<p>CASCompareAV<br>Java<code>AtomicStampedReference</code>CAS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Pair</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> T reference;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> stamp;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Pair</span><span class=\"params\">(T reference, <span class=\"keyword\">int</span> stamp)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.reference = reference;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stamp = stamp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> &lt;T&gt; <span class=\"function\">Pair&lt;T&gt; <span class=\"title\">of</span><span class=\"params\">(T reference, <span class=\"keyword\">int</span> stamp)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Pair&lt;T&gt;(reference, stamp);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AtomicStampedReference  Pair, reference stamp </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSet</span><span class=\"params\">(V   expectedReference,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             V   newReference,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             <span class=\"keyword\">int</span> expectedStamp,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             <span class=\"keyword\">int</span> newStamp)</span> </span>&#123;</span><br><span class=\"line\">    Pair&lt;V&gt; current = pair;</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">        expectedReference == current.reference &amp;&amp;</span><br><span class=\"line\">        expectedStamp == current.stamp &amp;&amp;</span><br><span class=\"line\">        ((newReference == current.reference &amp;&amp;</span><br><span class=\"line\">          newStamp == current.stamp) ||</span><br><span class=\"line\">         casPair(current, Pair.of(newReference, newStamp)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> compareAndSet </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><a href=\"https://www.jianshu.com/p/0e312402f6ca\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/0e312402f6ca</a></li>\n<li><a href=\"https://blog.csdn.net/dlh0313/article/details/52172833\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/dlh0313/article/details/52172833</a></li>\n<li><a href=\"https://www.cnblogs.com/noKing/p/9094983.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/noKing/p/9094983.html</a></li>\n<li><a href=\"https://www.jianshu.com/p/fb6e91b013cc\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/fb6e91b013cc</a></li>\n<li><a href=\"https://objcoding.com/2018/11/29/cas/\" target=\"_blank\" rel=\"noopener\">https://objcoding.com/2018/11/29/cas/</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/nRnQKhiSUrDKu3mz3vItWg\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/s/nRnQKhiSUrDKu3mz3vItWg</a></li>\n</ul>\n","site":{"data":{}},"excerpt":"<h1 id=\"CAS\"><a href=\"#CAS\" class=\"headerlink\" title=\"CAS\"></a>CAS</h1><p>CASCAS</p>","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>CAS Compare And Swap  CAS <br>java.util.concurrent  CAS  ReenterLock  AQS CAS</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p> CAS <br>volatile <br>synchronized  JVM </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> i;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> <code>javap -c Test.class</code> add</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">    Code:</span><br><span class=\"line\">       <span class=\"number\">0</span>: aload_0</span><br><span class=\"line\">       <span class=\"number\">1</span>: dup</span><br><span class=\"line\">       2: getfield      #2                  // Field n:I</span><br><span class=\"line\">       <span class=\"number\">5</span>: iconst_1</span><br><span class=\"line\">       <span class=\"number\">6</span>: iadd</span><br><span class=\"line\">       7: putfield      #2                  // Field n:I</span><br><span class=\"line\">      <span class=\"number\">10</span>: <span class=\"keyword\">return</span></span><br></pre></td></tr></table></figure>\n\n<p>i++<br>    1. getfieldi<br>    2. iadd1<br>    3. putfieldi</p>\n<p> 1  1 <br> 2  2 1 2 </p>\n<p><br> add  synchronized </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Test</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">public</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> i;</span><br><span class=\"line\">  <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">synchronized</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    i++;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"CAS\"><a href=\"#CAS\" class=\"headerlink\" title=\"CAS\"></a>CAS</h2><p>CAS3VAB<br>AV B  true false</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code>AtomicInteger</code>CAS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AtomicInteger</span> <span class=\"keyword\">extends</span> <span class=\"title\">Number</span> <span class=\"keyword\">implements</span> <span class=\"title\">java</span>.<span class=\"title\">io</span>.<span class=\"title\">Serializable</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6214790243416807050L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// setup to use Unsafe.compareAndSwapInt for updates</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> Unsafe unsafe = Unsafe.getUnsafe();</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> valueOffset;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            valueOffset = unsafe.objectFieldOffset</span><br><span class=\"line\">                (AtomicInteger.class.getDeclaredField(<span class=\"string\">\"value\"</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception ex) &#123; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(ex); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> value;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong>Unsafe</strong>CAS C/C++<br><strong>valueOffset</strong>Unsafe<br><strong>value</strong>volatile</p>\n<p><code>AtomicInteger</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// AtomicInteger.getAndAdd</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAdd</span><span class=\"params\">(<span class=\"keyword\">int</span> delta)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> unsafe.getAndAddInt(<span class=\"keyword\">this</span>, valueOffset, delta);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// unsafe.getAndAddInt</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> <span class=\"title\">getAndAddInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">int</span> var5;</span><br><span class=\"line\">    <span class=\"keyword\">do</span> &#123;</span><br><span class=\"line\">        var5 = <span class=\"keyword\">this</span>.getIntVolatile(var1, var2);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">while</span>(!<span class=\"keyword\">this</span>.compareAndSwapInt(var1, var2, var5, var5 + var4));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> var5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>ABgetAndAddCPU</p>\n<p>AtomicIntegervalue nJavaABvaluen</p>\n<ol>\n<li>A<code>getIntVolatile(var1, var2)</code>value nA</li>\n<li>B<code>getIntVolatile(var1, var2)</code>value nBcompareAndSwapInt n m</li>\n<li>A<code>compareAndSwapInt</code>(n)(m)</li>\n<li>valuevaluevolatileAA<code>compareAndSwapInt</code></li>\n</ol>\n<p>UnsafecompareAndSwapInt</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> <span class=\"keyword\">native</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSwapInt</span><span class=\"params\">(Object var1, <span class=\"keyword\">long</span> var2, <span class=\"keyword\">int</span> var4, <span class=\"keyword\">int</span> var5)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>Java  CASCAS  C++ Java  JNI  unsafe.cpp<br>OpenJDK8: openjdk/hotspot/src/share/vm/prims/unsafe.cpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UNSAFE_ENTRY(jboolean, Unsafe_CompareAndSwapInt(JNIEnv *env, jobject unsafe, jobject obj, jlong offset, jint e, jint x))</span><br><span class=\"line\">  UnsafeWrapper(<span class=\"string\">\"Unsafe_CompareAndSwapInt\"</span>);</span><br><span class=\"line\">  oop p = JNIHandles::resolve(obj);</span><br><span class=\"line\">  jint* addr = (jint *) index_oop_from_field_offset_long(p, offset);</span><br><span class=\"line\">  <span class=\"keyword\">return</span> (jint)(Atomic::cmpxchg(x, addr, e)) == e;</span><br><span class=\"line\">UNSAFE_END</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li>objAtomicInteger JNIHandles::resolve() objOOPp</li>\n<li>valueoffsetaddr</li>\n<li>xaddreAtomic::cmpxchg(x, addr, e)</li>\n<li>Atomic::cmpxchg(x, addr, e)CAS<br>OpenJDK8: openjdk/hotspot/src/share/vm/runtime/atomic.cpp</li>\n</ol>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">jbyte Atomic::cmpxchg(jbyte exchange_value, <span class=\"keyword\">volatile</span> jbyte* dest, jbyte compare_value) &#123;</span><br><span class=\"line\">  assert(<span class=\"keyword\">sizeof</span>(jbyte) == <span class=\"number\">1</span>, <span class=\"string\">\"assumption.\"</span>);</span><br><span class=\"line\">  <span class=\"keyword\">uintptr_t</span> dest_addr = (<span class=\"keyword\">uintptr_t</span>)dest;</span><br><span class=\"line\">  <span class=\"keyword\">uintptr_t</span> offset = dest_addr % <span class=\"keyword\">sizeof</span>(jint);</span><br><span class=\"line\">  <span class=\"keyword\">volatile</span> jint* dest_int = (<span class=\"keyword\">volatile</span> jint*)(dest_addr - offset);</span><br><span class=\"line\">  jint cur = *dest_int;</span><br><span class=\"line\">  jbyte* cur_as_bytes = (jbyte*)(&amp;cur);</span><br><span class=\"line\">  jint new_val = cur;</span><br><span class=\"line\">  jbyte* new_val_as_bytes = (jbyte*)(&amp;new_val);</span><br><span class=\"line\">  new_val_as_bytes[offset] = exchange_value;</span><br><span class=\"line\">  <span class=\"keyword\">while</span> (cur_as_bytes[offset] == compare_value) &#123;</span><br><span class=\"line\">    jint res = cmpxchg(new_val, dest_int, cur);</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (res == cur) <span class=\"keyword\">break</span>;</span><br><span class=\"line\">    cur = res;</span><br><span class=\"line\">    new_val = cur;</span><br><span class=\"line\">    new_val_as_bytes[offset] = exchange_value;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> cur_as_bytes[offset];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>cmpxchg. , . </p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"runtime/atomic.inline.hpp\"</span></span></span><br></pre></td></tr></table></figure>\n\n<p>atomic.inline.hpp, , cmpxchg().</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"runtime/atomic.hpp\"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Linux</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_x86</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_x86.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_sparc</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_sparc.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_zero</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_zero.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_arm</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_arm.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_linux_ppc</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_linux_ppc.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Solaris</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_solaris_x86</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_solaris_x86.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_solaris_sparc</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_solaris_sparc.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// Windows</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">ifdef</span> TARGET_OS_ARCH_windows_x86</span></span><br><span class=\"line\"><span class=\"meta\"># <span class=\"meta-keyword\">include</span> <span class=\"meta-string\">\"atomic_windows_x86.inline.hpp\"</span></span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">endif</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// ..</span></span><br></pre></td></tr></table></figure>\n\n<p>linux x86, atomic_linux_x86.inline.hpp<br>OpenJDK: openjdk/hotspot/src/os_cpu/linux_x86/vm/atomic_linux_x86.inline.hpp</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> LOCK_IF_MP(mp) <span class=\"meta-string\">\"cmp $0, \"</span> #mp <span class=\"meta-string\">\"; je 1f; lock; 1: \"</span></span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">inline</span> jint     Atomic::cmpxchg    (jint     exchange_value, <span class=\"keyword\">volatile</span> jint*     dest, jint     compare_value) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> mp = os::is_MP();</span><br><span class=\"line\">  __<span class=\"function\">asm__ <span class=\"title\">volatile</span> <span class=\"params\">(LOCK_IF_MP(%<span class=\"number\">4</span>) <span class=\"string\">\"cmpxchgl %1,(%3)\"</span></span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                    : <span class=\"string\">\"=a\"</span> (exchange_value)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                    : <span class=\"string\">\"r\"</span> (exchange_value), <span class=\"string\">\"a\"</span> (compare_value), <span class=\"string\">\"r\"</span> (dest), <span class=\"string\">\"r\"</span> (mp)</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                    : <span class=\"string\">\"cc\"</span>, <span class=\"string\">\"memory\"</span>)</span></span>;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> exchange_value;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<p><code>__asm__</code><br><code>volatile</code><br><code>cmpxchgl</code>x86<br><code>LOCK_IF_MP</code>cmpxchg1lock</p>\n<p>C</p>\n<figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">__<span class=\"function\">asm__ <span class=\"title\">volatile</span><span class=\"params\">(<span class=\"string\">\"Instruction List\"</span></span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\"> </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">: Output</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\"> </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">: Input</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\"> </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">: Clobber/Modify)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p><strong>instruction list</strong><br><strong>Clobber/Modify</strong>/,GCC,GCC;Clobber/Modify</p>\n<p><br>%0%0%1%9eax%0exchange_valuecompare_valuedestmp%1%2%3%4<br>asm<strong>cmpxchgl %1,(%3)</strong>eax(compare_valueeax)dest<strong>exchange_value</strong>destdesteax<br>: =a (<strong>exchange_value</strong>) eax(compare_value)<strong>exchange_value</strong></p>\n<p><code>Atomic::cmpxchg</code>exchange_value</p>\n<ol>\n<li><p>cmpxchglcompare_valuedestdest<strong>exchange_value</strong>eaxcompare_value<strong>exchange_value</strong>compare_value<br>Unsafe_CompareAndSwapInt(jint)(Atomic::cmpxchg(x, addr, e)) == etrueCAS</p>\n</li>\n<li><p>cmpxchglcompare_value(dest)desteax<strong>exchange_value</strong><br>(jint)(Atomic::cmpxchg(x, addr, e)) == efalseCAS</p>\n</li>\n</ol>\n<h3 id=\"lock\"><a href=\"#lock\" class=\"headerlink\" title=\"lock\"></a>lock</h3><p>lock<br>,</p>\n<p> X86 CPU  LOCK  LOCK  CPU  LOCK# </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li>CPUCPU</li>\n<li>CASSynchronized</li>\n<li>ABACAS</li>\n</ol>\n<h2 id=\"ABA\"><a href=\"#ABA\" class=\"headerlink\" title=\"ABA\"></a>ABA</h2><p> 1  V  A 2  V  A 1  2  V  B A<br> 1  V  1 VA-&gt;B-&gt;A</p>\n<p><br>CAS10050<br>10050<br><br>110050250<br>2350100<br>2100compare10010050<br>50</p>\n<p>CASCompareAV<br>Java<code>AtomicStampedReference</code>CAS</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Pair</span>&lt;<span class=\"title\">T</span>&gt; </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> T reference;</span><br><span class=\"line\">    <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> stamp;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"title\">Pair</span><span class=\"params\">(T reference, <span class=\"keyword\">int</span> stamp)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.reference = reference;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.stamp = stamp;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> &lt;T&gt; <span class=\"function\">Pair&lt;T&gt; <span class=\"title\">of</span><span class=\"params\">(T reference, <span class=\"keyword\">int</span> stamp)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">new</span> Pair&lt;T&gt;(reference, stamp);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>AtomicStampedReference  Pair, reference stamp </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">compareAndSet</span><span class=\"params\">(V   expectedReference,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             V   newReference,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             <span class=\"keyword\">int</span> expectedStamp,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                             <span class=\"keyword\">int</span> newStamp)</span> </span>&#123;</span><br><span class=\"line\">    Pair&lt;V&gt; current = pair;</span><br><span class=\"line\">    <span class=\"keyword\">return</span></span><br><span class=\"line\">        expectedReference == current.reference &amp;&amp;</span><br><span class=\"line\">        expectedStamp == current.stamp &amp;&amp;</span><br><span class=\"line\">        ((newReference == current.reference &amp;&amp;</span><br><span class=\"line\">          newStamp == current.stamp) ||</span><br><span class=\"line\">         casPair(current, Pair.of(newReference, newStamp)));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> compareAndSet </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><a href=\"https://www.jianshu.com/p/0e312402f6ca\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/0e312402f6ca</a></li>\n<li><a href=\"https://blog.csdn.net/dlh0313/article/details/52172833\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/dlh0313/article/details/52172833</a></li>\n<li><a href=\"https://www.cnblogs.com/noKing/p/9094983.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/noKing/p/9094983.html</a></li>\n<li><a href=\"https://www.jianshu.com/p/fb6e91b013cc\" target=\"_blank\" rel=\"noopener\">https://www.jianshu.com/p/fb6e91b013cc</a></li>\n<li><a href=\"https://objcoding.com/2018/11/29/cas/\" target=\"_blank\" rel=\"noopener\">https://objcoding.com/2018/11/29/cas/</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/nRnQKhiSUrDKu3mz3vItWg\" target=\"_blank\" rel=\"noopener\">https://mp.weixin.qq.com/s/nRnQKhiSUrDKu3mz3vItWg</a></li>\n</ul>"},{"title":"redis-sds","date":"2019-03-27T07:56:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"## SDS\n\n```c\n/*\n *  sdshdr  buf \n */\ntypedef char *sds;\n\n/*\n * \n */\nstruct sdshdr {\n    \n    // buf \n    int len;\n\n    // buf \n    int free;\n\n    // \n    char buf[];\n};\n\n```\n<!-- more -->\n## SDS\n\n### sdslen-sds\n```c\n/*\n *  sds \n *\n * T = O(1)\n */\nstatic inline size_t sdslen(const sds s) {\n    struct sdshdr *sh = (void*)(s-(sizeof(struct sdshdr)));\n    return sh->len;\n}\n\n```\ns bufchar8sdshdrlen\nchar buf[]sizeof(struct sdshdr)8\n\n![sdshdr](Redis-sds/sdshdr.png)\n### sdsavail-sdsfree\n```c\n/*\n *  sds \n *\n * T = O(1)\n */\nstatic inline size_t sdsavail(const sds s) {\n    struct sdshdr *sh = (void*)(s-(sizeof(struct sdshdr)));\n    return sh->free;\n}\n```\n\n### sdsnewlen-sds\n```c\n/**\n *  init  initlen, sds\n * @param init \n * @param initlen \n * @return  sdshdr  sds, NULL\n * T = O(N)\n */\nsds sdsnewlen(const void *init, size_t initlen) {\n\n    struct sdshdr *sh;\n\n    // \n    // T = O(N)\n    if (init) {\n        // zmalloc \n        sh = zmalloc(sizeof(struct sdshdr)+initlen+1);\n    } else {\n        // zcalloc  0\n        sh = zcalloc(sizeof(struct sdshdr)+initlen+1);\n    }\n\n    // \n    if (sh == NULL) return NULL;\n\n    // \n    sh->len = initlen;\n    //  sds \n    sh->free = 0;\n    //  sdshdr  buf \n    // T = O(N)\n    if (initlen && init)\n        memcpy(sh->buf, init, initlen);\n    //  \\0 \n    sh->buf[initlen] = '\\0';\n\n    //  buf  sdshdr\n    return (char*)sh->buf;\n}\n```\n### sdsnew-sds\n```c\n/**\n *  init  sds\n * @param init  NULL  sds\n * @return  sdshdr  sds NULL\n * T = O(N)\n */\nsds sdsnew(const char *init) {\n    size_t initlen = (init == NULL) ? 0 : strlen(init);\n    return sdsnewlen(init, initlen);\n}\n```\n### sdsempty-sds\n```c\n/**\n *  \"\"  sds\n * @return  sdshdr  sds, NULL\n * T = O(1)\n */\nsds sdsempty(void) {\n    return sdsnewlen(\"\",0);\n}\n```\n### sdsdup-sds\n```c\n/**\n *  sds \n * @param s sds\n * @return  sds \n *  T = O(N)\n */\nsds sdsdup(const sds s) {\n    return sdsnewlen(s, sdslen(s));\n}\n```\n### sdsfree-sds\n```c\n/**\n *  sds\n * @param s \n * T = O(N)\n */\nvoid sdsfree(sds s) {\n    if (s == NULL) return;\n    zfree(s-sizeof(struct sdshdr));\n}\n```\n### sdsgrowzero-sds0\n```c\n/**\n *  sds  0 \n * @param s\n * @param len \n * @return  sds  NULL\n * T = O(N)\n */\nsds sdsgrowzero(sds s, size_t len) {\n    struct sdshdr *sh = (void*)(s-(sizeof(struct sdshdr)));\n    size_t totlen, curlen = sh->len;\n\n    //  len \n    // \n    if (len <= curlen) return s;\n\n    //  sds\n    // T = O(N)\n    s = sdsMakeRoomFor(s,len-curlen);\n    // \n    if (s == NULL) return NULL;\n\n    //  0 \n    // T = O(N)\n    sh = (void*)(s-(sizeof(struct sdshdr)));\n    memset(s+curlen,0,(len-curlen+1));\n\n    // \n    totlen = sh->len+sh->free;\n    sh->len = len;\n    sh->free = totlen-sh->len;\n\n    //  sds\n    return s;\n}\n\n/**\n *  sds  buf \n * buf  addlen + 1  1  \\0 \n * @param s \n * @param addlen \n * @return  sds NULL\n * T = O(N)\n */\nsds sdsMakeRoomFor(sds s, size_t addlen) {\n\n    struct sdshdr *sh, *newsh;\n\n    //  s \n    size_t free = sdsavail(s);\n\n    size_t len, newlen;\n\n    // s \n    if (free >= addlen) return s;\n\n    //  s \n    len = sdslen(s);\n    sh = (void*) (s-(sizeof(struct sdshdr)));\n\n    // s \n    newlen = (len+addlen);\n\n    //  s \n    if (newlen < SDS_MAX_PREALLOC)\n        //  SDS_MAX_PREALLOC \n        // \n        newlen *= 2;\n    else\n        //  SDS_MAX_PREALLOC\n        newlen += SDS_MAX_PREALLOC;\n    // T = O(N)\n    newsh = zrealloc(sh, sizeof(struct sdshdr)+newlen+1);\n\n    // \n    if (newsh == NULL) return NULL;\n\n    //  sds \n    newsh->free = newlen - len;\n\n    //  sds\n    return newsh->buf;\n}\n\n/*\n * \n */\n#define SDS_MAX_PREALLOC (1024*1024)\n```\n\n### sdscatlen-sds\n```c\n/**\n *   len  t  sds \n * @param s\n * @param t t\n * @param len t\n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscatlen(sds s, const void *t, size_t len) {\n    \n    struct sdshdr *sh;\n    \n    // \n    size_t curlen = sdslen(s);\n\n    //  sds \n    // T = O(N)\n    s = sdsMakeRoomFor(s,len);\n\n    // \n    if (s == NULL) return NULL;\n\n    //  t \n    // T = O(N)\n    sh = (void*) (s-(sizeof(struct sdshdr)));\n    memcpy(s+curlen, t, len);\n\n    // \n    sh->len = curlen+len;\n    sh->free = sh->free-len;\n\n    // \n    s[curlen+len] = '\\0';\n\n    //  sds\n    return s;\n}\n```\n### sdscat-sds\n```c\n/**\n *  t  sds \n * @return  sds  NULL\n *  T = O(N)\n */\nsds sdscat(sds s, const char *t) {\n    return sdscatlen(s, t, strlen(t));\n}\n```\n\n### sdscatsds-sdssds\n```c\n/**\n *  sds  sds \n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscatsds(sds s, const sds t) {\n    return sdscatlen(s, t, sdslen(t));\n}\n```\n### sdscpylen-lensds\n```c\n/**\n *  t  len  sds s ,\n *  sds  len  sds\n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscpylen(sds s, const char *t, size_t len) {\n\n    struct sdshdr *sh = (void*) (s-(sizeof(struct sdshdr)));\n\n    // sds  buf \n    size_t totlen = sh->free+sh->len;\n\n    //  s  buf  len \n    if (totlen < len) {\n        // T = O(N)\n        s = sdsMakeRoomFor(s,len-sh->len);\n        if (s == NULL) return NULL;\n        sh = (void*) (s-(sizeof(struct sdshdr)));\n        totlen = sh->free+sh->len;\n    }\n\n    // \n    // T = O(N)\n    memcpy(s, t, len);\n\n    // \n    s[len] = '\\0';\n\n    // \n    sh->len = len;\n    sh->free = totlen-len;\n\n    //  sds\n    return s;\n}\n```\n### sdscpy- sds \n```c\n/**\n *  sds ,\n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscpy(sds s, const char *t) {\n    return sdscpylen(s, t, strlen(t));\n}\n```","source":"_posts/Redis-sds.md","raw":"---\ntitle: redis-sds\ndate: 2019-03-27 15:56:04\ntags:\n    - redis\n    - \ncategories: redis\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n## SDS\n\n```c\n/*\n *  sdshdr  buf \n */\ntypedef char *sds;\n\n/*\n * \n */\nstruct sdshdr {\n    \n    // buf \n    int len;\n\n    // buf \n    int free;\n\n    // \n    char buf[];\n};\n\n```\n<!-- more -->\n## SDS\n\n### sdslen-sds\n```c\n/*\n *  sds \n *\n * T = O(1)\n */\nstatic inline size_t sdslen(const sds s) {\n    struct sdshdr *sh = (void*)(s-(sizeof(struct sdshdr)));\n    return sh->len;\n}\n\n```\ns bufchar8sdshdrlen\nchar buf[]sizeof(struct sdshdr)8\n\n![sdshdr](Redis-sds/sdshdr.png)\n### sdsavail-sdsfree\n```c\n/*\n *  sds \n *\n * T = O(1)\n */\nstatic inline size_t sdsavail(const sds s) {\n    struct sdshdr *sh = (void*)(s-(sizeof(struct sdshdr)));\n    return sh->free;\n}\n```\n\n### sdsnewlen-sds\n```c\n/**\n *  init  initlen, sds\n * @param init \n * @param initlen \n * @return  sdshdr  sds, NULL\n * T = O(N)\n */\nsds sdsnewlen(const void *init, size_t initlen) {\n\n    struct sdshdr *sh;\n\n    // \n    // T = O(N)\n    if (init) {\n        // zmalloc \n        sh = zmalloc(sizeof(struct sdshdr)+initlen+1);\n    } else {\n        // zcalloc  0\n        sh = zcalloc(sizeof(struct sdshdr)+initlen+1);\n    }\n\n    // \n    if (sh == NULL) return NULL;\n\n    // \n    sh->len = initlen;\n    //  sds \n    sh->free = 0;\n    //  sdshdr  buf \n    // T = O(N)\n    if (initlen && init)\n        memcpy(sh->buf, init, initlen);\n    //  \\0 \n    sh->buf[initlen] = '\\0';\n\n    //  buf  sdshdr\n    return (char*)sh->buf;\n}\n```\n### sdsnew-sds\n```c\n/**\n *  init  sds\n * @param init  NULL  sds\n * @return  sdshdr  sds NULL\n * T = O(N)\n */\nsds sdsnew(const char *init) {\n    size_t initlen = (init == NULL) ? 0 : strlen(init);\n    return sdsnewlen(init, initlen);\n}\n```\n### sdsempty-sds\n```c\n/**\n *  \"\"  sds\n * @return  sdshdr  sds, NULL\n * T = O(1)\n */\nsds sdsempty(void) {\n    return sdsnewlen(\"\",0);\n}\n```\n### sdsdup-sds\n```c\n/**\n *  sds \n * @param s sds\n * @return  sds \n *  T = O(N)\n */\nsds sdsdup(const sds s) {\n    return sdsnewlen(s, sdslen(s));\n}\n```\n### sdsfree-sds\n```c\n/**\n *  sds\n * @param s \n * T = O(N)\n */\nvoid sdsfree(sds s) {\n    if (s == NULL) return;\n    zfree(s-sizeof(struct sdshdr));\n}\n```\n### sdsgrowzero-sds0\n```c\n/**\n *  sds  0 \n * @param s\n * @param len \n * @return  sds  NULL\n * T = O(N)\n */\nsds sdsgrowzero(sds s, size_t len) {\n    struct sdshdr *sh = (void*)(s-(sizeof(struct sdshdr)));\n    size_t totlen, curlen = sh->len;\n\n    //  len \n    // \n    if (len <= curlen) return s;\n\n    //  sds\n    // T = O(N)\n    s = sdsMakeRoomFor(s,len-curlen);\n    // \n    if (s == NULL) return NULL;\n\n    //  0 \n    // T = O(N)\n    sh = (void*)(s-(sizeof(struct sdshdr)));\n    memset(s+curlen,0,(len-curlen+1));\n\n    // \n    totlen = sh->len+sh->free;\n    sh->len = len;\n    sh->free = totlen-sh->len;\n\n    //  sds\n    return s;\n}\n\n/**\n *  sds  buf \n * buf  addlen + 1  1  \\0 \n * @param s \n * @param addlen \n * @return  sds NULL\n * T = O(N)\n */\nsds sdsMakeRoomFor(sds s, size_t addlen) {\n\n    struct sdshdr *sh, *newsh;\n\n    //  s \n    size_t free = sdsavail(s);\n\n    size_t len, newlen;\n\n    // s \n    if (free >= addlen) return s;\n\n    //  s \n    len = sdslen(s);\n    sh = (void*) (s-(sizeof(struct sdshdr)));\n\n    // s \n    newlen = (len+addlen);\n\n    //  s \n    if (newlen < SDS_MAX_PREALLOC)\n        //  SDS_MAX_PREALLOC \n        // \n        newlen *= 2;\n    else\n        //  SDS_MAX_PREALLOC\n        newlen += SDS_MAX_PREALLOC;\n    // T = O(N)\n    newsh = zrealloc(sh, sizeof(struct sdshdr)+newlen+1);\n\n    // \n    if (newsh == NULL) return NULL;\n\n    //  sds \n    newsh->free = newlen - len;\n\n    //  sds\n    return newsh->buf;\n}\n\n/*\n * \n */\n#define SDS_MAX_PREALLOC (1024*1024)\n```\n\n### sdscatlen-sds\n```c\n/**\n *   len  t  sds \n * @param s\n * @param t t\n * @param len t\n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscatlen(sds s, const void *t, size_t len) {\n    \n    struct sdshdr *sh;\n    \n    // \n    size_t curlen = sdslen(s);\n\n    //  sds \n    // T = O(N)\n    s = sdsMakeRoomFor(s,len);\n\n    // \n    if (s == NULL) return NULL;\n\n    //  t \n    // T = O(N)\n    sh = (void*) (s-(sizeof(struct sdshdr)));\n    memcpy(s+curlen, t, len);\n\n    // \n    sh->len = curlen+len;\n    sh->free = sh->free-len;\n\n    // \n    s[curlen+len] = '\\0';\n\n    //  sds\n    return s;\n}\n```\n### sdscat-sds\n```c\n/**\n *  t  sds \n * @return  sds  NULL\n *  T = O(N)\n */\nsds sdscat(sds s, const char *t) {\n    return sdscatlen(s, t, strlen(t));\n}\n```\n\n### sdscatsds-sdssds\n```c\n/**\n *  sds  sds \n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscatsds(sds s, const sds t) {\n    return sdscatlen(s, t, sdslen(t));\n}\n```\n### sdscpylen-lensds\n```c\n/**\n *  t  len  sds s ,\n *  sds  len  sds\n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscpylen(sds s, const char *t, size_t len) {\n\n    struct sdshdr *sh = (void*) (s-(sizeof(struct sdshdr)));\n\n    // sds  buf \n    size_t totlen = sh->free+sh->len;\n\n    //  s  buf  len \n    if (totlen < len) {\n        // T = O(N)\n        s = sdsMakeRoomFor(s,len-sh->len);\n        if (s == NULL) return NULL;\n        sh = (void*) (s-(sizeof(struct sdshdr)));\n        totlen = sh->free+sh->len;\n    }\n\n    // \n    // T = O(N)\n    memcpy(s, t, len);\n\n    // \n    s[len] = '\\0';\n\n    // \n    sh->len = len;\n    sh->free = totlen-len;\n\n    //  sds\n    return s;\n}\n```\n### sdscpy- sds \n```c\n/**\n *  sds ,\n * @return  sds  NULL\n * T = O(N)\n */\nsds sdscpy(sds s, const char *t) {\n    return sdscpylen(s, t, strlen(t));\n}\n```","slug":"Redis-sds","published":1,"updated":"2019-07-30T11:37:16.777Z","layout":"post","photos":[],"link":"","_id":"ck4859y99003tt0fyqzh5afwk","content":"<h2 id=\"SDS\"><a href=\"#SDS\" class=\"headerlink\" title=\"SDS\"></a>SDS</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *  sdshdr  buf </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">char</span> *sds;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> &#123;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// buf </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// buf </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">free</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">char</span> buf[];</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<h2 id=\"SDS\"><a href=\"#SDS\" class=\"headerlink\" title=\"SDS\"></a>SDS</h2><h3 id=\"sdslen-sds\"><a href=\"#sdslen-sds\" class=\"headerlink\" title=\"sdslen-sds\"></a>sdslen-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">inline</span> size_t <span class=\"title\">sdslen</span><span class=\"params\">(<span class=\"keyword\">const</span> sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*)(<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> sh-&gt;len;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>s bufchar8sdshdrlen<br>char buf[]sizeof(struct sdshdr)8<br><br><img src=\"/2019/03/27/Redis-sds/sdshdr.png\" alt=\"sdshdr\"></p>\n<h3 id=\"sdsavail-sdsfree\"><a href=\"#sdsavail-sdsfree\" class=\"headerlink\" title=\"sdsavail-sdsfree\"></a>sdsavail-sdsfree</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">inline</span> size_t <span class=\"title\">sdsavail</span><span class=\"params\">(<span class=\"keyword\">const</span> sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*)(<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> sh-&gt;<span class=\"built_in\">free</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsnewlen-sds\"><a href=\"#sdsnewlen-sds\" class=\"headerlink\" title=\"sdsnewlen-sds\"></a>sdsnewlen-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  init  initlen, sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @param init </span></span><br><span class=\"line\"><span class=\"comment\"> * @param initlen </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sdshdr  sds, NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsnewlen</span><span class=\"params\">(<span class=\"keyword\">const</span> <span class=\"keyword\">void</span> *init, <span class=\"keyword\">size_t</span> initlen)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (init) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// zmalloc </span></span><br><span class=\"line\">        sh = zmalloc(<span class=\"keyword\">sizeof</span>(struct sdshdr)+initlen+<span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// zcalloc  0</span></span><br><span class=\"line\">        sh = zcalloc(<span class=\"keyword\">sizeof</span>(struct sdshdr)+initlen+<span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sh == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    sh-&gt;len = initlen;</span><br><span class=\"line\">    <span class=\"comment\">//  sds </span></span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">//  sdshdr  buf </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (initlen &amp;&amp; init)</span><br><span class=\"line\">        <span class=\"built_in\">memcpy</span>(sh-&gt;buf, init, initlen);</span><br><span class=\"line\">    <span class=\"comment\">//  \\0 </span></span><br><span class=\"line\">    sh-&gt;buf[initlen] = <span class=\"string\">'\\0'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  buf  sdshdr</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (<span class=\"keyword\">char</span>*)sh-&gt;buf;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsnew-sds\"><a href=\"#sdsnew-sds\" class=\"headerlink\" title=\"sdsnew-sds\"></a>sdsnew-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  init  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @param init  NULL  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sdshdr  sds NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsnew</span><span class=\"params\">(<span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *init)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> initlen = (init == <span class=\"literal\">NULL</span>) ? <span class=\"number\">0</span> : <span class=\"built_in\">strlen</span>(init);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdsnewlen(init, initlen);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsempty-sds\"><a href=\"#sdsempty-sds\" class=\"headerlink\" title=\"sdsempty-sds\"></a>sdsempty-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  \"\"  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sdshdr  sds, NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsempty</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdsnewlen(<span class=\"string\">\"\"</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsdup-sds\"><a href=\"#sdsdup-sds\" class=\"headerlink\" title=\"sdsdup-sds\"></a>sdsdup-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds </span></span><br><span class=\"line\"><span class=\"comment\"> *  T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsdup</span><span class=\"params\">(<span class=\"keyword\">const</span> sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdsnewlen(s, sdslen(s));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsfree-sds\"><a href=\"#sdsfree-sds\" class=\"headerlink\" title=\"sdsfree-sds\"></a>sdsfree-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @param s </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">sdsfree</span><span class=\"params\">(sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    zfree(s-<span class=\"keyword\">sizeof</span>(struct sdshdr));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsgrowzero-sds0\"><a href=\"#sdsgrowzero-sds0\" class=\"headerlink\" title=\"sdsgrowzero-sds0\"></a>sdsgrowzero-sds0</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  0 </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s</span></span><br><span class=\"line\"><span class=\"comment\"> * @param len </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsgrowzero</span><span class=\"params\">(sds s, <span class=\"keyword\">size_t</span> len)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*)(<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> totlen, curlen = sh-&gt;len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  len </span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (len &lt;= curlen) <span class=\"keyword\">return</span> s;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    s = sdsMakeRoomFor(s,len-curlen);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  0 </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    sh = (<span class=\"keyword\">void</span>*)(s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(s+curlen,<span class=\"number\">0</span>,(len-curlen+<span class=\"number\">1</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    totlen = sh-&gt;len+sh-&gt;<span class=\"built_in\">free</span>;</span><br><span class=\"line\">    sh-&gt;len = len;</span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = totlen-sh-&gt;len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  buf </span></span><br><span class=\"line\"><span class=\"comment\"> * buf  addlen + 1  1  \\0 </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s </span></span><br><span class=\"line\"><span class=\"comment\"> * @param addlen </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsMakeRoomFor</span><span class=\"params\">(sds s, <span class=\"keyword\">size_t</span> addlen)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span>, *<span class=\"title\">newsh</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s </span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> <span class=\"built_in\">free</span> = sdsavail(s);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> len, newlen;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// s </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">free</span> &gt;= addlen) <span class=\"keyword\">return</span> s;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s </span></span><br><span class=\"line\">    len = sdslen(s);</span><br><span class=\"line\">    sh = (<span class=\"keyword\">void</span>*) (s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// s </span></span><br><span class=\"line\">    newlen = (len+addlen);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newlen &lt; SDS_MAX_PREALLOC)</span><br><span class=\"line\">        <span class=\"comment\">//  SDS_MAX_PREALLOC </span></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        newlen *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"comment\">//  SDS_MAX_PREALLOC</span></span><br><span class=\"line\">        newlen += SDS_MAX_PREALLOC;</span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    newsh = zrealloc(sh, <span class=\"keyword\">sizeof</span>(struct sdshdr)+newlen+<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newsh == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds </span></span><br><span class=\"line\">    newsh-&gt;<span class=\"built_in\">free</span> = newlen - len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> newsh-&gt;buf;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SDS_MAX_PREALLOC (1024*1024)</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscatlen-sds\"><a href=\"#sdscatlen-sds\" class=\"headerlink\" title=\"sdscatlen-sds\"></a>sdscatlen-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *   len  t  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s</span></span><br><span class=\"line\"><span class=\"comment\"> * @param t t</span></span><br><span class=\"line\"><span class=\"comment\"> * @param len t</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscatlen</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">void</span> *t, <span class=\"keyword\">size_t</span> len)</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span>;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> curlen = sdslen(s);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    s = sdsMakeRoomFor(s,len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  t </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    sh = (<span class=\"keyword\">void</span>*) (s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(s+curlen, t, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    sh-&gt;len = curlen+len;</span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = sh-&gt;<span class=\"built_in\">free</span>-len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    s[curlen+len] = <span class=\"string\">'\\0'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscat-sds\"><a href=\"#sdscat-sds\" class=\"headerlink\" title=\"sdscat-sds\"></a>sdscat-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  t  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> *  T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscat</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdscatlen(s, t, <span class=\"built_in\">strlen</span>(t));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscatsds-sdssds\"><a href=\"#sdscatsds-sdssds\" class=\"headerlink\" title=\"sdscatsds-sdssds\"></a>sdscatsds-sdssds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscatsds</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> sds t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdscatlen(s, t, sdslen(t));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscpylen-lensds\"><a href=\"#sdscpylen-lensds\" class=\"headerlink\" title=\"sdscpylen-lensds\"></a>sdscpylen-lensds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  t  len  sds s ,</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  len  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscpylen</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *t, <span class=\"keyword\">size_t</span> len)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*) (<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// sds  buf </span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> totlen = sh-&gt;<span class=\"built_in\">free</span>+sh-&gt;len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s  buf  len </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (totlen &lt; len) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">        s = sdsMakeRoomFor(s,len-sh-&gt;len);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        sh = (<span class=\"keyword\">void</span>*) (s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\">        totlen = sh-&gt;<span class=\"built_in\">free</span>+sh-&gt;len;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(s, t, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    s[len] = <span class=\"string\">'\\0'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    sh-&gt;len = len;</span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = totlen-len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscpy--sds-\"><a href=\"#sdscpy--sds-\" class=\"headerlink\" title=\"sdscpy- sds \"></a>sdscpy- sds </h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds ,</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscpy</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdscpylen(s, t, <span class=\"built_in\">strlen</span>(t));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h2 id=\"SDS\"><a href=\"#SDS\" class=\"headerlink\" title=\"SDS\"></a>SDS</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *  sdshdr  buf </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"keyword\">char</span> *sds;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> &#123;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// buf </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// buf </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> <span class=\"built_in\">free</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">char</span> buf[];</span><br><span class=\"line\">&#125;;</span><br></pre></td></tr></table></figure>","more":"<h2 id=\"SDS\"><a href=\"#SDS\" class=\"headerlink\" title=\"SDS\"></a>SDS</h2><h3 id=\"sdslen-sds\"><a href=\"#sdslen-sds\" class=\"headerlink\" title=\"sdslen-sds\"></a>sdslen-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">inline</span> size_t <span class=\"title\">sdslen</span><span class=\"params\">(<span class=\"keyword\">const</span> sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*)(<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> sh-&gt;len;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>s bufchar8sdshdrlen<br>char buf[]sizeof(struct sdshdr)8<br><br><img src=\"/2019/03/27/Redis-sds/sdshdr.png\" alt=\"sdshdr\"></p>\n<h3 id=\"sdsavail-sdsfree\"><a href=\"#sdsavail-sdsfree\" class=\"headerlink\" title=\"sdsavail-sdsfree\"></a>sdsavail-sdsfree</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds </span></span><br><span class=\"line\"><span class=\"comment\"> *</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">static</span> <span class=\"keyword\">inline</span> size_t <span class=\"title\">sdsavail</span><span class=\"params\">(<span class=\"keyword\">const</span> sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*)(<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> sh-&gt;<span class=\"built_in\">free</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsnewlen-sds\"><a href=\"#sdsnewlen-sds\" class=\"headerlink\" title=\"sdsnewlen-sds\"></a>sdsnewlen-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  init  initlen, sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @param init </span></span><br><span class=\"line\"><span class=\"comment\"> * @param initlen </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sdshdr  sds, NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsnewlen</span><span class=\"params\">(<span class=\"keyword\">const</span> <span class=\"keyword\">void</span> *init, <span class=\"keyword\">size_t</span> initlen)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (init) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// zmalloc </span></span><br><span class=\"line\">        sh = zmalloc(<span class=\"keyword\">sizeof</span>(struct sdshdr)+initlen+<span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// zcalloc  0</span></span><br><span class=\"line\">        sh = zcalloc(<span class=\"keyword\">sizeof</span>(struct sdshdr)+initlen+<span class=\"number\">1</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (sh == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    sh-&gt;len = initlen;</span><br><span class=\"line\">    <span class=\"comment\">//  sds </span></span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"comment\">//  sdshdr  buf </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (initlen &amp;&amp; init)</span><br><span class=\"line\">        <span class=\"built_in\">memcpy</span>(sh-&gt;buf, init, initlen);</span><br><span class=\"line\">    <span class=\"comment\">//  \\0 </span></span><br><span class=\"line\">    sh-&gt;buf[initlen] = <span class=\"string\">'\\0'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  buf  sdshdr</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> (<span class=\"keyword\">char</span>*)sh-&gt;buf;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsnew-sds\"><a href=\"#sdsnew-sds\" class=\"headerlink\" title=\"sdsnew-sds\"></a>sdsnew-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  init  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @param init  NULL  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sdshdr  sds NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsnew</span><span class=\"params\">(<span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *init)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> initlen = (init == <span class=\"literal\">NULL</span>) ? <span class=\"number\">0</span> : <span class=\"built_in\">strlen</span>(init);</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdsnewlen(init, initlen);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsempty-sds\"><a href=\"#sdsempty-sds\" class=\"headerlink\" title=\"sdsempty-sds\"></a>sdsempty-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  \"\"  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sdshdr  sds, NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsempty</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdsnewlen(<span class=\"string\">\"\"</span>,<span class=\"number\">0</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsdup-sds\"><a href=\"#sdsdup-sds\" class=\"headerlink\" title=\"sdsdup-sds\"></a>sdsdup-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds </span></span><br><span class=\"line\"><span class=\"comment\"> *  T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsdup</span><span class=\"params\">(<span class=\"keyword\">const</span> sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdsnewlen(s, sdslen(s));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsfree-sds\"><a href=\"#sdsfree-sds\" class=\"headerlink\" title=\"sdsfree-sds\"></a>sdsfree-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @param s </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">sdsfree</span><span class=\"params\">(sds s)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\">    zfree(s-<span class=\"keyword\">sizeof</span>(struct sdshdr));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdsgrowzero-sds0\"><a href=\"#sdsgrowzero-sds0\" class=\"headerlink\" title=\"sdsgrowzero-sds0\"></a>sdsgrowzero-sds0</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  0 </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s</span></span><br><span class=\"line\"><span class=\"comment\"> * @param len </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsgrowzero</span><span class=\"params\">(sds s, <span class=\"keyword\">size_t</span> len)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*)(<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> totlen, curlen = sh-&gt;len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  len </span></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (len &lt;= curlen) <span class=\"keyword\">return</span> s;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    s = sdsMakeRoomFor(s,len-curlen);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  0 </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    sh = (<span class=\"keyword\">void</span>*)(s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\">    <span class=\"built_in\">memset</span>(s+curlen,<span class=\"number\">0</span>,(len-curlen+<span class=\"number\">1</span>));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    totlen = sh-&gt;len+sh-&gt;<span class=\"built_in\">free</span>;</span><br><span class=\"line\">    sh-&gt;len = len;</span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = totlen-sh-&gt;len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  buf </span></span><br><span class=\"line\"><span class=\"comment\"> * buf  addlen + 1  1  \\0 </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s </span></span><br><span class=\"line\"><span class=\"comment\"> * @param addlen </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdsMakeRoomFor</span><span class=\"params\">(sds s, <span class=\"keyword\">size_t</span> addlen)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span>, *<span class=\"title\">newsh</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s </span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> <span class=\"built_in\">free</span> = sdsavail(s);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> len, newlen;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// s </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">free</span> &gt;= addlen) <span class=\"keyword\">return</span> s;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s </span></span><br><span class=\"line\">    len = sdslen(s);</span><br><span class=\"line\">    sh = (<span class=\"keyword\">void</span>*) (s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// s </span></span><br><span class=\"line\">    newlen = (len+addlen);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newlen &lt; SDS_MAX_PREALLOC)</span><br><span class=\"line\">        <span class=\"comment\">//  SDS_MAX_PREALLOC </span></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        newlen *= <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"comment\">//  SDS_MAX_PREALLOC</span></span><br><span class=\"line\">        newlen += SDS_MAX_PREALLOC;</span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    newsh = zrealloc(sh, <span class=\"keyword\">sizeof</span>(struct sdshdr)+newlen+<span class=\"number\">1</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (newsh == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds </span></span><br><span class=\"line\">    newsh-&gt;<span class=\"built_in\">free</span> = newlen - len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> newsh-&gt;buf;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"meta\">#<span class=\"meta-keyword\">define</span> SDS_MAX_PREALLOC (1024*1024)</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscatlen-sds\"><a href=\"#sdscatlen-sds\" class=\"headerlink\" title=\"sdscatlen-sds\"></a>sdscatlen-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *   len  t  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @param s</span></span><br><span class=\"line\"><span class=\"comment\"> * @param t t</span></span><br><span class=\"line\"><span class=\"comment\"> * @param len t</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscatlen</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">void</span> *t, <span class=\"keyword\">size_t</span> len)</span> </span>&#123;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span>;</span></span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> curlen = sdslen(s);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    s = sdsMakeRoomFor(s,len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  t </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    sh = (<span class=\"keyword\">void</span>*) (s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(s+curlen, t, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    sh-&gt;len = curlen+len;</span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = sh-&gt;<span class=\"built_in\">free</span>-len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    s[curlen+len] = <span class=\"string\">'\\0'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscat-sds\"><a href=\"#sdscat-sds\" class=\"headerlink\" title=\"sdscat-sds\"></a>sdscat-sds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  t  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> *  T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscat</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdscatlen(s, t, <span class=\"built_in\">strlen</span>(t));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscatsds-sdssds\"><a href=\"#sdscatsds-sdssds\" class=\"headerlink\" title=\"sdscatsds-sdssds\"></a>sdscatsds-sdssds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  sds </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscatsds</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> sds t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdscatlen(s, t, sdslen(t));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscpylen-lensds\"><a href=\"#sdscpylen-lensds\" class=\"headerlink\" title=\"sdscpylen-lensds\"></a>sdscpylen-lensds</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  t  len  sds s ,</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds  len  sds</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscpylen</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *t, <span class=\"keyword\">size_t</span> len)</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">sdshdr</span> *<span class=\"title\">sh</span> = (<span class=\"title\">void</span>*) (<span class=\"title\">s</span>-(<span class=\"title\">sizeof</span>(<span class=\"title\">struct</span> <span class=\"title\">sdshdr</span>)));</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// sds  buf </span></span><br><span class=\"line\">    <span class=\"keyword\">size_t</span> totlen = sh-&gt;<span class=\"built_in\">free</span>+sh-&gt;len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  s  buf  len </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (totlen &lt; len) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">        s = sdsMakeRoomFor(s,len-sh-&gt;len);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        sh = (<span class=\"keyword\">void</span>*) (s-(<span class=\"keyword\">sizeof</span>(struct sdshdr)));</span><br><span class=\"line\">        totlen = sh-&gt;<span class=\"built_in\">free</span>+sh-&gt;len;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// T = O(N)</span></span><br><span class=\"line\">    <span class=\"built_in\">memcpy</span>(s, t, len);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    s[len] = <span class=\"string\">'\\0'</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    sh-&gt;len = len;</span><br><span class=\"line\">    sh-&gt;<span class=\"built_in\">free</span> = totlen-len;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//  sds</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"sdscpy--sds-\"><a href=\"#sdscpy--sds-\" class=\"headerlink\" title=\"sdscpy- sds \"></a>sdscpy- sds </h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  sds ,</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  sds  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">sds <span class=\"title\">sdscpy</span><span class=\"params\">(sds s, <span class=\"keyword\">const</span> <span class=\"keyword\">char</span> *t)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sdscpylen(s, t, <span class=\"built_in\">strlen</span>(t));</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"redis-list","date":"2019-03-28T08:18:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"## list\n```c\n/*\n * \n */\ntypedef struct listNode {\n\n    // \n    struct listNode *prev;\n\n    // \n    struct listNode *next;\n\n    // \n    void *value;\n\n} listNode;\n\n/*\n * \n */\ntypedef struct listIter {\n\n    // \n    listNode *next;\n\n    // \n    int direction;\n\n} listIter;\n\n/*\n * \n */\ntypedef struct list {\n\n    // \n    listNode *head;\n\n    // \n    listNode *tail;\n\n    // \n    void *(*dup)(void *ptr);\n\n    // \n    void (*free)(void *ptr);\n\n    // \n    int (*match)(void *ptr, void *key);\n\n    // \n    unsigned long len;\n\n} list;\n```\n<!-- more -->\n![list](Redis-adlist/list.png)\n## list\n\n### listCreate-\n```c\n/**\n * \n * @return   NULL\n * T = O(1)\n */\nlist *listCreate(void)\n{\n    struct list *list;\n\n    // \n    if ((list = zmalloc(sizeof(*list))) == NULL)\n        return NULL;\n\n    // \n    list->head = list->tail = NULL;\n    list->len = 0;\n    list->dup = NULL;\n    list->free = NULL;\n    list->match = NULL;\n\n    return list;\n}\n```\n\n### listRelease-\n```c\n/**\n * \n * @param list\n * T = O(N)\n */\nvoid listRelease(list *list)\n{\n    unsigned long len;\n    listNode *current, *next;\n\n    // \n    current = list->head;\n    // \n    len = list->len;\n    while(len--) {\n        next = current->next;\n\n        // \n        if (list->free) list->free(current->value);\n\n        // \n        zfree(current);\n\n        current = next;\n    }\n\n    // \n    zfree(list);\n}\n```\n### listAddNodeHead-\n```c\n/**\n *  value \n * @param list\n * @param value\n * @return  NULL\n * T = O(1)\n */\nlist *listAddNodeHead(list *list, void *value)\n{\n    listNode *node;\n\n    // \n    if ((node = zmalloc(sizeof(*node))) == NULL)\n        return NULL;\n\n    // \n    node->value = value;\n\n    // \n    if (list->len == 0) {\n        list->head = list->tail = node;\n        node->prev = node->next = NULL;\n    // \n    } else {\n        node->prev = NULL;\n        node->next = list->head;\n        list->head->prev = node;\n        list->head = node;\n    }\n\n    // \n    list->len++;\n\n    return list;\n}\n```\n### listAddNodeTail-\n```c\n/**\n *  value \n * @param list\n * @param value \n * @return  NULL\n * T = O(1)\n */\nlist *listAddNodeTail(list *list, void *value)\n{\n    listNode *node;\n\n    // \n    if ((node = zmalloc(sizeof(*node))) == NULL)\n        return NULL;\n\n    // \n    node->value = value;\n\n    // \n    if (list->len == 0) {\n        list->head = list->tail = node;\n        node->prev = node->next = NULL;\n    // \n    } else {\n        node->prev = list->tail;\n        node->next = NULL;\n        list->tail->next = node;\n        list->tail = node;\n    }\n\n    // \n    list->len++;\n\n    return list;\n}\n```\n### listInsertNode-\n```c\n/**\n *  value  old_node \n *  after  0  old_node \n *  after  1  old_node \n * @param list \n * @param old_node \n * @param value \n * @param after\n * @return  NULL\n * T = O(1)\n */\nlist *listInsertNode(list *list, listNode *old_node, void *value, int after) {\n    listNode *node;\n\n    // \n    if ((node = zmalloc(sizeof(*node))) == NULL)\n        return NULL;\n\n    // \n    node->value = value;\n\n    // \n    if (after) {\n        node->prev = old_node;\n        node->next = old_node->next;\n        // \n        if (list->tail == old_node) {\n            list->tail = node;\n        }\n    // \n    } else {\n        node->next = old_node;\n        node->prev = old_node->prev;\n        // \n        if (list->head == old_node) {\n            list->head = node;\n        }\n    }\n\n    // \n    if (node->prev != NULL) {\n        node->prev->next = node;\n    }\n    // \n    if (node->next != NULL) {\n        node->next->prev = node;\n    }\n\n    // \n    list->len++;\n\n    return list;\n}\n```\n### listDelNode-\n```c\n/**\n *  list  node \n * (private value of the node)\n * @param list \n * @param node \n * T = O(1)\n */\nvoid listDelNode(list *list, listNode *node)\n{\n    // \n    if (node->prev)\n        node->prev->next = node->next;\n    else\n        list->head = node->next;\n\n    // \n    if (node->next)\n        node->next->prev = node->prev;\n    else\n        list->tail = node->prev;\n\n    // \n    if (list->free) list->free(node->value);\n\n    // \n    zfree(node);\n\n    // \n    list->len--;\n}\n\n```\n### listGetIterator-\n```c\n/**\n * \n *  listNext \n * @param list \n * @param direction  \n *        AL_START_HEAD \n *        AL_START_TAIL \n * @return \n * T = O(1)\n */\nlistIter *listGetIterator(list *list, int direction)\n{\n    // \n    listIter *iter;\n    if ((iter = zmalloc(sizeof(*iter))) == NULL) return NULL;\n\n    // \n    if (direction == AL_START_HEAD)\n        iter->next = list->head;\n    else\n        iter->next = list->tail;\n\n    // \n    iter->direction = direction;\n\n    return iter;\n}\n```\n### listNext-\n```c\n/**\n * \n * \n * @param iter \n * @return  NULL \n * T = O(1)\n */\nlistNode *listNext(listIter *iter)\n{\n    listNode *current = iter->next;\n\n    if (current != NULL) {\n        // \n        if (iter->direction == AL_START_HEAD)\n            // \n            iter->next = current->next;\n        else\n            // \n            iter->next = current->prev;\n    }\n\n    return current;\n}\n```\n### listDup-\n```c\n/**\n * \n * \n *  dup \n * \n * @param orig\n * @return  NULL \n * T = O(N)\n */\nlist *listDup(list *orig)\n{\n    list *copy;\n    listIter *iter;\n    listNode *node;\n\n    // \n    if ((copy = listCreate()) == NULL)\n        return NULL;\n\n    // \n    copy->dup = orig->dup;\n    copy->free = orig->free;\n    copy->match = orig->match;\n\n    // \n    iter = listGetIterator(orig, AL_START_HEAD);\n    while((node = listNext(iter)) != NULL) {\n        void *value;\n\n        // \n        if (copy->dup) {\n            value = copy->dup(node->value);\n            if (value == NULL) {\n                listRelease(copy);\n                listReleaseIterator(iter);\n                return NULL;\n            }\n        } else\n            value = node->value;\n\n        // \n        if (listAddNodeTail(copy, value) == NULL) {\n            listRelease(copy);\n            listReleaseIterator(iter);\n            return NULL;\n        }\n    }\n\n    // \n    listReleaseIterator(iter);\n\n    // \n    return copy;\n}\n```\n### listSearchKey-key\n```c\n/**\n *  list  key \n *  match  match \n * \n * @param list \n * @param key \n * @return \n *          NULL \n */\nlistNode *listSearchKey(list *list, void *key)\n{\n    listIter *iter;\n    listNode *node;\n\n    // \n    iter = listGetIterator(list, AL_START_HEAD);\n    while((node = listNext(iter)) != NULL) {\n        \n        // \n        if (list->match) {\n            if (list->match(node->value, key)) {\n                listReleaseIterator(iter);\n                // \n                return node;\n            }\n        } else {\n            if (key == node->value) {\n                listReleaseIterator(iter);\n                // \n                return node;\n            }\n        }\n    }\n    \n    listReleaseIterator(iter);\n\n    // \n    return NULL;\n}\n```\n### listIndex-\n```c\n/**\n * \n * @param list \n * @param index  0  -1 \n * @return out of range NULL \n * T = O(N)\n */\nlistNode *listIndex(list *list, long index) {\n    listNode *n;\n\n    // \n    if (index < 0) {\n        index = (-index)-1;\n        n = list->tail;\n        while(index-- && n) n = n->prev;\n    // \n    } else {\n        n = list->head;\n        while(index-- && n) n = n->next;\n    }\n\n    return n;\n}\n```\n### listRewind-\n```c\n/**\n *  AL_START_HEAD \n * @param list \n * @param li \n * T = O(1)\n */\nvoid listRewind(list *list, listIter *li) {\n    li->next = list->head;\n    li->direction = AL_START_HEAD;\n}\n```\n### listRewindTail-\n```c\n/**\n *  AL_START_TAIL, \n * @param list \n * @param li \n * T = O(1)\n */\nvoid listRewindTail(list *list, listIter *li) {\n    li->next = list->tail;\n    li->direction = AL_START_TAIL;\n}\n```\n### listRotate-\n```c\n/\n * \n * @param list \n * T = O(1)\n */\nvoid listRotate(list *list) {\n    listNode *tail = list->tail;\n\n    if (listLength(list) <= 1) return;\n\n    // \n    list->tail = tail->prev;\n    list->tail->next = NULL;\n\n    // \n    list->head->prev = tail;\n    tail->prev = NULL;\n    tail->next = list->head;\n    list->head = tail;\n}\n```","source":"_posts/Redis-adlist.md","raw":"---\ntitle: redis-list\ndate: 2019-03-28 16:18:04\ntags:\n    - redis\n    - \ncategories: redis\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n## list\n```c\n/*\n * \n */\ntypedef struct listNode {\n\n    // \n    struct listNode *prev;\n\n    // \n    struct listNode *next;\n\n    // \n    void *value;\n\n} listNode;\n\n/*\n * \n */\ntypedef struct listIter {\n\n    // \n    listNode *next;\n\n    // \n    int direction;\n\n} listIter;\n\n/*\n * \n */\ntypedef struct list {\n\n    // \n    listNode *head;\n\n    // \n    listNode *tail;\n\n    // \n    void *(*dup)(void *ptr);\n\n    // \n    void (*free)(void *ptr);\n\n    // \n    int (*match)(void *ptr, void *key);\n\n    // \n    unsigned long len;\n\n} list;\n```\n<!-- more -->\n![list](Redis-adlist/list.png)\n## list\n\n### listCreate-\n```c\n/**\n * \n * @return   NULL\n * T = O(1)\n */\nlist *listCreate(void)\n{\n    struct list *list;\n\n    // \n    if ((list = zmalloc(sizeof(*list))) == NULL)\n        return NULL;\n\n    // \n    list->head = list->tail = NULL;\n    list->len = 0;\n    list->dup = NULL;\n    list->free = NULL;\n    list->match = NULL;\n\n    return list;\n}\n```\n\n### listRelease-\n```c\n/**\n * \n * @param list\n * T = O(N)\n */\nvoid listRelease(list *list)\n{\n    unsigned long len;\n    listNode *current, *next;\n\n    // \n    current = list->head;\n    // \n    len = list->len;\n    while(len--) {\n        next = current->next;\n\n        // \n        if (list->free) list->free(current->value);\n\n        // \n        zfree(current);\n\n        current = next;\n    }\n\n    // \n    zfree(list);\n}\n```\n### listAddNodeHead-\n```c\n/**\n *  value \n * @param list\n * @param value\n * @return  NULL\n * T = O(1)\n */\nlist *listAddNodeHead(list *list, void *value)\n{\n    listNode *node;\n\n    // \n    if ((node = zmalloc(sizeof(*node))) == NULL)\n        return NULL;\n\n    // \n    node->value = value;\n\n    // \n    if (list->len == 0) {\n        list->head = list->tail = node;\n        node->prev = node->next = NULL;\n    // \n    } else {\n        node->prev = NULL;\n        node->next = list->head;\n        list->head->prev = node;\n        list->head = node;\n    }\n\n    // \n    list->len++;\n\n    return list;\n}\n```\n### listAddNodeTail-\n```c\n/**\n *  value \n * @param list\n * @param value \n * @return  NULL\n * T = O(1)\n */\nlist *listAddNodeTail(list *list, void *value)\n{\n    listNode *node;\n\n    // \n    if ((node = zmalloc(sizeof(*node))) == NULL)\n        return NULL;\n\n    // \n    node->value = value;\n\n    // \n    if (list->len == 0) {\n        list->head = list->tail = node;\n        node->prev = node->next = NULL;\n    // \n    } else {\n        node->prev = list->tail;\n        node->next = NULL;\n        list->tail->next = node;\n        list->tail = node;\n    }\n\n    // \n    list->len++;\n\n    return list;\n}\n```\n### listInsertNode-\n```c\n/**\n *  value  old_node \n *  after  0  old_node \n *  after  1  old_node \n * @param list \n * @param old_node \n * @param value \n * @param after\n * @return  NULL\n * T = O(1)\n */\nlist *listInsertNode(list *list, listNode *old_node, void *value, int after) {\n    listNode *node;\n\n    // \n    if ((node = zmalloc(sizeof(*node))) == NULL)\n        return NULL;\n\n    // \n    node->value = value;\n\n    // \n    if (after) {\n        node->prev = old_node;\n        node->next = old_node->next;\n        // \n        if (list->tail == old_node) {\n            list->tail = node;\n        }\n    // \n    } else {\n        node->next = old_node;\n        node->prev = old_node->prev;\n        // \n        if (list->head == old_node) {\n            list->head = node;\n        }\n    }\n\n    // \n    if (node->prev != NULL) {\n        node->prev->next = node;\n    }\n    // \n    if (node->next != NULL) {\n        node->next->prev = node;\n    }\n\n    // \n    list->len++;\n\n    return list;\n}\n```\n### listDelNode-\n```c\n/**\n *  list  node \n * (private value of the node)\n * @param list \n * @param node \n * T = O(1)\n */\nvoid listDelNode(list *list, listNode *node)\n{\n    // \n    if (node->prev)\n        node->prev->next = node->next;\n    else\n        list->head = node->next;\n\n    // \n    if (node->next)\n        node->next->prev = node->prev;\n    else\n        list->tail = node->prev;\n\n    // \n    if (list->free) list->free(node->value);\n\n    // \n    zfree(node);\n\n    // \n    list->len--;\n}\n\n```\n### listGetIterator-\n```c\n/**\n * \n *  listNext \n * @param list \n * @param direction  \n *        AL_START_HEAD \n *        AL_START_TAIL \n * @return \n * T = O(1)\n */\nlistIter *listGetIterator(list *list, int direction)\n{\n    // \n    listIter *iter;\n    if ((iter = zmalloc(sizeof(*iter))) == NULL) return NULL;\n\n    // \n    if (direction == AL_START_HEAD)\n        iter->next = list->head;\n    else\n        iter->next = list->tail;\n\n    // \n    iter->direction = direction;\n\n    return iter;\n}\n```\n### listNext-\n```c\n/**\n * \n * \n * @param iter \n * @return  NULL \n * T = O(1)\n */\nlistNode *listNext(listIter *iter)\n{\n    listNode *current = iter->next;\n\n    if (current != NULL) {\n        // \n        if (iter->direction == AL_START_HEAD)\n            // \n            iter->next = current->next;\n        else\n            // \n            iter->next = current->prev;\n    }\n\n    return current;\n}\n```\n### listDup-\n```c\n/**\n * \n * \n *  dup \n * \n * @param orig\n * @return  NULL \n * T = O(N)\n */\nlist *listDup(list *orig)\n{\n    list *copy;\n    listIter *iter;\n    listNode *node;\n\n    // \n    if ((copy = listCreate()) == NULL)\n        return NULL;\n\n    // \n    copy->dup = orig->dup;\n    copy->free = orig->free;\n    copy->match = orig->match;\n\n    // \n    iter = listGetIterator(orig, AL_START_HEAD);\n    while((node = listNext(iter)) != NULL) {\n        void *value;\n\n        // \n        if (copy->dup) {\n            value = copy->dup(node->value);\n            if (value == NULL) {\n                listRelease(copy);\n                listReleaseIterator(iter);\n                return NULL;\n            }\n        } else\n            value = node->value;\n\n        // \n        if (listAddNodeTail(copy, value) == NULL) {\n            listRelease(copy);\n            listReleaseIterator(iter);\n            return NULL;\n        }\n    }\n\n    // \n    listReleaseIterator(iter);\n\n    // \n    return copy;\n}\n```\n### listSearchKey-key\n```c\n/**\n *  list  key \n *  match  match \n * \n * @param list \n * @param key \n * @return \n *          NULL \n */\nlistNode *listSearchKey(list *list, void *key)\n{\n    listIter *iter;\n    listNode *node;\n\n    // \n    iter = listGetIterator(list, AL_START_HEAD);\n    while((node = listNext(iter)) != NULL) {\n        \n        // \n        if (list->match) {\n            if (list->match(node->value, key)) {\n                listReleaseIterator(iter);\n                // \n                return node;\n            }\n        } else {\n            if (key == node->value) {\n                listReleaseIterator(iter);\n                // \n                return node;\n            }\n        }\n    }\n    \n    listReleaseIterator(iter);\n\n    // \n    return NULL;\n}\n```\n### listIndex-\n```c\n/**\n * \n * @param list \n * @param index  0  -1 \n * @return out of range NULL \n * T = O(N)\n */\nlistNode *listIndex(list *list, long index) {\n    listNode *n;\n\n    // \n    if (index < 0) {\n        index = (-index)-1;\n        n = list->tail;\n        while(index-- && n) n = n->prev;\n    // \n    } else {\n        n = list->head;\n        while(index-- && n) n = n->next;\n    }\n\n    return n;\n}\n```\n### listRewind-\n```c\n/**\n *  AL_START_HEAD \n * @param list \n * @param li \n * T = O(1)\n */\nvoid listRewind(list *list, listIter *li) {\n    li->next = list->head;\n    li->direction = AL_START_HEAD;\n}\n```\n### listRewindTail-\n```c\n/**\n *  AL_START_TAIL, \n * @param list \n * @param li \n * T = O(1)\n */\nvoid listRewindTail(list *list, listIter *li) {\n    li->next = list->tail;\n    li->direction = AL_START_TAIL;\n}\n```\n### listRotate-\n```c\n/\n * \n * @param list \n * T = O(1)\n */\nvoid listRotate(list *list) {\n    listNode *tail = list->tail;\n\n    if (listLength(list) <= 1) return;\n\n    // \n    list->tail = tail->prev;\n    list->tail->next = NULL;\n\n    // \n    list->head->prev = tail;\n    tail->prev = NULL;\n    tail->next = list->head;\n    list->head = tail;\n}\n```","slug":"Redis-adlist","published":1,"updated":"2019-07-30T11:37:16.764Z","layout":"post","photos":[],"link":"","_id":"ck4859y9a003vt0fywpon18c5","content":"<h2 id=\"list\"><a href=\"#list\" class=\"headerlink\" title=\"list\"></a>list</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listNode</span> &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listNode</span> *<span class=\"title\">prev</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listNode</span> *<span class=\"title\">next</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> *value;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; listNode;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listIter</span> &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listNode *next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> direction;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; listIter;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">list</span> &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listNode *head;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listNode *tail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> *(*dup)(<span class=\"keyword\">void</span> *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> (*<span class=\"built_in\">free</span>)(<span class=\"keyword\">void</span> *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> (*match)(<span class=\"keyword\">void</span> *ptr, <span class=\"keyword\">void</span> *key);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> len;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"built_in\">list</span>;</span><br></pre></td></tr></table></figure>\n\n<a id=\"more\"></a>\n<p><img src=\"/2019/03/28/Redis-adlist/list.png\" alt=\"list\"></p>\n<h2 id=\"list\"><a href=\"#list\" class=\"headerlink\" title=\"list\"></a>list</h2><h3 id=\"listCreate-\"><a href=\"#listCreate-\" class=\"headerlink\" title=\"listCreate-\"></a>listCreate-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @return   NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listCreate</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">list</span> *<span class=\"title\">list</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((<span class=\"built_in\">list</span> = zmalloc(<span class=\"keyword\">sizeof</span>(*<span class=\"built_in\">list</span>))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;head = <span class=\"built_in\">list</span>-&gt;tail = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;dup = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span> = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;match = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRelease-\"><a href=\"#listRelease-\" class=\"headerlink\" title=\"listRelease-\"></a>listRelease-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listRelease</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> len;</span><br><span class=\"line\">    listNode *current, *next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    current = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    len = <span class=\"built_in\">list</span>-&gt;len;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(len--) &#123;</span><br><span class=\"line\">        next = current-&gt;next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>) <span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>(current-&gt;value);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        zfree(current);</span><br><span class=\"line\"></span><br><span class=\"line\">        current = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    zfree(<span class=\"built_in\">list</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listAddNodeHead-\"><a href=\"#listAddNodeHead-\" class=\"headerlink\" title=\"listAddNodeHead-\"></a>listAddNodeHead-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  value </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list</span></span><br><span class=\"line\"><span class=\"comment\"> * @param value</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listAddNodeHead</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">void</span> *value)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((node = zmalloc(<span class=\"keyword\">sizeof</span>(*node))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    node-&gt;value = value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;len == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">        node-&gt;prev = node-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        node-&gt;prev = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        node-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head-&gt;prev = node;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listAddNodeTail-\"><a href=\"#listAddNodeTail-\" class=\"headerlink\" title=\"listAddNodeTail-\"></a>listAddNodeTail-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  value </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list</span></span><br><span class=\"line\"><span class=\"comment\"> * @param value </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listAddNodeTail</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">void</span> *value)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((node = zmalloc(<span class=\"keyword\">sizeof</span>(*node))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    node-&gt;value = value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;len == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">        node-&gt;prev = node-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        node-&gt;prev = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\">        node-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;tail-&gt;next = node;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listInsertNode-\"><a href=\"#listInsertNode-\" class=\"headerlink\" title=\"listInsertNode-\"></a>listInsertNode-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  value  old_node </span></span><br><span class=\"line\"><span class=\"comment\"> *  after  0  old_node </span></span><br><span class=\"line\"><span class=\"comment\"> *  after  1  old_node </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param old_node </span></span><br><span class=\"line\"><span class=\"comment\"> * @param value </span></span><br><span class=\"line\"><span class=\"comment\"> * @param after</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listInsertNode</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listNode *old_node, <span class=\"keyword\">void</span> *value, <span class=\"keyword\">int</span> after)</span> </span>&#123;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((node = zmalloc(<span class=\"keyword\">sizeof</span>(*node))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    node-&gt;value = value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (after) &#123;</span><br><span class=\"line\">        node-&gt;prev = old_node;</span><br><span class=\"line\">        node-&gt;next = old_node-&gt;next;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;tail == old_node) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        node-&gt;next = old_node;</span><br><span class=\"line\">        node-&gt;prev = old_node-&gt;prev;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;head == old_node) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">list</span>-&gt;head = node;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;prev != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        node-&gt;prev-&gt;next = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;next != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        node-&gt;next-&gt;prev = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listDelNode-\"><a href=\"#listDelNode-\" class=\"headerlink\" title=\"listDelNode-\"></a>listDelNode-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  list  node </span></span><br><span class=\"line\"><span class=\"comment\"> * (private value of the node)</span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param node </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listDelNode</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listNode *node)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;prev)</span><br><span class=\"line\">        node-&gt;prev-&gt;next = node-&gt;next;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = node-&gt;next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;next)</span><br><span class=\"line\">        node-&gt;next-&gt;prev = node-&gt;prev;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;tail = node-&gt;prev;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>) <span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>(node-&gt;value);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    zfree(node);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len--;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listGetIterator-\"><a href=\"#listGetIterator-\" class=\"headerlink\" title=\"listGetIterator-\"></a>listGetIterator-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> *  listNext </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param direction  </span></span><br><span class=\"line\"><span class=\"comment\"> *        AL_START_HEAD </span></span><br><span class=\"line\"><span class=\"comment\"> *        AL_START_TAIL </span></span><br><span class=\"line\"><span class=\"comment\"> * @return </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listIter *<span class=\"title\">listGetIterator</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">int</span> direction)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listIter *iter;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((iter = zmalloc(<span class=\"keyword\">sizeof</span>(*iter))) == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (direction == AL_START_HEAD)</span><br><span class=\"line\">        iter-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        iter-&gt;next = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    iter-&gt;direction = direction;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> iter;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listNext-\"><a href=\"#listNext-\" class=\"headerlink\" title=\"listNext-\"></a>listNext-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param iter </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listNode *<span class=\"title\">listNext</span><span class=\"params\">(listIter *iter)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listNode *current = iter-&gt;next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (current != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (iter-&gt;direction == AL_START_HEAD)</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            iter-&gt;next = current-&gt;next;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            iter-&gt;next = current-&gt;prev;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> current;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listDup-\"><a href=\"#listDup-\" class=\"headerlink\" title=\"listDup-\"></a>listDup-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> *  dup </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param orig</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listDup</span><span class=\"params\">(<span class=\"built_in\">list</span> *orig)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">list</span> *copy;</span><br><span class=\"line\">    listIter *iter;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((copy = listCreate()) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    copy-&gt;dup = orig-&gt;dup;</span><br><span class=\"line\">    copy-&gt;<span class=\"built_in\">free</span> = orig-&gt;<span class=\"built_in\">free</span>;</span><br><span class=\"line\">    copy-&gt;match = orig-&gt;match;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    iter = listGetIterator(orig, AL_START_HEAD);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((node = listNext(iter)) != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">void</span> *value;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (copy-&gt;dup) &#123;</span><br><span class=\"line\">            value = copy-&gt;dup(node-&gt;value);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (value == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">                listRelease(copy);</span><br><span class=\"line\">                listReleaseIterator(iter);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span></span><br><span class=\"line\">            value = node-&gt;value;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (listAddNodeTail(copy, value) == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">            listRelease(copy);</span><br><span class=\"line\">            listReleaseIterator(iter);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listReleaseIterator(iter);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> copy;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listSearchKey-key\"><a href=\"#listSearchKey-key\" class=\"headerlink\" title=\"listSearchKey-key\"></a>listSearchKey-key</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  list  key </span></span><br><span class=\"line\"><span class=\"comment\"> *  match  match </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param key </span></span><br><span class=\"line\"><span class=\"comment\"> * @return </span></span><br><span class=\"line\"><span class=\"comment\"> *          NULL </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listNode *<span class=\"title\">listSearchKey</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">void</span> *key)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listIter *iter;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    iter = listGetIterator(<span class=\"built_in\">list</span>, AL_START_HEAD);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((node = listNext(iter)) != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;match) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;match(node-&gt;value, key)) &#123;</span><br><span class=\"line\">                listReleaseIterator(iter);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> node;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (key == node-&gt;value) &#123;</span><br><span class=\"line\">                listReleaseIterator(iter);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> node;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    listReleaseIterator(iter);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listIndex-\"><a href=\"#listIndex-\" class=\"headerlink\" title=\"listIndex-\"></a>listIndex-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param index  0  -1 </span></span><br><span class=\"line\"><span class=\"comment\"> * @return out of range NULL </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listNode *<span class=\"title\">listIndex</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">long</span> index)</span> </span>&#123;</span><br><span class=\"line\">    listNode *n;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        index = (-index)<span class=\"number\">-1</span>;</span><br><span class=\"line\">        n = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(index-- &amp;&amp; n) n = n-&gt;prev;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        n = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(index-- &amp;&amp; n) n = n-&gt;next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> n;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRewind-\"><a href=\"#listRewind-\" class=\"headerlink\" title=\"listRewind-\"></a>listRewind-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  AL_START_HEAD </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param li </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listRewind</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listIter *li)</span> </span>&#123;</span><br><span class=\"line\">    li-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    li-&gt;direction = AL_START_HEAD;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRewindTail-\"><a href=\"#listRewindTail-\" class=\"headerlink\" title=\"listRewindTail-\"></a>listRewindTail-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  AL_START_TAIL, </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param li </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listRewindTail</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listIter *li)</span> </span>&#123;</span><br><span class=\"line\">    li-&gt;next = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\">    li-&gt;direction = AL_START_TAIL;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRotate-\"><a href=\"#listRotate-\" class=\"headerlink\" title=\"listRotate-\"></a>listRotate-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/</span><br><span class=\"line\"> * </span><br><span class=\"line\"> * @param <span class=\"built_in\">list</span> </span><br><span class=\"line\"> * T = O(<span class=\"number\">1</span>)</span><br><span class=\"line\"> */</span><br><span class=\"line\"><span class=\"keyword\">void</span> listRotate(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>) &#123;</span><br><span class=\"line\">    listNode *tail = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (listLength(<span class=\"built_in\">list</span>) &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;tail = tail-&gt;prev;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;tail-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;head-&gt;prev = tail;</span><br><span class=\"line\">    tail-&gt;prev = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    tail-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;head = tail;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h2 id=\"list\"><a href=\"#list\" class=\"headerlink\" title=\"list\"></a>list</h2><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listNode</span> &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listNode</span> *<span class=\"title\">prev</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listNode</span> *<span class=\"title\">next</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> *value;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; listNode;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">listIter</span> &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listNode *next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> direction;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; listIter;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/*</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">typedef</span> <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">list</span> &#123;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listNode *head;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listNode *tail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> *(*dup)(<span class=\"keyword\">void</span> *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">void</span> (*<span class=\"built_in\">free</span>)(<span class=\"keyword\">void</span> *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> (*match)(<span class=\"keyword\">void</span> *ptr, <span class=\"keyword\">void</span> *key);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> len;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125; <span class=\"built_in\">list</span>;</span><br></pre></td></tr></table></figure>","more":"<p><img src=\"/2019/03/28/Redis-adlist/list.png\" alt=\"list\"></p>\n<h2 id=\"list\"><a href=\"#list\" class=\"headerlink\" title=\"list\"></a>list</h2><h3 id=\"listCreate-\"><a href=\"#listCreate-\" class=\"headerlink\" title=\"listCreate-\"></a>listCreate-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @return   NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listCreate</span><span class=\"params\">(<span class=\"keyword\">void</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"class\"><span class=\"keyword\">struct</span> <span class=\"title\">list</span> *<span class=\"title\">list</span>;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((<span class=\"built_in\">list</span> = zmalloc(<span class=\"keyword\">sizeof</span>(*<span class=\"built_in\">list</span>))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;head = <span class=\"built_in\">list</span>-&gt;tail = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;dup = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span> = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;match = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRelease-\"><a href=\"#listRelease-\" class=\"headerlink\" title=\"listRelease-\"></a>listRelease-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listRelease</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">unsigned</span> <span class=\"keyword\">long</span> len;</span><br><span class=\"line\">    listNode *current, *next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    current = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    len = <span class=\"built_in\">list</span>-&gt;len;</span><br><span class=\"line\">    <span class=\"keyword\">while</span>(len--) &#123;</span><br><span class=\"line\">        next = current-&gt;next;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>) <span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>(current-&gt;value);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        zfree(current);</span><br><span class=\"line\"></span><br><span class=\"line\">        current = next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    zfree(<span class=\"built_in\">list</span>);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listAddNodeHead-\"><a href=\"#listAddNodeHead-\" class=\"headerlink\" title=\"listAddNodeHead-\"></a>listAddNodeHead-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  value </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list</span></span><br><span class=\"line\"><span class=\"comment\"> * @param value</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listAddNodeHead</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">void</span> *value)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((node = zmalloc(<span class=\"keyword\">sizeof</span>(*node))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    node-&gt;value = value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;len == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">        node-&gt;prev = node-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        node-&gt;prev = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        node-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head-&gt;prev = node;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listAddNodeTail-\"><a href=\"#listAddNodeTail-\" class=\"headerlink\" title=\"listAddNodeTail-\"></a>listAddNodeTail-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  value </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list</span></span><br><span class=\"line\"><span class=\"comment\"> * @param value </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listAddNodeTail</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">void</span> *value)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((node = zmalloc(<span class=\"keyword\">sizeof</span>(*node))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    node-&gt;value = value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;len == <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">        node-&gt;prev = node-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        node-&gt;prev = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\">        node-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;tail-&gt;next = node;</span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listInsertNode-\"><a href=\"#listInsertNode-\" class=\"headerlink\" title=\"listInsertNode-\"></a>listInsertNode-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  value  old_node </span></span><br><span class=\"line\"><span class=\"comment\"> *  after  0  old_node </span></span><br><span class=\"line\"><span class=\"comment\"> *  after  1  old_node </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param old_node </span></span><br><span class=\"line\"><span class=\"comment\"> * @param value </span></span><br><span class=\"line\"><span class=\"comment\"> * @param after</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL</span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listInsertNode</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listNode *old_node, <span class=\"keyword\">void</span> *value, <span class=\"keyword\">int</span> after)</span> </span>&#123;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((node = zmalloc(<span class=\"keyword\">sizeof</span>(*node))) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    node-&gt;value = value;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (after) &#123;</span><br><span class=\"line\">        node-&gt;prev = old_node;</span><br><span class=\"line\">        node-&gt;next = old_node-&gt;next;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;tail == old_node) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">list</span>-&gt;tail = node;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        node-&gt;next = old_node;</span><br><span class=\"line\">        node-&gt;prev = old_node-&gt;prev;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;head == old_node) &#123;</span><br><span class=\"line\">            <span class=\"built_in\">list</span>-&gt;head = node;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;prev != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        node-&gt;prev-&gt;next = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;next != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        node-&gt;next-&gt;prev = node;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len++;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"built_in\">list</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listDelNode-\"><a href=\"#listDelNode-\" class=\"headerlink\" title=\"listDelNode-\"></a>listDelNode-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  list  node </span></span><br><span class=\"line\"><span class=\"comment\"> * (private value of the node)</span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param node </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listDelNode</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listNode *node)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;prev)</span><br><span class=\"line\">        node-&gt;prev-&gt;next = node-&gt;next;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;head = node-&gt;next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (node-&gt;next)</span><br><span class=\"line\">        node-&gt;next-&gt;prev = node-&gt;prev;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        <span class=\"built_in\">list</span>-&gt;tail = node-&gt;prev;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>) <span class=\"built_in\">list</span>-&gt;<span class=\"built_in\">free</span>(node-&gt;value);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    zfree(node);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;len--;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listGetIterator-\"><a href=\"#listGetIterator-\" class=\"headerlink\" title=\"listGetIterator-\"></a>listGetIterator-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> *  listNext </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param direction  </span></span><br><span class=\"line\"><span class=\"comment\"> *        AL_START_HEAD </span></span><br><span class=\"line\"><span class=\"comment\"> *        AL_START_TAIL </span></span><br><span class=\"line\"><span class=\"comment\"> * @return </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listIter *<span class=\"title\">listGetIterator</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">int</span> direction)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listIter *iter;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((iter = zmalloc(<span class=\"keyword\">sizeof</span>(*iter))) == <span class=\"literal\">NULL</span>) <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (direction == AL_START_HEAD)</span><br><span class=\"line\">        iter-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    <span class=\"keyword\">else</span></span><br><span class=\"line\">        iter-&gt;next = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    iter-&gt;direction = direction;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> iter;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listNext-\"><a href=\"#listNext-\" class=\"headerlink\" title=\"listNext-\"></a>listNext-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param iter </span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listNode *<span class=\"title\">listNext</span><span class=\"params\">(listIter *iter)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listNode *current = iter-&gt;next;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (current != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (iter-&gt;direction == AL_START_HEAD)</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            iter-&gt;next = current-&gt;next;</span><br><span class=\"line\">        <span class=\"keyword\">else</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            iter-&gt;next = current-&gt;prev;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> current;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listDup-\"><a href=\"#listDup-\" class=\"headerlink\" title=\"listDup-\"></a>listDup-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> *  dup </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param orig</span></span><br><span class=\"line\"><span class=\"comment\"> * @return  NULL </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"built_in\">list</span> *<span class=\"title\">listDup</span><span class=\"params\">(<span class=\"built_in\">list</span> *orig)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    <span class=\"built_in\">list</span> *copy;</span><br><span class=\"line\">    listIter *iter;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> ((copy = listCreate()) == <span class=\"literal\">NULL</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    copy-&gt;dup = orig-&gt;dup;</span><br><span class=\"line\">    copy-&gt;<span class=\"built_in\">free</span> = orig-&gt;<span class=\"built_in\">free</span>;</span><br><span class=\"line\">    copy-&gt;match = orig-&gt;match;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    iter = listGetIterator(orig, AL_START_HEAD);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((node = listNext(iter)) != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">void</span> *value;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (copy-&gt;dup) &#123;</span><br><span class=\"line\">            value = copy-&gt;dup(node-&gt;value);</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (value == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">                listRelease(copy);</span><br><span class=\"line\">                listReleaseIterator(iter);</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span></span><br><span class=\"line\">            value = node-&gt;value;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (listAddNodeTail(copy, value) == <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">            listRelease(copy);</span><br><span class=\"line\">            listReleaseIterator(iter);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    listReleaseIterator(iter);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> copy;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listSearchKey-key\"><a href=\"#listSearchKey-key\" class=\"headerlink\" title=\"listSearchKey-key\"></a>listSearchKey-key</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  list  key </span></span><br><span class=\"line\"><span class=\"comment\"> *  match  match </span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param key </span></span><br><span class=\"line\"><span class=\"comment\"> * @return </span></span><br><span class=\"line\"><span class=\"comment\"> *          NULL </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listNode *<span class=\"title\">listSearchKey</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">void</span> *key)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">    listIter *iter;</span><br><span class=\"line\">    listNode *node;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    iter = listGetIterator(<span class=\"built_in\">list</span>, AL_START_HEAD);</span><br><span class=\"line\">    <span class=\"keyword\">while</span>((node = listNext(iter)) != <span class=\"literal\">NULL</span>) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;match) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"built_in\">list</span>-&gt;match(node-&gt;value, key)) &#123;</span><br><span class=\"line\">                listReleaseIterator(iter);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> node;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (key == node-&gt;value) &#123;</span><br><span class=\"line\">                listReleaseIterator(iter);</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> node;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    listReleaseIterator(iter);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listIndex-\"><a href=\"#listIndex-\" class=\"headerlink\" title=\"listIndex-\"></a>listIndex-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param index  0  -1 </span></span><br><span class=\"line\"><span class=\"comment\"> * @return out of range NULL </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(N)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\">listNode *<span class=\"title\">listIndex</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, <span class=\"keyword\">long</span> index)</span> </span>&#123;</span><br><span class=\"line\">    listNode *n;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (index &lt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">        index = (-index)<span class=\"number\">-1</span>;</span><br><span class=\"line\">        n = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(index-- &amp;&amp; n) n = n-&gt;prev;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">        n = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">        <span class=\"keyword\">while</span>(index-- &amp;&amp; n) n = n-&gt;next;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> n;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRewind-\"><a href=\"#listRewind-\" class=\"headerlink\" title=\"listRewind-\"></a>listRewind-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  AL_START_HEAD </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param li </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listRewind</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listIter *li)</span> </span>&#123;</span><br><span class=\"line\">    li-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    li-&gt;direction = AL_START_HEAD;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRewindTail-\"><a href=\"#listRewindTail-\" class=\"headerlink\" title=\"listRewindTail-\"></a>listRewindTail-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> *  AL_START_TAIL, </span></span><br><span class=\"line\"><span class=\"comment\"> * @param list </span></span><br><span class=\"line\"><span class=\"comment\"> * @param li </span></span><br><span class=\"line\"><span class=\"comment\"> * T = O(1)</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">listRewindTail</span><span class=\"params\">(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>, listIter *li)</span> </span>&#123;</span><br><span class=\"line\">    li-&gt;next = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\">    li-&gt;direction = AL_START_TAIL;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"listRotate-\"><a href=\"#listRotate-\" class=\"headerlink\" title=\"listRotate-\"></a>listRotate-</h3><figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/</span><br><span class=\"line\"> * </span><br><span class=\"line\"> * @param <span class=\"built_in\">list</span> </span><br><span class=\"line\"> * T = O(<span class=\"number\">1</span>)</span><br><span class=\"line\"> */</span><br><span class=\"line\"><span class=\"keyword\">void</span> listRotate(<span class=\"built_in\">list</span> *<span class=\"built_in\">list</span>) &#123;</span><br><span class=\"line\">    listNode *tail = <span class=\"built_in\">list</span>-&gt;tail;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (listLength(<span class=\"built_in\">list</span>) &lt;= <span class=\"number\">1</span>) <span class=\"keyword\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;tail = tail-&gt;prev;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;tail-&gt;next = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;head-&gt;prev = tail;</span><br><span class=\"line\">    tail-&gt;prev = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">    tail-&gt;next = <span class=\"built_in\">list</span>-&gt;head;</span><br><span class=\"line\">    <span class=\"built_in\">list</span>-&gt;head = tail;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>"},{"title":"Kafka","date":"2019-05-25T03:38:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"## Kafka\nkafkaLinkedInLinkedIn\n<!-- more -->\n## Kafka\nKafkaLinkedInScala\n\nkafkatopictopictopicpartitionpartitionparition\n\nkafkaappend\n\n## Kafka\n\n### \n* **Broker**brokerKafkabroker\n* **Topic**Kafkatopic\n* **Partition**topicpartitionpartitionpartitionpartition\n* **Producer**broker\n* **Consumer**broker\n* **ConsumerGroup**consumerconsumer groupconsumergroup namegroupconsumer groupconsumer groupconsumer\n* **replica**partition  partition \n* **leader**replica  producer  consumer  leader \n* **follower**replica  leader \n* **controller**brokerbrokerbroker\n* **zookeeper**Kafka  zookeeper  meta \n\n### \n#### \n![](Kafka-Background/1.png)\nProducersBrokersTopicConsumersBrokersTopic\n\n#### \n![](Kafka-Background/2.png)\n ProducerRecord TopicPartition Key Value\n\nsend() \n\n key  value\n\n ProducerRecord  Key \n\n Broker \n\nBroker\n\nkeykey\n\n#### topic\n![](Kafka-Background/3.jpg)\nTopiclogkafka\n\nTopicpartitionTopicserverpartitionTopic\n\n#### partition\n![](Kafka-Background/4.jpg)\n\n Partition  Partition log  offset  consumeroffsetconsumer\n\nkafkapartitiontopicpartition\n\n\n\n*  Partition  topic  Partition ;\n*  Partition \n\n#### Replication\n partition  replication( server.properties  default.replication.factor=N)\n\n replication  broker  patition  producer  patition\n\n replication   partition  replication replication  leaderproducer  consumer  leader  replication  follower  leader \n\n### \n![](Kafka-Background/5.jpeg)\ntopic\n\npartition`partition`\n\npartition\n\n### Kafka Zookeeper \n![](Kafka-Background/6.png)\n\n\n## Kafka\n#### 1.\nKafkaKafka KafkaKafka ActiveMQRabbitMQ\n\n#### 2.\nkafka-topichadoop/\n\n#### 3.\n\n\n#### 4.\nScribeApache FlumeKafkalog aggregationKafkaKafkaKafka\n\n#### 5.\nStormtopictopictopictopicStromSamza\n\n#### 6.commit log\nKafkaKafkaKafkaApache BookKeeper\n\n#### 7.\nkafka\n\n`MQ`\n\n## KafkaMQMQ\n\n**RabbitMQ**Rabbit Message Queue RabbitMQErlang AMQP RabbitMQ\n\n**ZeroMQ**``TCP/IP\n\n**RocketMQ**\n\n**ActiveMQ**JMS1.1(MOM)\n\n\n | Kafka | RabbitMQ | ZeroMQ | RocketMQ | ActiveMQ\n:-: | :-: | :-: | :-: | :-: | :-:\n | Scala | Erlang | C | Java | Java\n | TCP | AMQP | TCPUDP |  | OpenWireSTOMPRESTMQTTXMPPAMQPWS\n |  |  |  |  | \n |  |  |  |  | \n\t|  | \t |  |  | zookeeper\n | Leader-SlaveMasterSlave |  |  | Master-Slave SlaveMaster | -\n |  |  |  |  | \n | at least onceat most once | at least onceat most once | at least onceat most onceexactly only once | at least once | at least once\nTPS |  |  |  |  | \n | ms | us |   | ms | ms\n | topictopic | 4direct, topic ,Headersfanout | (p2p) | topic/messageTag | (p2p)-\n |  |  |  |  | \n |  |  |  |  | \n\t| offset |  |  |  | \n | offset |  |  |  | \n |  |  |  |  | \n | kafka |  | zeromq | rocketmq | activemq\n\n### MQ\n\n#### Kafka\n##### \n* TPS/\n* ms\n* kafka\n* Pull, , ;\n* Kafka WebKafka-Manager\n* \n* MQ\n\n##### \n* Kafka64/Loadload\n* \n* \n* \n* \n\n#### RabbitMQ\n##### \n* erlangmq \n* MQ\n* \n* \n* \n\n##### \n* erlangbug\n* RabbitMQ\n* \n\n#### ZeroMQ\n##### \n* \n* MQZeroMQ\n\n##### \n* \n* \n\n#### RocketMQ\n##### \n* \n* \n* 0\n* MQ\n* 10\n* javaMQ\n\n##### \n* javac++c++\n* \n* MQJMS\n\n#### RocketMQ\n##### \n* \n* topic\n* ms\n* \n* \n* MQ\n* JMS\n\n##### \n* \n* ActiveMQ 5.x\n\n\n\n\n\n\n","source":"_posts/Kafka-Background.md","raw":"---\ntitle: Kafka\ndate: 2019-05-25 11:38:04\ntags:\n    - Kafka\n    - JAVA\n    - \ncategories: Kafka\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n## Kafka\nkafkaLinkedInLinkedIn\n<!-- more -->\n## Kafka\nKafkaLinkedInScala\n\nkafkatopictopictopicpartitionpartitionparition\n\nkafkaappend\n\n## Kafka\n\n### \n* **Broker**brokerKafkabroker\n* **Topic**Kafkatopic\n* **Partition**topicpartitionpartitionpartitionpartition\n* **Producer**broker\n* **Consumer**broker\n* **ConsumerGroup**consumerconsumer groupconsumergroup namegroupconsumer groupconsumer groupconsumer\n* **replica**partition  partition \n* **leader**replica  producer  consumer  leader \n* **follower**replica  leader \n* **controller**brokerbrokerbroker\n* **zookeeper**Kafka  zookeeper  meta \n\n### \n#### \n![](Kafka-Background/1.png)\nProducersBrokersTopicConsumersBrokersTopic\n\n#### \n![](Kafka-Background/2.png)\n ProducerRecord TopicPartition Key Value\n\nsend() \n\n key  value\n\n ProducerRecord  Key \n\n Broker \n\nBroker\n\nkeykey\n\n#### topic\n![](Kafka-Background/3.jpg)\nTopiclogkafka\n\nTopicpartitionTopicserverpartitionTopic\n\n#### partition\n![](Kafka-Background/4.jpg)\n\n Partition  Partition log  offset  consumeroffsetconsumer\n\nkafkapartitiontopicpartition\n\n\n\n*  Partition  topic  Partition ;\n*  Partition \n\n#### Replication\n partition  replication( server.properties  default.replication.factor=N)\n\n replication  broker  patition  producer  patition\n\n replication   partition  replication replication  leaderproducer  consumer  leader  replication  follower  leader \n\n### \n![](Kafka-Background/5.jpeg)\ntopic\n\npartition`partition`\n\npartition\n\n### Kafka Zookeeper \n![](Kafka-Background/6.png)\n\n\n## Kafka\n#### 1.\nKafkaKafka KafkaKafka ActiveMQRabbitMQ\n\n#### 2.\nkafka-topichadoop/\n\n#### 3.\n\n\n#### 4.\nScribeApache FlumeKafkalog aggregationKafkaKafkaKafka\n\n#### 5.\nStormtopictopictopictopicStromSamza\n\n#### 6.commit log\nKafkaKafkaKafkaApache BookKeeper\n\n#### 7.\nkafka\n\n`MQ`\n\n## KafkaMQMQ\n\n**RabbitMQ**Rabbit Message Queue RabbitMQErlang AMQP RabbitMQ\n\n**ZeroMQ**``TCP/IP\n\n**RocketMQ**\n\n**ActiveMQ**JMS1.1(MOM)\n\n\n | Kafka | RabbitMQ | ZeroMQ | RocketMQ | ActiveMQ\n:-: | :-: | :-: | :-: | :-: | :-:\n | Scala | Erlang | C | Java | Java\n | TCP | AMQP | TCPUDP |  | OpenWireSTOMPRESTMQTTXMPPAMQPWS\n |  |  |  |  | \n |  |  |  |  | \n\t|  | \t |  |  | zookeeper\n | Leader-SlaveMasterSlave |  |  | Master-Slave SlaveMaster | -\n |  |  |  |  | \n | at least onceat most once | at least onceat most once | at least onceat most onceexactly only once | at least once | at least once\nTPS |  |  |  |  | \n | ms | us |   | ms | ms\n | topictopic | 4direct, topic ,Headersfanout | (p2p) | topic/messageTag | (p2p)-\n |  |  |  |  | \n |  |  |  |  | \n\t| offset |  |  |  | \n | offset |  |  |  | \n |  |  |  |  | \n | kafka |  | zeromq | rocketmq | activemq\n\n### MQ\n\n#### Kafka\n##### \n* TPS/\n* ms\n* kafka\n* Pull, , ;\n* Kafka WebKafka-Manager\n* \n* MQ\n\n##### \n* Kafka64/Loadload\n* \n* \n* \n* \n\n#### RabbitMQ\n##### \n* erlangmq \n* MQ\n* \n* \n* \n\n##### \n* erlangbug\n* RabbitMQ\n* \n\n#### ZeroMQ\n##### \n* \n* MQZeroMQ\n\n##### \n* \n* \n\n#### RocketMQ\n##### \n* \n* \n* 0\n* MQ\n* 10\n* javaMQ\n\n##### \n* javac++c++\n* \n* MQJMS\n\n#### RocketMQ\n##### \n* \n* topic\n* ms\n* \n* \n* MQ\n* JMS\n\n##### \n* \n* ActiveMQ 5.x\n\n\n\n\n\n\n","slug":"Kafka-Background","published":1,"updated":"2019-07-30T11:37:52.660Z","layout":"post","photos":[],"link":"","_id":"ck4859yb4004kt0fyeb9xqpka","content":"<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><p>kafkaLinkedInLinkedIn</p>\n<a id=\"more\"></a>\n<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><p>KafkaLinkedInScala</p>\n<p>kafkatopictopictopicpartitionpartitionparition</p>\n<p>kafkaappend</p>\n<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><strong>Broker</strong>brokerKafkabroker</li>\n<li><strong>Topic</strong>Kafkatopic</li>\n<li><strong>Partition</strong>topicpartitionpartitionpartitionpartition</li>\n<li><strong>Producer</strong>broker</li>\n<li><strong>Consumer</strong>broker</li>\n<li><strong>ConsumerGroup</strong>consumerconsumer groupconsumergroup namegroupconsumer groupconsumer groupconsumer</li>\n<li><strong>replica</strong>partition  partition </li>\n<li><strong>leader</strong>replica  producer  consumer  leader </li>\n<li><strong>follower</strong>replica  leader </li>\n<li><strong>controller</strong>brokerbrokerbroker</li>\n<li><strong>zookeeper</strong>Kafka  zookeeper  meta </li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/2019/05/25/Kafka-Background/1.png\" alt=\"\"><br>ProducersBrokersTopicConsumersBrokersTopic</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/2019/05/25/Kafka-Background/2.png\" alt=\"\"><br> ProducerRecord TopicPartition Key Value</p>\n<p>send() </p>\n<p> key  value</p>\n<p> ProducerRecord  Key </p>\n<p> Broker </p>\n<p>Broker</p>\n<p>keykey</p>\n<h4 id=\"topic\"><a href=\"#topic\" class=\"headerlink\" title=\"topic\"></a>topic</h4><p><img src=\"/2019/05/25/Kafka-Background/3.jpg\" alt=\"\"><br>Topiclogkafka</p>\n<p>TopicpartitionTopicserverpartitionTopic</p>\n<h4 id=\"partition\"><a href=\"#partition\" class=\"headerlink\" title=\"partition\"></a>partition</h4><p><img src=\"/2019/05/25/Kafka-Background/4.jpg\" alt=\"\"></p>\n<p> Partition  Partition log  offset  consumeroffsetconsumer</p>\n<p>kafkapartitiontopicpartition</p>\n<p></p>\n<ul>\n<li> Partition  topic  Partition ;</li>\n<li> Partition </li>\n</ul>\n<h4 id=\"Replication\"><a href=\"#Replication\" class=\"headerlink\" title=\"Replication\"></a>Replication</h4><p> partition  replication( server.properties  default.replication.factor=N)</p>\n<p> replication  broker  patition  producer  patition</p>\n<p> replication   partition  replication replication  leaderproducer  consumer  leader  replication  follower  leader </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/05/25/Kafka-Background/5.jpeg\" alt=\"\"><br>topic</p>\n<p>partition<code>partition</code></p>\n<p>partition</p>\n<h3 id=\"Kafka-Zookeeper-\"><a href=\"#Kafka-Zookeeper-\" class=\"headerlink\" title=\"Kafka Zookeeper \"></a>Kafka Zookeeper </h3><p><img src=\"/2019/05/25/Kafka-Background/6.png\" alt=\"\"></p>\n<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><p>KafkaKafka KafkaKafka ActiveMQRabbitMQ</p>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p>kafka-topichadoop/</p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p></p>\n<h4 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h4><p>ScribeApache FlumeKafkalog aggregationKafkaKafkaKafka</p>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><p>StormtopictopictopictopicStromSamza</p>\n<h4 id=\"6-commit-log\"><a href=\"#6-commit-log\" class=\"headerlink\" title=\"6.commit log\"></a>6.commit log</h4><p>KafkaKafkaKafkaApache BookKeeper</p>\n<h4 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h4><p>kafka</p>\n<p><code>MQ</code></p>\n<h2 id=\"KafkaMQMQ\"><a href=\"#KafkaMQMQ\" class=\"headerlink\" title=\"KafkaMQMQ\"></a>KafkaMQMQ</h2><p><strong>RabbitMQ</strong>Rabbit Message Queue RabbitMQErlang AMQP RabbitMQ</p>\n<p><strong>ZeroMQ</strong><code></code>TCP/IP</p>\n<p><strong>RocketMQ</strong></p>\n<p><strong>ActiveMQ</strong>JMS1.1(MOM)</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">Kafka</th>\n<th align=\"center\">RabbitMQ</th>\n<th align=\"center\">ZeroMQ</th>\n<th align=\"center\">RocketMQ</th>\n<th align=\"center\">ActiveMQ</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\">Scala</td>\n<td align=\"center\">Erlang</td>\n<td align=\"center\">C</td>\n<td align=\"center\">Java</td>\n<td align=\"center\">Java</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">TCP</td>\n<td align=\"center\">AMQP</td>\n<td align=\"center\">TCPUDP</td>\n<td align=\"center\"></td>\n<td align=\"center\">OpenWireSTOMPRESTMQTTXMPPAMQPWS</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">zookeeper</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Leader-SlaveMasterSlave</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Master-Slave SlaveMaster</td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">at least onceat most once</td>\n<td align=\"center\">at least onceat most once</td>\n<td align=\"center\">at least onceat most onceexactly only once</td>\n<td align=\"center\">at least once</td>\n<td align=\"center\">at least once</td>\n</tr>\n<tr>\n<td align=\"center\">TPS</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">ms</td>\n<td align=\"center\">us</td>\n<td align=\"center\"></td>\n<td align=\"center\">ms</td>\n<td align=\"center\">ms</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">topictopic</td>\n<td align=\"center\">4direct, topic ,Headersfanout</td>\n<td align=\"center\">(p2p)</td>\n<td align=\"center\">topic/messageTag</td>\n<td align=\"center\">(p2p)-</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">offset</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">offset</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">kafka</td>\n<td align=\"center\"></td>\n<td align=\"center\">zeromq</td>\n<td align=\"center\">rocketmq</td>\n<td align=\"center\">activemq</td>\n</tr>\n</tbody></table>\n<h3 id=\"MQ\"><a href=\"#MQ\" class=\"headerlink\" title=\"MQ\"></a>MQ</h3><h4 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>TPS/</li>\n<li>ms</li>\n<li>kafka</li>\n<li>Pull, , ;</li>\n<li>Kafka WebKafka-Manager</li>\n<li></li>\n<li>MQ</li>\n</ul>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>Kafka64/Loadload</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"RabbitMQ\"><a href=\"#RabbitMQ\" class=\"headerlink\" title=\"RabbitMQ\"></a>RabbitMQ</h4><h5 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>erlangmq </li>\n<li>MQ </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h5 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>erlangbug</li>\n<li>RabbitMQ</li>\n<li></li>\n</ul>\n<h4 id=\"ZeroMQ\"><a href=\"#ZeroMQ\" class=\"headerlink\" title=\"ZeroMQ\"></a>ZeroMQ</h4><h5 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li>MQZeroMQ</li>\n</ul>\n<h5 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"RocketMQ\"><a href=\"#RocketMQ\" class=\"headerlink\" title=\"RocketMQ\"></a>RocketMQ</h4><h5 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li></li>\n<li>0</li>\n<li>MQ</li>\n<li>10</li>\n<li>javaMQ</li>\n</ul>\n<h5 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>javac++c++</li>\n<li></li>\n<li>MQJMS</li>\n</ul>\n<h4 id=\"RocketMQ-1\"><a href=\"#RocketMQ-1\" class=\"headerlink\" title=\"RocketMQ\"></a>RocketMQ</h4><h5 id=\"-4\"><a href=\"#-4\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li>topic</li>\n<li>ms</li>\n<li></li>\n<li></li>\n<li>MQ</li>\n<li>JMS</li>\n</ul>\n<h5 id=\"-4\"><a href=\"#-4\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li>ActiveMQ 5.x</li>\n</ul>\n","site":{"data":{}},"excerpt":"<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><p>kafkaLinkedInLinkedIn</p>","more":"<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><p>KafkaLinkedInScala</p>\n<p>kafkatopictopictopicpartitionpartitionparition</p>\n<p>kafkaappend</p>\n<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><strong>Broker</strong>brokerKafkabroker</li>\n<li><strong>Topic</strong>Kafkatopic</li>\n<li><strong>Partition</strong>topicpartitionpartitionpartitionpartition</li>\n<li><strong>Producer</strong>broker</li>\n<li><strong>Consumer</strong>broker</li>\n<li><strong>ConsumerGroup</strong>consumerconsumer groupconsumergroup namegroupconsumer groupconsumer groupconsumer</li>\n<li><strong>replica</strong>partition  partition </li>\n<li><strong>leader</strong>replica  producer  consumer  leader </li>\n<li><strong>follower</strong>replica  leader </li>\n<li><strong>controller</strong>brokerbrokerbroker</li>\n<li><strong>zookeeper</strong>Kafka  zookeeper  meta </li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/2019/05/25/Kafka-Background/1.png\" alt=\"\"><br>ProducersBrokersTopicConsumersBrokersTopic</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/2019/05/25/Kafka-Background/2.png\" alt=\"\"><br> ProducerRecord TopicPartition Key Value</p>\n<p>send() </p>\n<p> key  value</p>\n<p> ProducerRecord  Key </p>\n<p> Broker </p>\n<p>Broker</p>\n<p>keykey</p>\n<h4 id=\"topic\"><a href=\"#topic\" class=\"headerlink\" title=\"topic\"></a>topic</h4><p><img src=\"/2019/05/25/Kafka-Background/3.jpg\" alt=\"\"><br>Topiclogkafka</p>\n<p>TopicpartitionTopicserverpartitionTopic</p>\n<h4 id=\"partition\"><a href=\"#partition\" class=\"headerlink\" title=\"partition\"></a>partition</h4><p><img src=\"/2019/05/25/Kafka-Background/4.jpg\" alt=\"\"></p>\n<p> Partition  Partition log  offset  consumeroffsetconsumer</p>\n<p>kafkapartitiontopicpartition</p>\n<p></p>\n<ul>\n<li> Partition  topic  Partition ;</li>\n<li> Partition </li>\n</ul>\n<h4 id=\"Replication\"><a href=\"#Replication\" class=\"headerlink\" title=\"Replication\"></a>Replication</h4><p> partition  replication( server.properties  default.replication.factor=N)</p>\n<p> replication  broker  patition  producer  patition</p>\n<p> replication   partition  replication replication  leaderproducer  consumer  leader  replication  follower  leader </p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/05/25/Kafka-Background/5.jpeg\" alt=\"\"><br>topic</p>\n<p>partition<code>partition</code></p>\n<p>partition</p>\n<h3 id=\"Kafka-Zookeeper-\"><a href=\"#Kafka-Zookeeper-\" class=\"headerlink\" title=\"Kafka Zookeeper \"></a>Kafka Zookeeper </h3><p><img src=\"/2019/05/25/Kafka-Background/6.png\" alt=\"\"></p>\n<h2 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h2><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1.\"></a>1.</h4><p>KafkaKafka KafkaKafka ActiveMQRabbitMQ</p>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2.\"></a>2.</h4><p>kafka-topichadoop/</p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3.\"></a>3.</h4><p></p>\n<h4 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4.\"></a>4.</h4><p>ScribeApache FlumeKafkalog aggregationKafkaKafkaKafka</p>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5.\"></a>5.</h4><p>StormtopictopictopictopicStromSamza</p>\n<h4 id=\"6-commit-log\"><a href=\"#6-commit-log\" class=\"headerlink\" title=\"6.commit log\"></a>6.commit log</h4><p>KafkaKafkaKafkaApache BookKeeper</p>\n<h4 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h4><p>kafka</p>\n<p><code>MQ</code></p>\n<h2 id=\"KafkaMQMQ\"><a href=\"#KafkaMQMQ\" class=\"headerlink\" title=\"KafkaMQMQ\"></a>KafkaMQMQ</h2><p><strong>RabbitMQ</strong>Rabbit Message Queue RabbitMQErlang AMQP RabbitMQ</p>\n<p><strong>ZeroMQ</strong><code></code>TCP/IP</p>\n<p><strong>RocketMQ</strong></p>\n<p><strong>ActiveMQ</strong>JMS1.1(MOM)</p>\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\">Kafka</th>\n<th align=\"center\">RabbitMQ</th>\n<th align=\"center\">ZeroMQ</th>\n<th align=\"center\">RocketMQ</th>\n<th align=\"center\">ActiveMQ</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\"></td>\n<td align=\"center\">Scala</td>\n<td align=\"center\">Erlang</td>\n<td align=\"center\">C</td>\n<td align=\"center\">Java</td>\n<td align=\"center\">Java</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">TCP</td>\n<td align=\"center\">AMQP</td>\n<td align=\"center\">TCPUDP</td>\n<td align=\"center\"></td>\n<td align=\"center\">OpenWireSTOMPRESTMQTTXMPPAMQPWS</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">zookeeper</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">Leader-SlaveMasterSlave</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\">Master-Slave SlaveMaster</td>\n<td align=\"center\">-</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">at least onceat most once</td>\n<td align=\"center\">at least onceat most once</td>\n<td align=\"center\">at least onceat most onceexactly only once</td>\n<td align=\"center\">at least once</td>\n<td align=\"center\">at least once</td>\n</tr>\n<tr>\n<td align=\"center\">TPS</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">ms</td>\n<td align=\"center\">us</td>\n<td align=\"center\"></td>\n<td align=\"center\">ms</td>\n<td align=\"center\">ms</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">topictopic</td>\n<td align=\"center\">4direct, topic ,Headersfanout</td>\n<td align=\"center\">(p2p)</td>\n<td align=\"center\">topic/messageTag</td>\n<td align=\"center\">(p2p)-</td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">offset</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">offset</td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n<td align=\"center\"></td>\n</tr>\n<tr>\n<td align=\"center\"></td>\n<td align=\"center\">kafka</td>\n<td align=\"center\"></td>\n<td align=\"center\">zeromq</td>\n<td align=\"center\">rocketmq</td>\n<td align=\"center\">activemq</td>\n</tr>\n</tbody></table>\n<h3 id=\"MQ\"><a href=\"#MQ\" class=\"headerlink\" title=\"MQ\"></a>MQ</h3><h4 id=\"Kafka\"><a href=\"#Kafka\" class=\"headerlink\" title=\"Kafka\"></a>Kafka</h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>TPS/</li>\n<li>ms</li>\n<li>kafka</li>\n<li>Pull, , ;</li>\n<li>Kafka WebKafka-Manager</li>\n<li></li>\n<li>MQ</li>\n</ul>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>Kafka64/Loadload</li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"RabbitMQ\"><a href=\"#RabbitMQ\" class=\"headerlink\" title=\"RabbitMQ\"></a>RabbitMQ</h4><h5 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>erlangmq </li>\n<li>MQ </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h5 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>erlangbug</li>\n<li>RabbitMQ</li>\n<li></li>\n</ul>\n<h4 id=\"ZeroMQ\"><a href=\"#ZeroMQ\" class=\"headerlink\" title=\"ZeroMQ\"></a>ZeroMQ</h4><h5 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li>MQZeroMQ</li>\n</ul>\n<h5 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li></li>\n</ul>\n<h4 id=\"RocketMQ\"><a href=\"#RocketMQ\" class=\"headerlink\" title=\"RocketMQ\"></a>RocketMQ</h4><h5 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li></li>\n<li>0</li>\n<li>MQ</li>\n<li>10</li>\n<li>javaMQ</li>\n</ul>\n<h5 id=\"-3\"><a href=\"#-3\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li>javac++c++</li>\n<li></li>\n<li>MQJMS</li>\n</ul>\n<h4 id=\"RocketMQ-1\"><a href=\"#RocketMQ-1\" class=\"headerlink\" title=\"RocketMQ\"></a>RocketMQ</h4><h5 id=\"-4\"><a href=\"#-4\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li>topic</li>\n<li>ms</li>\n<li></li>\n<li></li>\n<li>MQ</li>\n<li>JMS</li>\n</ul>\n<h5 id=\"-4\"><a href=\"#-4\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li></li>\n<li>ActiveMQ 5.x</li>\n</ul>"},{"title":"Spring Boot + MyBatis ","date":"2019-06-02T07:30:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"### \n#### \n* IDEIntelliJ IDEA 2019.1\n* mac OSX\n\n#### \n* biz\n* daoMBxml\n* common\n* web\n<!-- more -->\n### \n\n#### \n\n1 IDEA  File -> New -> Project...\n![](Project-Module/1.png)\n2Spring InitializrInitializrDefaultNext\n![](Project-Module/2.png)\n3,Next\n![](Project-Module/3.png)\n4Next\n![](Project-Module/4.png)\n5nameFinish\n![](Project-Module/5.png)\n6\n![](Project-Module/6.png)\n7\n![](Project-Module/7.png)\n\n#### \n8,->New -> Module\n![](Project-Module/8.png)\n9MavenNext\n![](Project-Module/9.png)\n10ArifactIdNext\n![](Project-Module/10.png)\n11Finish\n![](Project-Module/11.png)\n12\n![](Project-Module/12.png)\n\n#### \n\n\n* bizdaocommon\n* dao\n* common\n* webbizcommon\n\n13pom\n```xml\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>biz</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>common</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>dao</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>web</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n```\n14bizpomdaocommon\n```xml\n    <dependencies>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>dao</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>common</artifactId>\n        </dependency>\n    </dependencies>\n```\n15webpombizcommon\n```xml\n    <dependencies>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>biz</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>common</artifactId>\n        </dependency>\n    </dependencies>\n```\n\n#### \n16webpomspring-boot-starter-web\n```xml\n        <!-- spring-boot -->\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n```\n\n17webcom.example.test.demo.webAppServiceApplication.java\n![](Project-Module/17.png)\n\n```java\n\npackage com.example.test.demo.web;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class AppServiceApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(AppServiceApplication.class, args);\n    }\n}\n\n```\n18com.example.test.demo.webcontrollertest\n```java\npackage com.example.test.demo.web.controller;\n\n\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(\"demo\")\npublic class DemoController {\n\n    @RequestMapping(\"test\")\n    public String test() {\n        return \"Hello World!\";\n    }\n}\n```\n\n19AppServiceApplicationmain8080http://localhost:8080/demo/test\n![](Project-Module/19.png)\n\n20bizcom.example.test.demo.bizDemoService\n```java\npackage com.example.test.demo.biz;\n\npublic interface DemoService {\n    String test();\n}\n\n```\n\n21com.example.test.demo.bizimplDemoServiceImpl\n```java\npackage com.example.test.demo.biz.impl;\n\n\nimport com.example.test.demo.biz.DemoService;\nimport org.springframework.stereotype.Service;\n\n\n@Service\npublic class DemoServiceImpl implements DemoService {\n\n    @Override\n    public String test() {\n        return \"biz test\";\n    }\n}\n```\n\n22DemoController@AutowiredDemoServiceDemoControllertest\n```java\npackage com.example.test.demo.web.controller;\n\n\nimport com.example.test.demo.biz.DemoService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(\"demo\")\npublic class DemoController {\n\n    @Autowired\n    private DemoService demoService;\n\n    @RequestMapping(\"test\")\n    public String test() {\n        return demoService.test();\n    }\n}\n```\n\n23AppServiceApplication@ComponentScan\n```java\npackage com.example.test.demo.web;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.context.annotation.ComponentScan;\n\n@SpringBootApplication\n@ComponentScan(basePackages = {\n        \"com.example.test.demo.*\"\n})\npublic class AppServiceApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(AppServiceApplication.class, args);\n    }\n}\n```\n\n24mainhttp://localhost:8080/demo/test\n![](Project-Module/24.png)\n\n25\n\n#### Mybatis\n\n26pommybatis-spring-boot-startermysql-connector-java\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <packaging>pom</packaging>\n    <modules>\n        <module>biz</module>\n        <module>dao</module>\n        <module>common</module>\n        <module>web</module>\n    </modules>\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.2.RELEASE</version>\n        <relativePath/> <!-- lookup parent from repository -->\n    </parent>\n    <groupId>com.example.test</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <name>demo</name>\n    <description>Demo project for Spring Boot</description>\n\n    <properties>\n        <java.version>1.8</java.version>\n        <mysql-connector.version>8.0.11</mysql-connector.version>\n        <mybatis.version>1.3.2</mybatis.version>\n        <mybatis.generator.version>1.3.2</mybatis.generator.version>\n    </properties>\n\n    <build>\n        <pluginManagement>\n            <plugins>\n                <plugin>\n                    <groupId>org.springframework.boot</groupId>\n                    <artifactId>spring-boot-maven-plugin</artifactId>\n                </plugin>\n                <!--mybatis-->\n                <plugin>\n                    <groupId>org.mybatis.generator</groupId>\n                    <artifactId>mybatis-generator-maven-plugin</artifactId>\n                    <version>${mybatis.generator.version}</version>\n                    <dependencies>\n                        <dependency>\n                            <groupId>mysql</groupId>\n                            <artifactId>mysql-connector-java</artifactId>\n                            <version>${mysql-connector.version}</version>\n                        </dependency>\n                        <dependency>\n                            <groupId>org.mybatis.generator</groupId>\n                            <artifactId>mybatis-generator-core</artifactId>\n                            <version>${mybatis.generator.version}</version>\n                        </dependency>\n                    </dependencies>\n                </plugin>\n            </plugins>\n        </pluginManagement>\n        <resources>\n            <resource>\n                <directory>src/main/resources</directory>\n                <filtering>true</filtering>\n            </resource>\n        </resources>\n    </build>\n\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>biz</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>common</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>dao</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>web</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n\n\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter</artifactId>\n            </dependency>\n\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-test</artifactId>\n                <scope>test</scope>\n            </dependency>\n\n            <!--mybatis-->\n            <dependency>\n                <groupId>org.mybatis.spring.boot</groupId>\n                <artifactId>mybatis-spring-boot-starter</artifactId>\n                <version>${mybatis.version}</version>\n            </dependency>\n\n            <!-- mysql -->\n            <dependency>\n                <groupId>mysql</groupId>\n                <artifactId>mysql-connector-java</artifactId>\n                <version>${mysql-connector.version}</version>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n</project>\n\n```\n27daopom\n```xml\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n            <plugin>\n                <groupId>org.mybatis.generator</groupId>\n                <artifactId>mybatis-generator-maven-plugin</artifactId>\n                <configuration>\n                    <configurationFile>${basedir}/src/main/resources/mybatis-generator.xml</configurationFile>\n                    <overwrite>true</overwrite>\n                    <verbose>true</verbose>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n```\n28web/src/main/resourcesapplication.properties\n\n* **com.mysql.jdbc.Driver**  mysql-connector-java 5\n* **com.mysql.cj.jdbc.Driver**  mysql-connector-java 6\n\n```properties\nspring.datasource.driverClassName = com.mysql.cj.jdbc.Driver\nspring.datasource.url = jdbc:mysql://localhost:3306/test?useUnicode=true&characterEncoding=UTF8&connectTimeout=1000&socketTimeout=3000\nspring.datasource.username = root\nspring.datasource.password = qwertyui\n\nmybatis.type-aliases-package = com.example.test.demo.dao.po\nmybatis.mapper-locations = classpath:mapper/*.xml\n```\n29web/src/main/resourcesmybatis-generator.xml\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE generatorConfiguration\n        PUBLIC \"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\">\n<generatorConfiguration>\n    <!-- SpringBoot -->\n    <properties resource=\"application.properties\"/>\n\n    <context id=\"Mysql\" targetRuntime=\"MyBatis3\" defaultModelType=\"flat\">\n        <!-- pojoimplements Serializable-->\n        <plugin type=\"org.mybatis.generator.plugins.SerializablePlugin\"/>\n\n        <commentGenerator>\n            <!--* true  false:-->\n            <property name=\"suppressDate\" value=\"true\" />\n            <!--  true  false: -->\n            <property name=\"suppressAllComments\" value=\"true\" />\n        </commentGenerator>\n\n        <jdbcConnection driverClass=\"${spring.datasource.driverClassName}\"\n                        connectionURL=\"${spring.datasource.url}\"\n                        userId=\"${spring.datasource.username}\"\n                        password=\"${spring.datasource.password}\">\n        </jdbcConnection>\n\n        <!--\n       model(targetProject)targetProject,./src/main/java\n       MAVENtarget/generatord-source\n       -->\n        <javaModelGenerator targetPackage=\"com.example.test.demo.dao.po\" targetProject=\"../dao/src/main/java\" >\n            <!-- targetPackageschemapackagepackagefalse -->\n            <property name=\"enableSubPackages\" value=\"true\"/>\n            <!--  -->\n            <property name=\"trimStrings\" value=\"true\"/>\n        </javaModelGenerator>\n\n        <!--mapper.xml -->\n        <sqlMapGenerator targetPackage=\"mapper\"\n                         targetProject=\"../dao/src/main/resources\">\n            <property name=\"enableSubPackages\" value=\"true\"/>\n        </sqlMapGenerator>\n\n        <!-- Mapper -->\n        <javaClientGenerator type=\"XMLMAPPER\" targetPackage=\"com.example.test.demo.dao.mapper\"\n                             targetProject=\"../dao/src/main/java\">\n            <property name=\"enableSubPackages\" value=\"true\"/>\n        </javaClientGenerator>\n\n        <!-- po-->\n        <table tableName=\"user_info\" domainObjectName=\"UserInfoPO\"\n               enableCountByExample=\"true\" enableUpdateByExample=\"true\" enableDeleteByExample=\"true\"\n               enableSelectByExample=\"true\" selectByExampleQueryId=\"false\">\n            <property name=\"useActualColumnNames\" value=\"false\"/>\n            <generatedKey column=\"id\" identity=\"true\" sqlStatement=\"MySql\"/>\n        </table>\n    </context>\n</generatorConfiguration>\n```\n30Mapperpo,\n![](Project-Module/30.1.png)\n\n![](Project-Module/30.2.png)\n\n30bizDemoServiceImpl@AutowiredUserMapperDemoServicetest\n```java\npackage com.example.test.demo.biz.impl;\n\n\nimport com.example.test.demo.biz.DemoService;\nimport com.example.test.demo.dao.mapper.UserInfoPOMapper;\nimport com.example.test.demo.dao.po.UserInfoPO;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\n\n@Service\npublic class DemoServiceImpl implements DemoService {\n\n    @Autowired\n    private UserInfoPOMapper userInfoPOMapper;\n\n    @Override\n    public String test() {\n        UserInfoPO po = userInfoPOMapper.selectByPrimaryKey(1L);\n        return \"UserInfo name is:\" + po.getName();\n    }\n}\n```\n31AppServiceApplication\n```java\n@MapperScan(\"com.example.test.demo.dao.mapper\")\n```\n32main\n![](Project-Module/32.png)\n\n### \nmybatis \n> Client does not support authentication protocol requested by server; consider upgrading MySQL client\n\nmysql\n```bash\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'qwertyui';\nSELECT plugin FROM mysql.user WHERE User = 'root';\n```","source":"_posts/Project-Module.md","raw":"---\ntitle: Spring Boot + MyBatis \ndate: 2019-06-02 15:30:04\ntags:\n    - MyBatis\n    - \n    - Spring Boot\ncategories: \nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n### \n#### \n* IDEIntelliJ IDEA 2019.1\n* mac OSX\n\n#### \n* biz\n* daoMBxml\n* common\n* web\n<!-- more -->\n### \n\n#### \n\n1 IDEA  File -> New -> Project...\n![](Project-Module/1.png)\n2Spring InitializrInitializrDefaultNext\n![](Project-Module/2.png)\n3,Next\n![](Project-Module/3.png)\n4Next\n![](Project-Module/4.png)\n5nameFinish\n![](Project-Module/5.png)\n6\n![](Project-Module/6.png)\n7\n![](Project-Module/7.png)\n\n#### \n8,->New -> Module\n![](Project-Module/8.png)\n9MavenNext\n![](Project-Module/9.png)\n10ArifactIdNext\n![](Project-Module/10.png)\n11Finish\n![](Project-Module/11.png)\n12\n![](Project-Module/12.png)\n\n#### \n\n\n* bizdaocommon\n* dao\n* common\n* webbizcommon\n\n13pom\n```xml\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>biz</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>common</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>dao</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>web</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n```\n14bizpomdaocommon\n```xml\n    <dependencies>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>dao</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>common</artifactId>\n        </dependency>\n    </dependencies>\n```\n15webpombizcommon\n```xml\n    <dependencies>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>biz</artifactId>\n        </dependency>\n        <dependency>\n            <groupId>com.example.test</groupId>\n            <artifactId>common</artifactId>\n        </dependency>\n    </dependencies>\n```\n\n#### \n16webpomspring-boot-starter-web\n```xml\n        <!-- spring-boot -->\n        <dependency>\n            <groupId>org.springframework.boot</groupId>\n            <artifactId>spring-boot-starter-web</artifactId>\n        </dependency>\n```\n\n17webcom.example.test.demo.webAppServiceApplication.java\n![](Project-Module/17.png)\n\n```java\n\npackage com.example.test.demo.web;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\npublic class AppServiceApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(AppServiceApplication.class, args);\n    }\n}\n\n```\n18com.example.test.demo.webcontrollertest\n```java\npackage com.example.test.demo.web.controller;\n\n\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(\"demo\")\npublic class DemoController {\n\n    @RequestMapping(\"test\")\n    public String test() {\n        return \"Hello World!\";\n    }\n}\n```\n\n19AppServiceApplicationmain8080http://localhost:8080/demo/test\n![](Project-Module/19.png)\n\n20bizcom.example.test.demo.bizDemoService\n```java\npackage com.example.test.demo.biz;\n\npublic interface DemoService {\n    String test();\n}\n\n```\n\n21com.example.test.demo.bizimplDemoServiceImpl\n```java\npackage com.example.test.demo.biz.impl;\n\n\nimport com.example.test.demo.biz.DemoService;\nimport org.springframework.stereotype.Service;\n\n\n@Service\npublic class DemoServiceImpl implements DemoService {\n\n    @Override\n    public String test() {\n        return \"biz test\";\n    }\n}\n```\n\n22DemoController@AutowiredDemoServiceDemoControllertest\n```java\npackage com.example.test.demo.web.controller;\n\n\nimport com.example.test.demo.biz.DemoService;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\n@RestController\n@RequestMapping(\"demo\")\npublic class DemoController {\n\n    @Autowired\n    private DemoService demoService;\n\n    @RequestMapping(\"test\")\n    public String test() {\n        return demoService.test();\n    }\n}\n```\n\n23AppServiceApplication@ComponentScan\n```java\npackage com.example.test.demo.web;\n\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\nimport org.springframework.context.annotation.ComponentScan;\n\n@SpringBootApplication\n@ComponentScan(basePackages = {\n        \"com.example.test.demo.*\"\n})\npublic class AppServiceApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(AppServiceApplication.class, args);\n    }\n}\n```\n\n24mainhttp://localhost:8080/demo/test\n![](Project-Module/24.png)\n\n25\n\n#### Mybatis\n\n26pommybatis-spring-boot-startermysql-connector-java\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n         xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\">\n    <modelVersion>4.0.0</modelVersion>\n    <packaging>pom</packaging>\n    <modules>\n        <module>biz</module>\n        <module>dao</module>\n        <module>common</module>\n        <module>web</module>\n    </modules>\n    <parent>\n        <groupId>org.springframework.boot</groupId>\n        <artifactId>spring-boot-starter-parent</artifactId>\n        <version>2.1.2.RELEASE</version>\n        <relativePath/> <!-- lookup parent from repository -->\n    </parent>\n    <groupId>com.example.test</groupId>\n    <artifactId>demo</artifactId>\n    <version>0.0.1-SNAPSHOT</version>\n    <name>demo</name>\n    <description>Demo project for Spring Boot</description>\n\n    <properties>\n        <java.version>1.8</java.version>\n        <mysql-connector.version>8.0.11</mysql-connector.version>\n        <mybatis.version>1.3.2</mybatis.version>\n        <mybatis.generator.version>1.3.2</mybatis.generator.version>\n    </properties>\n\n    <build>\n        <pluginManagement>\n            <plugins>\n                <plugin>\n                    <groupId>org.springframework.boot</groupId>\n                    <artifactId>spring-boot-maven-plugin</artifactId>\n                </plugin>\n                <!--mybatis-->\n                <plugin>\n                    <groupId>org.mybatis.generator</groupId>\n                    <artifactId>mybatis-generator-maven-plugin</artifactId>\n                    <version>${mybatis.generator.version}</version>\n                    <dependencies>\n                        <dependency>\n                            <groupId>mysql</groupId>\n                            <artifactId>mysql-connector-java</artifactId>\n                            <version>${mysql-connector.version}</version>\n                        </dependency>\n                        <dependency>\n                            <groupId>org.mybatis.generator</groupId>\n                            <artifactId>mybatis-generator-core</artifactId>\n                            <version>${mybatis.generator.version}</version>\n                        </dependency>\n                    </dependencies>\n                </plugin>\n            </plugins>\n        </pluginManagement>\n        <resources>\n            <resource>\n                <directory>src/main/resources</directory>\n                <filtering>true</filtering>\n            </resource>\n        </resources>\n    </build>\n\n    <dependencyManagement>\n        <dependencies>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>biz</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>common</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>dao</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n            <dependency>\n                <groupId>com.example.test</groupId>\n                <artifactId>web</artifactId>\n                <version>${project.version}</version>\n            </dependency>\n\n\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter</artifactId>\n            </dependency>\n\n            <dependency>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-starter-test</artifactId>\n                <scope>test</scope>\n            </dependency>\n\n            <!--mybatis-->\n            <dependency>\n                <groupId>org.mybatis.spring.boot</groupId>\n                <artifactId>mybatis-spring-boot-starter</artifactId>\n                <version>${mybatis.version}</version>\n            </dependency>\n\n            <!-- mysql -->\n            <dependency>\n                <groupId>mysql</groupId>\n                <artifactId>mysql-connector-java</artifactId>\n                <version>${mysql-connector.version}</version>\n            </dependency>\n        </dependencies>\n    </dependencyManagement>\n</project>\n\n```\n27daopom\n```xml\n    <build>\n        <plugins>\n            <plugin>\n                <groupId>org.springframework.boot</groupId>\n                <artifactId>spring-boot-maven-plugin</artifactId>\n            </plugin>\n            <plugin>\n                <groupId>org.mybatis.generator</groupId>\n                <artifactId>mybatis-generator-maven-plugin</artifactId>\n                <configuration>\n                    <configurationFile>${basedir}/src/main/resources/mybatis-generator.xml</configurationFile>\n                    <overwrite>true</overwrite>\n                    <verbose>true</verbose>\n                </configuration>\n            </plugin>\n        </plugins>\n    </build>\n```\n28web/src/main/resourcesapplication.properties\n\n* **com.mysql.jdbc.Driver**  mysql-connector-java 5\n* **com.mysql.cj.jdbc.Driver**  mysql-connector-java 6\n\n```properties\nspring.datasource.driverClassName = com.mysql.cj.jdbc.Driver\nspring.datasource.url = jdbc:mysql://localhost:3306/test?useUnicode=true&characterEncoding=UTF8&connectTimeout=1000&socketTimeout=3000\nspring.datasource.username = root\nspring.datasource.password = qwertyui\n\nmybatis.type-aliases-package = com.example.test.demo.dao.po\nmybatis.mapper-locations = classpath:mapper/*.xml\n```\n29web/src/main/resourcesmybatis-generator.xml\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<!DOCTYPE generatorConfiguration\n        PUBLIC \"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\">\n<generatorConfiguration>\n    <!-- SpringBoot -->\n    <properties resource=\"application.properties\"/>\n\n    <context id=\"Mysql\" targetRuntime=\"MyBatis3\" defaultModelType=\"flat\">\n        <!-- pojoimplements Serializable-->\n        <plugin type=\"org.mybatis.generator.plugins.SerializablePlugin\"/>\n\n        <commentGenerator>\n            <!--* true  false:-->\n            <property name=\"suppressDate\" value=\"true\" />\n            <!--  true  false: -->\n            <property name=\"suppressAllComments\" value=\"true\" />\n        </commentGenerator>\n\n        <jdbcConnection driverClass=\"${spring.datasource.driverClassName}\"\n                        connectionURL=\"${spring.datasource.url}\"\n                        userId=\"${spring.datasource.username}\"\n                        password=\"${spring.datasource.password}\">\n        </jdbcConnection>\n\n        <!--\n       model(targetProject)targetProject,./src/main/java\n       MAVENtarget/generatord-source\n       -->\n        <javaModelGenerator targetPackage=\"com.example.test.demo.dao.po\" targetProject=\"../dao/src/main/java\" >\n            <!-- targetPackageschemapackagepackagefalse -->\n            <property name=\"enableSubPackages\" value=\"true\"/>\n            <!--  -->\n            <property name=\"trimStrings\" value=\"true\"/>\n        </javaModelGenerator>\n\n        <!--mapper.xml -->\n        <sqlMapGenerator targetPackage=\"mapper\"\n                         targetProject=\"../dao/src/main/resources\">\n            <property name=\"enableSubPackages\" value=\"true\"/>\n        </sqlMapGenerator>\n\n        <!-- Mapper -->\n        <javaClientGenerator type=\"XMLMAPPER\" targetPackage=\"com.example.test.demo.dao.mapper\"\n                             targetProject=\"../dao/src/main/java\">\n            <property name=\"enableSubPackages\" value=\"true\"/>\n        </javaClientGenerator>\n\n        <!-- po-->\n        <table tableName=\"user_info\" domainObjectName=\"UserInfoPO\"\n               enableCountByExample=\"true\" enableUpdateByExample=\"true\" enableDeleteByExample=\"true\"\n               enableSelectByExample=\"true\" selectByExampleQueryId=\"false\">\n            <property name=\"useActualColumnNames\" value=\"false\"/>\n            <generatedKey column=\"id\" identity=\"true\" sqlStatement=\"MySql\"/>\n        </table>\n    </context>\n</generatorConfiguration>\n```\n30Mapperpo,\n![](Project-Module/30.1.png)\n\n![](Project-Module/30.2.png)\n\n30bizDemoServiceImpl@AutowiredUserMapperDemoServicetest\n```java\npackage com.example.test.demo.biz.impl;\n\n\nimport com.example.test.demo.biz.DemoService;\nimport com.example.test.demo.dao.mapper.UserInfoPOMapper;\nimport com.example.test.demo.dao.po.UserInfoPO;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Service;\n\n\n@Service\npublic class DemoServiceImpl implements DemoService {\n\n    @Autowired\n    private UserInfoPOMapper userInfoPOMapper;\n\n    @Override\n    public String test() {\n        UserInfoPO po = userInfoPOMapper.selectByPrimaryKey(1L);\n        return \"UserInfo name is:\" + po.getName();\n    }\n}\n```\n31AppServiceApplication\n```java\n@MapperScan(\"com.example.test.demo.dao.mapper\")\n```\n32main\n![](Project-Module/32.png)\n\n### \nmybatis \n> Client does not support authentication protocol requested by server; consider upgrading MySQL client\n\nmysql\n```bash\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY 'qwertyui';\nSELECT plugin FROM mysql.user WHERE User = 'root';\n```","slug":"Project-Module","published":1,"updated":"2019-07-30T11:37:16.751Z","layout":"post","photos":[],"link":"","_id":"ck4859yb5004lt0fy34mg0llc","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>IDEIntelliJ IDEA 2019.1</li>\n<li>mac OSX</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>biz</li>\n<li>daoMBxml</li>\n<li>common</li>\n<li>web<a id=\"more\"></a>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1 IDEA  File -&gt; New -&gt; Project<br><img src=\"/2019/06/02/Project-Module/1.png\" alt=\"\"><br>2Spring InitializrInitializrDefaultNext<br><img src=\"/2019/06/02/Project-Module/2.png\" alt=\"\"><br>3,Next<br><img src=\"/2019/06/02/Project-Module/3.png\" alt=\"\"><br>4Next<br><img src=\"/2019/06/02/Project-Module/4.png\" alt=\"\"><br>5nameFinish<br><img src=\"/2019/06/02/Project-Module/5.png\" alt=\"\"><br>6<br><img src=\"/2019/06/02/Project-Module/6.png\" alt=\"\"><br>7<br><img src=\"/2019/06/02/Project-Module/7.png\" alt=\"\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>8,-&gt;New -&gt; Module<br><img src=\"/2019/06/02/Project-Module/8.png\" alt=\"\"><br>9MavenNext<br><img src=\"/2019/06/02/Project-Module/9.png\" alt=\"\"><br>10ArifactIdNext<br><img src=\"/2019/06/02/Project-Module/10.png\" alt=\"\"><br>11Finish<br><img src=\"/2019/06/02/Project-Module/11.png\" alt=\"\"><br>12<br><img src=\"/2019/06/02/Project-Module/12.png\" alt=\"\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li>bizdaocommon</li>\n<li>dao</li>\n<li>common</li>\n<li>webbizcommon</li>\n</ul>\n<p>13pom</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>14bizpomdaocommon</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>15webpombizcommon</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>16webpomspring-boot-starter-web</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- spring-boot --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>17webcom.example.test.demo.webAppServiceApplication.java<br><img src=\"/2019/06/02/Project-Module/17.png\" alt=\"\"><br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.SpringApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppServiceApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(AppServiceApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>18com.example.test.demo.webcontrollertest</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"demo\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"Hello World!\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>19AppServiceApplicationmain8080<a href=\"http://localhost:8080/demo/test\" target=\"_blank\" rel=\"noopener\">http://localhost:8080/demo/test</a><br><img src=\"/2019/06/02/Project-Module/19.png\" alt=\"\"></p>\n<p>20bizcom.example.test.demo.bizDemoService</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.biz;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">DemoService</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">test</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>21com.example.test.demo.bizimplDemoServiceImpl</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.biz.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.biz.DemoService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">DemoService</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"biz test\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>22DemoController@AutowiredDemoServiceDemoControllertest</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.biz.DemoService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"demo\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DemoService demoService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> demoService.test();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>23AppServiceApplication@ComponentScan</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.SpringApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan</span>(basePackages = &#123;</span><br><span class=\"line\">        <span class=\"string\">\"com.example.test.demo.*\"</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppServiceApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(AppServiceApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>24main<a href=\"http://localhost:8080/demo/test\" target=\"_blank\" rel=\"noopener\">http://localhost:8080/demo/test</a><br><img src=\"/2019/06/02/Project-Module/24.png\" alt=\"\"></p>\n<p>25</p>\n<h4 id=\"Mybatis\"><a href=\"#Mybatis\" class=\"headerlink\" title=\"Mybatis\"></a>Mybatis</h4><p>26pommybatis-spring-boot-startermysql-connector-java</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">project</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://maven.apache.org/POM/4.0.0\"</span> <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">modelVersion</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">modelVersion</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>pom<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>web<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.1.2.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span> <span class=\"comment\">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span>Demo project for Spring Boot<span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mysql-connector.version</span>&gt;</span>8.0.11<span class=\"tag\">&lt;/<span class=\"name\">mysql-connector.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mybatis.version</span>&gt;</span>1.3.2<span class=\"tag\">&lt;/<span class=\"name\">mybatis.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mybatis.generator.version</span>&gt;</span>1.3.2<span class=\"tag\">&lt;/<span class=\"name\">mybatis.generator.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">pluginManagement</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--mybatis--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.generator.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mysql-connector.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.generator.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">pluginManagement</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--mybatis--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- mysql --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mysql-connector.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">project</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>27daopom</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configurationFile</span>&gt;</span>$&#123;basedir&#125;/src/main/resources/mybatis-generator.xml<span class=\"tag\">&lt;/<span class=\"name\">configurationFile</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">overwrite</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">overwrite</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">verbose</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">verbose</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>28web/src/main/resourcesapplication.properties</p>\n<ul>\n<li><strong>com.mysql.jdbc.Driver</strong>  mysql-connector-java 5</li>\n<li><strong>com.mysql.cj.jdbc.Driver</strong>  mysql-connector-java 6</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.datasource.driverClassName = com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">spring.datasource.url = jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=UTF8&amp;connectTimeout=1000&amp;socketTimeout=3000</span><br><span class=\"line\">spring.datasource.username = root</span><br><span class=\"line\">spring.datasource.password = qwertyui</span><br><span class=\"line\"></span><br><span class=\"line\">mybatis.type-aliases-package = com.example.test.demo.dao.po</span><br><span class=\"line\">mybatis.mapper-locations = classpath:mapper/*.xml</span><br></pre></td></tr></table></figure>\n\n<p>29web/src/main/resourcesmybatis-generator.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class=\"line\"><span class=\"meta\">        PUBLIC \"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">        \"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">generatorConfiguration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- SpringBoot --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">properties</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"application.properties\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context</span> <span class=\"attr\">id</span>=<span class=\"string\">\"Mysql\"</span> <span class=\"attr\">targetRuntime</span>=<span class=\"string\">\"MyBatis3\"</span> <span class=\"attr\">defaultModelType</span>=<span class=\"string\">\"flat\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- pojoimplements Serializable--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span> <span class=\"attr\">type</span>=<span class=\"string\">\"org.mybatis.generator.plugins.SerializablePlugin\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">commentGenerator</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--* true  false:--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suppressDate\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span> /&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--  true  false: --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suppressAllComments\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">commentGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">jdbcConnection</span> <span class=\"attr\">driverClass</span>=<span class=\"string\">\"$&#123;spring.datasource.driverClassName&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">connectionURL</span>=<span class=\"string\">\"$&#123;spring.datasource.url&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">userId</span>=<span class=\"string\">\"$&#123;spring.datasource.username&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">password</span>=<span class=\"string\">\"$&#123;spring.datasource.password&#125;\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">jdbcConnection</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">       model(targetProject)targetProject,./src/main/java</span></span><br><span class=\"line\"><span class=\"comment\">       MAVENtarget/generatord-source</span></span><br><span class=\"line\"><span class=\"comment\">       --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">javaModelGenerator</span> <span class=\"attr\">targetPackage</span>=<span class=\"string\">\"com.example.test.demo.dao.po\"</span> <span class=\"attr\">targetProject</span>=<span class=\"string\">\"../dao/src/main/java\"</span> &gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- targetPackageschemapackagepackagefalse --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"enableSubPackages\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"trimStrings\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">javaModelGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--mapper.xml --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">sqlMapGenerator</span> <span class=\"attr\">targetPackage</span>=<span class=\"string\">\"mapper\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                         <span class=\"attr\">targetProject</span>=<span class=\"string\">\"../dao/src/main/resources\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"enableSubPackages\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">sqlMapGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- Mapper --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">javaClientGenerator</span> <span class=\"attr\">type</span>=<span class=\"string\">\"XMLMAPPER\"</span> <span class=\"attr\">targetPackage</span>=<span class=\"string\">\"com.example.test.demo.dao.mapper\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                             <span class=\"attr\">targetProject</span>=<span class=\"string\">\"../dao/src/main/java\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"enableSubPackages\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">javaClientGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- po--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">table</span> <span class=\"attr\">tableName</span>=<span class=\"string\">\"user_info\"</span> <span class=\"attr\">domainObjectName</span>=<span class=\"string\">\"UserInfoPO\"</span></span></span><br><span class=\"line\"><span class=\"tag\">               <span class=\"attr\">enableCountByExample</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">enableUpdateByExample</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">enableDeleteByExample</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">               <span class=\"attr\">enableSelectByExample</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">selectByExampleQueryId</span>=<span class=\"string\">\"false\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"useActualColumnNames\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">generatedKey</span> <span class=\"attr\">column</span>=<span class=\"string\">\"id\"</span> <span class=\"attr\">identity</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">sqlStatement</span>=<span class=\"string\">\"MySql\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">context</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>30Mapperpo,<br><img src=\"/2019/06/02/Project-Module/30.1.png\" alt=\"\"><br><br><img src=\"/2019/06/02/Project-Module/30.2.png\" alt=\"\"></p>\n<p>30bizDemoServiceImpl@AutowiredUserMapperDemoServicetest</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.biz.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.biz.DemoService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.dao.mapper.UserInfoPOMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.dao.po.UserInfoPO;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">DemoService</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserInfoPOMapper userInfoPOMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        UserInfoPO po = userInfoPOMapper.selectByPrimaryKey(<span class=\"number\">1L</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"UserInfo name is:\"</span> + po.getName();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>31AppServiceApplication</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MapperScan</span>(<span class=\"string\">\"com.example.test.demo.dao.mapper\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>32main<br><img src=\"/2019/06/02/Project-Module/32.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>mybatis </p>\n<blockquote>\n<p>Client does not support authentication protocol requested by server; consider upgrading MySQL client</p>\n</blockquote>\n<p>mysql</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ALTER USER <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">'qwertyui'</span>;</span><br><span class=\"line\">SELECT plugin FROM mysql.user WHERE User = <span class=\"string\">'root'</span>;</span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>IDEIntelliJ IDEA 2019.1</li>\n<li>mac OSX</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>biz</li>\n<li>daoMBxml</li>\n<li>common</li>\n<li>web</li></ul>","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1 IDEA  File -&gt; New -&gt; Project<br><img src=\"/2019/06/02/Project-Module/1.png\" alt=\"\"><br>2Spring InitializrInitializrDefaultNext<br><img src=\"/2019/06/02/Project-Module/2.png\" alt=\"\"><br>3,Next<br><img src=\"/2019/06/02/Project-Module/3.png\" alt=\"\"><br>4Next<br><img src=\"/2019/06/02/Project-Module/4.png\" alt=\"\"><br>5nameFinish<br><img src=\"/2019/06/02/Project-Module/5.png\" alt=\"\"><br>6<br><img src=\"/2019/06/02/Project-Module/6.png\" alt=\"\"><br>7<br><img src=\"/2019/06/02/Project-Module/7.png\" alt=\"\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>8,-&gt;New -&gt; Module<br><img src=\"/2019/06/02/Project-Module/8.png\" alt=\"\"><br>9MavenNext<br><img src=\"/2019/06/02/Project-Module/9.png\" alt=\"\"><br>10ArifactIdNext<br><img src=\"/2019/06/02/Project-Module/10.png\" alt=\"\"><br>11Finish<br><img src=\"/2019/06/02/Project-Module/11.png\" alt=\"\"><br>12<br><img src=\"/2019/06/02/Project-Module/12.png\" alt=\"\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p></p>\n<ul>\n<li>bizdaocommon</li>\n<li>dao</li>\n<li>common</li>\n<li>webbizcommon</li>\n</ul>\n<p>13pom</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>14bizpomdaocommon</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>15webpombizcommon</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>16webpomspring-boot-starter-web</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">&lt;!-- spring-boot --&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>17webcom.example.test.demo.webAppServiceApplication.java<br><img src=\"/2019/06/02/Project-Module/17.png\" alt=\"\"><br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.SpringApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppServiceApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(AppServiceApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>18com.example.test.demo.webcontrollertest</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"demo\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"Hello World!\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>19AppServiceApplicationmain8080<a href=\"http://localhost:8080/demo/test\" target=\"_blank\" rel=\"noopener\">http://localhost:8080/demo/test</a><br><img src=\"/2019/06/02/Project-Module/19.png\" alt=\"\"></p>\n<p>20bizcom.example.test.demo.bizDemoService</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.biz;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">interface</span> <span class=\"title\">DemoService</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\">String <span class=\"title\">test</span><span class=\"params\">()</span></span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>21com.example.test.demo.bizimplDemoServiceImpl</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.biz.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.biz.DemoService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">DemoService</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"biz test\"</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>22DemoController@AutowiredDemoServiceDemoControllertest</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web.controller;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.biz.DemoService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@RestController</span></span><br><span class=\"line\"><span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"demo\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoController</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> DemoService demoService;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@RequestMapping</span>(<span class=\"string\">\"test\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> demoService.test();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>23AppServiceApplication@ComponentScan</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.web;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.SpringApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.context.annotation.ComponentScan;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@SpringBootApplication</span></span><br><span class=\"line\"><span class=\"meta\">@ComponentScan</span>(basePackages = &#123;</span><br><span class=\"line\">        <span class=\"string\">\"com.example.test.demo.*\"</span></span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">AppServiceApplication</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">        SpringApplication.run(AppServiceApplication.class, args);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>24main<a href=\"http://localhost:8080/demo/test\" target=\"_blank\" rel=\"noopener\">http://localhost:8080/demo/test</a><br><img src=\"/2019/06/02/Project-Module/24.png\" alt=\"\"></p>\n<p>25</p>\n<h4 id=\"Mybatis\"><a href=\"#Mybatis\" class=\"headerlink\" title=\"Mybatis\"></a>Mybatis</h4><p>26pommybatis-spring-boot-startermysql-connector-java</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">project</span> <span class=\"attr\">xmlns</span>=<span class=\"string\">\"http://maven.apache.org/POM/4.0.0\"</span> <span class=\"attr\">xmlns:xsi</span>=<span class=\"string\">\"http://www.w3.org/2001/XMLSchema-instance\"</span></span></span><br><span class=\"line\"><span class=\"tag\">         <span class=\"attr\">xsi:schemaLocation</span>=<span class=\"string\">\"http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd\"</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">modelVersion</span>&gt;</span>4.0.0<span class=\"tag\">&lt;/<span class=\"name\">modelVersion</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">packaging</span>&gt;</span>pom<span class=\"tag\">&lt;/<span class=\"name\">packaging</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">modules</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">module</span>&gt;</span>web<span class=\"tag\">&lt;/<span class=\"name\">module</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">modules</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-parent<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>2.1.2.RELEASE<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">relativePath</span>/&gt;</span> <span class=\"comment\">&lt;!-- lookup parent from repository --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">parent</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>0.0.1-SNAPSHOT<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">name</span>&gt;</span>demo<span class=\"tag\">&lt;/<span class=\"name\">name</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">description</span>&gt;</span>Demo project for Spring Boot<span class=\"tag\">&lt;/<span class=\"name\">description</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">java.version</span>&gt;</span>1.8<span class=\"tag\">&lt;/<span class=\"name\">java.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mysql-connector.version</span>&gt;</span>8.0.11<span class=\"tag\">&lt;/<span class=\"name\">mysql-connector.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mybatis.version</span>&gt;</span>1.3.2<span class=\"tag\">&lt;/<span class=\"name\">mybatis.version</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">mybatis.generator.version</span>&gt;</span>1.3.2<span class=\"tag\">&lt;/<span class=\"name\">mybatis.generator.version</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">properties</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">pluginManagement</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                <span class=\"comment\">&lt;!--mybatis--&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.generator.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mysql-connector.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-core<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                            <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.generator.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">                        <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                    <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">pluginManagement</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">directory</span>&gt;</span>src/main/resources<span class=\"tag\">&lt;/<span class=\"name\">directory</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">filtering</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">filtering</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">resource</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">resources</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>biz<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>common<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>dao<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>com.example.test<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>web<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;project.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">scope</span>&gt;</span>test<span class=\"tag\">&lt;/<span class=\"name\">scope</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--mybatis--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- mysql --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>mysql<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">version</span>&gt;</span>$&#123;mysql-connector.version&#125;<span class=\"tag\">&lt;/<span class=\"name\">version</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">dependency</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">dependencies</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">dependencyManagement</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">project</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>27daopom</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">build</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>spring-boot-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">groupId</span>&gt;</span>org.mybatis.generator<span class=\"tag\">&lt;/<span class=\"name\">groupId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">artifactId</span>&gt;</span>mybatis-generator-maven-plugin<span class=\"tag\">&lt;/<span class=\"name\">artifactId</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">configurationFile</span>&gt;</span>$&#123;basedir&#125;/src/main/resources/mybatis-generator.xml<span class=\"tag\">&lt;/<span class=\"name\">configurationFile</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">overwrite</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">overwrite</span>&gt;</span></span><br><span class=\"line\">                <span class=\"tag\">&lt;<span class=\"name\">verbose</span>&gt;</span>true<span class=\"tag\">&lt;/<span class=\"name\">verbose</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;/<span class=\"name\">configuration</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">plugin</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">plugins</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">build</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>28web/src/main/resourcesapplication.properties</p>\n<ul>\n<li><strong>com.mysql.jdbc.Driver</strong>  mysql-connector-java 5</li>\n<li><strong>com.mysql.cj.jdbc.Driver</strong>  mysql-connector-java 6</li>\n</ul>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.datasource.driverClassName = com.mysql.cj.jdbc.Driver</span><br><span class=\"line\">spring.datasource.url = jdbc:mysql://localhost:3306/test?useUnicode=true&amp;characterEncoding=UTF8&amp;connectTimeout=1000&amp;socketTimeout=3000</span><br><span class=\"line\">spring.datasource.username = root</span><br><span class=\"line\">spring.datasource.password = qwertyui</span><br><span class=\"line\"></span><br><span class=\"line\">mybatis.type-aliases-package = com.example.test.demo.dao.po</span><br><span class=\"line\">mybatis.mapper-locations = classpath:mapper/*.xml</span><br></pre></td></tr></table></figure>\n\n<p>29web/src/main/resourcesmybatis-generator.xml</p>\n<figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</span></span><br><span class=\"line\"><span class=\"meta\">&lt;!DOCTYPE generatorConfiguration</span></span><br><span class=\"line\"><span class=\"meta\">        PUBLIC \"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\"</span></span><br><span class=\"line\"><span class=\"meta\">        \"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\"&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">generatorConfiguration</span>&gt;</span></span><br><span class=\"line\">    <span class=\"comment\">&lt;!-- SpringBoot --&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">properties</span> <span class=\"attr\">resource</span>=<span class=\"string\">\"application.properties\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"tag\">&lt;<span class=\"name\">context</span> <span class=\"attr\">id</span>=<span class=\"string\">\"Mysql\"</span> <span class=\"attr\">targetRuntime</span>=<span class=\"string\">\"MyBatis3\"</span> <span class=\"attr\">defaultModelType</span>=<span class=\"string\">\"flat\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- pojoimplements Serializable--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">plugin</span> <span class=\"attr\">type</span>=<span class=\"string\">\"org.mybatis.generator.plugins.SerializablePlugin\"</span>/&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">commentGenerator</span>&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--* true  false:--&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suppressDate\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span> /&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--  true  false: --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"suppressAllComments\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span> /&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">commentGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">jdbcConnection</span> <span class=\"attr\">driverClass</span>=<span class=\"string\">\"$&#123;spring.datasource.driverClassName&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">connectionURL</span>=<span class=\"string\">\"$&#123;spring.datasource.url&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">userId</span>=<span class=\"string\">\"$&#123;spring.datasource.username&#125;\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                        <span class=\"attr\">password</span>=<span class=\"string\">\"$&#123;spring.datasource.password&#125;\"</span>&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">jdbcConnection</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--</span></span><br><span class=\"line\"><span class=\"comment\">       model(targetProject)targetProject,./src/main/java</span></span><br><span class=\"line\"><span class=\"comment\">       MAVENtarget/generatord-source</span></span><br><span class=\"line\"><span class=\"comment\">       --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">javaModelGenerator</span> <span class=\"attr\">targetPackage</span>=<span class=\"string\">\"com.example.test.demo.dao.po\"</span> <span class=\"attr\">targetProject</span>=<span class=\"string\">\"../dao/src/main/java\"</span> &gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!-- targetPackageschemapackagepackagefalse --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"enableSubPackages\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"comment\">&lt;!--  --&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"trimStrings\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">javaModelGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!--mapper.xml --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">sqlMapGenerator</span> <span class=\"attr\">targetPackage</span>=<span class=\"string\">\"mapper\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                         <span class=\"attr\">targetProject</span>=<span class=\"string\">\"../dao/src/main/resources\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"enableSubPackages\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">sqlMapGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- Mapper --&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">javaClientGenerator</span> <span class=\"attr\">type</span>=<span class=\"string\">\"XMLMAPPER\"</span> <span class=\"attr\">targetPackage</span>=<span class=\"string\">\"com.example.test.demo.dao.mapper\"</span></span></span><br><span class=\"line\"><span class=\"tag\">                             <span class=\"attr\">targetProject</span>=<span class=\"string\">\"../dao/src/main/java\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"enableSubPackages\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"true\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">javaClientGenerator</span>&gt;</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">&lt;!-- po--&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;<span class=\"name\">table</span> <span class=\"attr\">tableName</span>=<span class=\"string\">\"user_info\"</span> <span class=\"attr\">domainObjectName</span>=<span class=\"string\">\"UserInfoPO\"</span></span></span><br><span class=\"line\"><span class=\"tag\">               <span class=\"attr\">enableCountByExample</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">enableUpdateByExample</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">enableDeleteByExample</span>=<span class=\"string\">\"true\"</span></span></span><br><span class=\"line\"><span class=\"tag\">               <span class=\"attr\">enableSelectByExample</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">selectByExampleQueryId</span>=<span class=\"string\">\"false\"</span>&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">property</span> <span class=\"attr\">name</span>=<span class=\"string\">\"useActualColumnNames\"</span> <span class=\"attr\">value</span>=<span class=\"string\">\"false\"</span>/&gt;</span></span><br><span class=\"line\">            <span class=\"tag\">&lt;<span class=\"name\">generatedKey</span> <span class=\"attr\">column</span>=<span class=\"string\">\"id\"</span> <span class=\"attr\">identity</span>=<span class=\"string\">\"true\"</span> <span class=\"attr\">sqlStatement</span>=<span class=\"string\">\"MySql\"</span>/&gt;</span></span><br><span class=\"line\">        <span class=\"tag\">&lt;/<span class=\"name\">table</span>&gt;</span></span><br><span class=\"line\">    <span class=\"tag\">&lt;/<span class=\"name\">context</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;/<span class=\"name\">generatorConfiguration</span>&gt;</span></span><br></pre></td></tr></table></figure>\n\n<p>30Mapperpo,<br><img src=\"/2019/06/02/Project-Module/30.1.png\" alt=\"\"><br><br><img src=\"/2019/06/02/Project-Module/30.2.png\" alt=\"\"></p>\n<p>30bizDemoServiceImpl@AutowiredUserMapperDemoServicetest</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">package</span> com.example.test.demo.biz.impl;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.biz.DemoService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.dao.mapper.UserInfoPOMapper;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.example.test.demo.dao.po.UserInfoPO;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Service;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Service</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">DemoServiceImpl</span> <span class=\"keyword\">implements</span> <span class=\"title\">DemoService</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> UserInfoPOMapper userInfoPOMapper;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> String <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        UserInfoPO po = userInfoPOMapper.selectByPrimaryKey(<span class=\"number\">1L</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"string\">\"UserInfo name is:\"</span> + po.getName();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>31AppServiceApplication</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@MapperScan</span>(<span class=\"string\">\"com.example.test.demo.dao.mapper\"</span>)</span><br></pre></td></tr></table></figure>\n\n<p>32main<br><img src=\"/2019/06/02/Project-Module/32.png\" alt=\"\"></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>mybatis </p>\n<blockquote>\n<p>Client does not support authentication protocol requested by server; consider upgrading MySQL client</p>\n</blockquote>\n<p>mysql</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ALTER USER <span class=\"string\">'root'</span>@<span class=\"string\">'localhost'</span> IDENTIFIED WITH mysql_native_password BY <span class=\"string\">'qwertyui'</span>;</span><br><span class=\"line\">SELECT plugin FROM mysql.user WHERE User = <span class=\"string\">'root'</span>;</span><br></pre></td></tr></table></figure>"},{"title":"Mysql-","author":"Guyuqing","copyright":true,"comments":0,"date":"2019-08-28T08:32:00.000Z","_content":"MySQL``````````````\n<!-- more -->\n![](Mysql-storage/640.png)\n\n# \n\nMySQL`@`MySQL<font color='red'>a</font>\n```sql\nmysql> SET @a = 1;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n<font color='Orange'>SELECT</font>@\n```sql\nmysql> SELECT @a;\n+------+\n| @a   |\n+------+\n|    1 |\n+------+\n1 row in set (0.00 sec)\n```\n\n<font color='red'>a</font>\n```sql\nmysql> SET @a = '';\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> SELECT @a;\n+------+\n| @a   |\n+------+\n|    |\n+------+\n1 row in set (0.00 sec)\n```\n\n\n```sql\nmysql> SET @b = @a;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> SELECT @b;\n+------+\n| @b   |\n+------+\n|    |\n+------+\n1 row in set (0.00 sec)\n```\n\n<font color='red'></font>\n```sql\nmysql> SET @a = (SELECT first_column FROM first_table LIMIT 1);\nQuery OK, 0 rows affected (0.00 sec)\n\n```\n\n\n```sql\nmysql> SELECT first_column FROM first_table LIMIT 1 INTO @b;\nQuery OK, 1 row affected (0.00 sec)\n\n```\n\n\n```sql\nmysql> SELECT @a, @b;\n+------+------+\n| @a   | @b   |\n+------+------+\n|    1 |    1 |\n+------+------+\n1 row in set (0.00 sec)\n```\n`INTO`\n```sql\nmysql> SELECT first_column, second_column FROM first_table LIMIT 1 INTO @a, @b;\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> SELECT @a, @b;                                                           \n+------+------+\n| @a   | @b   |\n+------+------+\n|    1 | aaa  |\n+------+------+\n1 row in set (0.00 sec)\n```\n\n# \n\nMySQLMySQL`;``\\g``\\G`\n```sql\nmysql> SELECT first_column FROM first_table ;SELECT second_column FROM first_table;\n+--------------+\n| first_column |\n+--------------+\n|            1 |\n|            2 |\n|         NULL |\n+--------------+\n3 rows in set (0.00 sec)\n\n+---------------+\n| second_column |\n+---------------+\n| aaa           |\n| NULL          |\n| ccc           |\n+---------------+\n3 rows in set (0.00 sec)\n\n```\n\n`delimiter`MySQL\n```sql\nmysql> delimiter $\nmysql> SELECT first_column FROM first_table ;\n    -> SELECT second_column FROM first_table;\n    -> $\n+--------------+\n| first_column |\n+--------------+\n|            1 |\n|            2 |\n|         NULL |\n+--------------+\n3 rows in set (0.00 sec)\n\n+---------------+\n| second_column |\n+---------------+\n| aaa           |\n| NULL          |\n| ccc           |\n+---------------+\n3 rows in set (0.00 sec)\n\n```\n\n`delimiter $`MySQL`$`,MySQL\n```sql\nmysql> delimiter 666\nmysql> SELECT first_column FROM first_table;\n    -> SELECT second_column FROM first_table;\n    -> 666\n+--------------+\n| first_column |\n+--------------+\n|            1 |\n|            2 |\n|         NULL |\n+--------------+\n3 rows in set (0.00 sec)\n\n+---------------+\n| second_column |\n+---------------+\n| aaa           |\n| NULL          |\n| ccc           |\n+---------------+\n3 rows in set (0.00 sec)\n```\n\n# \n\n## \n````\nMySQL\n```sql\nCREATE FUNCTION ([])\nRETURNS \nBEGIN\n    \nEND\n```\n\n\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION second_column(a INT)\n    -> RETURNS VARCHAR(100)\n    -> BEGIN\n    -> RETURN (SELECT second_column FROM first_table WHERE first_column = a);\n    -> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> delimiter ;\n```\n\n## \n`()`\n```sql\nmysql> SELECT second_column(1);\n+------------------+\n| second_column(1) |\n+------------------+\n| aaa              |\n+------------------+\n1 row in set (0.00 sec)\n```\n\n## \n:\n```sql\nSHOW FUNCTION STATUS [LIKE ]\n```\n\n:\n```sql\nSHOW CREATE FUNCTION \n```\n\n## \n\n```sql\nDROP FUNCTION \n```\n\n## \n\n`@`,\n```sql\nDECLARE   [DEFAULT ];   \n\nmysql> delimiter $\nmysql> CREATE FUNCTION var_demo(a INT)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE b INT;\n    -> SET b = 5;\n    -> RETURN b+a;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> delimiter ;\n```\n\n```sql\nmysql> SELECT var_demo(2);\n+-------------+\n| var_demo(2) |\n+-------------+\n|           7 |\n+-------------+\n1 row in set (0.00 sec)\n```\nNULL`DEFAULT`.\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION var_default_demo()\n-> RETURNS INT\n-> BEGIN\n->     DECLARE c INT DEFAULT 1;\n->     RETURN c;\n-> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> delimiter ;\n\nmysql> SELECT var_default_demo();\n+--------------------+\n| var_default_demo() |\n+--------------------+\n|                  1 |\n+--------------------+\n1 row in set (0.00 sec)\n\n```\n\n## \n\nsecond_column\n\n```sql\nmysql> CREATE FUNCTION second_column(a INT)\n    -> RETURNS VARCHAR(100)\n    -> BEGIN\n    -> RETURN (SELECT second_column FROM first_table WHERE first_column = a);\n    -> END $\n```\n\n\n\n\n## \n\n\n```sql\nIF  THEN \n    \n[ELSEIF  THEN\n    ]\n[ELSE \n    ]    \nEND IF;\n```\n\n\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION condition_demo(i INT)\n    -> RETURNS VARCHAR(10)\n    -> BEGIN\n    -> DECLARE result VARCHAR(10);\n    -> IF i = 1 THEN\n    -> SET result = '1';\n    -> ELSEIF i = 2 THEN\n    ->  SET result = '2';\n    -> ELSEIF i = 3 THEN\n    -> SET result = '3';\n    -> ELSE\n    -> SET result = '';\n    -> END IF;\n    -> RETURN result;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> delimiter;\n\n\nmysql> SELECT condition_demo(2);\n+-------------------+\n| condition_demo(2) |\n+-------------------+\n| 2           |\n+-------------------+\n1 row in set (0.00 sec)\n\n```\n\n## \n`while`\n```sql\nWHILE  DO\n    \nEND WHILE;\n```\n\n\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION sum_all(n INT UNSIGNED)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE result INT DEFAULT 0;\n    -> DECLARE i INT DEFAULT 1;\n    -> WHILE i <= n DO\n    -> SET result = result + i;\n    -> SET i = i + 1;\n    -> END WHILE;\n    -> RETURN result;\n    -> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> delimiter;\n\nmysql> select sum_all(10);\n+-------------+\n| sum_all(10) |\n+-------------+\n|          55 |\n+-------------+\n1 row in set (0.00 sec)\n```\n\n`REPEAT`\n```sql\nREPEAT\n    \nUNTIL  END REPEAT;\n```\n\n```sql\nmysql> CREATE FUNCTION sum_repeat(n INT UNSIGNED)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE result INT DEFAULT 0;\n    -> DECLARE i INT DEFAULT 1;\n    -> REPEAT\n    -> -- \n    -> SET result = result + i;\n    -> SET i = i + 1;\n    -> UNTIL i > n END REPEAT;\n    -> RETURN result;\n    -> END $\nQuery OK, 0 rows affected (0.02 sec)\n\nmysql> select sum_repeat(5);\n+---------------+\n| sum_repeat(5) |\n+---------------+\n|            15 |\n+---------------+\n1 row in set (0.01 sec)\n```\n\n\n`LOOP`\n```sql\n:LOOP\n    \n    LEAVE ;\nEND LOOP ;\n```\n\n```sql\nmysql> CREATE FUNCTION sum_loop(n INT UNSIGNED)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE result INT DEFAULT 0;\n    -> DECLARE i INT DEFAULT 1;\n    -> LOOP_NAME:LOOP -- \n    -> IF i > n THEN\n    -> LEAVE LOOP_NAME;\n    -> END IF;\n    -> SET result = result + i;\n    -> SET i = i + 1;\n    -> END LOOP LOOP_NAME;\n    -> RETURN result;\n    -> END $\n    \nmysql> select sum_loop(10);\n+--------------+\n| sum_loop(10) |\n+--------------+\n|           55 |\n+--------------+\n1 row in set (0.00 sec)\n```\n\n# \n\n\n## \n```sql\nCREATE PROCEDURE ([])\nBEGIN\n    \nEND  \n```\n\n```sql\nmysql> CREATE PROCEDURE insert_first_table(c1 INT,c2 VARCHAR(100))\n    -> BEGIN\n    -> SELECT * FROM first_table;\n    -> INSERT INTO first_table(first_column,second_column) VALUES(c1,c2);\n    -> SELECT * FROM first_table;\n    -> END $\nQuery OK, 0 rows affected (0.02 sec)\n```\n\n## \n\n\nCALL\n\n```sql\nCALL ([]);\n```\n\n```sql\nmysql> CALL insert_first_table(4,'test');\n \n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n+--------------+---------------+\n3 rows in set (0.00 sec)\n\n\n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n|            4 | test          |\n+--------------+---------------+\n4 rows in set (0.00 sec)\n```\n\n## \n```sql\n\nSHOW PROCEDURE STATUS [LIKE ]\n\n\nSHOW CREATE PROCEDURE \n```\n\n## \n\n```sql\nDROP PROCEDURE \n```\n\n## \n<table>\n<tr>\n    <th></th>\n    <th></th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\">IN</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">OUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">INOUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\">INOUT</td>\n</tr>\n</table>  \n\n### IN\n```sql\nmysql> CREATE PROCEDURE test_in(IN num INT)\n    -> BEGIN\n    -> SELECT num;\n    -> SET num = 666;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> SET @a = 111;\n\nQuery OK, 0 rows affected (0.01 sec)\n\n\nmysql> CALL test_in(@a);\n+------+\n| num  |\n+------+\n|  111 |\n+------+\n1 row in set (0.00 sec)\n\nQuery OK, 0 rows affected (0.00 sec)\n```\nIN\nIN\n\n### OUT\n```sql\nmysql> CREATE PROCEDURE test_out(OUT num INT)\n    -> BEGIN\n    -> SELECT num;\n    -> SET num = 666;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\n\nmysql> CALL test_out(@a);\n+------+\n| num  |\n+------+\n| NULL |\n+------+\n1 row in set (0.00 sec)\n\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> SELECT @a;\n+------+\n| @a   |\n+------+\n|  666 |\n+------+\n1 row in set (0.00 sec)\n\n```\n\nOUT,\n\n\n```sql\nmysql> CREATE PROCEDURE data_out(OUT a INT,OUT b INT)\n    -> BEGIN\n    -> SET a = 100;\n    -> SET b = 200;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> CALL data_out(@a,@b);\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> select @a,@b;\n+------+------+\n| @a   | @b   |\n+------+------+\n|  100 |  200 |\n+------+------+\n1 row in set (0.00 sec)\n\n```\n\n### INOUT\n\n\n\n## \n\n* RETURNSRETURN\n\n* ININOUTINOUT\n\n* OUT\n\n* \n\n* CALL\n\n# \nCursor\n,\n\n## \n```sql\nDECLARE  CURSOR FOR ;\n```\n\n```sql\nmysql> CREATE PROCEDURE cursor_demo()\n    -> BEGIN\n    -> DECLARE first_table_cursor CURSOR FOR select * from first_table;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n```\n## \n```sql\nOPEN ;\n\nCLOSE ;\n```\n\n\n## \n\n```sql\nFETCH  INTO 1, 2, ... n\n```\n\n```sql\nmysql> CREATE PROCEDURE cursor_demo()\n    -> BEGIN\n    -> DECLARE c1 INT;\n    -> DECLARE c2 VARCHAR(100);\n    -> DECLARE record_count INT;\n    -> DECLARE i INT DEFAULT 0;\n    ->  -- \n    -> DECLARE first_table_cursor CURSOR FOR select * from first_table;\n    ->\n    -> -- \n    -> SELECT COUNT(*) FROM first_table INTO record_count;\n    ->\n    -> -- \n    -> OPEN first_table_cursor;\n    ->\n    -> WHILE i < record_count DO\n    -> FETCH first_table_cursor INTO c1 , c2;\n    -> SELECT c1,c2;\n    -> SET i = i + 1;\n    -> END WHILE;\n    -> CLOSE first_table_cursor;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> CALL cursor_demo();\n+------+------+\n| c1   | c2   |\n+------+------+\n|    1 | aaa  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    2 | NULL |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n| NULL | ccc  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    4 | test |\n+------+------+\n1 row in set (0.01 sec)\n\nQuery OK, 0 rows affected (0.01 sec)\n\n```\ni FETCH \n\n## \n\nFETCH\nMySQL\n```sql\nDECLARE CONTINUE HANDLER FOR NOT FOUND ;  \n```\ncursor_demo\n```sql\nmysql> delimiter $\nmysql> CREATE PROCEDURE cursor_demo()\n    -> BEGIN\n    -> -- \n    -> DECLARE c1 INT;\n    -> DECLARE c2 VARCHAR(100);\n    -> DECLARE not_done INT DEFAULT 1;\n    ->\n    -> -- \n    -> DECLARE first_table_cursor CURSOR FOR select * from first_table;\n    ->\n    -> --  not_done  0\n    -> DECLARE CONTINUE HANDLER FOR NOT FOUND SET not_done = 0;\n    ->\n    -> -- \n    -> OPEN first_table_cursor;\n    ->\n    -> WHILE not_done = 1 DO\n    ->\n    -> FETCH first_table_cursor INTO c1 , c2;\n    -> SELECT c1,c2;\n    -> END WHILE;\n    -> CLOSE first_table_cursor;\n    -> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql>  CALL cursor_demo();\n+------+------+\n| c1   | c2   |\n+------+------+\n|    1 | aaa  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    2 | NULL |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n| NULL | ccc  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    4 | test |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    4 | test |\n+------+------+\n1 row in set (0.01 sec)\n\nQuery OK, 0 rows affected (0.01 sec)\n\n```\n`EXIT``CONTINUE`\n`CONTINUE`FETCH\n`EXIT`FETCH\n\n# \n``\n\n## \n\n```sql\nCREATE TRIGGER \n{BEFORE|AFTER}          \n{INSERT|DELETE|UPDATE}\nON \nFOR EACH ROW \nBEGIN\n    \nEND\n```\nMySQLINSERTDELETEUPDATE\n\n\nMySQLNEWOLD\n* INSERTNEWOLD\n* DELETEOLDNEW\n* UPDATENEWOLD\n\n\n```sql\nmysql> CREATE TRIGGER test_trigger\n    -> BEFORE INSERT ON first_table\n    -> FOR EACH ROW\n    -> BEGIN\n    -> IF NEW.first_column < 1 THEN\n    ->  SET NEW.first_column = 1;\n    -> ELSEIF NEW.first_column > 10 THEN\n    ->  SET NEW.first_column = 10;\n    -> END IF;\n    -> END $\nQuery OK, 0 rows affected (0.02 sec)\n\nmysql> select * from first_table;\n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n|            4 | test          |\n+--------------+---------------+\n4 rows in set (0.00 sec)\n\nmysql> INSERT INTO first_table(first_column,second_column) VALUES(5,'5'),(20,'20');\nQuery OK, 2 rows affected (0.01 sec)\nRecords: 2  Duplicates: 0  Warnings: 0\n\n\nmysql> select * from first_table;\n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n|            4 | test          |\n|            5 | 5             |\n|           10 | 20            |\n+--------------+---------------+\n6 rows in set (0.00 sec)\n```\n(20,'20')(10,'20')\n\n## \n\n```sql\n\nSHOW TRIGGERS;\n\n\nSHOW CREATE TRIGGER ;\n```\n\n## \n```sql\nDROP TRIGGER ;\n```\n\n## \n1. \n2. 6\n    * BEFORE INSERT\n    * BEFORE DELETE\n    * BEFORE UPDATE\n    * AFTER INSERT\n    * AFTER DELETE\n    * AFTER UPDATE\n3. NEWOLD\n4. `BEFORE``ERROR``ERROR``AFTER`\n\n# \n\n,\n\n## \n```sql\nCREATE EVENT \nON SCHEDULE\n{AT  | EVERY  [STARTS datetime][END datetime]}\nDO\nBEGIN\n    \nEND\n```\n\n\n1. \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> AT '2019-09-10 11:30:30'\n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> AT DATE_ADD(NOW(), INTERVAL 2 DAY)\n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    DATE_ADD(NOW(), INTERVAL 2 DAY)\n\n2. \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> EVERY 1 HOUR \n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> EVERY 1 HOUR STARTS '2019-09-10 11:30:30' ENDS '2019-09-12 11:30:30'\n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    MySQL\n\n## \n```sql\n\nSHOW EVENTS;\n\n:\nSHOW CREATE EVENT ;\n```\n\n## \n```sql\nDROP EVENT ;\n```\n\n## \nMySQL\n```sql\nevent_scheduler = ON\n```\n`event_scheduler`MySQL\n```sql\nmysql> SET GLOBAL event_scheduler = ON;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n\n\n# \nMySql\n```sql\nERROR 1418 (HY000): This function has none of DETERMINISTIC, NO SQL, or READS SQL DATA in its declaration and binary logging is enabled (you *might* want to use the less safe log_bin_trust_function_creators variable)\n```\n\n```sql\nmysql> set global log_bin_trust_function_creators=1;\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","source":"_posts/Mysql-storage.md","raw":"title: Mysql-\ntags:\n  - MySql\ncategories:\n  - Mysql\nauthor: Guyuqing\ncopyright: true\ncomments: false\ndate: 2019-08-28 16:32:00\n---\nMySQL``````````````\n<!-- more -->\n![](Mysql-storage/640.png)\n\n# \n\nMySQL`@`MySQL<font color='red'>a</font>\n```sql\nmysql> SET @a = 1;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n<font color='Orange'>SELECT</font>@\n```sql\nmysql> SELECT @a;\n+------+\n| @a   |\n+------+\n|    1 |\n+------+\n1 row in set (0.00 sec)\n```\n\n<font color='red'>a</font>\n```sql\nmysql> SET @a = '';\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> SELECT @a;\n+------+\n| @a   |\n+------+\n|    |\n+------+\n1 row in set (0.00 sec)\n```\n\n\n```sql\nmysql> SET @b = @a;\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> SELECT @b;\n+------+\n| @b   |\n+------+\n|    |\n+------+\n1 row in set (0.00 sec)\n```\n\n<font color='red'></font>\n```sql\nmysql> SET @a = (SELECT first_column FROM first_table LIMIT 1);\nQuery OK, 0 rows affected (0.00 sec)\n\n```\n\n\n```sql\nmysql> SELECT first_column FROM first_table LIMIT 1 INTO @b;\nQuery OK, 1 row affected (0.00 sec)\n\n```\n\n\n```sql\nmysql> SELECT @a, @b;\n+------+------+\n| @a   | @b   |\n+------+------+\n|    1 |    1 |\n+------+------+\n1 row in set (0.00 sec)\n```\n`INTO`\n```sql\nmysql> SELECT first_column, second_column FROM first_table LIMIT 1 INTO @a, @b;\nQuery OK, 1 row affected (0.00 sec)\n\nmysql> SELECT @a, @b;                                                           \n+------+------+\n| @a   | @b   |\n+------+------+\n|    1 | aaa  |\n+------+------+\n1 row in set (0.00 sec)\n```\n\n# \n\nMySQLMySQL`;``\\g``\\G`\n```sql\nmysql> SELECT first_column FROM first_table ;SELECT second_column FROM first_table;\n+--------------+\n| first_column |\n+--------------+\n|            1 |\n|            2 |\n|         NULL |\n+--------------+\n3 rows in set (0.00 sec)\n\n+---------------+\n| second_column |\n+---------------+\n| aaa           |\n| NULL          |\n| ccc           |\n+---------------+\n3 rows in set (0.00 sec)\n\n```\n\n`delimiter`MySQL\n```sql\nmysql> delimiter $\nmysql> SELECT first_column FROM first_table ;\n    -> SELECT second_column FROM first_table;\n    -> $\n+--------------+\n| first_column |\n+--------------+\n|            1 |\n|            2 |\n|         NULL |\n+--------------+\n3 rows in set (0.00 sec)\n\n+---------------+\n| second_column |\n+---------------+\n| aaa           |\n| NULL          |\n| ccc           |\n+---------------+\n3 rows in set (0.00 sec)\n\n```\n\n`delimiter $`MySQL`$`,MySQL\n```sql\nmysql> delimiter 666\nmysql> SELECT first_column FROM first_table;\n    -> SELECT second_column FROM first_table;\n    -> 666\n+--------------+\n| first_column |\n+--------------+\n|            1 |\n|            2 |\n|         NULL |\n+--------------+\n3 rows in set (0.00 sec)\n\n+---------------+\n| second_column |\n+---------------+\n| aaa           |\n| NULL          |\n| ccc           |\n+---------------+\n3 rows in set (0.00 sec)\n```\n\n# \n\n## \n````\nMySQL\n```sql\nCREATE FUNCTION ([])\nRETURNS \nBEGIN\n    \nEND\n```\n\n\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION second_column(a INT)\n    -> RETURNS VARCHAR(100)\n    -> BEGIN\n    -> RETURN (SELECT second_column FROM first_table WHERE first_column = a);\n    -> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> delimiter ;\n```\n\n## \n`()`\n```sql\nmysql> SELECT second_column(1);\n+------------------+\n| second_column(1) |\n+------------------+\n| aaa              |\n+------------------+\n1 row in set (0.00 sec)\n```\n\n## \n:\n```sql\nSHOW FUNCTION STATUS [LIKE ]\n```\n\n:\n```sql\nSHOW CREATE FUNCTION \n```\n\n## \n\n```sql\nDROP FUNCTION \n```\n\n## \n\n`@`,\n```sql\nDECLARE   [DEFAULT ];   \n\nmysql> delimiter $\nmysql> CREATE FUNCTION var_demo(a INT)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE b INT;\n    -> SET b = 5;\n    -> RETURN b+a;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> delimiter ;\n```\n\n```sql\nmysql> SELECT var_demo(2);\n+-------------+\n| var_demo(2) |\n+-------------+\n|           7 |\n+-------------+\n1 row in set (0.00 sec)\n```\nNULL`DEFAULT`.\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION var_default_demo()\n-> RETURNS INT\n-> BEGIN\n->     DECLARE c INT DEFAULT 1;\n->     RETURN c;\n-> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> delimiter ;\n\nmysql> SELECT var_default_demo();\n+--------------------+\n| var_default_demo() |\n+--------------------+\n|                  1 |\n+--------------------+\n1 row in set (0.00 sec)\n\n```\n\n## \n\nsecond_column\n\n```sql\nmysql> CREATE FUNCTION second_column(a INT)\n    -> RETURNS VARCHAR(100)\n    -> BEGIN\n    -> RETURN (SELECT second_column FROM first_table WHERE first_column = a);\n    -> END $\n```\n\n\n\n\n## \n\n\n```sql\nIF  THEN \n    \n[ELSEIF  THEN\n    ]\n[ELSE \n    ]    \nEND IF;\n```\n\n\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION condition_demo(i INT)\n    -> RETURNS VARCHAR(10)\n    -> BEGIN\n    -> DECLARE result VARCHAR(10);\n    -> IF i = 1 THEN\n    -> SET result = '1';\n    -> ELSEIF i = 2 THEN\n    ->  SET result = '2';\n    -> ELSEIF i = 3 THEN\n    -> SET result = '3';\n    -> ELSE\n    -> SET result = '';\n    -> END IF;\n    -> RETURN result;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> delimiter;\n\n\nmysql> SELECT condition_demo(2);\n+-------------------+\n| condition_demo(2) |\n+-------------------+\n| 2           |\n+-------------------+\n1 row in set (0.00 sec)\n\n```\n\n## \n`while`\n```sql\nWHILE  DO\n    \nEND WHILE;\n```\n\n\n```sql\nmysql> delimiter $\nmysql> CREATE FUNCTION sum_all(n INT UNSIGNED)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE result INT DEFAULT 0;\n    -> DECLARE i INT DEFAULT 1;\n    -> WHILE i <= n DO\n    -> SET result = result + i;\n    -> SET i = i + 1;\n    -> END WHILE;\n    -> RETURN result;\n    -> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> delimiter;\n\nmysql> select sum_all(10);\n+-------------+\n| sum_all(10) |\n+-------------+\n|          55 |\n+-------------+\n1 row in set (0.00 sec)\n```\n\n`REPEAT`\n```sql\nREPEAT\n    \nUNTIL  END REPEAT;\n```\n\n```sql\nmysql> CREATE FUNCTION sum_repeat(n INT UNSIGNED)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE result INT DEFAULT 0;\n    -> DECLARE i INT DEFAULT 1;\n    -> REPEAT\n    -> -- \n    -> SET result = result + i;\n    -> SET i = i + 1;\n    -> UNTIL i > n END REPEAT;\n    -> RETURN result;\n    -> END $\nQuery OK, 0 rows affected (0.02 sec)\n\nmysql> select sum_repeat(5);\n+---------------+\n| sum_repeat(5) |\n+---------------+\n|            15 |\n+---------------+\n1 row in set (0.01 sec)\n```\n\n\n`LOOP`\n```sql\n:LOOP\n    \n    LEAVE ;\nEND LOOP ;\n```\n\n```sql\nmysql> CREATE FUNCTION sum_loop(n INT UNSIGNED)\n    -> RETURNS INT\n    -> BEGIN\n    -> DECLARE result INT DEFAULT 0;\n    -> DECLARE i INT DEFAULT 1;\n    -> LOOP_NAME:LOOP -- \n    -> IF i > n THEN\n    -> LEAVE LOOP_NAME;\n    -> END IF;\n    -> SET result = result + i;\n    -> SET i = i + 1;\n    -> END LOOP LOOP_NAME;\n    -> RETURN result;\n    -> END $\n    \nmysql> select sum_loop(10);\n+--------------+\n| sum_loop(10) |\n+--------------+\n|           55 |\n+--------------+\n1 row in set (0.00 sec)\n```\n\n# \n\n\n## \n```sql\nCREATE PROCEDURE ([])\nBEGIN\n    \nEND  \n```\n\n```sql\nmysql> CREATE PROCEDURE insert_first_table(c1 INT,c2 VARCHAR(100))\n    -> BEGIN\n    -> SELECT * FROM first_table;\n    -> INSERT INTO first_table(first_column,second_column) VALUES(c1,c2);\n    -> SELECT * FROM first_table;\n    -> END $\nQuery OK, 0 rows affected (0.02 sec)\n```\n\n## \n\n\nCALL\n\n```sql\nCALL ([]);\n```\n\n```sql\nmysql> CALL insert_first_table(4,'test');\n \n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n+--------------+---------------+\n3 rows in set (0.00 sec)\n\n\n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n|            4 | test          |\n+--------------+---------------+\n4 rows in set (0.00 sec)\n```\n\n## \n```sql\n\nSHOW PROCEDURE STATUS [LIKE ]\n\n\nSHOW CREATE PROCEDURE \n```\n\n## \n\n```sql\nDROP PROCEDURE \n```\n\n## \n<table>\n<tr>\n    <th></th>\n    <th></th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\">IN</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">OUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">INOUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\">INOUT</td>\n</tr>\n</table>  \n\n### IN\n```sql\nmysql> CREATE PROCEDURE test_in(IN num INT)\n    -> BEGIN\n    -> SELECT num;\n    -> SET num = 666;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> SET @a = 111;\n\nQuery OK, 0 rows affected (0.01 sec)\n\n\nmysql> CALL test_in(@a);\n+------+\n| num  |\n+------+\n|  111 |\n+------+\n1 row in set (0.00 sec)\n\nQuery OK, 0 rows affected (0.00 sec)\n```\nIN\nIN\n\n### OUT\n```sql\nmysql> CREATE PROCEDURE test_out(OUT num INT)\n    -> BEGIN\n    -> SELECT num;\n    -> SET num = 666;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\n\nmysql> CALL test_out(@a);\n+------+\n| num  |\n+------+\n| NULL |\n+------+\n1 row in set (0.00 sec)\n\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql> SELECT @a;\n+------+\n| @a   |\n+------+\n|  666 |\n+------+\n1 row in set (0.00 sec)\n\n```\n\nOUT,\n\n\n```sql\nmysql> CREATE PROCEDURE data_out(OUT a INT,OUT b INT)\n    -> BEGIN\n    -> SET a = 100;\n    -> SET b = 200;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> CALL data_out(@a,@b);\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> select @a,@b;\n+------+------+\n| @a   | @b   |\n+------+------+\n|  100 |  200 |\n+------+------+\n1 row in set (0.00 sec)\n\n```\n\n### INOUT\n\n\n\n## \n\n* RETURNSRETURN\n\n* ININOUTINOUT\n\n* OUT\n\n* \n\n* CALL\n\n# \nCursor\n,\n\n## \n```sql\nDECLARE  CURSOR FOR ;\n```\n\n```sql\nmysql> CREATE PROCEDURE cursor_demo()\n    -> BEGIN\n    -> DECLARE first_table_cursor CURSOR FOR select * from first_table;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n```\n## \n```sql\nOPEN ;\n\nCLOSE ;\n```\n\n\n## \n\n```sql\nFETCH  INTO 1, 2, ... n\n```\n\n```sql\nmysql> CREATE PROCEDURE cursor_demo()\n    -> BEGIN\n    -> DECLARE c1 INT;\n    -> DECLARE c2 VARCHAR(100);\n    -> DECLARE record_count INT;\n    -> DECLARE i INT DEFAULT 0;\n    ->  -- \n    -> DECLARE first_table_cursor CURSOR FOR select * from first_table;\n    ->\n    -> -- \n    -> SELECT COUNT(*) FROM first_table INTO record_count;\n    ->\n    -> -- \n    -> OPEN first_table_cursor;\n    ->\n    -> WHILE i < record_count DO\n    -> FETCH first_table_cursor INTO c1 , c2;\n    -> SELECT c1,c2;\n    -> SET i = i + 1;\n    -> END WHILE;\n    -> CLOSE first_table_cursor;\n    -> END $\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> CALL cursor_demo();\n+------+------+\n| c1   | c2   |\n+------+------+\n|    1 | aaa  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    2 | NULL |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n| NULL | ccc  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    4 | test |\n+------+------+\n1 row in set (0.01 sec)\n\nQuery OK, 0 rows affected (0.01 sec)\n\n```\ni FETCH \n\n## \n\nFETCH\nMySQL\n```sql\nDECLARE CONTINUE HANDLER FOR NOT FOUND ;  \n```\ncursor_demo\n```sql\nmysql> delimiter $\nmysql> CREATE PROCEDURE cursor_demo()\n    -> BEGIN\n    -> -- \n    -> DECLARE c1 INT;\n    -> DECLARE c2 VARCHAR(100);\n    -> DECLARE not_done INT DEFAULT 1;\n    ->\n    -> -- \n    -> DECLARE first_table_cursor CURSOR FOR select * from first_table;\n    ->\n    -> --  not_done  0\n    -> DECLARE CONTINUE HANDLER FOR NOT FOUND SET not_done = 0;\n    ->\n    -> -- \n    -> OPEN first_table_cursor;\n    ->\n    -> WHILE not_done = 1 DO\n    ->\n    -> FETCH first_table_cursor INTO c1 , c2;\n    -> SELECT c1,c2;\n    -> END WHILE;\n    -> CLOSE first_table_cursor;\n    -> END $\nQuery OK, 0 rows affected (0.00 sec)\n\nmysql>  CALL cursor_demo();\n+------+------+\n| c1   | c2   |\n+------+------+\n|    1 | aaa  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    2 | NULL |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n| NULL | ccc  |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    4 | test |\n+------+------+\n1 row in set (0.01 sec)\n\n+------+------+\n| c1   | c2   |\n+------+------+\n|    4 | test |\n+------+------+\n1 row in set (0.01 sec)\n\nQuery OK, 0 rows affected (0.01 sec)\n\n```\n`EXIT``CONTINUE`\n`CONTINUE`FETCH\n`EXIT`FETCH\n\n# \n``\n\n## \n\n```sql\nCREATE TRIGGER \n{BEFORE|AFTER}          \n{INSERT|DELETE|UPDATE}\nON \nFOR EACH ROW \nBEGIN\n    \nEND\n```\nMySQLINSERTDELETEUPDATE\n\n\nMySQLNEWOLD\n* INSERTNEWOLD\n* DELETEOLDNEW\n* UPDATENEWOLD\n\n\n```sql\nmysql> CREATE TRIGGER test_trigger\n    -> BEFORE INSERT ON first_table\n    -> FOR EACH ROW\n    -> BEGIN\n    -> IF NEW.first_column < 1 THEN\n    ->  SET NEW.first_column = 1;\n    -> ELSEIF NEW.first_column > 10 THEN\n    ->  SET NEW.first_column = 10;\n    -> END IF;\n    -> END $\nQuery OK, 0 rows affected (0.02 sec)\n\nmysql> select * from first_table;\n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n|            4 | test          |\n+--------------+---------------+\n4 rows in set (0.00 sec)\n\nmysql> INSERT INTO first_table(first_column,second_column) VALUES(5,'5'),(20,'20');\nQuery OK, 2 rows affected (0.01 sec)\nRecords: 2  Duplicates: 0  Warnings: 0\n\n\nmysql> select * from first_table;\n+--------------+---------------+\n| first_column | second_column |\n+--------------+---------------+\n|            1 | aaa           |\n|            2 | NULL          |\n|         NULL | ccc           |\n|            4 | test          |\n|            5 | 5             |\n|           10 | 20            |\n+--------------+---------------+\n6 rows in set (0.00 sec)\n```\n(20,'20')(10,'20')\n\n## \n\n```sql\n\nSHOW TRIGGERS;\n\n\nSHOW CREATE TRIGGER ;\n```\n\n## \n```sql\nDROP TRIGGER ;\n```\n\n## \n1. \n2. 6\n    * BEFORE INSERT\n    * BEFORE DELETE\n    * BEFORE UPDATE\n    * AFTER INSERT\n    * AFTER DELETE\n    * AFTER UPDATE\n3. NEWOLD\n4. `BEFORE``ERROR``ERROR``AFTER`\n\n# \n\n,\n\n## \n```sql\nCREATE EVENT \nON SCHEDULE\n{AT  | EVERY  [STARTS datetime][END datetime]}\nDO\nBEGIN\n    \nEND\n```\n\n\n1. \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> AT '2019-09-10 11:30:30'\n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> AT DATE_ADD(NOW(), INTERVAL 2 DAY)\n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    DATE_ADD(NOW(), INTERVAL 2 DAY)\n\n2. \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> EVERY 1 HOUR \n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    \n    ```sql\n    mysql> CREATE EVENT insert_first_table\n        -> ON SCHEDULE\n        -> EVERY 1 HOUR STARTS '2019-09-10 11:30:30' ENDS '2019-09-12 11:30:30'\n        -> DO\n        -> BEGIN\n        -> INSERT INTO first_table(first_column,second_column) VALUES(6,'6');\n        -> END $\n    ```\n    MySQL\n\n## \n```sql\n\nSHOW EVENTS;\n\n:\nSHOW CREATE EVENT ;\n```\n\n## \n```sql\nDROP EVENT ;\n```\n\n## \nMySQL\n```sql\nevent_scheduler = ON\n```\n`event_scheduler`MySQL\n```sql\nmysql> SET GLOBAL event_scheduler = ON;\nQuery OK, 0 rows affected (0.00 sec)\n```\n\n\n\n# \nMySql\n```sql\nERROR 1418 (HY000): This function has none of DETERMINISTIC, NO SQL, or READS SQL DATA in its declaration and binary logging is enabled (you *might* want to use the less safe log_bin_trust_function_creators variable)\n```\n\n```sql\nmysql> set global log_bin_trust_function_creators=1;\n```\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","slug":"Mysql-storage","published":1,"updated":"2019-09-03T08:55:44.349Z","layout":"post","photos":[],"link":"","_id":"ck4859yd3004vt0fyo8ktt58x","content":"<p>MySQL<code></code><code></code><code></code><code></code><code></code><code></code><code></code></p>\n<a id=\"more\"></a>\n<p><img src=\"/2019/08/28/Mysql-storage/640.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySQL<code>@</code>MySQL<font color=\"red\">a</font></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @a = 1;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"Orange\">SELECT</font>@</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT @a;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @a   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|    1 |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"red\">a</font></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @a = '';</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT @a;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @a   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|    |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @b = @a;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT @b;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|    |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"red\"></font></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @a = (SELECT first_column FROM first_table LIMIT 1);</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT first_column FROM first_table LIMIT 1 INTO @b;</span><br><span class=\"line\">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT @a, @b;</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| @a   | @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 |    1 |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>INTO</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT first_column, second_column FROM first_table LIMIT 1 INTO @a, @b;</span><br><span class=\"line\">Query OK, 1 row affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT @a, @b;                                                           </span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| @a   | @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 | aaa  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySQLMySQL<code>;</code><code>\\g</code><code>\\G</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT first_column FROM first_table ;SELECT second_column FROM first_table;</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| first_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|            1 |</span><br><span class=\"line\">|            2 |</span><br><span class=\"line\">|         NULL |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| second_column |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| aaa           |</span><br><span class=\"line\">| <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">| ccc           |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\"><span class=\"number\">3</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>delimiter</code>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; SELECT first_column FROM first_table ;</span><br><span class=\"line\">    -&gt; SELECT second_column FROM first_table;</span><br><span class=\"line\">    -&gt; $</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| first_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|            1 |</span><br><span class=\"line\">|            2 |</span><br><span class=\"line\">|         NULL |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| second_column |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| aaa           |</span><br><span class=\"line\">| <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">| ccc           |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\"><span class=\"number\">3</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>delimiter $</code>MySQL<code>$</code>,MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter 666</span><br><span class=\"line\">mysql&gt; SELECT first_column FROM first_table;</span><br><span class=\"line\">    -&gt; SELECT second_column FROM first_table;</span><br><span class=\"line\">    -&gt; 666</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| first_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|            1 |</span><br><span class=\"line\">|            2 |</span><br><span class=\"line\">|         NULL |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| second_column |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| aaa           |</span><br><span class=\"line\">| <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">| ccc           |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\"><span class=\"number\">3</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code></code><code></code><br>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">FUNCTION</span> ([])</span><br><span class=\"line\"><span class=\"keyword\">RETURNS</span> </span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION second_column(a INT)</span><br><span class=\"line\">    -&gt; RETURNS VARCHAR(100)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; RETURN (SELECT second_column FROM first_table WHERE first_column = a);</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>()</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT second_column(1);</span><br><span class=\"line\">+<span class=\"comment\">------------------+</span></span><br><span class=\"line\">| second_column(1) |</span><br><span class=\"line\">+<span class=\"comment\">------------------+</span></span><br><span class=\"line\">| aaa              |</span><br><span class=\"line\">+<span class=\"comment\">------------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">FUNCTION</span> <span class=\"keyword\">STATUS</span> [<span class=\"keyword\">LIKE</span> ]</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">FUNCTION</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">FUNCTION</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>@</code>,</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DECLARE</span>   [<span class=\"keyword\">DEFAULT</span> ];   </span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION var_demo(a INT)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE b INT;</span><br><span class=\"line\">    -&gt; SET b = 5;</span><br><span class=\"line\">    -&gt; RETURN b+a;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT var_demo(2);</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">| var_demo(2) |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">|           7 |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>NULL<code>DEFAULT</code>.</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION var_default_demo()</span><br><span class=\"line\">-&gt; RETURNS INT</span><br><span class=\"line\">-&gt; BEGIN</span><br><span class=\"line\">-&gt;     DECLARE c INT DEFAULT 1;</span><br><span class=\"line\">-&gt;     RETURN c;</span><br><span class=\"line\">-&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter ;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT var_default_demo();</span><br><span class=\"line\">+<span class=\"comment\">--------------------+</span></span><br><span class=\"line\">| var_default_demo() |</span><br><span class=\"line\">+<span class=\"comment\">--------------------+</span></span><br><span class=\"line\">|                  1 |</span><br><span class=\"line\">+<span class=\"comment\">--------------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>second_column</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE FUNCTION second_column(a INT)</span><br><span class=\"line\">    -&gt; RETURNS VARCHAR(100)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; RETURN (SELECT second_column FROM first_table WHERE first_column = a);</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IF  THEN </span><br><span class=\"line\">    </span><br><span class=\"line\">[ELSEIF  THEN</span><br><span class=\"line\">    ]</span><br><span class=\"line\">[ELSE </span><br><span class=\"line\">    ]    </span><br><span class=\"line\"><span class=\"keyword\">END</span> <span class=\"keyword\">IF</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION condition_demo(i INT)</span><br><span class=\"line\">    -&gt; RETURNS VARCHAR(10)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result VARCHAR(10);</span><br><span class=\"line\">    -&gt; IF i = 1 THEN</span><br><span class=\"line\">    -&gt; SET result = '1';</span><br><span class=\"line\">    -&gt; ELSEIF i = 2 THEN</span><br><span class=\"line\">    -&gt;  SET result = '2';</span><br><span class=\"line\">    -&gt; ELSEIF i = 3 THEN</span><br><span class=\"line\">    -&gt; SET result = '3';</span><br><span class=\"line\">    -&gt; ELSE</span><br><span class=\"line\">    -&gt; SET result = '';</span><br><span class=\"line\">    -&gt; END IF;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT condition_demo(2);</span><br><span class=\"line\">+<span class=\"comment\">-------------------+</span></span><br><span class=\"line\">| condition_demo(2) |</span><br><span class=\"line\">+<span class=\"comment\">-------------------+</span></span><br><span class=\"line\">| 2           |</span><br><span class=\"line\">+<span class=\"comment\">-------------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>while</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">WHILE  <span class=\"keyword\">DO</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span> <span class=\"keyword\">WHILE</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION sum_all(n INT UNSIGNED)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result INT DEFAULT 0;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 1;</span><br><span class=\"line\">    -&gt; WHILE i &lt;= n DO</span><br><span class=\"line\">    -&gt; SET result = result + i;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; END WHILE;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select sum_all(10);</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">| sum_all(10) |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">|          55 |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>REPEAT</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">REPEAT</span><br><span class=\"line\">    </span><br><span class=\"line\">UNTIL  <span class=\"keyword\">END</span> <span class=\"keyword\">REPEAT</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE FUNCTION sum_repeat(n INT UNSIGNED)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result INT DEFAULT 0;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 1;</span><br><span class=\"line\">    -&gt; REPEAT</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; SET result = result + i;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; UNTIL i &gt; n END REPEAT;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.02 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select sum_repeat(5);</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| sum_repeat(5) |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">|            15 |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>LOOP</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:LOOP</span><br><span class=\"line\">    </span><br><span class=\"line\">    LEAVE ;</span><br><span class=\"line\"><span class=\"keyword\">END</span> <span class=\"keyword\">LOOP</span> ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE FUNCTION sum_loop(n INT UNSIGNED)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result INT DEFAULT 0;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 1;</span><br><span class=\"line\">    -&gt; LOOP_NAME:LOOP -- </span><br><span class=\"line\">    -&gt; IF i &gt; n THEN</span><br><span class=\"line\">    -&gt; LEAVE LOOP_NAME;</span><br><span class=\"line\">    -&gt; END IF;</span><br><span class=\"line\">    -&gt; SET result = result + i;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; END LOOP LOOP_NAME;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">    </span><br><span class=\"line\">mysql&gt; select sum_loop(10);</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| sum_loop(10) |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|           55 |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">PROCEDURE</span> ([])</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE insert_first_table(c1 INT,c2 VARCHAR(100))</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SELECT * FROM first_table;</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(c1,c2);</span><br><span class=\"line\">    -&gt; SELECT * FROM first_table;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.02 sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><br>CALL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CALL</span> ([]);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CALL insert_first_table(4,'test');</span><br><span class=\"line\"> </span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            1 | aaa           |</span><br><span class=\"line\">|            2 | NULL          |</span><br><span class=\"line\">|         NULL | ccc           |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            <span class=\"number\">1</span> | aaa           |</span><br><span class=\"line\">|            <span class=\"number\">2</span> | <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">|         <span class=\"literal\">NULL</span> | ccc           |</span><br><span class=\"line\">|            <span class=\"number\">4</span> | <span class=\"keyword\">test</span>          |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\"><span class=\"number\">4</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">PROCEDURE</span> <span class=\"keyword\">STATUS</span> [<span class=\"keyword\">LIKE</span> ]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">PROCEDURE</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">PROCEDURE</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<tr>\n    <th></th>\n    <th></th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\">IN</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">OUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">INOUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\">INOUT</td>\n</tr>\n</table>  \n\n<h3 id=\"IN\"><a href=\"#IN\" class=\"headerlink\" title=\"IN\"></a>IN</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE test_in(IN num INT)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SELECT num;</span><br><span class=\"line\">    -&gt; SET num = 666;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SET @a = 111;</span><br><span class=\"line\"></span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL test_in(@a);</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| num  |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|  111 |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>IN<br>IN</p>\n<h3 id=\"OUT\"><a href=\"#OUT\" class=\"headerlink\" title=\"OUT\"></a>OUT</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE test_out(OUT num INT)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SELECT num;</span><br><span class=\"line\">    -&gt; SET num = 666;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL test_out(@a);</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| num  |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| NULL |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; <span class=\"keyword\">SELECT</span> @a;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @a   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|  666 |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>OUT,</p>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE data_out(OUT a INT,OUT b INT)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SET a = 100;</span><br><span class=\"line\">    -&gt; SET b = 200;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL data_out(@a,@b);</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select @a,@b;</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| @a   | @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|  100 |  200 |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"INOUT\"><a href=\"#INOUT\" class=\"headerlink\" title=\"INOUT\"></a>INOUT</h3><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>RETURNSRETURN</p>\n</li>\n<li><p>ININOUTINOUT</p>\n</li>\n<li><p>OUT</p>\n</li>\n<li><p></p>\n</li>\n<li><p>CALL</p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Cursor<br>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DECLARE</span>  <span class=\"keyword\">CURSOR</span> <span class=\"keyword\">FOR</span> ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE cursor_demo()</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE first_table_cursor CURSOR FOR select * from first_table;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">OPEN ;</span><br><span class=\"line\"></span><br><span class=\"line\">CLOSE ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FETCH  INTO 1, 2, ... n</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE cursor_demo()</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE c1 INT;</span><br><span class=\"line\">    -&gt; DECLARE c2 VARCHAR(100);</span><br><span class=\"line\">    -&gt; DECLARE record_count INT;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 0;</span><br><span class=\"line\">    -&gt;  -- </span><br><span class=\"line\">    -&gt; DECLARE first_table_cursor CURSOR FOR select * from first_table;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; SELECT COUNT(*) FROM first_table INTO record_count;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; OPEN first_table_cursor;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; WHILE i &lt; record_count DO</span><br><span class=\"line\">    -&gt; FETCH first_table_cursor INTO c1 , c2;</span><br><span class=\"line\">    -&gt; SELECT c1,c2;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; END WHILE;</span><br><span class=\"line\">    -&gt; CLOSE first_table_cursor;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL cursor_demo();</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 | aaa  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">2</span> | <span class=\"literal\">NULL</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| <span class=\"literal\">NULL</span> | ccc  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">4</span> | <span class=\"keyword\">test</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.01</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>i FETCH </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>FETCH<br>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DECLARE</span> CONTINUE <span class=\"keyword\">HANDLER</span> <span class=\"keyword\">FOR</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">FOUND</span> ;</span><br></pre></td></tr></table></figure>\n\n<p>cursor_demo</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE PROCEDURE cursor_demo()</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; DECLARE c1 INT;</span><br><span class=\"line\">    -&gt; DECLARE c2 VARCHAR(100);</span><br><span class=\"line\">    -&gt; DECLARE not_done INT DEFAULT 1;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; DECLARE first_table_cursor CURSOR FOR select * from first_table;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; --  not_done  0</span><br><span class=\"line\">    -&gt; DECLARE CONTINUE HANDLER FOR NOT FOUND SET not_done = 0;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; OPEN first_table_cursor;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; WHILE not_done = 1 DO</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; FETCH first_table_cursor INTO c1 , c2;</span><br><span class=\"line\">    -&gt; SELECT c1,c2;</span><br><span class=\"line\">    -&gt; END WHILE;</span><br><span class=\"line\">    -&gt; CLOSE first_table_cursor;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt;  CALL cursor_demo();</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 | aaa  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">2</span> | <span class=\"literal\">NULL</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| <span class=\"literal\">NULL</span> | ccc  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">4</span> | <span class=\"keyword\">test</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">4</span> | <span class=\"keyword\">test</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.01</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>EXIT</code><code>CONTINUE</code><br><code>CONTINUE</code>FETCH<br><code>EXIT</code>FETCH</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code></code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> </span><br><span class=\"line\">&#123;<span class=\"keyword\">BEFORE</span>|<span class=\"keyword\">AFTER</span>&#125;          </span><br><span class=\"line\">&#123;<span class=\"keyword\">INSERT</span>|<span class=\"keyword\">DELETE</span>|<span class=\"keyword\">UPDATE</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">ON</span> </span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"keyword\">ROW</span> </span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p>MySQLINSERTDELETEUPDATE</p>\n<p><br>MySQLNEWOLD</p>\n<ul>\n<li>INSERTNEWOLD</li>\n<li>DELETEOLDNEW</li>\n<li>UPDATENEWOLD</li>\n</ul>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE TRIGGER test_trigger</span><br><span class=\"line\">    -&gt; BEFORE INSERT ON first_table</span><br><span class=\"line\">    -&gt; FOR EACH ROW</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; IF NEW.first_column &lt; 1 THEN</span><br><span class=\"line\">    -&gt;  SET NEW.first_column = 1;</span><br><span class=\"line\">    -&gt; ELSEIF NEW.first_column &gt; 10 THEN</span><br><span class=\"line\">    -&gt;  SET NEW.first_column = 10;</span><br><span class=\"line\">    -&gt; END IF;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.02 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select * from first_table;</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            1 | aaa           |</span><br><span class=\"line\">|            2 | NULL          |</span><br><span class=\"line\">|         NULL | ccc           |</span><br><span class=\"line\">|            4 | test          |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">4 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> first_table(first_column,second_column) <span class=\"keyword\">VALUES</span>(<span class=\"number\">5</span>,<span class=\"string\">'5'</span>),(<span class=\"number\">20</span>,<span class=\"string\">'20'</span>);</span><br><span class=\"line\">Query OK, 2 rows affected (0.01 sec)</span><br><span class=\"line\">Records: 2  Duplicates: 0  Warnings: 0</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select * from first_table;</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            1 | aaa           |</span><br><span class=\"line\">|            2 | NULL          |</span><br><span class=\"line\">|         NULL | ccc           |</span><br><span class=\"line\">|            4 | test          |</span><br><span class=\"line\">|            5 | 5             |</span><br><span class=\"line\">|           10 | 20            |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">6 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>(20,20)(10,20)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">TRIGGERS</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li>6<ul>\n<li>BEFORE INSERT</li>\n<li>BEFORE DELETE</li>\n<li>BEFORE UPDATE</li>\n<li>AFTER INSERT</li>\n<li>AFTER DELETE</li>\n<li>AFTER UPDATE</li>\n</ul>\n</li>\n<li>NEWOLD</li>\n<li><code>BEFORE</code><code>ERROR</code><code>ERROR</code><code>AFTER</code></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">EVENT</span> </span><br><span class=\"line\"><span class=\"keyword\">ON</span> SCHEDULE</span><br><span class=\"line\">&#123;<span class=\"keyword\">AT</span>  | EVERY  [STARTS datetime][<span class=\"keyword\">END</span> datetime]&#125;</span><br><span class=\"line\"><span class=\"keyword\">DO</span></span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li><p></p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; AT '2019-09-10 11:30:30'</span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; AT DATE_ADD(NOW(), INTERVAL 2 DAY)</span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> DATE_ADD(NOW(), INTERVAL 2 DAY)</p>\n</li>\n<li><p></p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; EVERY 1 HOUR </span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; EVERY 1 HOUR STARTS '2019-09-10 11:30:30' ENDS '2019-09-12 11:30:30'</span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> MySQL</p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">EVENTS</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">:</span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">EVENT</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">EVENT</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">event_scheduler = ON</span><br></pre></td></tr></table></figure>\n\n<p><code>event_scheduler</code>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET GLOBAL event_scheduler = ON;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySql</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ERROR 1418 (HY000): This function has none of DETERMINISTIC, NO SQL, or READS SQL DATA in its declaration and binary logging is enabled (you *might* want to use the less safe log_bin_trust_function_creators variable)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; set global log_bin_trust_function_creators=1;</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"<p>MySQL<code></code><code></code><code></code><code></code><code></code><code></code><code></code></p>","more":"<p><img src=\"/2019/08/28/Mysql-storage/640.png\" alt=\"\"></p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySQL<code>@</code>MySQL<font color=\"red\">a</font></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @a = 1;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"Orange\">SELECT</font>@</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT @a;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @a   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|    1 |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"red\">a</font></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @a = '';</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT @a;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @a   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|    |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @b = @a;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT @b;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|    |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><font color=\"red\"></font></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET @a = (SELECT first_column FROM first_table LIMIT 1);</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT first_column FROM first_table LIMIT 1 INTO @b;</span><br><span class=\"line\">Query OK, 1 row affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT @a, @b;</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| @a   | @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 |    1 |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>INTO</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT first_column, second_column FROM first_table LIMIT 1 INTO @a, @b;</span><br><span class=\"line\">Query OK, 1 row affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT @a, @b;                                                           </span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| @a   | @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 | aaa  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySQLMySQL<code>;</code><code>\\g</code><code>\\G</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT first_column FROM first_table ;SELECT second_column FROM first_table;</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| first_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|            1 |</span><br><span class=\"line\">|            2 |</span><br><span class=\"line\">|         NULL |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| second_column |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| aaa           |</span><br><span class=\"line\">| <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">| ccc           |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\"><span class=\"number\">3</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>delimiter</code>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; SELECT first_column FROM first_table ;</span><br><span class=\"line\">    -&gt; SELECT second_column FROM first_table;</span><br><span class=\"line\">    -&gt; $</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| first_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|            1 |</span><br><span class=\"line\">|            2 |</span><br><span class=\"line\">|         NULL |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| second_column |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| aaa           |</span><br><span class=\"line\">| <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">| ccc           |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\"><span class=\"number\">3</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>delimiter $</code>MySQL<code>$</code>,MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter 666</span><br><span class=\"line\">mysql&gt; SELECT first_column FROM first_table;</span><br><span class=\"line\">    -&gt; SELECT second_column FROM first_table;</span><br><span class=\"line\">    -&gt; 666</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| first_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|            1 |</span><br><span class=\"line\">|            2 |</span><br><span class=\"line\">|         NULL |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| second_column |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| aaa           |</span><br><span class=\"line\">| <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">| ccc           |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\"><span class=\"number\">3</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code></code><code></code><br>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">FUNCTION</span> ([])</span><br><span class=\"line\"><span class=\"keyword\">RETURNS</span> </span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION second_column(a INT)</span><br><span class=\"line\">    -&gt; RETURNS VARCHAR(100)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; RETURN (SELECT second_column FROM first_table WHERE first_column = a);</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>()</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT second_column(1);</span><br><span class=\"line\">+<span class=\"comment\">------------------+</span></span><br><span class=\"line\">| second_column(1) |</span><br><span class=\"line\">+<span class=\"comment\">------------------+</span></span><br><span class=\"line\">| aaa              |</span><br><span class=\"line\">+<span class=\"comment\">------------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">FUNCTION</span> <span class=\"keyword\">STATUS</span> [<span class=\"keyword\">LIKE</span> ]</span><br></pre></td></tr></table></figure>\n\n<p>:</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">FUNCTION</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">FUNCTION</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>@</code>,</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DECLARE</span>   [<span class=\"keyword\">DEFAULT</span> ];   </span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION var_demo(a INT)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE b INT;</span><br><span class=\"line\">    -&gt; SET b = 5;</span><br><span class=\"line\">    -&gt; RETURN b+a;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SELECT var_demo(2);</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">| var_demo(2) |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">|           7 |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>NULL<code>DEFAULT</code>.</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION var_default_demo()</span><br><span class=\"line\">-&gt; RETURNS INT</span><br><span class=\"line\">-&gt; BEGIN</span><br><span class=\"line\">-&gt;     DECLARE c INT DEFAULT 1;</span><br><span class=\"line\">-&gt;     RETURN c;</span><br><span class=\"line\">-&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter ;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT var_default_demo();</span><br><span class=\"line\">+<span class=\"comment\">--------------------+</span></span><br><span class=\"line\">| var_default_demo() |</span><br><span class=\"line\">+<span class=\"comment\">--------------------+</span></span><br><span class=\"line\">|                  1 |</span><br><span class=\"line\">+<span class=\"comment\">--------------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>second_column</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE FUNCTION second_column(a INT)</span><br><span class=\"line\">    -&gt; RETURNS VARCHAR(100)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; RETURN (SELECT second_column FROM first_table WHERE first_column = a);</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IF  THEN </span><br><span class=\"line\">    </span><br><span class=\"line\">[ELSEIF  THEN</span><br><span class=\"line\">    ]</span><br><span class=\"line\">[ELSE </span><br><span class=\"line\">    ]    </span><br><span class=\"line\"><span class=\"keyword\">END</span> <span class=\"keyword\">IF</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION condition_demo(i INT)</span><br><span class=\"line\">    -&gt; RETURNS VARCHAR(10)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result VARCHAR(10);</span><br><span class=\"line\">    -&gt; IF i = 1 THEN</span><br><span class=\"line\">    -&gt; SET result = '1';</span><br><span class=\"line\">    -&gt; ELSEIF i = 2 THEN</span><br><span class=\"line\">    -&gt;  SET result = '2';</span><br><span class=\"line\">    -&gt; ELSEIF i = 3 THEN</span><br><span class=\"line\">    -&gt; SET result = '3';</span><br><span class=\"line\">    -&gt; ELSE</span><br><span class=\"line\">    -&gt; SET result = '';</span><br><span class=\"line\">    -&gt; END IF;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SELECT condition_demo(2);</span><br><span class=\"line\">+<span class=\"comment\">-------------------+</span></span><br><span class=\"line\">| condition_demo(2) |</span><br><span class=\"line\">+<span class=\"comment\">-------------------+</span></span><br><span class=\"line\">| 2           |</span><br><span class=\"line\">+<span class=\"comment\">-------------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><code>while</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">WHILE  <span class=\"keyword\">DO</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span> <span class=\"keyword\">WHILE</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE FUNCTION sum_all(n INT UNSIGNED)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result INT DEFAULT 0;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 1;</span><br><span class=\"line\">    -&gt; WHILE i &lt;= n DO</span><br><span class=\"line\">    -&gt; SET result = result + i;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; END WHILE;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; delimiter;</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select sum_all(10);</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">| sum_all(10) |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">|          55 |</span><br><span class=\"line\">+<span class=\"comment\">-------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>REPEAT</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">REPEAT</span><br><span class=\"line\">    </span><br><span class=\"line\">UNTIL  <span class=\"keyword\">END</span> <span class=\"keyword\">REPEAT</span>;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE FUNCTION sum_repeat(n INT UNSIGNED)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result INT DEFAULT 0;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 1;</span><br><span class=\"line\">    -&gt; REPEAT</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; SET result = result + i;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; UNTIL i &gt; n END REPEAT;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.02 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select sum_repeat(5);</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">| sum_repeat(5) |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">|            15 |</span><br><span class=\"line\">+<span class=\"comment\">---------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>LOOP</code></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">:LOOP</span><br><span class=\"line\">    </span><br><span class=\"line\">    LEAVE ;</span><br><span class=\"line\"><span class=\"keyword\">END</span> <span class=\"keyword\">LOOP</span> ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE FUNCTION sum_loop(n INT UNSIGNED)</span><br><span class=\"line\">    -&gt; RETURNS INT</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE result INT DEFAULT 0;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 1;</span><br><span class=\"line\">    -&gt; LOOP_NAME:LOOP -- </span><br><span class=\"line\">    -&gt; IF i &gt; n THEN</span><br><span class=\"line\">    -&gt; LEAVE LOOP_NAME;</span><br><span class=\"line\">    -&gt; END IF;</span><br><span class=\"line\">    -&gt; SET result = result + i;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; END LOOP LOOP_NAME;</span><br><span class=\"line\">    -&gt; RETURN result;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">    </span><br><span class=\"line\">mysql&gt; select sum_loop(10);</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">| sum_loop(10) |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">|           55 |</span><br><span class=\"line\">+<span class=\"comment\">--------------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">PROCEDURE</span> ([])</span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE insert_first_table(c1 INT,c2 VARCHAR(100))</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SELECT * FROM first_table;</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(c1,c2);</span><br><span class=\"line\">    -&gt; SELECT * FROM first_table;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.02 sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><br><br>CALL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CALL</span> ([]);</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CALL insert_first_table(4,'test');</span><br><span class=\"line\"> </span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            1 | aaa           |</span><br><span class=\"line\">|            2 | NULL          |</span><br><span class=\"line\">|         NULL | ccc           |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">3 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            <span class=\"number\">1</span> | aaa           |</span><br><span class=\"line\">|            <span class=\"number\">2</span> | <span class=\"literal\">NULL</span>          |</span><br><span class=\"line\">|         <span class=\"literal\">NULL</span> | ccc           |</span><br><span class=\"line\">|            <span class=\"number\">4</span> | <span class=\"keyword\">test</span>          |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\"><span class=\"number\">4</span> <span class=\"keyword\">rows</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">PROCEDURE</span> <span class=\"keyword\">STATUS</span> [<span class=\"keyword\">LIKE</span> ]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">PROCEDURE</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">PROCEDURE</span> </span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><table>\n<tr>\n    <th></th>\n    <th></th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\">IN</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">OUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\"></td>\n</tr>\n<tr>\n    <td style=\"text-align:center\">INOUT</td>\n    <td style=\"text-align:center\"></td>\n    <td colspan=\"3\">INOUT</td>\n</tr>\n</table>  \n\n<h3 id=\"IN\"><a href=\"#IN\" class=\"headerlink\" title=\"IN\"></a>IN</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE test_in(IN num INT)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SELECT num;</span><br><span class=\"line\">    -&gt; SET num = 666;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; SET @a = 111;</span><br><span class=\"line\"></span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL test_in(@a);</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| num  |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|  111 |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>IN<br>IN</p>\n<h3 id=\"OUT\"><a href=\"#OUT\" class=\"headerlink\" title=\"OUT\"></a>OUT</h3><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE test_out(OUT num INT)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SELECT num;</span><br><span class=\"line\">    -&gt; SET num = 666;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL test_out(@a);</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| num  |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| NULL |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; <span class=\"keyword\">SELECT</span> @a;</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">| @a   |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">|  666 |</span><br><span class=\"line\">+<span class=\"comment\">------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>OUT,</p>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE data_out(OUT a INT,OUT b INT)</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; SET a = 100;</span><br><span class=\"line\">    -&gt; SET b = 200;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL data_out(@a,@b);</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select @a,@b;</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| @a   | @b   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|  100 |  200 |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"INOUT\"><a href=\"#INOUT\" class=\"headerlink\" title=\"INOUT\"></a>INOUT</h3><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ul>\n<li><p>RETURNSRETURN</p>\n</li>\n<li><p>ININOUTINOUT</p>\n</li>\n<li><p>OUT</p>\n</li>\n<li><p></p>\n</li>\n<li><p>CALL</p>\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>Cursor<br>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DECLARE</span>  <span class=\"keyword\">CURSOR</span> <span class=\"keyword\">FOR</span> ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE cursor_demo()</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE first_table_cursor CURSOR FOR select * from first_table;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">OPEN ;</span><br><span class=\"line\"></span><br><span class=\"line\">CLOSE ;</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FETCH  INTO 1, 2, ... n</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE PROCEDURE cursor_demo()</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; DECLARE c1 INT;</span><br><span class=\"line\">    -&gt; DECLARE c2 VARCHAR(100);</span><br><span class=\"line\">    -&gt; DECLARE record_count INT;</span><br><span class=\"line\">    -&gt; DECLARE i INT DEFAULT 0;</span><br><span class=\"line\">    -&gt;  -- </span><br><span class=\"line\">    -&gt; DECLARE first_table_cursor CURSOR FOR select * from first_table;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; SELECT COUNT(*) FROM first_table INTO record_count;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; OPEN first_table_cursor;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; WHILE i &lt; record_count DO</span><br><span class=\"line\">    -&gt; FETCH first_table_cursor INTO c1 , c2;</span><br><span class=\"line\">    -&gt; SELECT c1,c2;</span><br><span class=\"line\">    -&gt; SET i = i + 1;</span><br><span class=\"line\">    -&gt; END WHILE;</span><br><span class=\"line\">    -&gt; CLOSE first_table_cursor;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.01 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; CALL cursor_demo();</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 | aaa  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">2</span> | <span class=\"literal\">NULL</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| <span class=\"literal\">NULL</span> | ccc  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">4</span> | <span class=\"keyword\">test</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.01</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>i FETCH </p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>FETCH<br>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DECLARE</span> CONTINUE <span class=\"keyword\">HANDLER</span> <span class=\"keyword\">FOR</span> <span class=\"keyword\">NOT</span> <span class=\"keyword\">FOUND</span> ;</span><br></pre></td></tr></table></figure>\n\n<p>cursor_demo</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; delimiter $</span><br><span class=\"line\">mysql&gt; CREATE PROCEDURE cursor_demo()</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; DECLARE c1 INT;</span><br><span class=\"line\">    -&gt; DECLARE c2 VARCHAR(100);</span><br><span class=\"line\">    -&gt; DECLARE not_done INT DEFAULT 1;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; DECLARE first_table_cursor CURSOR FOR select * from first_table;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; --  not_done  0</span><br><span class=\"line\">    -&gt; DECLARE CONTINUE HANDLER FOR NOT FOUND SET not_done = 0;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; -- </span><br><span class=\"line\">    -&gt; OPEN first_table_cursor;</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; WHILE not_done = 1 DO</span><br><span class=\"line\">    -&gt;</span><br><span class=\"line\">    -&gt; FETCH first_table_cursor INTO c1 , c2;</span><br><span class=\"line\">    -&gt; SELECT c1,c2;</span><br><span class=\"line\">    -&gt; END WHILE;</span><br><span class=\"line\">    -&gt; CLOSE first_table_cursor;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt;  CALL cursor_demo();</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    1 | aaa  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">1 row in <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">2</span> | <span class=\"literal\">NULL</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| <span class=\"literal\">NULL</span> | ccc  |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">4</span> | <span class=\"keyword\">test</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">| c1   | c2   |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\">|    <span class=\"number\">4</span> | <span class=\"keyword\">test</span> |</span><br><span class=\"line\">+<span class=\"comment\">------+------+</span></span><br><span class=\"line\"><span class=\"number\">1</span> <span class=\"keyword\">row</span> <span class=\"keyword\">in</span> <span class=\"keyword\">set</span> (<span class=\"number\">0.01</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">Query</span> OK, <span class=\"number\">0</span> <span class=\"keyword\">rows</span> affected (<span class=\"number\">0.01</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p><code>EXIT</code><code>CONTINUE</code><br><code>CONTINUE</code>FETCH<br><code>EXIT</code>FETCH</p>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><code></code></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> </span><br><span class=\"line\">&#123;<span class=\"keyword\">BEFORE</span>|<span class=\"keyword\">AFTER</span>&#125;          </span><br><span class=\"line\">&#123;<span class=\"keyword\">INSERT</span>|<span class=\"keyword\">DELETE</span>|<span class=\"keyword\">UPDATE</span>&#125;</span><br><span class=\"line\"><span class=\"keyword\">ON</span> </span><br><span class=\"line\"><span class=\"keyword\">FOR</span> <span class=\"keyword\">EACH</span> <span class=\"keyword\">ROW</span> </span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p>MySQLINSERTDELETEUPDATE</p>\n<p><br>MySQLNEWOLD</p>\n<ul>\n<li>INSERTNEWOLD</li>\n<li>DELETEOLDNEW</li>\n<li>UPDATENEWOLD</li>\n</ul>\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE TRIGGER test_trigger</span><br><span class=\"line\">    -&gt; BEFORE INSERT ON first_table</span><br><span class=\"line\">    -&gt; FOR EACH ROW</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; IF NEW.first_column &lt; 1 THEN</span><br><span class=\"line\">    -&gt;  SET NEW.first_column = 1;</span><br><span class=\"line\">    -&gt; ELSEIF NEW.first_column &gt; 10 THEN</span><br><span class=\"line\">    -&gt;  SET NEW.first_column = 10;</span><br><span class=\"line\">    -&gt; END IF;</span><br><span class=\"line\">    -&gt; END $</span><br><span class=\"line\">Query OK, 0 rows affected (0.02 sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select * from first_table;</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            1 | aaa           |</span><br><span class=\"line\">|            2 | NULL          |</span><br><span class=\"line\">|         NULL | ccc           |</span><br><span class=\"line\">|            4 | test          |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">4 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; <span class=\"keyword\">INSERT</span> <span class=\"keyword\">INTO</span> first_table(first_column,second_column) <span class=\"keyword\">VALUES</span>(<span class=\"number\">5</span>,<span class=\"string\">'5'</span>),(<span class=\"number\">20</span>,<span class=\"string\">'20'</span>);</span><br><span class=\"line\">Query OK, 2 rows affected (0.01 sec)</span><br><span class=\"line\">Records: 2  Duplicates: 0  Warnings: 0</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">mysql&gt; select * from first_table;</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">| first_column | second_column |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">|            1 | aaa           |</span><br><span class=\"line\">|            2 | NULL          |</span><br><span class=\"line\">|         NULL | ccc           |</span><br><span class=\"line\">|            4 | test          |</span><br><span class=\"line\">|            5 | 5             |</span><br><span class=\"line\">|           10 | 20            |</span><br><span class=\"line\">+<span class=\"comment\">--------------+---------------+</span></span><br><span class=\"line\">6 rows in <span class=\"keyword\">set</span> (<span class=\"number\">0.00</span> sec)</span><br></pre></td></tr></table></figure>\n\n<p>(20,20)(10,20)</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">TRIGGERS</span>;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">TRIGGER</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">TRIGGER</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li>6<ul>\n<li>BEFORE INSERT</li>\n<li>BEFORE DELETE</li>\n<li>BEFORE UPDATE</li>\n<li>AFTER INSERT</li>\n<li>AFTER DELETE</li>\n<li>AFTER UPDATE</li>\n</ul>\n</li>\n<li>NEWOLD</li>\n<li><code>BEFORE</code><code>ERROR</code><code>ERROR</code><code>AFTER</code></li>\n</ol>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>,</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE</span> <span class=\"keyword\">EVENT</span> </span><br><span class=\"line\"><span class=\"keyword\">ON</span> SCHEDULE</span><br><span class=\"line\">&#123;<span class=\"keyword\">AT</span>  | EVERY  [STARTS datetime][<span class=\"keyword\">END</span> datetime]&#125;</span><br><span class=\"line\"><span class=\"keyword\">DO</span></span><br><span class=\"line\"><span class=\"keyword\">BEGIN</span></span><br><span class=\"line\">    </span><br><span class=\"line\"><span class=\"keyword\">END</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<ol>\n<li><p></p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; AT '2019-09-10 11:30:30'</span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; AT DATE_ADD(NOW(), INTERVAL 2 DAY)</span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> DATE_ADD(NOW(), INTERVAL 2 DAY)</p>\n</li>\n<li><p></p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; EVERY 1 HOUR </span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n <figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; CREATE EVENT insert_first_table</span><br><span class=\"line\">    -&gt; ON SCHEDULE</span><br><span class=\"line\">    -&gt; EVERY 1 HOUR STARTS '2019-09-10 11:30:30' ENDS '2019-09-12 11:30:30'</span><br><span class=\"line\">    -&gt; DO</span><br><span class=\"line\">    -&gt; BEGIN</span><br><span class=\"line\">    -&gt; INSERT INTO first_table(first_column,second_column) VALUES(6,'6');</span><br><span class=\"line\">    -&gt; END $</span><br></pre></td></tr></table></figure>\n\n<p> MySQL</p>\n</li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">EVENTS</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">:</span><br><span class=\"line\"><span class=\"keyword\">SHOW</span> <span class=\"keyword\">CREATE</span> <span class=\"keyword\">EVENT</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">DROP</span> <span class=\"keyword\">EVENT</span> ;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">event_scheduler = ON</span><br></pre></td></tr></table></figure>\n\n<p><code>event_scheduler</code>MySQL</p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; SET GLOBAL event_scheduler = ON;</span><br><span class=\"line\">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></table></figure>\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p>MySql</p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ERROR 1418 (HY000): This function has none of DETERMINISTIC, NO SQL, or READS SQL DATA in its declaration and binary logging is enabled (you *might* want to use the less safe log_bin_trust_function_creators variable)</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mysql&gt; set global log_bin_trust_function_creators=1;</span><br></pre></td></tr></table></figure>"},{"title":"Mysql-InnoDB","author":"Guyuqing","copyright":true,"comments":0,"date":"2019-07-31T03:34:00.000Z","_content":"# \n\n* InnoDBInnobase OyMySQL\n* MySQL 5.5<font color=gray>InnoDBWindows</font>\n* ACIDMySQL<font color=gray>BDBMySQL</font>\n*  MVCC CPU\n<!-- more -->\n\n# \n![innoDB](Mysql02/innodb-Architecture.png)\nInnoDB\n\n## \n\nInnoDB , \n\n### Master Thread\n\nMaster ThreadUNDO\n\n### IO Thread\n\n InnoDB IO(Async IO)IO, IO Thread IO \n\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">4  io threadwritereadinsert bufferlog IO Thread.\n    <ul>\n        <li>LinuxIO Thread</li>\n        <li>Windows innodb_file_io_threads IO Thread</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">read  write IO thread  4 <br>\n    <ul>\n    <li> innodb_read_io_threads  innodb_write_io_threads </li>\n    </ul>\n    </td>\n</tr>\n</table>  \n\n### Purge Thread\n\nundo logPurge ThreadUNDO\n\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge  master thread </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge , master thread , cpu <br>\n    <ul>\n    <li>MySQL<code>[mysqld]</code>Purge Thread</li>\n    <li>innodb_purge_threads=1 </li>\n    <li>1.1 innodb_purge_threads 1InnoDB1</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.2</td>\n    <td colspan=\"4\">Purge Thread, UNDO</td>\n</tr>\n</table>                                  \n\n### Page Cleaner Thread\n\nPage Cleaner ThreadMaster Thread\nMaster Thread\n\n## \n\ninnoDB[(innodb buffer pool)](#)[(redo log buffer)](#)[(innodb additional men pool size)](#)\n\n### \n\n80\n\n     ![](Mysql02/read.png)\n\n     ![](Mysql02/write.png)\n\n\n{% note info %}\n\n323G\n`PAE`3264GB\n, 64 \n\n{% endnote %}\n\n||||\n|:---:|:---:|:---:|\n|innodb_buffer_pool_instances|InnoDB 1.0.x|1|\n \n#### \n \n* (index page)\n* (data page)\n* undo(undo Log Page)undo\n* [](#)insert buffer\n* adaptive hash index B+ Tree\n* InnoDBlock info\n* data dictionary\n    MySQL\n    InnoDBInnoDB\n\n \n#### \n![list](Mysql02/three-list2.png)\n 1. **Free list**\n    LRUFree list\n    Free listFreeLRU,\n\n 2. **LRU list** \n     **LRU**LRULRU16KB\n     **InnoDBLRU(midpoint insertion strategy)** `midpoint` \"\"\n     ![lru](Mysql02/innodb-buffer-pool-list.jpg)\n\n     <table>\n     <tr>\n         <th></th>\n         <th colspan=\"2\"></th>\n     </tr>\n     <tr>\n         <td style=\"text-align:center\"> innodb_old_blocks_pct </td>\n         <td colspan=\"2\">LRU old list <br>\n             373/8<br>\n             5 95\n         </td>\n     </tr>\n     <tr>\n         <td style=\"text-align:center\"> innodb_old_blocks_time </td>\n         <td colspan=\"2\">ms<br>\n            LRU<br>\n             1000 ms\n         </td>\n     </tr>\n     </table> \n     \n     \n     *  `midpoint`LRU list 5/8\n     * `midpoint`new sublistold sublist\n     *  InnoDB `midpoint`(old sublist)\n     * old sublist && old sublistinnodb_old_blocks_time`young`,(new sublist)\n     * LRUoldnew`page made young`innodb_old_blocks_timeoldnew`page not made young`\n     * new sublistnew sublistold listold list\n     \n {% note warning %}\n LRU\n SQL\n {% endnote %}  \n \n  3. **Flush list**               \n    LRUDirty Page\n    `CHECKPOINT`Flush list\n\n### \n   {% note info %}\n    **redo log**\n    buffer poolbuffer poolbuffer poolbuffer pooldirty page \n    DBIO\n    data pageIODBcrashDB\n    redo log  <br>\n    **undo log**\n    undo\n     id=1 Name='B' Name = 'B2' undoName='B'undo\n   {% endnote %}  \n\n![lru](Mysql02/redo-buffer.png)\n  \n  8M\n  * Master Thread\n  * \n  * 1/2\n  \n### \n   InnoDB\n\n# Checkpoint \n        \n{% note info %}    \n   **Checkpoint**\n   (event)(DBWR)                           \n   \n   **Checkpoint**\n   innoDB\n   1) \n   2) \n   3)             \n                                         \n   **Checkpoint **\n   1) \n   2) \n   3) \n{% endnote %} \n\nInnoDBLSNLog Sequence NumberLSNLSNCheckpointLSN\n\ninnodb  checkpoint\n1. **sharp checkpoint**`` innodb_fast_shudown=1\n2. **fuzzy checkpoint**``\n    - master thread checkpointmaster thread  10 \n         - flush list\n    - flush_lru_list checkpointInnoDBLRU100 lru list  checkpoint\n         - innodb 1.1.x,\n         - innodb 1.2.x page cleaner , **innodb_lru_scan_depth** lru1024\n    - async/sync flush checkpoint\n         * checkpoint age = redo_log_lsn - cp_lsn\n            =75% * total_redo_log_file_size\n            =90% * total_redo_log_file_size\n         * checkpoint age <  \n          \t\n         *   <=  checkpoint age <= \n          \t checkpoint async flush flush_list checkpoint age < \n         * checkpoint age > \n             checkpoint sync flush flush_list,  checkpoint age < \n    \n    - dirty page too much checkpointCheckpoint [innodb_max_dirty_pages_pct](#innodb_max_dirty_pages_pct) \n              \n<div style=\"text-align:center;color:#bfbfbf;font-size:16px;\">\n    <span>--------  --------</span>\n</div>\n                               \n# Master thread \n\n## InnoDB 1.0.x  Master thread\nMaster thread  loop \n*  loop\n*  backgroup loop\n*  flush loop\n*  suspend loop\n\n\n\n```java\nvoid master_thread()\n{\n\tgoto loop;\n\t//\n\tloop \n\tfor(int i = 0; i < 10; ++i){\n\t\tthread_sleep(1);\n\t\t//1. \n\t\tdo log buffer flush to disk;\n\t\t//2. IO5\n\t\tif(last_one_second_ios < 5)\n\t\t\tdo merge at most 5 insert buffer;\n\t\t//3.  100 \n\t\tif(buf_get_modified_ratio_pct > innodb_max_dirty_pages_pct)\n\t\t\tdo buffer pool flush 100 dirty page;\n\t\t//4. shutdown backgroup loop\n\t\tif(no user activity)\n\t\t\tgoto backgroud loop;\n\t}\n\t\n\t//1. 10IO200 100 \n\tif(last_ten_second_ios < 200)\n\t\tdo buffer pool flush 100 dirty page;\n\t//2.  5 \n\tdo merge at most 5 insert buffer;\n\t//3. \n\tdo log buffer flush to disk;\n\t//4.  undo  20  undo \n\tdo full purge;\n\t//5.  70% 100  10 \n\tif ( buf_get_modified_ratio_pct  70 % )\n\t\tdo buffer pool flush 100 dirty page\n\telse\n\t\tbuffer pool flush 10 dirty page\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tgoto loop\n\t//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tbackground loop :\n\t//1.  undo \n\tdo full purge\n\t//2.  20 \n\tdo merge 20 insert buffer\n\t//3.\n\tif not idle\t\n\t\tgoto loop\n\telse\n\t\tgoto flush loop\n\t\n\t//\n\tflush loop :\n\t//100\n\tdo buffer pool flush 100 dirty page\n\tif ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )\n\t\tgoto flush loop\n\t//\n\tgoto suspend loop\n\t\n\t//\n\tsuspend loop :\n\t//\n\tsuspend_thread()\n\twaiting event\n\tgoto loop;\n}\n\n```\n## InnoDB 1.2.x  Master thread\n1.  IO ,\n    *  [innodb_io_capacity](#innodb_io_capacity)  5%\n    *  [innodb_io_capacity](#innodb_io_capacity)\n2. \n    * 1.0.x[innodb_max_dirty_pages_pct](#innodb_max_dirty_pages_pct)100\n    * 1.0.x[innodb_adaptive_flushing](#innodb_adaptive_flushing)buf_flush_get_desired_flush_rate\n3. full purgeUndo[innodb_purge_batch_size](#innodb_purge_batch_size)\n\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_io_capacity\">innodb_io_capacity</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">IO,200</td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">90</td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0.x</td>\n    <td colspan=\"3\">75<br>IO</td>                       \n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_adaptive_flushing\">innodb_adaptive_flushing</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> ON</td>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_purge_batch_size\">innodb_purge_batch_size</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> undo ,, 20</td>\n</tr>\n</table>   \n\nMaster Thread\n\n```java\nvoid master_thread()\n{\n\tgoto loop;\n\t//\n\tloop \n\tfor(int i = 0; i < 10; ++i){\n\t\tthread_sleep(1);\n\t\t//1. \n\t\tdo log buffer flush to disk;\n\t\t//2. IO5%innodb_io_capacity\n\t\tif(last_one_second_ios < 5%innodb_io_capacity)\n\t\t\tdo merge 5%innodb_io_capacity insert buffer;\n\t\t//3.  100%innodb_io_capacity \n\t\tif(buf_get_modified_ratio_pct > innodb_max_dirty_pages_pct)\n\t\t\tdo buffer pool flush 100%innodb_io_capacity dirty page;\n\t\t//4. shutdown backgroup loop\n\t\tif(no user activity)\n\t\t\tgoto backgroud loop;\n\t}\n\t\n\t//1. 10IOinnodb_io_capacity innodb_io_capacity \n\tif(last_ten_second_ios < innodb_io_capacity)\n\t\tdo buffer pool flush 100%innodb_io_capacity dirty page;\n\t//2.  5%innodb_io_capacity \n\tdo merge at most 5%innodb_io_capacity insert buffer;\n\t//3. \n\tdo log buffer flush to disk;\n\t//4.  undo  5%innodb_io_capacity  undo \n\tdo full purge;\n\t//5.  70%  100%innodb_io_capacity \n\t//  10%innodb_io_capacity \n\tif ( buf_get_modified_ratio_pct  70 % )\n\t\tdo buffer pool flush 100%innodb_io_capacity dirty page\n\telse\n\t\tbuffer pool flush 10%innodb_io_capacity dirty page\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tgoto loop\n\t//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tbackground loop :\n\t//1.  undo \n\tdo full purge\n\t//2.  100%innodb_io_capacity \n\tdo merge 100%innodb_io_capacity insert buffer\n\t//3.\n\tif not idle\t\n\t\tgoto loop\n\telse\n\t\tgoto flush loop\n\t\n\t//\n\tflush loop :\n\t// 100%innodb_io_capacity \n\tdo buffer pool flush 100%innodb_io_capacity dirty page\n\tif ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )\n\t\tgoto flush loop\n\t//\n\tgoto suspend loop\n\t\n\t//\n\tsuspend loop :\n\t//\n\tsuspend_thread()\n\twaiting event\n\tgoto loop;\n}\n\n```\n## InnoDB 1.2.x  Master thread\n\nInnoDB 1.2.x  Master Thread \n```java\nif InnoDB is idle\n//10\nsrv_master_do_idle_tasks();\nelse\n//\nsrv_master_do_active_tasks();\n```\nMaster ThreadPage Cleaner ThreadMaster Thread\n\n\n# InnoDB \n\n*  insert buffer\n*  double write\n*  adaptive hash index\n*  io async io\n*  flush neighbor page\n\n## \n\n### \n\n\n\n### \n\nB+\n\n### \n![index](Mysql02/index-update.png)\ninsert delete update()\n\n![insertbufferindex](Mysql02/insert-buffer.png)\n\n### 1. insert buffer\nInsert Buffer\n![Insert Buffer](Mysql02/Insert-Buffer.svg)\n\n#### \n1secondary index\n22\n\n#### insert buffer\ninsert bufferB+B+\nB+Search key(space,marker,offset)\n* spaceididid\n* marker\n* offset\n\n(space,offset)search keyinsert buffer\ninsert bufferB+insert buffer\n`Insert buffer bitmap`\npage_sizeInsert buffer bitmap page\npage_size = 16384(16k)page_no01638432768pageInsert buffer bitmap pageBitmap pagepage_size  1page\nInsert buffer bitmap4bit\n\n#### merge insert buffer \n* buffer poolselectinsert buffermerge\n* Insert buffer bitmap page\n* Master Thread\n\n#### insert buffer \n* \n* \n* \n* redo log_redo log_\n\n#### \n1\n21/2\n\n### 2. change buffer\n\nInnoDB1.0.xChange BufferInsert Buffer\nInnoDBDMLInsertDeleteUpdate`(delete+insert)`\nInsert Buffer, Delete Buffer,Purge Buffer\n update \n\n* delete buffer\n* pruge buffer\n\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffering\">innodb_change_buffering</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">Bufferall<br>\n        <ul>\n        <li>inserts</li>\n        <li>deletes</li>\n        <li>purges</li>\n        <li>changes inserts  deletes</li>\n        <li>all</li>\n        <li>none</li>\n        </ul>\n    </td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffer_max_size\">innodb_change_buffer_max_size</span></td>\n    <td style=\"text-align:center\"> 1.2.x </td>\n    <td colspan=\"3\">change buffer<br>25,1/4<br>50</td>\n</tr>\n</table>  \n\n## \ninnodb(partial page write)\n\n### \n\nIO\n* IO16KMySQLoracle8K\n* IO4K1K\n* IO512\n\nIOpage\n![IO](Mysql02/IO.png)\n\ninnodb(partial page write)\n\n### Double write\n16K8K8K8K``\n\n** redo log **\nredodouble write\n\n{% note info %}   \n redo log  doublewrite \n redo log  512  IO \n{% endnote %}   \n\n### \n![](Mysql02/doublewrite.png)\ndoublewritedoublewrite buffer2MB(ibdata x)1282(extent)2M\n1. doublewrite buffer\n2. ()1MB\n3. doublewrite buffer()(doublewrite)\n\n double write \n1.  redo log \n2.  redo log \n3. \n\n## \n\n\n\nB+ 3-4  3-4 \n\n AHIadaptive hash index\n*  100 where x = ?\n*  N  N = 16\n\nInnoDB  AHI , 2  5 \n\n## IO\nIOIOIOIOIOAIO\nAIOIO MergeIO1IO, IOPS(Input/Output Per Second)\n\nspace, page_no)(8,6) (8,7) (8,8)16KBIO3IO(8,6)48KB\n\n## \n\nInnoDBextent\n\n<table>\n    <tr>\n        <th colspan=\"2\"></th>\n        <th></th>\n        <th colspan=\"3\"></th>\n    </tr>\n    <tr>\n        <th colspan=\"2\" style=\"text-align:center\" >innodb_flush_neighbors</th>\n        <td style=\"text-align:center\">1.2.x</td>\n        <td colspan=\"3\"></td>\n    </tr>\n</table> \n\n\n# \n* http://oohcode.com/2015/10/14/InnoDB-Key-Features/\n* https://chyroc.cn/posts/innodb-storage-engine-reading-1/\n* https://www.cnblogs.com/zhoujinyi/archive/2013/04/11/2988923.html\n* http://huzb.me/2019/01/14/%E6%8F%92%E5%85%A5%E7%BC%93%E5%86%B2%E3%80%81%E4%B8%A4%E6%AC%A1%E5%86%99%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/\n* https://blog.csdn.net/tanliqing2010/article/details/81509539\n* https://www.cnblogs.com/geaozhang/p/7341333.html\n* https://draveness.me/mysql-innodb\n* http://richfisher.me/blog/2017/12/18/innodb-notes/\n* https://www.docs4dev.com/docs/zh/mysql/5.7/reference/innodb-architecture.html#innodb%E6%9E%B6%E6%9E%84\n* MySQLInnoDB(2)","source":"_posts/Mysql02.md","raw":"title: Mysql-InnoDB\ntags:\n  - \n  - MySql\n  - InnoDB\ncategories:\n  - Mysql\nauthor: Guyuqing\ncopyright: true\ncomments: false\ndate: 2019-07-31 11:34:00\n---\n# \n\n* InnoDBInnobase OyMySQL\n* MySQL 5.5<font color=gray>InnoDBWindows</font>\n* ACIDMySQL<font color=gray>BDBMySQL</font>\n*  MVCC CPU\n<!-- more -->\n\n# \n![innoDB](Mysql02/innodb-Architecture.png)\nInnoDB\n\n## \n\nInnoDB , \n\n### Master Thread\n\nMaster ThreadUNDO\n\n### IO Thread\n\n InnoDB IO(Async IO)IO, IO Thread IO \n\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">4  io threadwritereadinsert bufferlog IO Thread.\n    <ul>\n        <li>LinuxIO Thread</li>\n        <li>Windows innodb_file_io_threads IO Thread</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">read  write IO thread  4 <br>\n    <ul>\n    <li> innodb_read_io_threads  innodb_write_io_threads </li>\n    </ul>\n    </td>\n</tr>\n</table>  \n\n### Purge Thread\n\nundo logPurge ThreadUNDO\n\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge  master thread </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge , master thread , cpu <br>\n    <ul>\n    <li>MySQL<code>[mysqld]</code>Purge Thread</li>\n    <li>innodb_purge_threads=1 </li>\n    <li>1.1 innodb_purge_threads 1InnoDB1</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.2</td>\n    <td colspan=\"4\">Purge Thread, UNDO</td>\n</tr>\n</table>                                  \n\n### Page Cleaner Thread\n\nPage Cleaner ThreadMaster Thread\nMaster Thread\n\n## \n\ninnoDB[(innodb buffer pool)](#)[(redo log buffer)](#)[(innodb additional men pool size)](#)\n\n### \n\n80\n\n     ![](Mysql02/read.png)\n\n     ![](Mysql02/write.png)\n\n\n{% note info %}\n\n323G\n`PAE`3264GB\n, 64 \n\n{% endnote %}\n\n||||\n|:---:|:---:|:---:|\n|innodb_buffer_pool_instances|InnoDB 1.0.x|1|\n \n#### \n \n* (index page)\n* (data page)\n* undo(undo Log Page)undo\n* [](#)insert buffer\n* adaptive hash index B+ Tree\n* InnoDBlock info\n* data dictionary\n    MySQL\n    InnoDBInnoDB\n\n \n#### \n![list](Mysql02/three-list2.png)\n 1. **Free list**\n    LRUFree list\n    Free listFreeLRU,\n\n 2. **LRU list** \n     **LRU**LRULRU16KB\n     **InnoDBLRU(midpoint insertion strategy)** `midpoint` \"\"\n     ![lru](Mysql02/innodb-buffer-pool-list.jpg)\n\n     <table>\n     <tr>\n         <th></th>\n         <th colspan=\"2\"></th>\n     </tr>\n     <tr>\n         <td style=\"text-align:center\"> innodb_old_blocks_pct </td>\n         <td colspan=\"2\">LRU old list <br>\n             373/8<br>\n             5 95\n         </td>\n     </tr>\n     <tr>\n         <td style=\"text-align:center\"> innodb_old_blocks_time </td>\n         <td colspan=\"2\">ms<br>\n            LRU<br>\n             1000 ms\n         </td>\n     </tr>\n     </table> \n     \n     \n     *  `midpoint`LRU list 5/8\n     * `midpoint`new sublistold sublist\n     *  InnoDB `midpoint`(old sublist)\n     * old sublist && old sublistinnodb_old_blocks_time`young`,(new sublist)\n     * LRUoldnew`page made young`innodb_old_blocks_timeoldnew`page not made young`\n     * new sublistnew sublistold listold list\n     \n {% note warning %}\n LRU\n SQL\n {% endnote %}  \n \n  3. **Flush list**               \n    LRUDirty Page\n    `CHECKPOINT`Flush list\n\n### \n   {% note info %}\n    **redo log**\n    buffer poolbuffer poolbuffer poolbuffer pooldirty page \n    DBIO\n    data pageIODBcrashDB\n    redo log  <br>\n    **undo log**\n    undo\n     id=1 Name='B' Name = 'B2' undoName='B'undo\n   {% endnote %}  \n\n![lru](Mysql02/redo-buffer.png)\n  \n  8M\n  * Master Thread\n  * \n  * 1/2\n  \n### \n   InnoDB\n\n# Checkpoint \n        \n{% note info %}    \n   **Checkpoint**\n   (event)(DBWR)                           \n   \n   **Checkpoint**\n   innoDB\n   1) \n   2) \n   3)             \n                                         \n   **Checkpoint **\n   1) \n   2) \n   3) \n{% endnote %} \n\nInnoDBLSNLog Sequence NumberLSNLSNCheckpointLSN\n\ninnodb  checkpoint\n1. **sharp checkpoint**`` innodb_fast_shudown=1\n2. **fuzzy checkpoint**``\n    - master thread checkpointmaster thread  10 \n         - flush list\n    - flush_lru_list checkpointInnoDBLRU100 lru list  checkpoint\n         - innodb 1.1.x,\n         - innodb 1.2.x page cleaner , **innodb_lru_scan_depth** lru1024\n    - async/sync flush checkpoint\n         * checkpoint age = redo_log_lsn - cp_lsn\n            =75% * total_redo_log_file_size\n            =90% * total_redo_log_file_size\n         * checkpoint age <  \n          \t\n         *   <=  checkpoint age <= \n          \t checkpoint async flush flush_list checkpoint age < \n         * checkpoint age > \n             checkpoint sync flush flush_list,  checkpoint age < \n    \n    - dirty page too much checkpointCheckpoint [innodb_max_dirty_pages_pct](#innodb_max_dirty_pages_pct) \n              \n<div style=\"text-align:center;color:#bfbfbf;font-size:16px;\">\n    <span>--------  --------</span>\n</div>\n                               \n# Master thread \n\n## InnoDB 1.0.x  Master thread\nMaster thread  loop \n*  loop\n*  backgroup loop\n*  flush loop\n*  suspend loop\n\n\n\n```java\nvoid master_thread()\n{\n\tgoto loop;\n\t//\n\tloop \n\tfor(int i = 0; i < 10; ++i){\n\t\tthread_sleep(1);\n\t\t//1. \n\t\tdo log buffer flush to disk;\n\t\t//2. IO5\n\t\tif(last_one_second_ios < 5)\n\t\t\tdo merge at most 5 insert buffer;\n\t\t//3.  100 \n\t\tif(buf_get_modified_ratio_pct > innodb_max_dirty_pages_pct)\n\t\t\tdo buffer pool flush 100 dirty page;\n\t\t//4. shutdown backgroup loop\n\t\tif(no user activity)\n\t\t\tgoto backgroud loop;\n\t}\n\t\n\t//1. 10IO200 100 \n\tif(last_ten_second_ios < 200)\n\t\tdo buffer pool flush 100 dirty page;\n\t//2.  5 \n\tdo merge at most 5 insert buffer;\n\t//3. \n\tdo log buffer flush to disk;\n\t//4.  undo  20  undo \n\tdo full purge;\n\t//5.  70% 100  10 \n\tif ( buf_get_modified_ratio_pct  70 % )\n\t\tdo buffer pool flush 100 dirty page\n\telse\n\t\tbuffer pool flush 10 dirty page\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tgoto loop\n\t//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tbackground loop :\n\t//1.  undo \n\tdo full purge\n\t//2.  20 \n\tdo merge 20 insert buffer\n\t//3.\n\tif not idle\t\n\t\tgoto loop\n\telse\n\t\tgoto flush loop\n\t\n\t//\n\tflush loop :\n\t//100\n\tdo buffer pool flush 100 dirty page\n\tif ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )\n\t\tgoto flush loop\n\t//\n\tgoto suspend loop\n\t\n\t//\n\tsuspend loop :\n\t//\n\tsuspend_thread()\n\twaiting event\n\tgoto loop;\n}\n\n```\n## InnoDB 1.2.x  Master thread\n1.  IO ,\n    *  [innodb_io_capacity](#innodb_io_capacity)  5%\n    *  [innodb_io_capacity](#innodb_io_capacity)\n2. \n    * 1.0.x[innodb_max_dirty_pages_pct](#innodb_max_dirty_pages_pct)100\n    * 1.0.x[innodb_adaptive_flushing](#innodb_adaptive_flushing)buf_flush_get_desired_flush_rate\n3. full purgeUndo[innodb_purge_batch_size](#innodb_purge_batch_size)\n\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_io_capacity\">innodb_io_capacity</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">IO,200</td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">90</td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0.x</td>\n    <td colspan=\"3\">75<br>IO</td>                       \n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_adaptive_flushing\">innodb_adaptive_flushing</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> ON</td>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_purge_batch_size\">innodb_purge_batch_size</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> undo ,, 20</td>\n</tr>\n</table>   \n\nMaster Thread\n\n```java\nvoid master_thread()\n{\n\tgoto loop;\n\t//\n\tloop \n\tfor(int i = 0; i < 10; ++i){\n\t\tthread_sleep(1);\n\t\t//1. \n\t\tdo log buffer flush to disk;\n\t\t//2. IO5%innodb_io_capacity\n\t\tif(last_one_second_ios < 5%innodb_io_capacity)\n\t\t\tdo merge 5%innodb_io_capacity insert buffer;\n\t\t//3.  100%innodb_io_capacity \n\t\tif(buf_get_modified_ratio_pct > innodb_max_dirty_pages_pct)\n\t\t\tdo buffer pool flush 100%innodb_io_capacity dirty page;\n\t\t//4. shutdown backgroup loop\n\t\tif(no user activity)\n\t\t\tgoto backgroud loop;\n\t}\n\t\n\t//1. 10IOinnodb_io_capacity innodb_io_capacity \n\tif(last_ten_second_ios < innodb_io_capacity)\n\t\tdo buffer pool flush 100%innodb_io_capacity dirty page;\n\t//2.  5%innodb_io_capacity \n\tdo merge at most 5%innodb_io_capacity insert buffer;\n\t//3. \n\tdo log buffer flush to disk;\n\t//4.  undo  5%innodb_io_capacity  undo \n\tdo full purge;\n\t//5.  70%  100%innodb_io_capacity \n\t//  10%innodb_io_capacity \n\tif ( buf_get_modified_ratio_pct  70 % )\n\t\tdo buffer pool flush 100%innodb_io_capacity dirty page\n\telse\n\t\tbuffer pool flush 10%innodb_io_capacity dirty page\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tgoto loop\n\t//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\n\tbackground loop :\n\t//1.  undo \n\tdo full purge\n\t//2.  100%innodb_io_capacity \n\tdo merge 100%innodb_io_capacity insert buffer\n\t//3.\n\tif not idle\t\n\t\tgoto loop\n\telse\n\t\tgoto flush loop\n\t\n\t//\n\tflush loop :\n\t// 100%innodb_io_capacity \n\tdo buffer pool flush 100%innodb_io_capacity dirty page\n\tif ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )\n\t\tgoto flush loop\n\t//\n\tgoto suspend loop\n\t\n\t//\n\tsuspend loop :\n\t//\n\tsuspend_thread()\n\twaiting event\n\tgoto loop;\n}\n\n```\n## InnoDB 1.2.x  Master thread\n\nInnoDB 1.2.x  Master Thread \n```java\nif InnoDB is idle\n//10\nsrv_master_do_idle_tasks();\nelse\n//\nsrv_master_do_active_tasks();\n```\nMaster ThreadPage Cleaner ThreadMaster Thread\n\n\n# InnoDB \n\n*  insert buffer\n*  double write\n*  adaptive hash index\n*  io async io\n*  flush neighbor page\n\n## \n\n### \n\n\n\n### \n\nB+\n\n### \n![index](Mysql02/index-update.png)\ninsert delete update()\n\n![insertbufferindex](Mysql02/insert-buffer.png)\n\n### 1. insert buffer\nInsert Buffer\n![Insert Buffer](Mysql02/Insert-Buffer.svg)\n\n#### \n1secondary index\n22\n\n#### insert buffer\ninsert bufferB+B+\nB+Search key(space,marker,offset)\n* spaceididid\n* marker\n* offset\n\n(space,offset)search keyinsert buffer\ninsert bufferB+insert buffer\n`Insert buffer bitmap`\npage_sizeInsert buffer bitmap page\npage_size = 16384(16k)page_no01638432768pageInsert buffer bitmap pageBitmap pagepage_size  1page\nInsert buffer bitmap4bit\n\n#### merge insert buffer \n* buffer poolselectinsert buffermerge\n* Insert buffer bitmap page\n* Master Thread\n\n#### insert buffer \n* \n* \n* \n* redo log_redo log_\n\n#### \n1\n21/2\n\n### 2. change buffer\n\nInnoDB1.0.xChange BufferInsert Buffer\nInnoDBDMLInsertDeleteUpdate`(delete+insert)`\nInsert Buffer, Delete Buffer,Purge Buffer\n update \n\n* delete buffer\n* pruge buffer\n\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffering\">innodb_change_buffering</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">Bufferall<br>\n        <ul>\n        <li>inserts</li>\n        <li>deletes</li>\n        <li>purges</li>\n        <li>changes inserts  deletes</li>\n        <li>all</li>\n        <li>none</li>\n        </ul>\n    </td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffer_max_size\">innodb_change_buffer_max_size</span></td>\n    <td style=\"text-align:center\"> 1.2.x </td>\n    <td colspan=\"3\">change buffer<br>25,1/4<br>50</td>\n</tr>\n</table>  \n\n## \ninnodb(partial page write)\n\n### \n\nIO\n* IO16KMySQLoracle8K\n* IO4K1K\n* IO512\n\nIOpage\n![IO](Mysql02/IO.png)\n\ninnodb(partial page write)\n\n### Double write\n16K8K8K8K``\n\n** redo log **\nredodouble write\n\n{% note info %}   \n redo log  doublewrite \n redo log  512  IO \n{% endnote %}   \n\n### \n![](Mysql02/doublewrite.png)\ndoublewritedoublewrite buffer2MB(ibdata x)1282(extent)2M\n1. doublewrite buffer\n2. ()1MB\n3. doublewrite buffer()(doublewrite)\n\n double write \n1.  redo log \n2.  redo log \n3. \n\n## \n\n\n\nB+ 3-4  3-4 \n\n AHIadaptive hash index\n*  100 where x = ?\n*  N  N = 16\n\nInnoDB  AHI , 2  5 \n\n## IO\nIOIOIOIOIOAIO\nAIOIO MergeIO1IO, IOPS(Input/Output Per Second)\n\nspace, page_no)(8,6) (8,7) (8,8)16KBIO3IO(8,6)48KB\n\n## \n\nInnoDBextent\n\n<table>\n    <tr>\n        <th colspan=\"2\"></th>\n        <th></th>\n        <th colspan=\"3\"></th>\n    </tr>\n    <tr>\n        <th colspan=\"2\" style=\"text-align:center\" >innodb_flush_neighbors</th>\n        <td style=\"text-align:center\">1.2.x</td>\n        <td colspan=\"3\"></td>\n    </tr>\n</table> \n\n\n# \n* http://oohcode.com/2015/10/14/InnoDB-Key-Features/\n* https://chyroc.cn/posts/innodb-storage-engine-reading-1/\n* https://www.cnblogs.com/zhoujinyi/archive/2013/04/11/2988923.html\n* http://huzb.me/2019/01/14/%E6%8F%92%E5%85%A5%E7%BC%93%E5%86%B2%E3%80%81%E4%B8%A4%E6%AC%A1%E5%86%99%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/\n* https://blog.csdn.net/tanliqing2010/article/details/81509539\n* https://www.cnblogs.com/geaozhang/p/7341333.html\n* https://draveness.me/mysql-innodb\n* http://richfisher.me/blog/2017/12/18/innodb-notes/\n* https://www.docs4dev.com/docs/zh/mysql/5.7/reference/innodb-architecture.html#innodb%E6%9E%B6%E6%9E%84\n* MySQLInnoDB(2)","slug":"Mysql02","published":1,"updated":"2019-08-27T13:08:43.968Z","layout":"post","photos":[],"link":"","_id":"ck4859yd5004wt0fyazelh5h3","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>InnoDBInnobase OyMySQL</li>\n<li>MySQL 5.5<font color=\"gray\">InnoDBWindows</font></li>\n<li>ACIDMySQL<font color=\"gray\">BDBMySQL</font></li>\n<li> MVCC CPU<a id=\"more\"></a>\n\n</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/2019/07/31/Mysql02/innodb-Architecture.png\" alt=\"innoDB\"><br>InnoDB</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InnoDB , </p>\n<h3 id=\"Master-Thread\"><a href=\"#Master-Thread\" class=\"headerlink\" title=\"Master Thread\"></a>Master Thread</h3><p>Master ThreadUNDO</p>\n<h3 id=\"IO-Thread\"><a href=\"#IO-Thread\" class=\"headerlink\" title=\"IO Thread\"></a>IO Thread</h3><p> InnoDB IO(Async IO)IO, IO Thread IO </p>\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">4  io threadwritereadinsert bufferlog IO Thread.\n    <ul>\n        <li>LinuxIO Thread</li>\n        <li>Windows innodb_file_io_threads IO Thread</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">read  write IO thread  4 <br>\n    <ul>\n    <li> innodb_read_io_threads  innodb_write_io_threads </li>\n    </ul>\n    </td>\n</tr>\n</table>  \n\n<h3 id=\"Purge-Thread\"><a href=\"#Purge-Thread\" class=\"headerlink\" title=\"Purge Thread\"></a>Purge Thread</h3><p>undo logPurge ThreadUNDO</p>\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge  master thread </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge , master thread , cpu <br>\n    <ul>\n    <li>MySQL<code>[mysqld]</code>Purge Thread</li>\n    <li>innodb_purge_threads=1 </li>\n    <li>1.1 innodb_purge_threads 1InnoDB1</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.2</td>\n    <td colspan=\"4\">Purge Thread, UNDO</td>\n</tr>\n</table>                                  \n\n<h3 id=\"Page-Cleaner-Thread\"><a href=\"#Page-Cleaner-Thread\" class=\"headerlink\" title=\"Page Cleaner Thread\"></a>Page Cleaner Thread</h3><p>Page Cleaner ThreadMaster Thread<br>Master Thread</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>innoDB<a href=\"#\">(innodb buffer pool)</a><a href=\"#\">(redo log buffer)</a><a href=\"#\">(innodb additional men pool size)</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>80<br><br>     <img src=\"/2019/07/31/Mysql02/read.png\" alt=\"\"><br><br>     <img src=\"/2019/07/31/Mysql02/write.png\" alt=\"\"></p>\n<p></p>\n<div class=\"note info\"><p>323G<br><code>PAE</code>3264GB<br>, 64 </p></div>\n\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">innodb_buffer_pool_instances</td>\n<td align=\"center\">InnoDB 1.0.x</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>(index page)</li>\n<li>(data page)</li>\n<li>undo(undo Log Page)undo</li>\n<li><a href=\"#\"></a>insert buffer</li>\n<li>adaptive hash index B+ Tree</li>\n<li>InnoDBlock info</li>\n<li>data dictionary<br>  MySQL<br>  InnoDBInnoDB</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/2019/07/31/Mysql02/three-list2.png\" alt=\"list\"></p>\n<ol>\n<li><p><strong>Free list</strong><br>LRUFree list<br>Free listFreeLRU,</p>\n</li>\n<li><p><strong>LRU list</strong><br> <strong>LRU</strong>LRULRU16KB<br> <strong>InnoDBLRU(midpoint insertion strategy)</strong> <code>midpoint</code> <br> <img src=\"/2019/07/31/Mysql02/innodb-buffer-pool-list.jpg\" alt=\"lru\"></p>\n <table>\n <tr>\n     <th></th>\n     <th colspan=\"2\"></th>\n </tr>\n <tr>\n     <td style=\"text-align:center\"> innodb_old_blocks_pct </td>\n     <td colspan=\"2\">LRU old list <br>\n         373/8<br>\n         5 95\n     </td>\n </tr>\n <tr>\n     <td style=\"text-align:center\"> innodb_old_blocks_time </td>\n     <td colspan=\"2\">ms<br>\n        LRU<br>\n         1000 ms\n     </td>\n </tr>\n </table> \n\n<p> </p>\n<ul>\n<li> <code>midpoint</code>LRU list 5/8</li>\n<li><code>midpoint</code>new sublistold sublist</li>\n<li> InnoDB <code>midpoint</code>(old sublist)</li>\n<li>old sublist &amp;&amp; old sublistinnodb_old_blocks_time<code>young</code>,(new sublist)</li>\n<li>LRUoldnew<code>page made young</code>innodb_old_blocks_timeoldnew<code>page not made young</code></li>\n<li>new sublistnew sublistold listold list</li>\n</ul>\n<div class=\"note warning\"><p>LRU<br>SQL</p></div>  \n\n<ol start=\"3\">\n<li><strong>Flush list</strong><br>LRUDirty Page<br><code>CHECKPOINT</code>Flush list</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>   <div class=\"note info\"><p><strong>redo log</strong><br>buffer poolbuffer poolbuffer poolbuffer pooldirty page <br>DBIO<br>data pageIODBcrashDB<br>redo log  <br><br><strong>undo log</strong><br>undo<br> id=1 Name=B Name = B2 undoName=Bundo</p></div>  \n\n<p><img src=\"/2019/07/31/Mysql02/redo-buffer.png\" alt=\"lru\"></p>\n<p>  8M</p>\n<ul>\n<li>Master Thread</li>\n<li></li>\n<li>1/2</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>   InnoDB</p>\n<h1 id=\"Checkpoint\"><a href=\"#Checkpoint\" class=\"headerlink\" title=\"Checkpoint\"></a>Checkpoint</h1><div class=\"note info\"><p><strong>Checkpoint</strong><br>(event)(DBWR)                           </p>\n<p><strong>Checkpoint</strong><br>innoDB<br>1) <br>2) <br>3)             </p>\n<p><strong>Checkpoint </strong><br>1) <br>2) <br>3) </p></div> \n\n<p>InnoDBLSNLog Sequence NumberLSNLSNCheckpointLSN</p>\n<p>innodb  checkpoint</p>\n<ol>\n<li><p><strong>sharp checkpoint</strong><code></code> innodb_fast_shudown=1</p>\n</li>\n<li><p><strong>fuzzy checkpoint</strong><code></code></p>\n<ul>\n<li><p>master thread checkpointmaster thread  10 </p>\n<ul>\n<li>flush list</li>\n</ul>\n</li>\n<li><p>flush_lru_list checkpointInnoDBLRU100 lru list  checkpoint</p>\n<ul>\n<li>innodb 1.1.x,</li>\n<li>innodb 1.2.x page cleaner , <strong>innodb_lru_scan_depth</strong> lru1024</li>\n</ul>\n</li>\n<li><p>async/sync flush checkpoint</p>\n<ul>\n<li>checkpoint age = redo_log_lsn - cp_lsn<br> =75% * total_redo_log_file_size<br> =90% * total_redo_log_file_size</li>\n<li>checkpoint age &lt; <br>   </li>\n<li>  &lt;=  checkpoint age &lt;= <br>    checkpoint async flush flush_list checkpoint age &lt; </li>\n<li>checkpoint age &gt; <br>  checkpoint sync flush flush_list,  checkpoint age &lt; </li>\n</ul>\n</li>\n<li><p>dirty page too much checkpointCheckpoint <a href=\"#innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</a> </p>\n</li>\n</ul>\n</li>\n</ol>\n<div style=\"text-align:center;color:#bfbfbf;font-size:16px;\">\n    <span>--------  --------</span>\n</div>\n\n<h1 id=\"Master-thread-\"><a href=\"#Master-thread-\" class=\"headerlink\" title=\"Master thread \"></a>Master thread </h1><h2 id=\"InnoDB-1-0-x--Master-thread\"><a href=\"#InnoDB-1-0-x--Master-thread\" class=\"headerlink\" title=\"InnoDB 1.0.x  Master thread\"></a>InnoDB 1.0.x  Master thread</h2><p>Master thread  loop </p>\n<ul>\n<li> loop</li>\n<li> backgroup loop</li>\n<li> flush loop</li>\n<li> suspend loop</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">master_thread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tloop </span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; ++i)&#123;</span><br><span class=\"line\">\t\tthread_sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"comment\">//1. </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t\t<span class=\"comment\">//2. IO5</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(last_one_second_ios &lt; <span class=\"number\">5</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> merge at most <span class=\"number\">5</span> insert buffer;</span><br><span class=\"line\">\t\t<span class=\"comment\">//3.  100 </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page;</span><br><span class=\"line\">\t\t<span class=\"comment\">//4. shutdown backgroup loop</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(no user activity)</span><br><span class=\"line\">\t\t\tgoto backgroud loop;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//1. 10IO200 100 </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(last_ten_second_ios &lt; <span class=\"number\">200</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page;</span><br><span class=\"line\">\t<span class=\"comment\">//2.  5 </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge at most <span class=\"number\">5</span> insert buffer;</span><br><span class=\"line\">\t<span class=\"comment\">//3. </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t<span class=\"comment\">//4.  undo  20  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge;</span><br><span class=\"line\">\t<span class=\"comment\">//5.  70% 100  10 </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  <span class=\"number\">70</span> % )</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tbuffer pool flush <span class=\"number\">10</span> dirty page</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span><br><span class=\"line\">\tgoto loop</span><br><span class=\"line\">\t<span class=\"comment\">//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span></span><br><span class=\"line\">\tbackground loop :</span><br><span class=\"line\">\t<span class=\"comment\">//1.  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge</span><br><span class=\"line\">\t<span class=\"comment\">//2.  20 </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge <span class=\"number\">20</span> insert buffer</span><br><span class=\"line\">\t<span class=\"comment\">//3.</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> not idle\t</span><br><span class=\"line\">\t\tgoto loop</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tflush loop :</span><br><span class=\"line\">\t<span class=\"comment\">//100</span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )</span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tgoto suspend loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend loop :</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend_thread()</span><br><span class=\"line\">\twaiting event</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"InnoDB-1-2-x--Master-thread\"><a href=\"#InnoDB-1-2-x--Master-thread\" class=\"headerlink\" title=\"InnoDB 1.2.x  Master thread\"></a>InnoDB 1.2.x  Master thread</h2><ol>\n<li> IO ,<ul>\n<li> <a href=\"#innodb_io_capacity\">innodb_io_capacity</a>  5%</li>\n<li> <a href=\"#innodb_io_capacity\">innodb_io_capacity</a></li>\n</ul>\n</li>\n<li><ul>\n<li>1.0.x<a href=\"#innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</a>100</li>\n<li>1.0.x<a href=\"#innodb_adaptive_flushing\">innodb_adaptive_flushing</a>buf_flush_get_desired_flush_rate</li>\n</ul>\n</li>\n<li>full purgeUndo<a href=\"#innodb_purge_batch_size\">innodb_purge_batch_size</a></li>\n</ol>\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_io_capacity\">innodb_io_capacity</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">IO,200</td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">90</td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0.x</td>\n    <td colspan=\"3\">75<br>IO</td>                       \n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_adaptive_flushing\">innodb_adaptive_flushing</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> ON</td>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_purge_batch_size\">innodb_purge_batch_size</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> undo ,, 20</td>\n</tr>\n</table>   \n\n<p>Master Thread</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">master_thread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tloop </span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; ++i)&#123;</span><br><span class=\"line\">\t\tthread_sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"comment\">//1. </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t\t<span class=\"comment\">//2. IO5%innodb_io_capacity</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(last_one_second_ios &lt; <span class=\"number\">5</span>%innodb_io_capacity)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> merge <span class=\"number\">5</span>%innodb_io_capacity insert buffer;</span><br><span class=\"line\">\t\t<span class=\"comment\">//3.  100%innodb_io_capacity </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page;</span><br><span class=\"line\">\t\t<span class=\"comment\">//4. shutdown backgroup loop</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(no user activity)</span><br><span class=\"line\">\t\t\tgoto backgroud loop;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//1. 10IOinnodb_io_capacity innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(last_ten_second_ios &lt; innodb_io_capacity)</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page;</span><br><span class=\"line\">\t<span class=\"comment\">//2.  5%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge at most <span class=\"number\">5</span>%innodb_io_capacity insert buffer;</span><br><span class=\"line\">\t<span class=\"comment\">//3. </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t<span class=\"comment\">//4.  undo  5%innodb_io_capacity  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge;</span><br><span class=\"line\">\t<span class=\"comment\">//5.  70%  100%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"comment\">//  10%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  <span class=\"number\">70</span> % )</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tbuffer pool flush <span class=\"number\">10</span>%innodb_io_capacity dirty page</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span><br><span class=\"line\">\tgoto loop</span><br><span class=\"line\">\t<span class=\"comment\">//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span></span><br><span class=\"line\">\tbackground loop :</span><br><span class=\"line\">\t<span class=\"comment\">//1.  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge</span><br><span class=\"line\">\t<span class=\"comment\">//2.  100%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge <span class=\"number\">100</span>%innodb_io_capacity insert buffer</span><br><span class=\"line\">\t<span class=\"comment\">//3.</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> not idle\t</span><br><span class=\"line\">\t\tgoto loop</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tflush loop :</span><br><span class=\"line\">\t<span class=\"comment\">// 100%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )</span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tgoto suspend loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend loop :</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend_thread()</span><br><span class=\"line\">\twaiting event</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"InnoDB-1-2-x--Master-thread\"><a href=\"#InnoDB-1-2-x--Master-thread\" class=\"headerlink\" title=\"InnoDB 1.2.x  Master thread\"></a>InnoDB 1.2.x  Master thread</h2><p>InnoDB 1.2.x  Master Thread </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> InnoDB is idle</span><br><span class=\"line\"><span class=\"comment\">//10</span></span><br><span class=\"line\">srv_master_do_idle_tasks();</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">srv_master_do_active_tasks();</span><br></pre></td></tr></table></figure>\n\n<p>Master ThreadPage Cleaner ThreadMaster Thread</p>\n<h1 id=\"InnoDB-\"><a href=\"#InnoDB-\" class=\"headerlink\" title=\"InnoDB \"></a>InnoDB </h1><p></p>\n<ul>\n<li> insert buffer</li>\n<li> double write</li>\n<li> adaptive hash index</li>\n<li> io async io</li>\n<li> flush neighbor page</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>B+</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/31/Mysql02/index-update.png\" alt=\"index\"><br>insert delete update()</p>\n<p><img src=\"/2019/07/31/Mysql02/insert-buffer.png\" alt=\"insertbufferindex\"></p>\n<h3 id=\"1-insert-buffer\"><a href=\"#1-insert-buffer\" class=\"headerlink\" title=\"1. insert buffer\"></a>1. insert buffer</h3><p>Insert Buffer<br><img src=\"/2019/07/31/Mysql02/Insert-Buffer.svg\" alt=\"Insert Buffer\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1secondary index<br>22</p>\n<h4 id=\"insert-buffer\"><a href=\"#insert-buffer\" class=\"headerlink\" title=\"insert buffer\"></a>insert buffer</h4><p>insert bufferB+B+<br>B+Search key(space,marker,offset)</p>\n<ul>\n<li>spaceididid</li>\n<li>marker</li>\n<li>offset</li>\n</ul>\n<p>(space,offset)search keyinsert buffer<br>insert bufferB+insert buffer<br><code>Insert buffer bitmap</code><br>page_sizeInsert buffer bitmap page<br>page_size = 16384(16k)page_no01638432768pageInsert buffer bitmap pageBitmap pagepage_size  1page<br>Insert buffer bitmap4bit</p>\n<h4 id=\"merge-insert-buffer-\"><a href=\"#merge-insert-buffer-\" class=\"headerlink\" title=\"merge insert buffer \"></a>merge insert buffer </h4><ul>\n<li>buffer poolselectinsert buffermerge</li>\n<li>Insert buffer bitmap page</li>\n<li>Master Thread</li>\n</ul>\n<h4 id=\"insert-buffer-\"><a href=\"#insert-buffer-\" class=\"headerlink\" title=\"insert buffer \"></a>insert buffer </h4><ul>\n<li></li>\n<li></li>\n<li></li>\n<li>redo log<em>redo log</em></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1<br>21/2</p>\n<h3 id=\"2-change-buffer\"><a href=\"#2-change-buffer\" class=\"headerlink\" title=\"2. change buffer\"></a>2. change buffer</h3><p>InnoDB1.0.xChange BufferInsert Buffer<br>InnoDBDMLInsertDeleteUpdate<code>(delete+insert)</code><br>Insert Buffer, Delete Buffer,Purge Buffer<br> update </p>\n<ul>\n<li>delete buffer</li>\n<li>pruge buffer</li>\n</ul>\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffering\">innodb_change_buffering</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">Bufferall<br>\n        <ul>\n        <li>inserts</li>\n        <li>deletes</li>\n        <li>purges</li>\n        <li>changes inserts  deletes</li>\n        <li>all</li>\n        <li>none</li>\n        </ul>\n    </td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffer_max_size\">innodb_change_buffer_max_size</span></td>\n    <td style=\"text-align:center\"> 1.2.x </td>\n    <td colspan=\"3\">change buffer<br>25,1/4<br>50</td>\n</tr>\n</table>  \n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>innodb(partial page write)</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>IO</p>\n<ul>\n<li>IO16KMySQLoracle8K</li>\n<li>IO4K1K</li>\n<li>IO512</li>\n</ul>\n<p>IOpage<br><img src=\"/2019/07/31/Mysql02/IO.png\" alt=\"IO\"></p>\n<p>innodb(partial page write)</p>\n<h3 id=\"Double-write\"><a href=\"#Double-write\" class=\"headerlink\" title=\"Double write\"></a>Double write</h3><p>16K8K8K8K<code></code></p>\n<p><strong> redo log </strong><br>redodouble write</p>\n<div class=\"note info\"><p> redo log  doublewrite <br> redo log  512  IO </p></div>   \n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/31/Mysql02/doublewrite.png\" alt=\"\"><br>doublewritedoublewrite buffer2MB(ibdata x)1282(extent)2M</p>\n<ol>\n<li>doublewrite buffer</li>\n<li>()1MB</li>\n<li>doublewrite buffer()(doublewrite)</li>\n</ol>\n<p> double write </p>\n<ol>\n<li> redo log </li>\n<li> redo log </li>\n<li></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>B+ 3-4  3-4 </p>\n<p> AHIadaptive hash index</p>\n<ul>\n<li> 100 where x = ?</li>\n<li> N  N = 16</li>\n</ul>\n<p>InnoDB  AHI , 2  5 </p>\n<h2 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h2><p>IOIOIOIOIOAIO<br>AIOIO MergeIO1IO, IOPS(Input/Output Per Second)</p>\n<p>space, page_no)(8,6) (8,7) (8,8)16KBIO3IO(8,6)48KB</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InnoDBextent</p>\n<table>\n    <tr>\n        <th colspan=\"2\"></th>\n        <th></th>\n        <th colspan=\"3\"></th>\n    </tr>\n    <tr>\n        <th colspan=\"2\" style=\"text-align:center\">innodb_flush_neighbors</th>\n        <td style=\"text-align:center\">1.2.x</td>\n        <td colspan=\"3\"></td>\n    </tr>\n</table> \n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://oohcode.com/2015/10/14/InnoDB-Key-Features/\" target=\"_blank\" rel=\"noopener\">http://oohcode.com/2015/10/14/InnoDB-Key-Features/</a></li>\n<li><a href=\"https://chyroc.cn/posts/innodb-storage-engine-reading-1/\" target=\"_blank\" rel=\"noopener\">https://chyroc.cn/posts/innodb-storage-engine-reading-1/</a></li>\n<li><a href=\"https://www.cnblogs.com/zhoujinyi/archive/2013/04/11/2988923.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/zhoujinyi/archive/2013/04/11/2988923.html</a></li>\n<li><a href=\"http://huzb.me/2019/01/14/%E6%8F%92%E5%85%A5%E7%BC%93%E5%86%B2%E3%80%81%E4%B8%A4%E6%AC%A1%E5%86%99%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/\" target=\"_blank\" rel=\"noopener\">http://huzb.me/2019/01/14/%E6%8F%92%E5%85%A5%E7%BC%93%E5%86%B2%E3%80%81%E4%B8%A4%E6%AC%A1%E5%86%99%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/</a></li>\n<li><a href=\"https://blog.csdn.net/tanliqing2010/article/details/81509539\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/tanliqing2010/article/details/81509539</a></li>\n<li><a href=\"https://www.cnblogs.com/geaozhang/p/7341333.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/geaozhang/p/7341333.html</a></li>\n<li><a href=\"https://draveness.me/mysql-innodb\" target=\"_blank\" rel=\"noopener\">https://draveness.me/mysql-innodb</a></li>\n<li><a href=\"http://richfisher.me/blog/2017/12/18/innodb-notes/\" target=\"_blank\" rel=\"noopener\">http://richfisher.me/blog/2017/12/18/innodb-notes/</a></li>\n<li><a href=\"https://www.docs4dev.com/docs/zh/mysql/5.7/reference/innodb-architecture.html#innodb%E6%9E%B6%E6%9E%84\" target=\"_blank\" rel=\"noopener\">https://www.docs4dev.com/docs/zh/mysql/5.7/reference/innodb-architecture.html#innodb%E6%9E%B6%E6%9E%84</a></li>\n<li>MySQLInnoDB(2)</li>\n</ul>\n","site":{"data":{}},"excerpt":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li>InnoDBInnobase OyMySQL</li>\n<li>MySQL 5.5<font color=\"gray\">InnoDBWindows</font></li>\n<li>ACIDMySQL<font color=\"gray\">BDBMySQL</font></li>\n<li> MVCC CPU</li></ul>","more":"\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><p><img src=\"/2019/07/31/Mysql02/innodb-Architecture.png\" alt=\"innoDB\"><br>InnoDB</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InnoDB , </p>\n<h3 id=\"Master-Thread\"><a href=\"#Master-Thread\" class=\"headerlink\" title=\"Master Thread\"></a>Master Thread</h3><p>Master ThreadUNDO</p>\n<h3 id=\"IO-Thread\"><a href=\"#IO-Thread\" class=\"headerlink\" title=\"IO Thread\"></a>IO Thread</h3><p> InnoDB IO(Async IO)IO, IO Thread IO </p>\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">4  io threadwritereadinsert bufferlog IO Thread.\n    <ul>\n        <li>LinuxIO Thread</li>\n        <li>Windows innodb_file_io_threads IO Thread</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0 </td>\n    <td colspan=\"4\">read  write IO thread  4 <br>\n    <ul>\n    <li> innodb_read_io_threads  innodb_write_io_threads </li>\n    </ul>\n    </td>\n</tr>\n</table>  \n\n<h3 id=\"Purge-Thread\"><a href=\"#Purge-Thread\" class=\"headerlink\" title=\"Purge Thread\"></a>Purge Thread</h3><p>undo logPurge ThreadUNDO</p>\n<table>\n<tr>\n    <th>InnoDB </th>\n    <th colspan=\"4\"></th>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge  master thread </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.1 </td>\n    <td colspan=\"4\">purge , master thread , cpu <br>\n    <ul>\n    <li>MySQL<code>[mysqld]</code>Purge Thread</li>\n    <li>innodb_purge_threads=1 </li>\n    <li>1.1 innodb_purge_threads 1InnoDB1</li>\n    </ul>\n    </td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.2</td>\n    <td colspan=\"4\">Purge Thread, UNDO</td>\n</tr>\n</table>                                  \n\n<h3 id=\"Page-Cleaner-Thread\"><a href=\"#Page-Cleaner-Thread\" class=\"headerlink\" title=\"Page Cleaner Thread\"></a>Page Cleaner Thread</h3><p>Page Cleaner ThreadMaster Thread<br>Master Thread</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>innoDB<a href=\"#\">(innodb buffer pool)</a><a href=\"#\">(redo log buffer)</a><a href=\"#\">(innodb additional men pool size)</a></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>80<br><br>     <img src=\"/2019/07/31/Mysql02/read.png\" alt=\"\"><br><br>     <img src=\"/2019/07/31/Mysql02/write.png\" alt=\"\"></p>\n<p></p>\n<div class=\"note info\"><p>323G<br><code>PAE</code>3264GB<br>, 64 </p></div>\n\n<table>\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n<th align=\"center\"></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"center\">innodb_buffer_pool_instances</td>\n<td align=\"center\">InnoDB 1.0.x</td>\n<td align=\"center\">1</td>\n</tr>\n</tbody></table>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>(index page)</li>\n<li>(data page)</li>\n<li>undo(undo Log Page)undo</li>\n<li><a href=\"#\"></a>insert buffer</li>\n<li>adaptive hash index B+ Tree</li>\n<li>InnoDBlock info</li>\n<li>data dictionary<br>  MySQL<br>  InnoDBInnoDB</li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><img src=\"/2019/07/31/Mysql02/three-list2.png\" alt=\"list\"></p>\n<ol>\n<li><p><strong>Free list</strong><br>LRUFree list<br>Free listFreeLRU,</p>\n</li>\n<li><p><strong>LRU list</strong><br> <strong>LRU</strong>LRULRU16KB<br> <strong>InnoDBLRU(midpoint insertion strategy)</strong> <code>midpoint</code> <br> <img src=\"/2019/07/31/Mysql02/innodb-buffer-pool-list.jpg\" alt=\"lru\"></p>\n <table>\n <tr>\n     <th></th>\n     <th colspan=\"2\"></th>\n </tr>\n <tr>\n     <td style=\"text-align:center\"> innodb_old_blocks_pct </td>\n     <td colspan=\"2\">LRU old list <br>\n         373/8<br>\n         5 95\n     </td>\n </tr>\n <tr>\n     <td style=\"text-align:center\"> innodb_old_blocks_time </td>\n     <td colspan=\"2\">ms<br>\n        LRU<br>\n         1000 ms\n     </td>\n </tr>\n </table> \n\n<p> </p>\n<ul>\n<li> <code>midpoint</code>LRU list 5/8</li>\n<li><code>midpoint</code>new sublistold sublist</li>\n<li> InnoDB <code>midpoint</code>(old sublist)</li>\n<li>old sublist &amp;&amp; old sublistinnodb_old_blocks_time<code>young</code>,(new sublist)</li>\n<li>LRUoldnew<code>page made young</code>innodb_old_blocks_timeoldnew<code>page not made young</code></li>\n<li>new sublistnew sublistold listold list</li>\n</ul>\n<div class=\"note warning\"><p>LRU<br>SQL</p></div>  \n\n<ol start=\"3\">\n<li><strong>Flush list</strong><br>LRUDirty Page<br><code>CHECKPOINT</code>Flush list</li>\n</ol>\n</li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>   <div class=\"note info\"><p><strong>redo log</strong><br>buffer poolbuffer poolbuffer poolbuffer pooldirty page <br>DBIO<br>data pageIODBcrashDB<br>redo log  <br><br><strong>undo log</strong><br>undo<br> id=1 Name=B Name = B2 undoName=Bundo</p></div>  \n\n<p><img src=\"/2019/07/31/Mysql02/redo-buffer.png\" alt=\"lru\"></p>\n<p>  8M</p>\n<ul>\n<li>Master Thread</li>\n<li></li>\n<li>1/2</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>   InnoDB</p>\n<h1 id=\"Checkpoint\"><a href=\"#Checkpoint\" class=\"headerlink\" title=\"Checkpoint\"></a>Checkpoint</h1><div class=\"note info\"><p><strong>Checkpoint</strong><br>(event)(DBWR)                           </p>\n<p><strong>Checkpoint</strong><br>innoDB<br>1) <br>2) <br>3)             </p>\n<p><strong>Checkpoint </strong><br>1) <br>2) <br>3) </p></div> \n\n<p>InnoDBLSNLog Sequence NumberLSNLSNCheckpointLSN</p>\n<p>innodb  checkpoint</p>\n<ol>\n<li><p><strong>sharp checkpoint</strong><code></code> innodb_fast_shudown=1</p>\n</li>\n<li><p><strong>fuzzy checkpoint</strong><code></code></p>\n<ul>\n<li><p>master thread checkpointmaster thread  10 </p>\n<ul>\n<li>flush list</li>\n</ul>\n</li>\n<li><p>flush_lru_list checkpointInnoDBLRU100 lru list  checkpoint</p>\n<ul>\n<li>innodb 1.1.x,</li>\n<li>innodb 1.2.x page cleaner , <strong>innodb_lru_scan_depth</strong> lru1024</li>\n</ul>\n</li>\n<li><p>async/sync flush checkpoint</p>\n<ul>\n<li>checkpoint age = redo_log_lsn - cp_lsn<br> =75% * total_redo_log_file_size<br> =90% * total_redo_log_file_size</li>\n<li>checkpoint age &lt; <br>   </li>\n<li>  &lt;=  checkpoint age &lt;= <br>    checkpoint async flush flush_list checkpoint age &lt; </li>\n<li>checkpoint age &gt; <br>  checkpoint sync flush flush_list,  checkpoint age &lt; </li>\n</ul>\n</li>\n<li><p>dirty page too much checkpointCheckpoint <a href=\"#innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</a> </p>\n</li>\n</ul>\n</li>\n</ol>\n<div style=\"text-align:center;color:#bfbfbf;font-size:16px;\">\n    <span>--------  --------</span>\n</div>\n\n<h1 id=\"Master-thread-\"><a href=\"#Master-thread-\" class=\"headerlink\" title=\"Master thread \"></a>Master thread </h1><h2 id=\"InnoDB-1-0-x--Master-thread\"><a href=\"#InnoDB-1-0-x--Master-thread\" class=\"headerlink\" title=\"InnoDB 1.0.x  Master thread\"></a>InnoDB 1.0.x  Master thread</h2><p>Master thread  loop </p>\n<ul>\n<li> loop</li>\n<li> backgroup loop</li>\n<li> flush loop</li>\n<li> suspend loop</li>\n</ul>\n<p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">master_thread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tloop </span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; ++i)&#123;</span><br><span class=\"line\">\t\tthread_sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"comment\">//1. </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t\t<span class=\"comment\">//2. IO5</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(last_one_second_ios &lt; <span class=\"number\">5</span>)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> merge at most <span class=\"number\">5</span> insert buffer;</span><br><span class=\"line\">\t\t<span class=\"comment\">//3.  100 </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page;</span><br><span class=\"line\">\t\t<span class=\"comment\">//4. shutdown backgroup loop</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(no user activity)</span><br><span class=\"line\">\t\t\tgoto backgroud loop;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//1. 10IO200 100 </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(last_ten_second_ios &lt; <span class=\"number\">200</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page;</span><br><span class=\"line\">\t<span class=\"comment\">//2.  5 </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge at most <span class=\"number\">5</span> insert buffer;</span><br><span class=\"line\">\t<span class=\"comment\">//3. </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t<span class=\"comment\">//4.  undo  20  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge;</span><br><span class=\"line\">\t<span class=\"comment\">//5.  70% 100  10 </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  <span class=\"number\">70</span> % )</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tbuffer pool flush <span class=\"number\">10</span> dirty page</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span><br><span class=\"line\">\tgoto loop</span><br><span class=\"line\">\t<span class=\"comment\">//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span></span><br><span class=\"line\">\tbackground loop :</span><br><span class=\"line\">\t<span class=\"comment\">//1.  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge</span><br><span class=\"line\">\t<span class=\"comment\">//2.  20 </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge <span class=\"number\">20</span> insert buffer</span><br><span class=\"line\">\t<span class=\"comment\">//3.</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> not idle\t</span><br><span class=\"line\">\t\tgoto loop</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tflush loop :</span><br><span class=\"line\">\t<span class=\"comment\">//100</span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span> dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )</span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tgoto suspend loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend loop :</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend_thread()</span><br><span class=\"line\">\twaiting event</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"InnoDB-1-2-x--Master-thread\"><a href=\"#InnoDB-1-2-x--Master-thread\" class=\"headerlink\" title=\"InnoDB 1.2.x  Master thread\"></a>InnoDB 1.2.x  Master thread</h2><ol>\n<li> IO ,<ul>\n<li> <a href=\"#innodb_io_capacity\">innodb_io_capacity</a>  5%</li>\n<li> <a href=\"#innodb_io_capacity\">innodb_io_capacity</a></li>\n</ul>\n</li>\n<li><ul>\n<li>1.0.x<a href=\"#innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</a>100</li>\n<li>1.0.x<a href=\"#innodb_adaptive_flushing\">innodb_adaptive_flushing</a>buf_flush_get_desired_flush_rate</li>\n</ul>\n</li>\n<li>full purgeUndo<a href=\"#innodb_purge_batch_size\">innodb_purge_batch_size</a></li>\n</ol>\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_io_capacity\">innodb_io_capacity</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">IO,200</td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_max_dirty_pages_pct\">innodb_max_dirty_pages_pct</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">90</td>\n</tr>\n<tr>\n    <td style=\"text-align:center\"> 1.0.x</td>\n    <td colspan=\"3\">75<br>IO</td>                       \n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_adaptive_flushing\">innodb_adaptive_flushing</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> ON</td>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_purge_batch_size\">innodb_purge_batch_size</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\"> undo ,, 20</td>\n</tr>\n</table>   \n\n<p>Master Thread</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">master_thread</span><span class=\"params\">()</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tloop </span><br><span class=\"line\">\t<span class=\"keyword\">for</span>(<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">10</span>; ++i)&#123;</span><br><span class=\"line\">\t\tthread_sleep(<span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t<span class=\"comment\">//1. </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t\t<span class=\"comment\">//2. IO5%innodb_io_capacity</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(last_one_second_ios &lt; <span class=\"number\">5</span>%innodb_io_capacity)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> merge <span class=\"number\">5</span>%innodb_io_capacity insert buffer;</span><br><span class=\"line\">\t\t<span class=\"comment\">//3.  100%innodb_io_capacity </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(buf_get_modified_ratio_pct &gt; innodb_max_dirty_pages_pct)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page;</span><br><span class=\"line\">\t\t<span class=\"comment\">//4. shutdown backgroup loop</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(no user activity)</span><br><span class=\"line\">\t\t\tgoto backgroud loop;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//1. 10IOinnodb_io_capacity innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span>(last_ten_second_ios &lt; innodb_io_capacity)</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page;</span><br><span class=\"line\">\t<span class=\"comment\">//2.  5%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge at most <span class=\"number\">5</span>%innodb_io_capacity insert buffer;</span><br><span class=\"line\">\t<span class=\"comment\">//3. </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> log buffer flush to disk;</span><br><span class=\"line\">\t<span class=\"comment\">//4.  undo  5%innodb_io_capacity  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge;</span><br><span class=\"line\">\t<span class=\"comment\">//5.  70%  100%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"comment\">//  10%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  <span class=\"number\">70</span> % )</span><br><span class=\"line\">\t\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tbuffer pool flush <span class=\"number\">10</span>%innodb_io_capacity dirty page</span><br><span class=\"line\">\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span><br><span class=\"line\">\tgoto loop</span><br><span class=\"line\">\t<span class=\"comment\">//\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span></span><br><span class=\"line\">\tbackground loop :</span><br><span class=\"line\">\t<span class=\"comment\">//1.  undo </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> full purge</span><br><span class=\"line\">\t<span class=\"comment\">//2.  100%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> merge <span class=\"number\">100</span>%innodb_io_capacity insert buffer</span><br><span class=\"line\">\t<span class=\"comment\">//3.</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> not idle\t</span><br><span class=\"line\">\t\tgoto loop</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tflush loop :</span><br><span class=\"line\">\t<span class=\"comment\">// 100%innodb_io_capacity </span></span><br><span class=\"line\">\t<span class=\"keyword\">do</span> buffer pool flush <span class=\"number\">100</span>%innodb_io_capacity dirty page</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ( buf_get_modified_ratio_pct  innodb_max_dirty_pages_pct )</span><br><span class=\"line\">\t\tgoto flush loop</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tgoto suspend loop</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend loop :</span><br><span class=\"line\">\t<span class=\"comment\">//</span></span><br><span class=\"line\">\tsuspend_thread()</span><br><span class=\"line\">\twaiting event</span><br><span class=\"line\">\tgoto loop;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"InnoDB-1-2-x--Master-thread\"><a href=\"#InnoDB-1-2-x--Master-thread\" class=\"headerlink\" title=\"InnoDB 1.2.x  Master thread\"></a>InnoDB 1.2.x  Master thread</h2><p>InnoDB 1.2.x  Master Thread </p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> InnoDB is idle</span><br><span class=\"line\"><span class=\"comment\">//10</span></span><br><span class=\"line\">srv_master_do_idle_tasks();</span><br><span class=\"line\"><span class=\"keyword\">else</span></span><br><span class=\"line\"><span class=\"comment\">//</span></span><br><span class=\"line\">srv_master_do_active_tasks();</span><br></pre></td></tr></table></figure>\n\n<p>Master ThreadPage Cleaner ThreadMaster Thread</p>\n<h1 id=\"InnoDB-\"><a href=\"#InnoDB-\" class=\"headerlink\" title=\"InnoDB \"></a>InnoDB </h1><p></p>\n<ul>\n<li> insert buffer</li>\n<li> double write</li>\n<li> adaptive hash index</li>\n<li> io async io</li>\n<li> flush neighbor page</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br></p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><br>B+</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/31/Mysql02/index-update.png\" alt=\"index\"><br>insert delete update()</p>\n<p><img src=\"/2019/07/31/Mysql02/insert-buffer.png\" alt=\"insertbufferindex\"></p>\n<h3 id=\"1-insert-buffer\"><a href=\"#1-insert-buffer\" class=\"headerlink\" title=\"1. insert buffer\"></a>1. insert buffer</h3><p>Insert Buffer<br><img src=\"/2019/07/31/Mysql02/Insert-Buffer.svg\" alt=\"Insert Buffer\"></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1secondary index<br>22</p>\n<h4 id=\"insert-buffer\"><a href=\"#insert-buffer\" class=\"headerlink\" title=\"insert buffer\"></a>insert buffer</h4><p>insert bufferB+B+<br>B+Search key(space,marker,offset)</p>\n<ul>\n<li>spaceididid</li>\n<li>marker</li>\n<li>offset</li>\n</ul>\n<p>(space,offset)search keyinsert buffer<br>insert bufferB+insert buffer<br><code>Insert buffer bitmap</code><br>page_sizeInsert buffer bitmap page<br>page_size = 16384(16k)page_no01638432768pageInsert buffer bitmap pageBitmap pagepage_size  1page<br>Insert buffer bitmap4bit</p>\n<h4 id=\"merge-insert-buffer-\"><a href=\"#merge-insert-buffer-\" class=\"headerlink\" title=\"merge insert buffer \"></a>merge insert buffer </h4><ul>\n<li>buffer poolselectinsert buffermerge</li>\n<li>Insert buffer bitmap page</li>\n<li>Master Thread</li>\n</ul>\n<h4 id=\"insert-buffer-\"><a href=\"#insert-buffer-\" class=\"headerlink\" title=\"insert buffer \"></a>insert buffer </h4><ul>\n<li></li>\n<li></li>\n<li></li>\n<li>redo log<em>redo log</em></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>1<br>21/2</p>\n<h3 id=\"2-change-buffer\"><a href=\"#2-change-buffer\" class=\"headerlink\" title=\"2. change buffer\"></a>2. change buffer</h3><p>InnoDB1.0.xChange BufferInsert Buffer<br>InnoDBDMLInsertDeleteUpdate<code>(delete+insert)</code><br>Insert Buffer, Delete Buffer,Purge Buffer<br> update </p>\n<ul>\n<li>delete buffer</li>\n<li>pruge buffer</li>\n</ul>\n<table>\n<tr>\n    <th colspan=\"2\"></th>\n    <th>InnoDB </th>\n    <th colspan=\"3\"></th>\n</tr>\n<tr>\n    <td colspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffering\">innodb_change_buffering</span></td>\n    <td style=\"text-align:center\"> 1.0.x </td>\n    <td colspan=\"3\">Bufferall<br>\n        <ul>\n        <li>inserts</li>\n        <li>deletes</li>\n        <li>purges</li>\n        <li>changes inserts  deletes</li>\n        <li>all</li>\n        <li>none</li>\n        </ul>\n    </td>\n</tr>\n<tr>\n    <td colspan=\"2\" rowspan=\"2\" style=\"text-align:center\"><span id=\"innodb_change_buffer_max_size\">innodb_change_buffer_max_size</span></td>\n    <td style=\"text-align:center\"> 1.2.x </td>\n    <td colspan=\"3\">change buffer<br>25,1/4<br>50</td>\n</tr>\n</table>  \n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>innodb(partial page write)</p>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>IO</p>\n<ul>\n<li>IO16KMySQLoracle8K</li>\n<li>IO4K1K</li>\n<li>IO512</li>\n</ul>\n<p>IOpage<br><img src=\"/2019/07/31/Mysql02/IO.png\" alt=\"IO\"></p>\n<p>innodb(partial page write)</p>\n<h3 id=\"Double-write\"><a href=\"#Double-write\" class=\"headerlink\" title=\"Double write\"></a>Double write</h3><p>16K8K8K8K<code></code></p>\n<p><strong> redo log </strong><br>redodouble write</p>\n<div class=\"note info\"><p> redo log  doublewrite <br> redo log  512  IO </p></div>   \n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><img src=\"/2019/07/31/Mysql02/doublewrite.png\" alt=\"\"><br>doublewritedoublewrite buffer2MB(ibdata x)1282(extent)2M</p>\n<ol>\n<li>doublewrite buffer</li>\n<li>()1MB</li>\n<li>doublewrite buffer()(doublewrite)</li>\n</ol>\n<p> double write </p>\n<ol>\n<li> redo log </li>\n<li> redo log </li>\n<li></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<p>B+ 3-4  3-4 </p>\n<p> AHIadaptive hash index</p>\n<ul>\n<li> 100 where x = ?</li>\n<li> N  N = 16</li>\n</ul>\n<p>InnoDB  AHI , 2  5 </p>\n<h2 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h2><p>IOIOIOIOIOAIO<br>AIOIO MergeIO1IO, IOPS(Input/Output Per Second)</p>\n<p>space, page_no)(8,6) (8,7) (8,8)16KBIO3IO(8,6)48KB</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>InnoDBextent</p>\n<table>\n    <tr>\n        <th colspan=\"2\"></th>\n        <th></th>\n        <th colspan=\"3\"></th>\n    </tr>\n    <tr>\n        <th colspan=\"2\" style=\"text-align:center\">innodb_flush_neighbors</th>\n        <td style=\"text-align:center\">1.2.x</td>\n        <td colspan=\"3\"></td>\n    </tr>\n</table> \n\n\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><ul>\n<li><a href=\"http://oohcode.com/2015/10/14/InnoDB-Key-Features/\" target=\"_blank\" rel=\"noopener\">http://oohcode.com/2015/10/14/InnoDB-Key-Features/</a></li>\n<li><a href=\"https://chyroc.cn/posts/innodb-storage-engine-reading-1/\" target=\"_blank\" rel=\"noopener\">https://chyroc.cn/posts/innodb-storage-engine-reading-1/</a></li>\n<li><a href=\"https://www.cnblogs.com/zhoujinyi/archive/2013/04/11/2988923.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/zhoujinyi/archive/2013/04/11/2988923.html</a></li>\n<li><a href=\"http://huzb.me/2019/01/14/%E6%8F%92%E5%85%A5%E7%BC%93%E5%86%B2%E3%80%81%E4%B8%A4%E6%AC%A1%E5%86%99%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/\" target=\"_blank\" rel=\"noopener\">http://huzb.me/2019/01/14/%E6%8F%92%E5%85%A5%E7%BC%93%E5%86%B2%E3%80%81%E4%B8%A4%E6%AC%A1%E5%86%99%E5%92%8C%E8%87%AA%E9%80%82%E5%BA%94%E5%93%88%E5%B8%8C%E7%B4%A2%E5%BC%95/</a></li>\n<li><a href=\"https://blog.csdn.net/tanliqing2010/article/details/81509539\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/tanliqing2010/article/details/81509539</a></li>\n<li><a href=\"https://www.cnblogs.com/geaozhang/p/7341333.html\" target=\"_blank\" rel=\"noopener\">https://www.cnblogs.com/geaozhang/p/7341333.html</a></li>\n<li><a href=\"https://draveness.me/mysql-innodb\" target=\"_blank\" rel=\"noopener\">https://draveness.me/mysql-innodb</a></li>\n<li><a href=\"http://richfisher.me/blog/2017/12/18/innodb-notes/\" target=\"_blank\" rel=\"noopener\">http://richfisher.me/blog/2017/12/18/innodb-notes/</a></li>\n<li><a href=\"https://www.docs4dev.com/docs/zh/mysql/5.7/reference/innodb-architecture.html#innodb%E6%9E%B6%E6%9E%84\" target=\"_blank\" rel=\"noopener\">https://www.docs4dev.com/docs/zh/mysql/5.7/reference/innodb-architecture.html#innodb%E6%9E%B6%E6%9E%84</a></li>\n<li>MySQLInnoDB(2)</li>\n</ul>"},{"title":"JAVA-","date":"2019-10-21T09:23:04.000Z","author":"Guyuqing","copyright":true,"comments":0,"_content":"# \n\n#### \nLight Weight Process     \n<!-- more -->\n#### \n\n* Thread\n* Runnablerun()new Thread(runnable).start()run\n* Callablecall()FutureTaskCallableFutureTaskThreadtarger\n       Runnable  Callable \n        1. RunnablerunCallablecall\n        2. RunnableCallable\n        3. runcall\n        4. CallableFutureFutureget()get()get()\n* Executors executor servicesRunnableCallableThreadPoolExecutorScheduledThreadPoolExecutor\n      1. public static ExecutorService newCachedThreadPool() \n      2. public static ExecutorService newFixedThreadPool(int nThreads)  \n      3. public static ExecutorService newSingleThreadExecutor() (FIFO, LIFO, )\n      4. public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) \n      5. public static ExecutorService newWorkStealingPool() CPUForkJoinPoolCPU\n\n#### \n* ForkJoinPool (WorkQueue)(ForkJoinTask)\n  * (fork())LIFO\n  * (pool)FIFO\n  * join()join\n* ExecutorCompletionService (BlockingQueue), , take()FutureTask\n\n# \n\n## ThreadPoolExecutor\n\n```java\n    public ThreadPoolExecutor(int corePoolSize,\n                              int maximumPoolSize,\n                              long keepAliveTime,\n                              TimeUnit unit,\n                              BlockingQueue<Runnable> workQueue,\n                              ThreadFactory threadFactory,\n                              RejectedExecutionHandler handler) {\n        if (corePoolSize < 0 ||\n            maximumPoolSize <= 0 ||\n            maximumPoolSize < corePoolSize ||\n            keepAliveTime < 0)\n            throw new IllegalArgumentException();\n        if (workQueue == null || threadFactory == null || handler == null)\n            throw new NullPointerException();\n        this.acc = System.getSecurityManager() == null ?\n                null :\n                AccessController.getContext();\n        this.corePoolSize = corePoolSize;\n        this.maximumPoolSize = maximumPoolSize;\n        this.workQueue = workQueue;\n        this.keepAliveTime = unit.toNanos(keepAliveTime);\n        this.threadFactory = threadFactory;\n        this.handler = handler;\n    }\n```\n\n\n* corePoolSize exectue()\n        1.  corePoolSize\n        2.  corePoolSize  maximumPoolSizeworkQueue\n        3. corePoolSize  maximumPoolSizeworkQueueworkQueueworkQueue\n        4. maximumPoolSizeworkQueuehandler\n        5.  corePoolSize > workQueue > maximumPoolSize\n* maximumPoolSize \n* keepAliveTime corePoolSizekeepAliveTime\n* workQueue , :\n  * ****SynchronousQueue\n  * ****LinkedBlockingQueuecorePoolSizemaximumPoolSizeRUNNING\n  * ****ArrayBlockingQueuemaximumPoolSize\n* threadFactory ThreadFactoryExecutors.defaultThreadFactory() ThreadFactoryNORM_PRIORITY\n* handler RejectedExecutionHandler4\n  * AbortPolicy\n  * CallerRunsPolicy\n  * DiscardOldestPolicy\n  * DiscardPolicy\n\n## \n\n### \n\n#### execute\n```java\n    public void execute(Runnable command) {\n        if (command == null)\n            throw new NullPointerException();\n        \n        // cltrunStateworkerCount\n        int c = ctl.get();\n        \n        // workerCountOf29\n        // corePoolSize\n        if (workerCountOf(c) < corePoolSize) {\n            \n            // addWorkercorePoolSizemaximumPoolSize\n            // truecorePoolSize\n            // falsemaximumPoolSize\n            if (addWorker(command, true))\n                return;\n            \n            // ctl\n            c = ctl.get();\n        }\n        \n        //   \n        if (isRunning(c) && workQueue.offer(command)) {\n            \n            // ctl\n            int recheck = ctl.get();\n            \n            // commandworkQueue\n            // command\n            // handler\n            if (! isRunning(recheck) && remove(command))\n                reject(command);\n            \n            // 0addWorker\n            // 1. null\n            // 2. falsemaximumPoolSizemaximumPoolSize\n            // workerCount0workQueuecommand\n            else if (workerCountOf(recheck) == 0)\n                addWorker(null, false);\n        }\n        // \n        // 1.RUNNING\n        // 2.RUNNINGworkerCount >= corePoolSizeworkQueue;\n        // addWorkerfalsemaximumPoolSize\n        //  \n        else if (!addWorker(command, false))\n            reject(command);\n    }\n\n```\n\nrunStateworkCountinthttps://blog.csdn.net/weixin_34396902/article/details/94527424\n\n#### addWorker\n\n```java\n    private boolean addWorker(Runnable firstTask, boolean core) {\n        // CAS+1\n        retry:\n        for (;;) {\n            \n            // cltrunStateworkerCount\n            int c = ctl.get();\n            \n            // \n            int rs = runStateOf(c);\n\n            // rs >= SHUTDOWN\n            // 31false\n            // 1. rs == SHUTDOWN\n            // 2. firsTask\n            // 3. \n            //\n            // rs == SHUTDOWN\n            // firstTaskfalse\n            // firstTaskworkQueuefalse\n            if (rs >= SHUTDOWN &&\n                ! (rs == SHUTDOWN &&\n                   firstTask == null &&\n                   ! workQueue.isEmpty()))\n                return false;\n\n            for (;;) {\n                // \n                int wc = workerCountOf(c);\n                \n                // wcCAPACITY(),ctl29291false\n                // coreaddWorker,truecorePoolSizefalsemaximumPoolSize;\n                if (wc >= CAPACITY ||\n                    wc >= (core ? corePoolSize : maximumPoolSize))\n                    return false;\n                \n                // CASworkerCountclt+1for\n                if (compareAndIncrementWorkerCount(c))\n                    break retry;\n                \n                // workerCountctl\n                c = ctl.get();  \n                // rsfor\n                if (runStateOf(c) != rs)\n                    continue retry;\n            }\n        }\n\n        // workers\n        boolean workerStarted = false;\n        boolean workerAdded = false;\n        Worker w = null;\n        try {\n            // firstTaskWorker\n            w = new Worker(firstTask);\n            \n            // Worker\n            final Thread t = w.thread;\n            \n            \n            if (t != null) {\n                // workers\n                final ReentrantLock mainLock = this.mainLock;\n                mainLock.lock();\n                try {\n                    // \n                    int rs = runStateOf(ctl.get());\n                    \n                    // rs < SHUTDOWNRUNNING\n                    // rsRUNNINGrsSHUTDOWNfirstTasknull\n                    // SHUTDOWNworkQueue\n                    if (rs < SHUTDOWN ||\n                        (rs == SHUTDOWN && firstTask == null)) {\n                        // ,\n                        if (t.isAlive()) \n                            throw new IllegalThreadStateException();\n                        \n                        // workershashSet\n                        workers.add(w);\n                        int s = workers.size();\n                        \n                        // largestPoolSize\n                        if (s > largestPoolSize)\n                            largestPoolSize = s;\n                        //\n                        workerAdded = true;\n                    }\n                } finally {\n                    mainLock.unlock();\n                }\n                if (workerAdded) {\n                    // \n                    t.start();\n                    // \n                    workerStarted = true;\n                }\n            }\n        } finally {\n            // startaddWorkerFailed\n            // clt\n            if (! workerStarted)\n                addWorkerFailed(w);\n        }\n        return workerStarted;\n    }\n\n```\nt.start()WorkerrunWorkerRunnableWorker\n\n#### Worker\n\n```java\n    private final class Worker extends AbstractQueuedSynchronizer implements Runnable\n    {\n\n        private static final long serialVersionUID = 6138294804551838833L;\n\n        /**  **/\n        final Thread thread;\n        /** thread runrun */\n        Runnable firstTask;\n        /**  */\n        volatile long completedTasks;\n\n        /**\n         * Creates with given first task and thread from ThreadFactory.\n         * @param firstTask the first task (null if none)\n         */\n        Worker(Runnable firstTask) {\n            setState(-1); // runWorker()interruptinterruptIfStarted() getState()>=0\n            this.firstTask = firstTask;\n            // \n            this.thread = getThreadFactory().newThread(this);\n        }\n\n        /** Delegates main run loop to outer runWorker  */\n        public void run() {\n            runWorker(this);\n        }\n\n        // Lock methods\n        //\n        // The value 0 represents the unlocked state.\n        // The value 1 represents the locked state.\n\n        protected boolean isHeldExclusively() {\n            return getState() != 0;\n        }\n\n        /**\n        * \n        */\n        protected boolean tryAcquire(int unused) {\n            //state01\n            if (compareAndSetState(0, 1)) {\n                //exclusiveOwnerThread=\n                setExclusiveOwnerThread(Thread.currentThread());\n                return true;\n            }\n            return false;\n        }\n\n        /**\n        * \n        */\n        protected boolean tryRelease(int unused) {\n            setExclusiveOwnerThread(null);\n            setState(0);\n            return true;\n        }\n\n        public void lock()        { acquire(1); }\n        public boolean tryLock()  { return tryAcquire(1); }\n        public void unlock()      { release(1); }\n        public boolean isLocked() { return isHeldExclusively(); }\n\n\n        /**\n        * \n        * shutdownNowworker\n        * workerworker\n        */\n        void interruptIfStarted() {\n            Thread t;\n            // state>=0t!=nullt\n            // new Worker()state==-1\n            if (getState() >= 0 && (t = thread) != null && !t.isInterrupted()) {\n                try {\n                    t.interrupt();\n                } catch (SecurityException ignore) {\n                }\n            }\n        }\n    }\n```\n\nWorkerAbstractQueuedSynchronizer,()workQueue.\nexecute(command)commandWorkerAQSTreadPoolExecutorshutdown()workerworkQueuegetTask()\n\n#### runWorker \n\nWorkerrunrunWorker.\n\n```java\n\n    final void runWorker(Worker w) {\n        Thread wt = Thread.currentThread();\n        \n        // \n        Runnable task = w.firstTask;\n        w.firstTask = null;\n        w.unlock(); // \n        \n         // \n        boolean completedAbruptly = true;\n        try {\n            \n            // taskgetTask\n            while (task != null || (task = getTask()) != null) {\n                w.lock();\n                // If pool is stopping, ensure thread is interrupted;\n                // if not, ensure thread is not interrupted.  This\n                // requires a recheck in second case to deal with\n                // shutdownNow race while clearing interrupt\n                // stopstop\n                // \n                if ((runStateAtLeast(ctl.get(), STOP) ||\n                     (Thread.interrupted() &&\n                      runStateAtLeast(ctl.get(), STOP))) &&\n                    !wt.isInterrupted())\n                    wt.interrupt();\n                try {\n                    //Hook\n                    beforeExecute(wt, task);\n                    Throwable thrown = null;\n                    try {\n                        //\n                        task.run();\n                    } catch (RuntimeException x) {\n                        thrown = x; throw x;\n                    } catch (Error x) {\n                        thrown = x; throw x;\n                    } catch (Throwable x) {\n                        thrown = x; throw new Error(x);\n                    } finally {\n                        //Hook\n                        afterExecute(task, thrown);\n                    }\n                } finally {\n                    //taskcompletedTasks++\n                    task = null;\n                    w.completedTasks++;\n                    w.unlock();\n                }\n            }\n            //\n            completedAbruptly = false;\n        } finally {\n            //Worker\n            processWorkerExit(w, completedAbruptly);\n        }\n    }\n\n```\n#### getTask \n\nrunWorkergetTask()\n\n```java\n    private Runnable getTask() {\n        // \n        boolean timedOut = false; // Did the last poll() time out?\n\n        for (;;) {\n            int c = ctl.get();\n            int rs = runStateOf(c);\n\n            // shutdown\n            // stopterminate\n            // -1null\n            if (rs >= SHUTDOWN && (rs >= STOP || workQueue.isEmpty())) {\n                decrementWorkerCount();\n                return null;\n            }\n\n            // \n            int wc = workerCountOf(c);\n\n            // timed\n            // allowCoreThreadTimeOutfalse\n            // wc > corePoolSize\n            // \n            boolean timed = allowCoreThreadTimeOut || wc > corePoolSize;\n\n            //   \n            //  1  \n            // workerCount1\n            if ((wc > maximumPoolSize || (timed && timedOut))\n                && (wc > 1 || workQueue.isEmpty())) {\n                if (compareAndDecrementWorkerCount(c))\n                    return null;\n                continue;\n            }\n\n            try {\n                //****\n                // timedtruepollkeepAliveTimenull\n                // taketake\n                Runnable r = timed ?\n                    workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) :\n                    workQueue.take();\n                if (r != null)\n                    return r;\n                \n                //  r == nulltimedOuttrue\n                timedOut = true;\n            } catch (InterruptedException retry) {\n                // timedOutfalse\n                timedOut = false;\n            }\n        }\n    }\n```\n### FutureTask\n\n```java\n\npublic class FutureTask<V> implements RunnableFuture<V> {\n\n    /**\n     * stateFutureTask7\n     * NEW:\n     * COMPLETING:outcome(outcome)NEWCOMPLETING\n     * NORMAL:outcomeCOMPLETINGNORMAL\n     * EXCEPTIONAL:outcomeCOMPLETINGEXCEPTIONAL\n     * CANCELLED:cancel(false)NEWCANCELLED\n     * INTERRUPTING: cancel(true)NEWINTERRUPTING\n     * INTERRUPTED:interrupt()INTERRUPTINGINTERRUPTED\n     * \n     * NEW -> COMPLETING -> NORMAL \n     * NEW -> COMPLETING -> EXCEPTIONAL \n     * NEW -> CANCELLED \n     * NEW -> INTERRUPTING -> INTERRUPTED \n     */\n    private volatile int state;\n    private static final int NEW          = 0;\n    private static final int COMPLETING   = 1;//\n    private static final int NORMAL       = 2;\n    private static final int EXCEPTIONAL  = 3;\n    private static final int CANCELLED    = 4;\n    private static final int INTERRUPTING = 5;\n    private static final int INTERRUPTED  = 6;\n\n    /** The underlying callable; nulled out after running */\n    private Callable<V> callable;\n    /** The result to return or exception to throw from get() */\n    private Object outcome; // non-volatile, protected by state reads/writes\n    /** callable **/\n    private volatile Thread runner;\n    /** TreiberStack */\n    private volatile WaitNode waiters;\n\n    @SuppressWarnings(\"unchecked\")\n    private V report(int s) throws ExecutionException {\n        // \n        Object x = outcome;\n        // \n        if (s == NORMAL)\n            // \n            return (V)x;\n        // \n        if (s >= CANCELLED)\n            throw new CancellationException();\n        throw new ExecutionException((Throwable)x);\n    }\n\n    /**\n     * \n     */\n    public FutureTask(Callable<V> callable) {\n        if (callable == null)\n            throw new NullPointerException();\n        this.callable = callable;\n        this.state = NEW;       // ensure visibility of callable\n    }\n\n    /**\n     * RunnableCallablecallableresult\n     * null\n     */\n    public FutureTask(Runnable runnable, V result) {\n        this.callable = Executors.callable(runnable, result);\n        this.state = NEW;       // ensure visibility of callable\n    }\n\n    //\n    public boolean isCancelled() {\n        return state >= CANCELLED;\n    }\n    //\n    public boolean isDone() {\n        return state != NEW;\n    }\n\n    public boolean cancel(boolean mayInterruptIfRunning) {\n        // 1. new  mayInterruptIfRunningNEWINTERRUPTINGCANCELLED \n        // false\n        if (!(state == NEW &&\n              UNSAFE.compareAndSwapInt(this, stateOffset, NEW,\n                  mayInterruptIfRunning ? INTERRUPTING : CANCELLED)))\n            return false;\n        try {    \n        // 2. \n            if (mayInterruptIfRunning) {\n                try {\n                    // runner\n                    Thread t = runner;\n                    if (t != null)\n                        //\n                        t.interrupt();\n                } finally { // final state\n                    // INTERRUPTED\n                    UNSAFE.putOrderedInt(this, stateOffset, INTERRUPTED);\n                }\n            }\n        } finally {\n            finishCompletion();\n        }\n        return true;\n    }\n\n\n    public V get() throws InterruptedException, ExecutionException {\n        int s = state;\n        // state <= COMPLETING\n        if (s <= COMPLETING)\n            // ()\n            // awaitDone()\n            s = awaitDone(false, 0L);\n        // report()\n        return report(s);\n    }\n\n\n    public V get(long timeout, TimeUnit unit)\n        throws InterruptedException, ExecutionException, TimeoutException {\n        if (unit == null)\n            throw new NullPointerException();\n        int s = state;\n        // awaitDone()\n        if (s <= COMPLETING &&\n            (s = awaitDone(true, unit.toNanos(timeout))) <= COMPLETING)\n            throw new TimeoutException();\n        return report(s);\n    }\n\n\n    protected void done() { }\n\n\n    protected void set(V v) {\n        // CASNEWCOMPLETING()\n        if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {\n            // outcome\n            outcome = v;\n            // CASCOMPLETINGNORMAL\n            UNSAFE.putOrderedInt(this, stateOffset, NORMAL); // final state\n            finishCompletion();\n        }\n    }\n\n\n    protected void setException(Throwable t) {\n        // CASNEWCOMPLETING()\n        if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {\n            // outcomeoutcome\n            outcome = t;\n            // CASCOMPLETINGEXCEPTIONAL\n            UNSAFE.putOrderedInt(this, stateOffset, EXCEPTIONAL); // final state\n            finishCompletion();\n        }\n    }\n\n\n    public void run() {\n        // NEW\n        // NEWrunner(runnerOffset)\n        if (state != NEW ||\n            !UNSAFE.compareAndSwapObject(this, runnerOffset,\n                                         null, Thread.currentThread()))\n            return;\n        try {\n            Callable<V> c = callable;\n            // \n            if (c != null && state == NEW) {\n                V result;\n                boolean ran;\n                try {\n                    //   \n                    result = c.call();\n                    ran = true;\n                } catch (Throwable ex) {\n                    result = null;\n                    ran = false;\n                    // \n                    setException(ex);\n                }\n                if (ran)\n                    // \n                    set(result);\n            }\n        } finally {\n            // runnernull\n            runner = null;\n            // state must be re-read after nulling runner to prevent\n            // leaked interrupts\n            int s = state;\n            // \n            if (s >= INTERRUPTING)\n                handlePossibleCancellationInterrupt(s);\n        }\n    }\n\n    /**\n     * run\n     *\n     * @return {@code true} if successfully run and reset\n     */\n    protected boolean runAndReset() {\n        if (state != NEW ||\n            !UNSAFE.compareAndSwapObject(this, runnerOffset,\n                                         null, Thread.currentThread()))\n            return false;\n        boolean ran = false;\n        int s = state;\n        try {\n            Callable<V> c = callable;\n            if (c != null && s == NEW) {\n                try {\n                    // \n                    c.call(); // don't set result\n                    ran = true;\n                } catch (Throwable ex) {\n                    setException(ex);\n                }\n            }\n        } finally {\n\n            runner = null;\n            s = state;\n            if (s >= INTERRUPTING)\n                handlePossibleCancellationInterrupt(s);\n        }\n        // \n        return ran && s == NEW;\n    }\n\n\n    private void handlePossibleCancellationInterrupt(int s) {\n        if (s == INTERRUPTING)\n            while (state == INTERRUPTING)\n                Thread.yield(); // wait out pending interrupt\n\n        // cancel(true)runrunAndReset\n        //Thread.yield()cancelINTERRUPTED\n    }\n\n    /**\n     * Simple linked list nodes to record waiting threads in a Treiber\n     * stack.  See other classes such as Phaser and SynchronousQueue\n     * for more detailed explanation.\n     */\n    static final class WaitNode {\n        volatile Thread thread;\n        volatile WaitNode next;\n        WaitNode() { thread = Thread.currentThread(); }\n    }\n\n    /**\n     * Removes and signals all waiting threads, invokes done(), and\n     * nulls out callable.\n     */\n    private void finishCompletion() {\n        // assert state > COMPLETING;\n        // stateCOMPLETING\n        // waiters\n        for (WaitNode q; (q = waiters) != null;) {\n            // null\n            if (UNSAFE.compareAndSwapObject(this, waitersOffset, q, null)) {\n                for (;;) {\n                    Thread t = q.thread;\n                    if (t != null) {\n                        q.thread = null;\n                        // \n                        LockSupport.unpark(t);\n                    }\n                    WaitNode next = q.next;\n                    // next\n                    if (next == null)\n                        break;\n                    // gc\n                    q.next = null; \n                    // node\n                    q = next;\n                }\n                break;\n            }\n        }\n        // \n        done();\n\n        callable = null;        // to reduce footprint\n    }\n\n    /**\n     * Awaits completion or aborts on interrupt or timeout.\n     *\n     * @param timed true if use timed waits\n     * @param nanos time to wait, if timed\n     * @return state upon completion\n     */\n    private int awaitDone(boolean timed, long nanos)\n        throws InterruptedException {\n        // \n        final long deadline = timed ? System.nanoTime() + nanos : 0L;\n        WaitNode q = null;\n        boolean queued = false;\n        for (;;) {\n            // 1. \n            if (Thread.interrupted()) {\n                // \n                removeWaiter(q);\n                // InterruptedException\n                throw new InterruptedException();\n            }\n\n            int s = state;\n            // 2. COMPLETING\n            if (s > COMPLETING) {\n                // ()\n                if (q != null)\n                    // thread\n                    q.thread = null;\n                // \n                return s;\n            }\n            // 3. COMPLETING\n            // outcome\n            else if (s == COMPLETING) // cannot time out yet\n                Thread.yield();// \n            // 4. \n            else if (q == null)\n                q = new WaitNode();\n            // 5. waiterswaiters\n            else if (!queued)\n                queued = UNSAFE.compareAndSwapObject(this, waitersOffset,\n                                                     q.next = waiters, q);\n            else if (timed) {\n                // \n                // \n                nanos = deadline - System.nanoTime();\n                if (nanos <= 0L) {\n                    removeWaiter(q);\n                    return state;\n                }\n                // 6. \n                LockSupport.parkNanos(this, nanos);\n            }\n            // 6. \n            else\n                LockSupport.park(this);\n        }\n    }\n\n\n    private void removeWaiter(WaitNode node) {\n        if (node != null) {\n            // threadnullthreadnullnode\n            node.thread = null;\n            // \n            retry:\n            for (;;) {          // restart on removeWaiter race\n                for (WaitNode pred = null, q = waiters, s; q != null; q = s) {\n                    s = q.next;\n                    // q.thread != nullq\n                    if (q.thread != null)\n                        pred = q;\n                    // q.thread == nullpred != nullq\n                    else if (pred != null) {\n                        // q\n                        pred.next = s;\n                         // pred.thread == null\n                         // for\n                        if (pred.thread == null) // check for race\n                            continue retry;\n                    }\n                     // q.thread != nullpred == nullq\n                     // s\n                    else if (!UNSAFE.compareAndSwapObject(this, waitersOffset,\n                                                          q, s))\n                        continue retry;\n                }\n                break;\n            }\n        }\n    }\n\n    // Unsafe mechanics\n    private static final sun.misc.Unsafe UNSAFE;\n    private static final long stateOffset;\n    private static final long runnerOffset;\n    private static final long waitersOffset;\n    static {\n        try {\n            UNSAFE = sun.misc.Unsafe.getUnsafe();\n            Class<?> k = FutureTask.class;\n            stateOffset = UNSAFE.objectFieldOffset\n                (k.getDeclaredField(\"state\"));\n            runnerOffset = UNSAFE.objectFieldOffset\n                (k.getDeclaredField(\"runner\"));\n            waitersOffset = UNSAFE.objectFieldOffset\n                (k.getDeclaredField(\"waiters\"));\n        } catch (Exception e) {\n            throw new Error(e);\n        }\n    }\n\n}\n\n```\n## \n\n\n* prestartCoreThread()\n* prestartAllCoreThreads()\n\n## \nThreadPoolExecutor\n* shutdown()\n* shutdownNow()\n\n## \n1. \n    1. CPUCPU NCPU+1\n    2. IO2*NCPU\n2. (+CPU/CPU * CPU\n3. \n\n## \n\n**workQueue**BlockingQueue BlockingQueuejava.util.concurrent BlockingQueue \n* ArrayBlockingQueueArrayBlockingQueue ()\n* LinkedBlockingQueueLinkedBlockingQueue () Integer.MAX_VALUE \n* DelayQueueDelayQueue  java.util.concurrent.Delayed \n* PriorityBlockingQueuePriorityBlockingQueue  java.util.PriorityQueue  null  PriorityBlockingQueue  java.lang.Comparable  Comparable \n* SynchronousQueueSynchronousQueue \n\n\n## \n1. \n2.  execute() \n     1.  corePoolSize\n     2.  corePoolSize\n     3.  maximumPoolSize\n     4.  maximumPoolSizeRejectExecutionException\n     5. \n     6. keepAliveTime corePoolSize corePoolSize \n\n","source":"_posts/Java-ThreadPool.md","raw":"---\ntitle: JAVA-\ndate: 2019-10-21 17:23:04\ntags:\n    - JAVA\n    - \n    - \ncategories: JAVA\nauthor: Guyuqing\ncopyright: true\ncomments: false\n---\n# \n\n#### \nLight Weight Process     \n<!-- more -->\n#### \n\n* Thread\n* Runnablerun()new Thread(runnable).start()run\n* Callablecall()FutureTaskCallableFutureTaskThreadtarger\n       Runnable  Callable \n        1. RunnablerunCallablecall\n        2. RunnableCallable\n        3. runcall\n        4. CallableFutureFutureget()get()get()\n* Executors executor servicesRunnableCallableThreadPoolExecutorScheduledThreadPoolExecutor\n      1. public static ExecutorService newCachedThreadPool() \n      2. public static ExecutorService newFixedThreadPool(int nThreads)  \n      3. public static ExecutorService newSingleThreadExecutor() (FIFO, LIFO, )\n      4. public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) \n      5. public static ExecutorService newWorkStealingPool() CPUForkJoinPoolCPU\n\n#### \n* ForkJoinPool (WorkQueue)(ForkJoinTask)\n  * (fork())LIFO\n  * (pool)FIFO\n  * join()join\n* ExecutorCompletionService (BlockingQueue), , take()FutureTask\n\n# \n\n## ThreadPoolExecutor\n\n```java\n    public ThreadPoolExecutor(int corePoolSize,\n                              int maximumPoolSize,\n                              long keepAliveTime,\n                              TimeUnit unit,\n                              BlockingQueue<Runnable> workQueue,\n                              ThreadFactory threadFactory,\n                              RejectedExecutionHandler handler) {\n        if (corePoolSize < 0 ||\n            maximumPoolSize <= 0 ||\n            maximumPoolSize < corePoolSize ||\n            keepAliveTime < 0)\n            throw new IllegalArgumentException();\n        if (workQueue == null || threadFactory == null || handler == null)\n            throw new NullPointerException();\n        this.acc = System.getSecurityManager() == null ?\n                null :\n                AccessController.getContext();\n        this.corePoolSize = corePoolSize;\n        this.maximumPoolSize = maximumPoolSize;\n        this.workQueue = workQueue;\n        this.keepAliveTime = unit.toNanos(keepAliveTime);\n        this.threadFactory = threadFactory;\n        this.handler = handler;\n    }\n```\n\n\n* corePoolSize exectue()\n        1.  corePoolSize\n        2.  corePoolSize  maximumPoolSizeworkQueue\n        3. corePoolSize  maximumPoolSizeworkQueueworkQueueworkQueue\n        4. maximumPoolSizeworkQueuehandler\n        5.  corePoolSize > workQueue > maximumPoolSize\n* maximumPoolSize \n* keepAliveTime corePoolSizekeepAliveTime\n* workQueue , :\n  * ****SynchronousQueue\n  * ****LinkedBlockingQueuecorePoolSizemaximumPoolSizeRUNNING\n  * ****ArrayBlockingQueuemaximumPoolSize\n* threadFactory ThreadFactoryExecutors.defaultThreadFactory() ThreadFactoryNORM_PRIORITY\n* handler RejectedExecutionHandler4\n  * AbortPolicy\n  * CallerRunsPolicy\n  * DiscardOldestPolicy\n  * DiscardPolicy\n\n## \n\n### \n\n#### execute\n```java\n    public void execute(Runnable command) {\n        if (command == null)\n            throw new NullPointerException();\n        \n        // cltrunStateworkerCount\n        int c = ctl.get();\n        \n        // workerCountOf29\n        // corePoolSize\n        if (workerCountOf(c) < corePoolSize) {\n            \n            // addWorkercorePoolSizemaximumPoolSize\n            // truecorePoolSize\n            // falsemaximumPoolSize\n            if (addWorker(command, true))\n                return;\n            \n            // ctl\n            c = ctl.get();\n        }\n        \n        //   \n        if (isRunning(c) && workQueue.offer(command)) {\n            \n            // ctl\n            int recheck = ctl.get();\n            \n            // commandworkQueue\n            // command\n            // handler\n            if (! isRunning(recheck) && remove(command))\n                reject(command);\n            \n            // 0addWorker\n            // 1. null\n            // 2. falsemaximumPoolSizemaximumPoolSize\n            // workerCount0workQueuecommand\n            else if (workerCountOf(recheck) == 0)\n                addWorker(null, false);\n        }\n        // \n        // 1.RUNNING\n        // 2.RUNNINGworkerCount >= corePoolSizeworkQueue;\n        // addWorkerfalsemaximumPoolSize\n        //  \n        else if (!addWorker(command, false))\n            reject(command);\n    }\n\n```\n\nrunStateworkCountinthttps://blog.csdn.net/weixin_34396902/article/details/94527424\n\n#### addWorker\n\n```java\n    private boolean addWorker(Runnable firstTask, boolean core) {\n        // CAS+1\n        retry:\n        for (;;) {\n            \n            // cltrunStateworkerCount\n            int c = ctl.get();\n            \n            // \n            int rs = runStateOf(c);\n\n            // rs >= SHUTDOWN\n            // 31false\n            // 1. rs == SHUTDOWN\n            // 2. firsTask\n            // 3. \n            //\n            // rs == SHUTDOWN\n            // firstTaskfalse\n            // firstTaskworkQueuefalse\n            if (rs >= SHUTDOWN &&\n                ! (rs == SHUTDOWN &&\n                   firstTask == null &&\n                   ! workQueue.isEmpty()))\n                return false;\n\n            for (;;) {\n                // \n                int wc = workerCountOf(c);\n                \n                // wcCAPACITY(),ctl29291false\n                // coreaddWorker,truecorePoolSizefalsemaximumPoolSize;\n                if (wc >= CAPACITY ||\n                    wc >= (core ? corePoolSize : maximumPoolSize))\n                    return false;\n                \n                // CASworkerCountclt+1for\n                if (compareAndIncrementWorkerCount(c))\n                    break retry;\n                \n                // workerCountctl\n                c = ctl.get();  \n                // rsfor\n                if (runStateOf(c) != rs)\n                    continue retry;\n            }\n        }\n\n        // workers\n        boolean workerStarted = false;\n        boolean workerAdded = false;\n        Worker w = null;\n        try {\n            // firstTaskWorker\n            w = new Worker(firstTask);\n            \n            // Worker\n            final Thread t = w.thread;\n            \n            \n            if (t != null) {\n                // workers\n                final ReentrantLock mainLock = this.mainLock;\n                mainLock.lock();\n                try {\n                    // \n                    int rs = runStateOf(ctl.get());\n                    \n                    // rs < SHUTDOWNRUNNING\n                    // rsRUNNINGrsSHUTDOWNfirstTasknull\n                    // SHUTDOWNworkQueue\n                    if (rs < SHUTDOWN ||\n                        (rs == SHUTDOWN && firstTask == null)) {\n                        // ,\n                        if (t.isAlive()) \n                            throw new IllegalThreadStateException();\n                        \n                        // workershashSet\n                        workers.add(w);\n                        int s = workers.size();\n                        \n                        // largestPoolSize\n                        if (s > largestPoolSize)\n                            largestPoolSize = s;\n                        //\n                        workerAdded = true;\n                    }\n                } finally {\n                    mainLock.unlock();\n                }\n                if (workerAdded) {\n                    // \n                    t.start();\n                    // \n                    workerStarted = true;\n                }\n            }\n        } finally {\n            // startaddWorkerFailed\n            // clt\n            if (! workerStarted)\n                addWorkerFailed(w);\n        }\n        return workerStarted;\n    }\n\n```\nt.start()WorkerrunWorkerRunnableWorker\n\n#### Worker\n\n```java\n    private final class Worker extends AbstractQueuedSynchronizer implements Runnable\n    {\n\n        private static final long serialVersionUID = 6138294804551838833L;\n\n        /**  **/\n        final Thread thread;\n        /** thread runrun */\n        Runnable firstTask;\n        /**  */\n        volatile long completedTasks;\n\n        /**\n         * Creates with given first task and thread from ThreadFactory.\n         * @param firstTask the first task (null if none)\n         */\n        Worker(Runnable firstTask) {\n            setState(-1); // runWorker()interruptinterruptIfStarted() getState()>=0\n            this.firstTask = firstTask;\n            // \n            this.thread = getThreadFactory().newThread(this);\n        }\n\n        /** Delegates main run loop to outer runWorker  */\n        public void run() {\n            runWorker(this);\n        }\n\n        // Lock methods\n        //\n        // The value 0 represents the unlocked state.\n        // The value 1 represents the locked state.\n\n        protected boolean isHeldExclusively() {\n            return getState() != 0;\n        }\n\n        /**\n        * \n        */\n        protected boolean tryAcquire(int unused) {\n            //state01\n            if (compareAndSetState(0, 1)) {\n                //exclusiveOwnerThread=\n                setExclusiveOwnerThread(Thread.currentThread());\n                return true;\n            }\n            return false;\n        }\n\n        /**\n        * \n        */\n        protected boolean tryRelease(int unused) {\n            setExclusiveOwnerThread(null);\n            setState(0);\n            return true;\n        }\n\n        public void lock()        { acquire(1); }\n        public boolean tryLock()  { return tryAcquire(1); }\n        public void unlock()      { release(1); }\n        public boolean isLocked() { return isHeldExclusively(); }\n\n\n        /**\n        * \n        * shutdownNowworker\n        * workerworker\n        */\n        void interruptIfStarted() {\n            Thread t;\n            // state>=0t!=nullt\n            // new Worker()state==-1\n            if (getState() >= 0 && (t = thread) != null && !t.isInterrupted()) {\n                try {\n                    t.interrupt();\n                } catch (SecurityException ignore) {\n                }\n            }\n        }\n    }\n```\n\nWorkerAbstractQueuedSynchronizer,()workQueue.\nexecute(command)commandWorkerAQSTreadPoolExecutorshutdown()workerworkQueuegetTask()\n\n#### runWorker \n\nWorkerrunrunWorker.\n\n```java\n\n    final void runWorker(Worker w) {\n        Thread wt = Thread.currentThread();\n        \n        // \n        Runnable task = w.firstTask;\n        w.firstTask = null;\n        w.unlock(); // \n        \n         // \n        boolean completedAbruptly = true;\n        try {\n            \n            // taskgetTask\n            while (task != null || (task = getTask()) != null) {\n                w.lock();\n                // If pool is stopping, ensure thread is interrupted;\n                // if not, ensure thread is not interrupted.  This\n                // requires a recheck in second case to deal with\n                // shutdownNow race while clearing interrupt\n                // stopstop\n                // \n                if ((runStateAtLeast(ctl.get(), STOP) ||\n                     (Thread.interrupted() &&\n                      runStateAtLeast(ctl.get(), STOP))) &&\n                    !wt.isInterrupted())\n                    wt.interrupt();\n                try {\n                    //Hook\n                    beforeExecute(wt, task);\n                    Throwable thrown = null;\n                    try {\n                        //\n                        task.run();\n                    } catch (RuntimeException x) {\n                        thrown = x; throw x;\n                    } catch (Error x) {\n                        thrown = x; throw x;\n                    } catch (Throwable x) {\n                        thrown = x; throw new Error(x);\n                    } finally {\n                        //Hook\n                        afterExecute(task, thrown);\n                    }\n                } finally {\n                    //taskcompletedTasks++\n                    task = null;\n                    w.completedTasks++;\n                    w.unlock();\n                }\n            }\n            //\n            completedAbruptly = false;\n        } finally {\n            //Worker\n            processWorkerExit(w, completedAbruptly);\n        }\n    }\n\n```\n#### getTask \n\nrunWorkergetTask()\n\n```java\n    private Runnable getTask() {\n        // \n        boolean timedOut = false; // Did the last poll() time out?\n\n        for (;;) {\n            int c = ctl.get();\n            int rs = runStateOf(c);\n\n            // shutdown\n            // stopterminate\n            // -1null\n            if (rs >= SHUTDOWN && (rs >= STOP || workQueue.isEmpty())) {\n                decrementWorkerCount();\n                return null;\n            }\n\n            // \n            int wc = workerCountOf(c);\n\n            // timed\n            // allowCoreThreadTimeOutfalse\n            // wc > corePoolSize\n            // \n            boolean timed = allowCoreThreadTimeOut || wc > corePoolSize;\n\n            //   \n            //  1  \n            // workerCount1\n            if ((wc > maximumPoolSize || (timed && timedOut))\n                && (wc > 1 || workQueue.isEmpty())) {\n                if (compareAndDecrementWorkerCount(c))\n                    return null;\n                continue;\n            }\n\n            try {\n                //****\n                // timedtruepollkeepAliveTimenull\n                // taketake\n                Runnable r = timed ?\n                    workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) :\n                    workQueue.take();\n                if (r != null)\n                    return r;\n                \n                //  r == nulltimedOuttrue\n                timedOut = true;\n            } catch (InterruptedException retry) {\n                // timedOutfalse\n                timedOut = false;\n            }\n        }\n    }\n```\n### FutureTask\n\n```java\n\npublic class FutureTask<V> implements RunnableFuture<V> {\n\n    /**\n     * stateFutureTask7\n     * NEW:\n     * COMPLETING:outcome(outcome)NEWCOMPLETING\n     * NORMAL:outcomeCOMPLETINGNORMAL\n     * EXCEPTIONAL:outcomeCOMPLETINGEXCEPTIONAL\n     * CANCELLED:cancel(false)NEWCANCELLED\n     * INTERRUPTING: cancel(true)NEWINTERRUPTING\n     * INTERRUPTED:interrupt()INTERRUPTINGINTERRUPTED\n     * \n     * NEW -> COMPLETING -> NORMAL \n     * NEW -> COMPLETING -> EXCEPTIONAL \n     * NEW -> CANCELLED \n     * NEW -> INTERRUPTING -> INTERRUPTED \n     */\n    private volatile int state;\n    private static final int NEW          = 0;\n    private static final int COMPLETING   = 1;//\n    private static final int NORMAL       = 2;\n    private static final int EXCEPTIONAL  = 3;\n    private static final int CANCELLED    = 4;\n    private static final int INTERRUPTING = 5;\n    private static final int INTERRUPTED  = 6;\n\n    /** The underlying callable; nulled out after running */\n    private Callable<V> callable;\n    /** The result to return or exception to throw from get() */\n    private Object outcome; // non-volatile, protected by state reads/writes\n    /** callable **/\n    private volatile Thread runner;\n    /** TreiberStack */\n    private volatile WaitNode waiters;\n\n    @SuppressWarnings(\"unchecked\")\n    private V report(int s) throws ExecutionException {\n        // \n        Object x = outcome;\n        // \n        if (s == NORMAL)\n            // \n            return (V)x;\n        // \n        if (s >= CANCELLED)\n            throw new CancellationException();\n        throw new ExecutionException((Throwable)x);\n    }\n\n    /**\n     * \n     */\n    public FutureTask(Callable<V> callable) {\n        if (callable == null)\n            throw new NullPointerException();\n        this.callable = callable;\n        this.state = NEW;       // ensure visibility of callable\n    }\n\n    /**\n     * RunnableCallablecallableresult\n     * null\n     */\n    public FutureTask(Runnable runnable, V result) {\n        this.callable = Executors.callable(runnable, result);\n        this.state = NEW;       // ensure visibility of callable\n    }\n\n    //\n    public boolean isCancelled() {\n        return state >= CANCELLED;\n    }\n    //\n    public boolean isDone() {\n        return state != NEW;\n    }\n\n    public boolean cancel(boolean mayInterruptIfRunning) {\n        // 1. new  mayInterruptIfRunningNEWINTERRUPTINGCANCELLED \n        // false\n        if (!(state == NEW &&\n              UNSAFE.compareAndSwapInt(this, stateOffset, NEW,\n                  mayInterruptIfRunning ? INTERRUPTING : CANCELLED)))\n            return false;\n        try {    \n        // 2. \n            if (mayInterruptIfRunning) {\n                try {\n                    // runner\n                    Thread t = runner;\n                    if (t != null)\n                        //\n                        t.interrupt();\n                } finally { // final state\n                    // INTERRUPTED\n                    UNSAFE.putOrderedInt(this, stateOffset, INTERRUPTED);\n                }\n            }\n        } finally {\n            finishCompletion();\n        }\n        return true;\n    }\n\n\n    public V get() throws InterruptedException, ExecutionException {\n        int s = state;\n        // state <= COMPLETING\n        if (s <= COMPLETING)\n            // ()\n            // awaitDone()\n            s = awaitDone(false, 0L);\n        // report()\n        return report(s);\n    }\n\n\n    public V get(long timeout, TimeUnit unit)\n        throws InterruptedException, ExecutionException, TimeoutException {\n        if (unit == null)\n            throw new NullPointerException();\n        int s = state;\n        // awaitDone()\n        if (s <= COMPLETING &&\n            (s = awaitDone(true, unit.toNanos(timeout))) <= COMPLETING)\n            throw new TimeoutException();\n        return report(s);\n    }\n\n\n    protected void done() { }\n\n\n    protected void set(V v) {\n        // CASNEWCOMPLETING()\n        if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {\n            // outcome\n            outcome = v;\n            // CASCOMPLETINGNORMAL\n            UNSAFE.putOrderedInt(this, stateOffset, NORMAL); // final state\n            finishCompletion();\n        }\n    }\n\n\n    protected void setException(Throwable t) {\n        // CASNEWCOMPLETING()\n        if (UNSAFE.compareAndSwapInt(this, stateOffset, NEW, COMPLETING)) {\n            // outcomeoutcome\n            outcome = t;\n            // CASCOMPLETINGEXCEPTIONAL\n            UNSAFE.putOrderedInt(this, stateOffset, EXCEPTIONAL); // final state\n            finishCompletion();\n        }\n    }\n\n\n    public void run() {\n        // NEW\n        // NEWrunner(runnerOffset)\n        if (state != NEW ||\n            !UNSAFE.compareAndSwapObject(this, runnerOffset,\n                                         null, Thread.currentThread()))\n            return;\n        try {\n            Callable<V> c = callable;\n            // \n            if (c != null && state == NEW) {\n                V result;\n                boolean ran;\n                try {\n                    //   \n                    result = c.call();\n                    ran = true;\n                } catch (Throwable ex) {\n                    result = null;\n                    ran = false;\n                    // \n                    setException(ex);\n                }\n                if (ran)\n                    // \n                    set(result);\n            }\n        } finally {\n            // runnernull\n            runner = null;\n            // state must be re-read after nulling runner to prevent\n            // leaked interrupts\n            int s = state;\n            // \n            if (s >= INTERRUPTING)\n                handlePossibleCancellationInterrupt(s);\n        }\n    }\n\n    /**\n     * run\n     *\n     * @return {@code true} if successfully run and reset\n     */\n    protected boolean runAndReset() {\n        if (state != NEW ||\n            !UNSAFE.compareAndSwapObject(this, runnerOffset,\n                                         null, Thread.currentThread()))\n            return false;\n        boolean ran = false;\n        int s = state;\n        try {\n            Callable<V> c = callable;\n            if (c != null && s == NEW) {\n                try {\n                    // \n                    c.call(); // don't set result\n                    ran = true;\n                } catch (Throwable ex) {\n                    setException(ex);\n                }\n            }\n        } finally {\n\n            runner = null;\n            s = state;\n            if (s >= INTERRUPTING)\n                handlePossibleCancellationInterrupt(s);\n        }\n        // \n        return ran && s == NEW;\n    }\n\n\n    private void handlePossibleCancellationInterrupt(int s) {\n        if (s == INTERRUPTING)\n            while (state == INTERRUPTING)\n                Thread.yield(); // wait out pending interrupt\n\n        // cancel(true)runrunAndReset\n        //Thread.yield()cancelINTERRUPTED\n    }\n\n    /**\n     * Simple linked list nodes to record waiting threads in a Treiber\n     * stack.  See other classes such as Phaser and SynchronousQueue\n     * for more detailed explanation.\n     */\n    static final class WaitNode {\n        volatile Thread thread;\n        volatile WaitNode next;\n        WaitNode() { thread = Thread.currentThread(); }\n    }\n\n    /**\n     * Removes and signals all waiting threads, invokes done(), and\n     * nulls out callable.\n     */\n    private void finishCompletion() {\n        // assert state > COMPLETING;\n        // stateCOMPLETING\n        // waiters\n        for (WaitNode q; (q = waiters) != null;) {\n            // null\n            if (UNSAFE.compareAndSwapObject(this, waitersOffset, q, null)) {\n                for (;;) {\n                    Thread t = q.thread;\n                    if (t != null) {\n                        q.thread = null;\n                        // \n                        LockSupport.unpark(t);\n                    }\n                    WaitNode next = q.next;\n                    // next\n                    if (next == null)\n                        break;\n                    // gc\n                    q.next = null; \n                    // node\n                    q = next;\n                }\n                break;\n            }\n        }\n        // \n        done();\n\n        callable = null;        // to reduce footprint\n    }\n\n    /**\n     * Awaits completion or aborts on interrupt or timeout.\n     *\n     * @param timed true if use timed waits\n     * @param nanos time to wait, if timed\n     * @return state upon completion\n     */\n    private int awaitDone(boolean timed, long nanos)\n        throws InterruptedException {\n        // \n        final long deadline = timed ? System.nanoTime() + nanos : 0L;\n        WaitNode q = null;\n        boolean queued = false;\n        for (;;) {\n            // 1. \n            if (Thread.interrupted()) {\n                // \n                removeWaiter(q);\n                // InterruptedException\n                throw new InterruptedException();\n            }\n\n            int s = state;\n            // 2. COMPLETING\n            if (s > COMPLETING) {\n                // ()\n                if (q != null)\n                    // thread\n                    q.thread = null;\n                // \n                return s;\n            }\n            // 3. COMPLETING\n            // outcome\n            else if (s == COMPLETING) // cannot time out yet\n                Thread.yield();// \n            // 4. \n            else if (q == null)\n                q = new WaitNode();\n            // 5. waiterswaiters\n            else if (!queued)\n                queued = UNSAFE.compareAndSwapObject(this, waitersOffset,\n                                                     q.next = waiters, q);\n            else if (timed) {\n                // \n                // \n                nanos = deadline - System.nanoTime();\n                if (nanos <= 0L) {\n                    removeWaiter(q);\n                    return state;\n                }\n                // 6. \n                LockSupport.parkNanos(this, nanos);\n            }\n            // 6. \n            else\n                LockSupport.park(this);\n        }\n    }\n\n\n    private void removeWaiter(WaitNode node) {\n        if (node != null) {\n            // threadnullthreadnullnode\n            node.thread = null;\n            // \n            retry:\n            for (;;) {          // restart on removeWaiter race\n                for (WaitNode pred = null, q = waiters, s; q != null; q = s) {\n                    s = q.next;\n                    // q.thread != nullq\n                    if (q.thread != null)\n                        pred = q;\n                    // q.thread == nullpred != nullq\n                    else if (pred != null) {\n                        // q\n                        pred.next = s;\n                         // pred.thread == null\n                         // for\n                        if (pred.thread == null) // check for race\n                            continue retry;\n                    }\n                     // q.thread != nullpred == nullq\n                     // s\n                    else if (!UNSAFE.compareAndSwapObject(this, waitersOffset,\n                                                          q, s))\n                        continue retry;\n                }\n                break;\n            }\n        }\n    }\n\n    // Unsafe mechanics\n    private static final sun.misc.Unsafe UNSAFE;\n    private static final long stateOffset;\n    private static final long runnerOffset;\n    private static final long waitersOffset;\n    static {\n        try {\n            UNSAFE = sun.misc.Unsafe.getUnsafe();\n            Class<?> k = FutureTask.class;\n            stateOffset = UNSAFE.objectFieldOffset\n                (k.getDeclaredField(\"state\"));\n            runnerOffset = UNSAFE.objectFieldOffset\n                (k.getDeclaredField(\"runner\"));\n            waitersOffset = UNSAFE.objectFieldOffset\n                (k.getDeclaredField(\"waiters\"));\n        } catch (Exception e) {\n            throw new Error(e);\n        }\n    }\n\n}\n\n```\n## \n\n\n* prestartCoreThread()\n* prestartAllCoreThreads()\n\n## \nThreadPoolExecutor\n* shutdown()\n* shutdownNow()\n\n## \n1. \n    1. CPUCPU NCPU+1\n    2. IO2*NCPU\n2. (+CPU/CPU * CPU\n3. \n\n## \n\n**workQueue**BlockingQueue BlockingQueuejava.util.concurrent BlockingQueue \n* ArrayBlockingQueueArrayBlockingQueue ()\n* LinkedBlockingQueueLinkedBlockingQueue () Integer.MAX_VALUE \n* DelayQueueDelayQueue  java.util.concurrent.Delayed \n* PriorityBlockingQueuePriorityBlockingQueue  java.util.PriorityQueue  null  PriorityBlockingQueue  java.lang.Comparable  Comparable \n* SynchronousQueueSynchronousQueue \n\n\n## \n1. \n2.  execute() \n     1.  corePoolSize\n     2.  corePoolSize\n     3.  maximumPoolSize\n     4.  maximumPoolSizeRejectExecutionException\n     5. \n     6. keepAliveTime corePoolSize corePoolSize \n\n","slug":"Java-ThreadPool","published":1,"updated":"2019-12-13T11:13:27.644Z","layout":"post","photos":[],"link":"","_id":"ck4859yg20053t0fy2bdu8e0b","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Light Weight Process     </p>\n<a id=\"more\"></a>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>Thread</li>\n<li>Runnablerun()new Thread(runnable).start()run</li>\n<li>Callablecall()FutureTaskCallableFutureTaskThreadtarger<pre><code>Runnable  Callable \n 1. RunnablerunCallablecall\n 2. RunnableCallable\n 3. runcall\n 4. CallableFutureFutureget()get()get()</code></pre></li>\n<li>Executors executor servicesRunnableCallableThreadPoolExecutorScheduledThreadPoolExecutor<pre><code>1. public static ExecutorService newCachedThreadPool() \n2. public static ExecutorService newFixedThreadPool(int nThreads)  \n3. public static ExecutorService newSingleThreadExecutor() (FIFO, LIFO, )\n4. public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) \n5. public static ExecutorService newWorkStealingPool() CPUForkJoinPoolCPU</code></pre></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>ForkJoinPool (WorkQueue)(ForkJoinTask)<ul>\n<li>(fork())LIFO</li>\n<li>(pool)FIFO</li>\n<li>join()join</li>\n</ul>\n</li>\n<li>ExecutorCompletionService (BlockingQueue), , take()FutureTask</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"ThreadPoolExecutor\"><a href=\"#ThreadPoolExecutor\" class=\"headerlink\" title=\"ThreadPoolExecutor\"></a>ThreadPoolExecutor</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ThreadPoolExecutor</span><span class=\"params\">(<span class=\"keyword\">int</span> corePoolSize,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          <span class=\"keyword\">int</span> maximumPoolSize,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          <span class=\"keyword\">long</span> keepAliveTime,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          TimeUnit unit,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          ThreadFactory threadFactory,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          RejectedExecutionHandler handler)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (corePoolSize &lt; <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt;= <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt; corePoolSize ||</span><br><span class=\"line\">        keepAliveTime &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workQueue == <span class=\"keyword\">null</span> || threadFactory == <span class=\"keyword\">null</span> || handler == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.acc = System.getSecurityManager() == <span class=\"keyword\">null</span> ?</span><br><span class=\"line\">            <span class=\"keyword\">null</span> :</span><br><span class=\"line\">            AccessController.getContext();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.corePoolSize = corePoolSize;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.workQueue = workQueue;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.threadFactory = threadFactory;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.handler = handler;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>corePoolSize exectue()<pre><code>1.  corePoolSize\n2.  corePoolSize  maximumPoolSizeworkQueue\n3. corePoolSize  maximumPoolSizeworkQueueworkQueueworkQueue\n4. maximumPoolSizeworkQueuehandler\n5.  corePoolSize &gt; workQueue &gt; maximumPoolSize</code></pre></li>\n<li>maximumPoolSize </li>\n<li>keepAliveTime corePoolSizekeepAliveTime</li>\n<li>workQueue , :<ul>\n<li><strong></strong>SynchronousQueue</li>\n<li><strong></strong>LinkedBlockingQueuecorePoolSizemaximumPoolSizeRUNNING</li>\n<li><strong></strong>ArrayBlockingQueuemaximumPoolSize</li>\n</ul>\n</li>\n<li>threadFactory ThreadFactoryExecutors.defaultThreadFactory() ThreadFactoryNORM_PRIORITY</li>\n<li>handler RejectedExecutionHandler4<ul>\n<li>AbortPolicy</li>\n<li>CallerRunsPolicy</li>\n<li>DiscardOldestPolicy</li>\n<li>DiscardPolicy</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"execute\"><a href=\"#execute\" class=\"headerlink\" title=\"execute\"></a>execute</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">execute</span><span class=\"params\">(Runnable command)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (command == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// cltrunStateworkerCount</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = ctl.get();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// workerCountOf29</span></span><br><span class=\"line\">    <span class=\"comment\">// corePoolSize</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// addWorkercorePoolSizemaximumPoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// truecorePoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// falsemaximumPoolSize</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (addWorker(command, <span class=\"keyword\">true</span>))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// ctl</span></span><br><span class=\"line\">        c = ctl.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//   </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// ctl</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> recheck = ctl.get();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// commandworkQueue</span></span><br><span class=\"line\">        <span class=\"comment\">// command</span></span><br><span class=\"line\">        <span class=\"comment\">// handler</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class=\"line\">            reject(command);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 0addWorker</span></span><br><span class=\"line\">        <span class=\"comment\">// 1. null</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. falsemaximumPoolSizemaximumPoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// workerCount0workQueuecommand</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (workerCountOf(recheck) == <span class=\"number\">0</span>)</span><br><span class=\"line\">            addWorker(<span class=\"keyword\">null</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// 1.RUNNING</span></span><br><span class=\"line\">    <span class=\"comment\">// 2.RUNNINGworkerCount &gt;= corePoolSizeworkQueue;</span></span><br><span class=\"line\">    <span class=\"comment\">// addWorkerfalsemaximumPoolSize</span></span><br><span class=\"line\">    <span class=\"comment\">//  </span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!addWorker(command, <span class=\"keyword\">false</span>))</span><br><span class=\"line\">        reject(command);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>runStateworkCountint<a href=\"https://blog.csdn.net/weixin_34396902/article/details/94527424\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/weixin_34396902/article/details/94527424</a></p>\n<h4 id=\"addWorker\"><a href=\"#addWorker\" class=\"headerlink\" title=\"addWorker\"></a>addWorker</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">addWorker</span><span class=\"params\">(Runnable firstTask, <span class=\"keyword\">boolean</span> core)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// CAS+1</span></span><br><span class=\"line\">    retry:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// cltrunStateworkerCount</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> c = ctl.get();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> rs = runStateOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// rs &gt;= SHUTDOWN</span></span><br><span class=\"line\">        <span class=\"comment\">// 31false</span></span><br><span class=\"line\">        <span class=\"comment\">// 1. rs == SHUTDOWN</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. firsTask</span></span><br><span class=\"line\">        <span class=\"comment\">// 3. </span></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"comment\">// rs == SHUTDOWN</span></span><br><span class=\"line\">        <span class=\"comment\">// firstTaskfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// firstTaskworkQueuefalse</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs &gt;= SHUTDOWN &amp;&amp;</span><br><span class=\"line\">            ! (rs == SHUTDOWN &amp;&amp;</span><br><span class=\"line\">               firstTask == <span class=\"keyword\">null</span> &amp;&amp;</span><br><span class=\"line\">               ! workQueue.isEmpty()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> wc = workerCountOf(c);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// wcCAPACITY(),ctl29291false</span></span><br><span class=\"line\">            <span class=\"comment\">// coreaddWorker,truecorePoolSizefalsemaximumPoolSize;</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (wc &gt;= CAPACITY ||</span><br><span class=\"line\">                wc &gt;= (core ? corePoolSize : maximumPoolSize))</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// CASworkerCountclt+1for</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (compareAndIncrementWorkerCount(c))</span><br><span class=\"line\">                <span class=\"keyword\">break</span> retry;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// workerCountctl</span></span><br><span class=\"line\">            c = ctl.get();  </span><br><span class=\"line\">            <span class=\"comment\">// rsfor</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (runStateOf(c) != rs)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// workers</span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> workerStarted = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> workerAdded = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    Worker w = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// firstTaskWorker</span></span><br><span class=\"line\">        w = <span class=\"keyword\">new</span> Worker(firstTask);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// Worker</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> Thread t = w.thread;</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// workers</span></span><br><span class=\"line\">            <span class=\"keyword\">final</span> ReentrantLock mainLock = <span class=\"keyword\">this</span>.mainLock;</span><br><span class=\"line\">            mainLock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">int</span> rs = runStateOf(ctl.get());</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// rs &lt; SHUTDOWNRUNNING</span></span><br><span class=\"line\">                <span class=\"comment\">// rsRUNNINGrsSHUTDOWNfirstTasknull</span></span><br><span class=\"line\">                <span class=\"comment\">// SHUTDOWNworkQueue</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (rs &lt; SHUTDOWN ||</span><br><span class=\"line\">                    (rs == SHUTDOWN &amp;&amp; firstTask == <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// ,</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t.isAlive()) </span><br><span class=\"line\">                        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalThreadStateException();</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"comment\">// workershashSet</span></span><br><span class=\"line\">                    workers.add(w);</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> s = workers.size();</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"comment\">// largestPoolSize</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (s &gt; largestPoolSize)</span><br><span class=\"line\">                        largestPoolSize = s;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    workerAdded = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                mainLock.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (workerAdded) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                t.start();</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                workerStarted = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// startaddWorkerFailed</span></span><br><span class=\"line\">        <span class=\"comment\">// clt</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! workerStarted)</span><br><span class=\"line\">            addWorkerFailed(w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> workerStarted;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t.start()WorkerrunWorkerRunnableWorker</p>\n<h4 id=\"Worker\"><a href=\"#Worker\" class=\"headerlink\" title=\"Worker\"></a>Worker</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Worker</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractQueuedSynchronizer</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6138294804551838833L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**  **/</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> Thread thread;</span><br><span class=\"line\">    <span class=\"comment\">/** thread runrun */</span></span><br><span class=\"line\">    Runnable firstTask;</span><br><span class=\"line\">    <span class=\"comment\">/**  */</span></span><br><span class=\"line\">    <span class=\"keyword\">volatile</span> <span class=\"keyword\">long</span> completedTasks;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Creates with given first task and thread from ThreadFactory.</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> firstTask the first task (null if none)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Worker(Runnable firstTask) &#123;</span><br><span class=\"line\">        setState(-<span class=\"number\">1</span>); <span class=\"comment\">// runWorker()interruptinterruptIfStarted() getState()&gt;=0</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.firstTask = firstTask;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.thread = getThreadFactory().newThread(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Delegates main run loop to outer runWorker  */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        runWorker(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Lock methods</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">// The value 0 represents the unlocked state.</span></span><br><span class=\"line\">    <span class=\"comment\">// The value 1 represents the locked state.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isHeldExclusively</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getState() != <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryAcquire</span><span class=\"params\">(<span class=\"keyword\">int</span> unused)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//state01</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (compareAndSetState(<span class=\"number\">0</span>, <span class=\"number\">1</span>)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//exclusiveOwnerThread=</span></span><br><span class=\"line\">            setExclusiveOwnerThread(Thread.currentThread());</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryRelease</span><span class=\"params\">(<span class=\"keyword\">int</span> unused)</span> </span>&#123;</span><br><span class=\"line\">        setExclusiveOwnerThread(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        setState(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">lock</span><span class=\"params\">()</span>        </span>&#123; acquire(<span class=\"number\">1</span>); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryLock</span><span class=\"params\">()</span>  </span>&#123; <span class=\"keyword\">return</span> tryAcquire(<span class=\"number\">1</span>); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">unlock</span><span class=\"params\">()</span>      </span>&#123; release(<span class=\"number\">1</span>); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isLocked</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> isHeldExclusively(); &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    * shutdownNowworker</span></span><br><span class=\"line\"><span class=\"comment\">    * workerworker</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">interruptIfStarted</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Thread t;</span><br><span class=\"line\">        <span class=\"comment\">// state&gt;=0t!=nullt</span></span><br><span class=\"line\">        <span class=\"comment\">// new Worker()state==-1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (getState() &gt;= <span class=\"number\">0</span> &amp;&amp; (t = thread) != <span class=\"keyword\">null</span> &amp;&amp; !t.isInterrupted()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                t.interrupt();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SecurityException ignore) &#123;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>WorkerAbstractQueuedSynchronizer,()workQueue.<br>execute(command)commandWorkerAQSTreadPoolExecutorshutdown()workerworkQueuegetTask()</p>\n<h4 id=\"runWorker-\"><a href=\"#runWorker-\" class=\"headerlink\" title=\"runWorker \"></a>runWorker </h4><p>WorkerrunrunWorker.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">runWorker</span><span class=\"params\">(Worker w)</span> </span>&#123;</span><br><span class=\"line\">    Thread wt = Thread.currentThread();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Runnable task = w.firstTask;</span><br><span class=\"line\">    w.firstTask = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    w.unlock(); <span class=\"comment\">// </span></span><br><span class=\"line\">    </span><br><span class=\"line\">     <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> completedAbruptly = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// taskgetTask</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (task != <span class=\"keyword\">null</span> || (task = getTask()) != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            w.lock();</span><br><span class=\"line\">            <span class=\"comment\">// If pool is stopping, ensure thread is interrupted;</span></span><br><span class=\"line\">            <span class=\"comment\">// if not, ensure thread is not interrupted.  This</span></span><br><span class=\"line\">            <span class=\"comment\">// requires a recheck in second case to deal with</span></span><br><span class=\"line\">            <span class=\"comment\">// shutdownNow race while clearing interrupt</span></span><br><span class=\"line\">            <span class=\"comment\">// stopstop</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((runStateAtLeast(ctl.get(), STOP) ||</span><br><span class=\"line\">                 (Thread.interrupted() &amp;&amp;</span><br><span class=\"line\">                  runStateAtLeast(ctl.get(), STOP))) &amp;&amp;</span><br><span class=\"line\">                !wt.isInterrupted())</span><br><span class=\"line\">                wt.interrupt();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//Hook</span></span><br><span class=\"line\">                beforeExecute(wt, task);</span><br><span class=\"line\">                Throwable thrown = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    task.run();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (RuntimeException x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Error x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(x);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//Hook</span></span><br><span class=\"line\">                    afterExecute(task, thrown);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//taskcompletedTasks++</span></span><br><span class=\"line\">                task = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                w.completedTasks++;</span><br><span class=\"line\">                w.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        completedAbruptly = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//Worker</span></span><br><span class=\"line\">        processWorkerExit(w, completedAbruptly);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getTask-\"><a href=\"#getTask-\" class=\"headerlink\" title=\"getTask \"></a>getTask </h4><p>runWorkergetTask()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> Runnable <span class=\"title\">getTask</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> timedOut = <span class=\"keyword\">false</span>; <span class=\"comment\">// Did the last poll() time out?</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> c = ctl.get();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> rs = runStateOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// shutdown</span></span><br><span class=\"line\">        <span class=\"comment\">// stopterminate</span></span><br><span class=\"line\">        <span class=\"comment\">// -1null</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs &gt;= SHUTDOWN &amp;&amp; (rs &gt;= STOP || workQueue.isEmpty())) &#123;</span><br><span class=\"line\">            decrementWorkerCount();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> wc = workerCountOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// timed</span></span><br><span class=\"line\">        <span class=\"comment\">// allowCoreThreadTimeOutfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// wc &gt; corePoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> timed = allowCoreThreadTimeOut || wc &gt; corePoolSize;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//   </span></span><br><span class=\"line\">        <span class=\"comment\">//  1  </span></span><br><span class=\"line\">        <span class=\"comment\">// workerCount1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut))</span><br><span class=\"line\">            &amp;&amp; (wc &gt; <span class=\"number\">1</span> || workQueue.isEmpty())) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (compareAndDecrementWorkerCount(c))</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//****</span></span><br><span class=\"line\">            <span class=\"comment\">// timedtruepollkeepAliveTimenull</span></span><br><span class=\"line\">            <span class=\"comment\">// taketake</span></span><br><span class=\"line\">            Runnable r = timed ?</span><br><span class=\"line\">                workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) :</span><br><span class=\"line\">                workQueue.take();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">//  r == nulltimedOuttrue</span></span><br><span class=\"line\">            timedOut = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException retry) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// timedOutfalse</span></span><br><span class=\"line\">            timedOut = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"FutureTask\"><a href=\"#FutureTask\" class=\"headerlink\" title=\"FutureTask\"></a>FutureTask</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FutureTask</span>&lt;<span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">RunnableFuture</span>&lt;<span class=\"title\">V</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * stateFutureTask7</span></span><br><span class=\"line\"><span class=\"comment\">     * NEW:</span></span><br><span class=\"line\"><span class=\"comment\">     * COMPLETING:outcome(outcome)NEWCOMPLETING</span></span><br><span class=\"line\"><span class=\"comment\">     * NORMAL:outcomeCOMPLETINGNORMAL</span></span><br><span class=\"line\"><span class=\"comment\">     * EXCEPTIONAL:outcomeCOMPLETINGEXCEPTIONAL</span></span><br><span class=\"line\"><span class=\"comment\">     * CANCELLED:cancel(false)NEWCANCELLED</span></span><br><span class=\"line\"><span class=\"comment\">     * INTERRUPTING: cancel(true)NEWINTERRUPTING</span></span><br><span class=\"line\"><span class=\"comment\">     * INTERRUPTED:interrupt()INTERRUPTINGINTERRUPTED</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; COMPLETING -&gt; NORMAL </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; COMPLETING -&gt; EXCEPTIONAL </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; CANCELLED </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; INTERRUPTING -&gt; INTERRUPTED </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> state;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> NEW          = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> COMPLETING   = <span class=\"number\">1</span>;<span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> NORMAL       = <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> EXCEPTIONAL  = <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> CANCELLED    = <span class=\"number\">4</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> INTERRUPTING = <span class=\"number\">5</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> INTERRUPTED  = <span class=\"number\">6</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** The underlying callable; nulled out after running */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Callable&lt;V&gt; callable;</span><br><span class=\"line\">    <span class=\"comment\">/** The result to return or exception to throw from get() */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object outcome; <span class=\"comment\">// non-volatile, protected by state reads/writes</span></span><br><span class=\"line\">    <span class=\"comment\">/** callable **/</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> Thread runner;</span><br><span class=\"line\">    <span class=\"comment\">/** TreiberStack */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> WaitNode waiters;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> V <span class=\"title\">report</span><span class=\"params\">(<span class=\"keyword\">int</span> s)</span> <span class=\"keyword\">throws</span> ExecutionException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Object x = outcome;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == NORMAL)</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> (V)x;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s &gt;= CANCELLED)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> CancellationException();</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ExecutionException((Throwable)x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">FutureTask</span><span class=\"params\">(Callable&lt;V&gt; callable)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (callable == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.callable = callable;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.state = NEW;       <span class=\"comment\">// ensure visibility of callable</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * RunnableCallablecallableresult</span></span><br><span class=\"line\"><span class=\"comment\">     * null</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">FutureTask</span><span class=\"params\">(Runnable runnable, V result)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.callable = Executors.callable(runnable, result);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.state = NEW;       <span class=\"comment\">// ensure visibility of callable</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isCancelled</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state &gt;= CANCELLED;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isDone</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state != NEW;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">cancel</span><span class=\"params\">(<span class=\"keyword\">boolean</span> mayInterruptIfRunning)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 1. new  mayInterruptIfRunningNEWINTERRUPTINGCANCELLED </span></span><br><span class=\"line\">        <span class=\"comment\">// false</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!(state == NEW &amp;&amp;</span><br><span class=\"line\">              UNSAFE.compareAndSwapInt(<span class=\"keyword\">this</span>, stateOffset, NEW,</span><br><span class=\"line\">                  mayInterruptIfRunning ? INTERRUPTING : CANCELLED)))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;    </span><br><span class=\"line\">        <span class=\"comment\">// 2. </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (mayInterruptIfRunning) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// runner</span></span><br><span class=\"line\">                    Thread t = runner;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        t.interrupt();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123; <span class=\"comment\">// final state</span></span><br><span class=\"line\">                    <span class=\"comment\">// INTERRUPTED</span></span><br><span class=\"line\">                    UNSAFE.putOrderedInt(<span class=\"keyword\">this</span>, stateOffset, INTERRUPTED);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            finishCompletion();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">get</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException, ExecutionException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">        <span class=\"comment\">// state &lt;= COMPLETING</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s &lt;= COMPLETING)</span><br><span class=\"line\">            <span class=\"comment\">// ()</span></span><br><span class=\"line\">            <span class=\"comment\">// awaitDone()</span></span><br><span class=\"line\">            s = awaitDone(<span class=\"keyword\">false</span>, <span class=\"number\">0L</span>);</span><br><span class=\"line\">        <span class=\"comment\">// report()</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> report(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">get</span><span class=\"params\">(<span class=\"keyword\">long</span> timeout, TimeUnit unit)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> InterruptedException, ExecutionException, TimeoutException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (unit == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">        <span class=\"comment\">// awaitDone()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s &lt;= COMPLETING &amp;&amp;</span><br><span class=\"line\">            (s = awaitDone(<span class=\"keyword\">true</span>, unit.toNanos(timeout))) &lt;= COMPLETING)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> TimeoutException();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> report(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">done</span><span class=\"params\">()</span> </span>&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(V v)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// CASNEWCOMPLETING()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (UNSAFE.compareAndSwapInt(<span class=\"keyword\">this</span>, stateOffset, NEW, COMPLETING)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// outcome</span></span><br><span class=\"line\">            outcome = v;</span><br><span class=\"line\">            <span class=\"comment\">// CASCOMPLETINGNORMAL</span></span><br><span class=\"line\">            UNSAFE.putOrderedInt(<span class=\"keyword\">this</span>, stateOffset, NORMAL); <span class=\"comment\">// final state</span></span><br><span class=\"line\">            finishCompletion();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">setException</span><span class=\"params\">(Throwable t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// CASNEWCOMPLETING()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (UNSAFE.compareAndSwapInt(<span class=\"keyword\">this</span>, stateOffset, NEW, COMPLETING)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// outcomeoutcome</span></span><br><span class=\"line\">            outcome = t;</span><br><span class=\"line\">            <span class=\"comment\">// CASCOMPLETINGEXCEPTIONAL</span></span><br><span class=\"line\">            UNSAFE.putOrderedInt(<span class=\"keyword\">this</span>, stateOffset, EXCEPTIONAL); <span class=\"comment\">// final state</span></span><br><span class=\"line\">            finishCompletion();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// NEW</span></span><br><span class=\"line\">        <span class=\"comment\">// NEWrunner(runnerOffset)</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state != NEW ||</span><br><span class=\"line\">            !UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, runnerOffset,</span><br><span class=\"line\">                                         <span class=\"keyword\">null</span>, Thread.currentThread()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Callable&lt;V&gt; c = callable;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"keyword\">null</span> &amp;&amp; state == NEW) &#123;</span><br><span class=\"line\">                V result;</span><br><span class=\"line\">                <span class=\"keyword\">boolean</span> ran;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//   </span></span><br><span class=\"line\">                    result = c.call();</span><br><span class=\"line\">                    ran = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">                    result = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    ran = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    setException(ex);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (ran)</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    set(result);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// runnernull</span></span><br><span class=\"line\">            runner = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            <span class=\"comment\">// state must be re-read after nulling runner to prevent</span></span><br><span class=\"line\">            <span class=\"comment\">// leaked interrupts</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (s &gt;= INTERRUPTING)</span><br><span class=\"line\">                handlePossibleCancellationInterrupt(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * run</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@code</span> true&#125; if successfully run and reset</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">runAndReset</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state != NEW ||</span><br><span class=\"line\">            !UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, runnerOffset,</span><br><span class=\"line\">                                         <span class=\"keyword\">null</span>, Thread.currentThread()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> ran = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Callable&lt;V&gt; c = callable;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"keyword\">null</span> &amp;&amp; s == NEW) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    c.call(); <span class=\"comment\">// don't set result</span></span><br><span class=\"line\">                    ran = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">                    setException(ex);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            runner = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            s = state;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (s &gt;= INTERRUPTING)</span><br><span class=\"line\">                handlePossibleCancellationInterrupt(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ran &amp;&amp; s == NEW;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">handlePossibleCancellationInterrupt</span><span class=\"params\">(<span class=\"keyword\">int</span> s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == INTERRUPTING)</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (state == INTERRUPTING)</span><br><span class=\"line\">                Thread.yield(); <span class=\"comment\">// wait out pending interrupt</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// cancel(true)runrunAndReset</span></span><br><span class=\"line\">        <span class=\"comment\">//Thread.yield()cancelINTERRUPTED</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Simple linked list nodes to record waiting threads in a Treiber</span></span><br><span class=\"line\"><span class=\"comment\">     * stack.  See other classes such as Phaser and SynchronousQueue</span></span><br><span class=\"line\"><span class=\"comment\">     * for more detailed explanation.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WaitNode</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">volatile</span> Thread thread;</span><br><span class=\"line\">        <span class=\"keyword\">volatile</span> WaitNode next;</span><br><span class=\"line\">        WaitNode() &#123; thread = Thread.currentThread(); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Removes and signals all waiting threads, invokes done(), and</span></span><br><span class=\"line\"><span class=\"comment\">     * nulls out callable.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">finishCompletion</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// assert state &gt; COMPLETING;</span></span><br><span class=\"line\">        <span class=\"comment\">// stateCOMPLETING</span></span><br><span class=\"line\">        <span class=\"comment\">// waiters</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (WaitNode q; (q = waiters) != <span class=\"keyword\">null</span>;) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// null</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, waitersOffset, q, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">                    Thread t = q.thread;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        q.thread = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        <span class=\"comment\">// </span></span><br><span class=\"line\">                        LockSupport.unpark(t);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    WaitNode next = q.next;</span><br><span class=\"line\">                    <span class=\"comment\">// next</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (next == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// gc</span></span><br><span class=\"line\">                    q.next = <span class=\"keyword\">null</span>; </span><br><span class=\"line\">                    <span class=\"comment\">// node</span></span><br><span class=\"line\">                    q = next;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        done();</span><br><span class=\"line\"></span><br><span class=\"line\">        callable = <span class=\"keyword\">null</span>;        <span class=\"comment\">// to reduce footprint</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Awaits completion or aborts on interrupt or timeout.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> timed true if use timed waits</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> nanos time to wait, if timed</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> state upon completion</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">awaitDone</span><span class=\"params\">(<span class=\"keyword\">boolean</span> timed, <span class=\"keyword\">long</span> nanos)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> deadline = timed ? System.nanoTime() + nanos : <span class=\"number\">0L</span>;</span><br><span class=\"line\">        WaitNode q = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> queued = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 1. </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (Thread.interrupted()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                removeWaiter(q);</span><br><span class=\"line\">                <span class=\"comment\">// InterruptedException</span></span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> InterruptedException();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">            <span class=\"comment\">// 2. COMPLETING</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (s &gt; COMPLETING) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// ()</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (q != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                    <span class=\"comment\">// thread</span></span><br><span class=\"line\">                    q.thread = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 3. COMPLETING</span></span><br><span class=\"line\">            <span class=\"comment\">// outcome</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (s == COMPLETING) <span class=\"comment\">// cannot time out yet</span></span><br><span class=\"line\">                Thread.yield();<span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"comment\">// 4. </span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (q == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                q = <span class=\"keyword\">new</span> WaitNode();</span><br><span class=\"line\">            <span class=\"comment\">// 5. waiterswaiters</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!queued)</span><br><span class=\"line\">                queued = UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, waitersOffset,</span><br><span class=\"line\">                                                     q.next = waiters, q);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (timed) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                nanos = deadline - System.nanoTime();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nanos &lt;= <span class=\"number\">0L</span>) &#123;</span><br><span class=\"line\">                    removeWaiter(q);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// 6. </span></span><br><span class=\"line\">                LockSupport.parkNanos(<span class=\"keyword\">this</span>, nanos);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 6. </span></span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                LockSupport.park(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">removeWaiter</span><span class=\"params\">(WaitNode node)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// threadnullthreadnullnode</span></span><br><span class=\"line\">            node.thread = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            retry:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (;;) &#123;          <span class=\"comment\">// restart on removeWaiter race</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (WaitNode pred = <span class=\"keyword\">null</span>, q = waiters, s; q != <span class=\"keyword\">null</span>; q = s) &#123;</span><br><span class=\"line\">                    s = q.next;</span><br><span class=\"line\">                    <span class=\"comment\">// q.thread != nullq</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (q.thread != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                        pred = q;</span><br><span class=\"line\">                    <span class=\"comment\">// q.thread == nullpred != nullq</span></span><br><span class=\"line\">                    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (pred != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// q</span></span><br><span class=\"line\">                        pred.next = s;</span><br><span class=\"line\">                         <span class=\"comment\">// pred.thread == null</span></span><br><span class=\"line\">                         <span class=\"comment\">// for</span></span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (pred.thread == <span class=\"keyword\">null</span>) <span class=\"comment\">// check for race</span></span><br><span class=\"line\">                            <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                     <span class=\"comment\">// q.thread != nullpred == nullq</span></span><br><span class=\"line\">                     <span class=\"comment\">// s</span></span><br><span class=\"line\">                    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, waitersOffset,</span><br><span class=\"line\">                                                          q, s))</span><br><span class=\"line\">                        <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Unsafe mechanics</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> sun.misc.Unsafe UNSAFE;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> stateOffset;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> runnerOffset;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> waitersOffset;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            UNSAFE = sun.misc.Unsafe.getUnsafe();</span><br><span class=\"line\">            Class&lt;?&gt; k = FutureTask.class;</span><br><span class=\"line\">            stateOffset = UNSAFE.objectFieldOffset</span><br><span class=\"line\">                (k.getDeclaredField(<span class=\"string\">\"state\"</span>));</span><br><span class=\"line\">            runnerOffset = UNSAFE.objectFieldOffset</span><br><span class=\"line\">                (k.getDeclaredField(<span class=\"string\">\"runner\"</span>));</span><br><span class=\"line\">            waitersOffset = UNSAFE.objectFieldOffset</span><br><span class=\"line\">                (k.getDeclaredField(<span class=\"string\">\"waiters\"</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li>prestartCoreThread()</li>\n<li>prestartAllCoreThreads()</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ThreadPoolExecutor</p>\n<ul>\n<li>shutdown()</li>\n<li>shutdownNow()</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><ol>\n<li>CPUCPU NCPU+1</li>\n<li>IO2*NCPU</li>\n</ol>\n</li>\n<li>(+CPU/CPU * CPU</li>\n<li></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>workQueue</strong>BlockingQueue BlockingQueuejava.util.concurrent BlockingQueue </p>\n<ul>\n<li>ArrayBlockingQueueArrayBlockingQueue ()</li>\n<li>LinkedBlockingQueueLinkedBlockingQueue () Integer.MAX_VALUE </li>\n<li>DelayQueueDelayQueue  java.util.concurrent.Delayed </li>\n<li>PriorityBlockingQueuePriorityBlockingQueue  java.util.PriorityQueue  null  PriorityBlockingQueue  java.lang.Comparable  Comparable </li>\n<li>SynchronousQueueSynchronousQueue </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li> execute() <ol>\n<li> corePoolSize</li>\n<li> corePoolSize</li>\n<li> maximumPoolSize</li>\n<li> maximumPoolSizeRejectExecutionException</li>\n<li></li>\n<li>keepAliveTime corePoolSize corePoolSize </li>\n</ol>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>Light Weight Process     </p>","more":"<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>Thread</li>\n<li>Runnablerun()new Thread(runnable).start()run</li>\n<li>Callablecall()FutureTaskCallableFutureTaskThreadtarger<pre><code>Runnable  Callable \n 1. RunnablerunCallablecall\n 2. RunnableCallable\n 3. runcall\n 4. CallableFutureFutureget()get()get()</code></pre></li>\n<li>Executors executor servicesRunnableCallableThreadPoolExecutorScheduledThreadPoolExecutor<pre><code>1. public static ExecutorService newCachedThreadPool() \n2. public static ExecutorService newFixedThreadPool(int nThreads)  \n3. public static ExecutorService newSingleThreadExecutor() (FIFO, LIFO, )\n4. public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) \n5. public static ExecutorService newWorkStealingPool() CPUForkJoinPoolCPU</code></pre></li>\n</ul>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ul>\n<li>ForkJoinPool (WorkQueue)(ForkJoinTask)<ul>\n<li>(fork())LIFO</li>\n<li>(pool)FIFO</li>\n<li>join()join</li>\n</ul>\n</li>\n<li>ExecutorCompletionService (BlockingQueue), , take()FutureTask</li>\n</ul>\n<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"ThreadPoolExecutor\"><a href=\"#ThreadPoolExecutor\" class=\"headerlink\" title=\"ThreadPoolExecutor\"></a>ThreadPoolExecutor</h2><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">ThreadPoolExecutor</span><span class=\"params\">(<span class=\"keyword\">int</span> corePoolSize,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          <span class=\"keyword\">int</span> maximumPoolSize,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          <span class=\"keyword\">long</span> keepAliveTime,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          TimeUnit unit,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          BlockingQueue&lt;Runnable&gt; workQueue,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          ThreadFactory threadFactory,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                          RejectedExecutionHandler handler)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (corePoolSize &lt; <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt;= <span class=\"number\">0</span> ||</span><br><span class=\"line\">        maximumPoolSize &lt; corePoolSize ||</span><br><span class=\"line\">        keepAliveTime &lt; <span class=\"number\">0</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalArgumentException();</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workQueue == <span class=\"keyword\">null</span> || threadFactory == <span class=\"keyword\">null</span> || handler == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.acc = System.getSecurityManager() == <span class=\"keyword\">null</span> ?</span><br><span class=\"line\">            <span class=\"keyword\">null</span> :</span><br><span class=\"line\">            AccessController.getContext();</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.corePoolSize = corePoolSize;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.maximumPoolSize = maximumPoolSize;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.workQueue = workQueue;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.keepAliveTime = unit.toNanos(keepAliveTime);</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.threadFactory = threadFactory;</span><br><span class=\"line\">    <span class=\"keyword\">this</span>.handler = handler;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>corePoolSize exectue()<pre><code>1.  corePoolSize\n2.  corePoolSize  maximumPoolSizeworkQueue\n3. corePoolSize  maximumPoolSizeworkQueueworkQueueworkQueue\n4. maximumPoolSizeworkQueuehandler\n5.  corePoolSize &gt; workQueue &gt; maximumPoolSize</code></pre></li>\n<li>maximumPoolSize </li>\n<li>keepAliveTime corePoolSizekeepAliveTime</li>\n<li>workQueue , :<ul>\n<li><strong></strong>SynchronousQueue</li>\n<li><strong></strong>LinkedBlockingQueuecorePoolSizemaximumPoolSizeRUNNING</li>\n<li><strong></strong>ArrayBlockingQueuemaximumPoolSize</li>\n</ul>\n</li>\n<li>threadFactory ThreadFactoryExecutors.defaultThreadFactory() ThreadFactoryNORM_PRIORITY</li>\n<li>handler RejectedExecutionHandler4<ul>\n<li>AbortPolicy</li>\n<li>CallerRunsPolicy</li>\n<li>DiscardOldestPolicy</li>\n<li>DiscardPolicy</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"execute\"><a href=\"#execute\" class=\"headerlink\" title=\"execute\"></a>execute</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">execute</span><span class=\"params\">(Runnable command)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">if</span> (command == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// cltrunStateworkerCount</span></span><br><span class=\"line\">    <span class=\"keyword\">int</span> c = ctl.get();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// workerCountOf29</span></span><br><span class=\"line\">    <span class=\"comment\">// corePoolSize</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (workerCountOf(c) &lt; corePoolSize) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// addWorkercorePoolSizemaximumPoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// truecorePoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// falsemaximumPoolSize</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (addWorker(command, <span class=\"keyword\">true</span>))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// ctl</span></span><br><span class=\"line\">        c = ctl.get();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">//   </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (isRunning(c) &amp;&amp; workQueue.offer(command)) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// ctl</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> recheck = ctl.get();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// commandworkQueue</span></span><br><span class=\"line\">        <span class=\"comment\">// command</span></span><br><span class=\"line\">        <span class=\"comment\">// handler</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! isRunning(recheck) &amp;&amp; remove(command))</span><br><span class=\"line\">            reject(command);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// 0addWorker</span></span><br><span class=\"line\">        <span class=\"comment\">// 1. null</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. falsemaximumPoolSizemaximumPoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// workerCount0workQueuecommand</span></span><br><span class=\"line\">        <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (workerCountOf(recheck) == <span class=\"number\">0</span>)</span><br><span class=\"line\">            addWorker(<span class=\"keyword\">null</span>, <span class=\"keyword\">false</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"comment\">// 1.RUNNING</span></span><br><span class=\"line\">    <span class=\"comment\">// 2.RUNNINGworkerCount &gt;= corePoolSizeworkQueue;</span></span><br><span class=\"line\">    <span class=\"comment\">// addWorkerfalsemaximumPoolSize</span></span><br><span class=\"line\">    <span class=\"comment\">//  </span></span><br><span class=\"line\">    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!addWorker(command, <span class=\"keyword\">false</span>))</span><br><span class=\"line\">        reject(command);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>runStateworkCountint<a href=\"https://blog.csdn.net/weixin_34396902/article/details/94527424\" target=\"_blank\" rel=\"noopener\">https://blog.csdn.net/weixin_34396902/article/details/94527424</a></p>\n<h4 id=\"addWorker\"><a href=\"#addWorker\" class=\"headerlink\" title=\"addWorker\"></a>addWorker</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> <span class=\"title\">addWorker</span><span class=\"params\">(Runnable firstTask, <span class=\"keyword\">boolean</span> core)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// CAS+1</span></span><br><span class=\"line\">    retry:</span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// cltrunStateworkerCount</span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> c = ctl.get();</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> rs = runStateOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// rs &gt;= SHUTDOWN</span></span><br><span class=\"line\">        <span class=\"comment\">// 31false</span></span><br><span class=\"line\">        <span class=\"comment\">// 1. rs == SHUTDOWN</span></span><br><span class=\"line\">        <span class=\"comment\">// 2. firsTask</span></span><br><span class=\"line\">        <span class=\"comment\">// 3. </span></span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        <span class=\"comment\">// rs == SHUTDOWN</span></span><br><span class=\"line\">        <span class=\"comment\">// firstTaskfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// firstTaskworkQueuefalse</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs &gt;= SHUTDOWN &amp;&amp;</span><br><span class=\"line\">            ! (rs == SHUTDOWN &amp;&amp;</span><br><span class=\"line\">               firstTask == <span class=\"keyword\">null</span> &amp;&amp;</span><br><span class=\"line\">               ! workQueue.isEmpty()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> wc = workerCountOf(c);</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// wcCAPACITY(),ctl29291false</span></span><br><span class=\"line\">            <span class=\"comment\">// coreaddWorker,truecorePoolSizefalsemaximumPoolSize;</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (wc &gt;= CAPACITY ||</span><br><span class=\"line\">                wc &gt;= (core ? corePoolSize : maximumPoolSize))</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// CASworkerCountclt+1for</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (compareAndIncrementWorkerCount(c))</span><br><span class=\"line\">                <span class=\"keyword\">break</span> retry;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">// workerCountctl</span></span><br><span class=\"line\">            c = ctl.get();  </span><br><span class=\"line\">            <span class=\"comment\">// rsfor</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (runStateOf(c) != rs)</span><br><span class=\"line\">                <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// workers</span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> workerStarted = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> workerAdded = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    Worker w = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// firstTaskWorker</span></span><br><span class=\"line\">        w = <span class=\"keyword\">new</span> Worker(firstTask);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// Worker</span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> Thread t = w.thread;</span><br><span class=\"line\">        </span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span> (t != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// workers</span></span><br><span class=\"line\">            <span class=\"keyword\">final</span> ReentrantLock mainLock = <span class=\"keyword\">this</span>.mainLock;</span><br><span class=\"line\">            mainLock.lock();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">int</span> rs = runStateOf(ctl.get());</span><br><span class=\"line\">                </span><br><span class=\"line\">                <span class=\"comment\">// rs &lt; SHUTDOWNRUNNING</span></span><br><span class=\"line\">                <span class=\"comment\">// rsRUNNINGrsSHUTDOWNfirstTasknull</span></span><br><span class=\"line\">                <span class=\"comment\">// SHUTDOWNworkQueue</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (rs &lt; SHUTDOWN ||</span><br><span class=\"line\">                    (rs == SHUTDOWN &amp;&amp; firstTask == <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// ,</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t.isAlive()) </span><br><span class=\"line\">                        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> IllegalThreadStateException();</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"comment\">// workershashSet</span></span><br><span class=\"line\">                    workers.add(w);</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> s = workers.size();</span><br><span class=\"line\">                    </span><br><span class=\"line\">                    <span class=\"comment\">// largestPoolSize</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (s &gt; largestPoolSize)</span><br><span class=\"line\">                        largestPoolSize = s;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    workerAdded = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                mainLock.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (workerAdded) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                t.start();</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                workerStarted = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">// startaddWorkerFailed</span></span><br><span class=\"line\">        <span class=\"comment\">// clt</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (! workerStarted)</span><br><span class=\"line\">            addWorkerFailed(w);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> workerStarted;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>t.start()WorkerrunWorkerRunnableWorker</p>\n<h4 id=\"Worker\"><a href=\"#Worker\" class=\"headerlink\" title=\"Worker\"></a>Worker</h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Worker</span> <span class=\"keyword\">extends</span> <span class=\"title\">AbstractQueuedSynchronizer</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span></span></span><br><span class=\"line\"><span class=\"class\"></span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> serialVersionUID = <span class=\"number\">6138294804551838833L</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**  **/</span></span><br><span class=\"line\">    <span class=\"keyword\">final</span> Thread thread;</span><br><span class=\"line\">    <span class=\"comment\">/** thread runrun */</span></span><br><span class=\"line\">    Runnable firstTask;</span><br><span class=\"line\">    <span class=\"comment\">/**  */</span></span><br><span class=\"line\">    <span class=\"keyword\">volatile</span> <span class=\"keyword\">long</span> completedTasks;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Creates with given first task and thread from ThreadFactory.</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> firstTask the first task (null if none)</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    Worker(Runnable firstTask) &#123;</span><br><span class=\"line\">        setState(-<span class=\"number\">1</span>); <span class=\"comment\">// runWorker()interruptinterruptIfStarted() getState()&gt;=0</span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.firstTask = firstTask;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">this</span>.thread = getThreadFactory().newThread(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** Delegates main run loop to outer runWorker  */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        runWorker(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Lock methods</span></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"comment\">// The value 0 represents the unlocked state.</span></span><br><span class=\"line\">    <span class=\"comment\">// The value 1 represents the locked state.</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isHeldExclusively</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> getState() != <span class=\"number\">0</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryAcquire</span><span class=\"params\">(<span class=\"keyword\">int</span> unused)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//state01</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (compareAndSetState(<span class=\"number\">0</span>, <span class=\"number\">1</span>)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//exclusiveOwnerThread=</span></span><br><span class=\"line\">            setExclusiveOwnerThread(Thread.currentThread());</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryRelease</span><span class=\"params\">(<span class=\"keyword\">int</span> unused)</span> </span>&#123;</span><br><span class=\"line\">        setExclusiveOwnerThread(<span class=\"keyword\">null</span>);</span><br><span class=\"line\">        setState(<span class=\"number\">0</span>);</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">lock</span><span class=\"params\">()</span>        </span>&#123; acquire(<span class=\"number\">1</span>); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">tryLock</span><span class=\"params\">()</span>  </span>&#123; <span class=\"keyword\">return</span> tryAcquire(<span class=\"number\">1</span>); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">unlock</span><span class=\"params\">()</span>      </span>&#123; release(<span class=\"number\">1</span>); &#125;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isLocked</span><span class=\"params\">()</span> </span>&#123; <span class=\"keyword\">return</span> isHeldExclusively(); &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">    * </span></span><br><span class=\"line\"><span class=\"comment\">    * shutdownNowworker</span></span><br><span class=\"line\"><span class=\"comment\">    * workerworker</span></span><br><span class=\"line\"><span class=\"comment\">    */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">void</span> <span class=\"title\">interruptIfStarted</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        Thread t;</span><br><span class=\"line\">        <span class=\"comment\">// state&gt;=0t!=nullt</span></span><br><span class=\"line\">        <span class=\"comment\">// new Worker()state==-1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (getState() &gt;= <span class=\"number\">0</span> &amp;&amp; (t = thread) != <span class=\"keyword\">null</span> &amp;&amp; !t.isInterrupted()) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                t.interrupt();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (SecurityException ignore) &#123;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>WorkerAbstractQueuedSynchronizer,()workQueue.<br>execute(command)commandWorkerAQSTreadPoolExecutorshutdown()workerworkQueuegetTask()</p>\n<h4 id=\"runWorker-\"><a href=\"#runWorker-\" class=\"headerlink\" title=\"runWorker \"></a>runWorker </h4><p>WorkerrunrunWorker.</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">final</span> <span class=\"keyword\">void</span> <span class=\"title\">runWorker</span><span class=\"params\">(Worker w)</span> </span>&#123;</span><br><span class=\"line\">    Thread wt = Thread.currentThread();</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Runnable task = w.firstTask;</span><br><span class=\"line\">    w.firstTask = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    w.unlock(); <span class=\"comment\">// </span></span><br><span class=\"line\">    </span><br><span class=\"line\">     <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> completedAbruptly = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// taskgetTask</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (task != <span class=\"keyword\">null</span> || (task = getTask()) != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            w.lock();</span><br><span class=\"line\">            <span class=\"comment\">// If pool is stopping, ensure thread is interrupted;</span></span><br><span class=\"line\">            <span class=\"comment\">// if not, ensure thread is not interrupted.  This</span></span><br><span class=\"line\">            <span class=\"comment\">// requires a recheck in second case to deal with</span></span><br><span class=\"line\">            <span class=\"comment\">// shutdownNow race while clearing interrupt</span></span><br><span class=\"line\">            <span class=\"comment\">// stopstop</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> ((runStateAtLeast(ctl.get(), STOP) ||</span><br><span class=\"line\">                 (Thread.interrupted() &amp;&amp;</span><br><span class=\"line\">                  runStateAtLeast(ctl.get(), STOP))) &amp;&amp;</span><br><span class=\"line\">                !wt.isInterrupted())</span><br><span class=\"line\">                wt.interrupt();</span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//Hook</span></span><br><span class=\"line\">                beforeExecute(wt, task);</span><br><span class=\"line\">                Throwable thrown = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//</span></span><br><span class=\"line\">                    task.run();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (RuntimeException x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Error x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> x;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable x) &#123;</span><br><span class=\"line\">                    thrown = x; <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(x);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//Hook</span></span><br><span class=\"line\">                    afterExecute(task, thrown);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">                <span class=\"comment\">//taskcompletedTasks++</span></span><br><span class=\"line\">                task = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                w.completedTasks++;</span><br><span class=\"line\">                w.unlock();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        completedAbruptly = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">    &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">        <span class=\"comment\">//Worker</span></span><br><span class=\"line\">        processWorkerExit(w, completedAbruptly);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"getTask-\"><a href=\"#getTask-\" class=\"headerlink\" title=\"getTask \"></a>getTask </h4><p>runWorkergetTask()</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> Runnable <span class=\"title\">getTask</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">boolean</span> timedOut = <span class=\"keyword\">false</span>; <span class=\"comment\">// Did the last poll() time out?</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> c = ctl.get();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> rs = runStateOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// shutdown</span></span><br><span class=\"line\">        <span class=\"comment\">// stopterminate</span></span><br><span class=\"line\">        <span class=\"comment\">// -1null</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (rs &gt;= SHUTDOWN &amp;&amp; (rs &gt;= STOP || workQueue.isEmpty())) &#123;</span><br><span class=\"line\">            decrementWorkerCount();</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">int</span> wc = workerCountOf(c);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// timed</span></span><br><span class=\"line\">        <span class=\"comment\">// allowCoreThreadTimeOutfalse</span></span><br><span class=\"line\">        <span class=\"comment\">// wc &gt; corePoolSize</span></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> timed = allowCoreThreadTimeOut || wc &gt; corePoolSize;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//   </span></span><br><span class=\"line\">        <span class=\"comment\">//  1  </span></span><br><span class=\"line\">        <span class=\"comment\">// workerCount1</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> ((wc &gt; maximumPoolSize || (timed &amp;&amp; timedOut))</span><br><span class=\"line\">            &amp;&amp; (wc &gt; <span class=\"number\">1</span> || workQueue.isEmpty())) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (compareAndDecrementWorkerCount(c))</span><br><span class=\"line\">                <span class=\"keyword\">return</span> <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            <span class=\"keyword\">continue</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//****</span></span><br><span class=\"line\">            <span class=\"comment\">// timedtruepollkeepAliveTimenull</span></span><br><span class=\"line\">            <span class=\"comment\">// taketake</span></span><br><span class=\"line\">            Runnable r = timed ?</span><br><span class=\"line\">                workQueue.poll(keepAliveTime, TimeUnit.NANOSECONDS) :</span><br><span class=\"line\">                workQueue.take();</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (r != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                <span class=\"keyword\">return</span> r;</span><br><span class=\"line\">            </span><br><span class=\"line\">            <span class=\"comment\">//  r == nulltimedOuttrue</span></span><br><span class=\"line\">            timedOut = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (InterruptedException retry) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// timedOutfalse</span></span><br><span class=\"line\">            timedOut = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"FutureTask\"><a href=\"#FutureTask\" class=\"headerlink\" title=\"FutureTask\"></a>FutureTask</h3><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br><span class=\"line\">257</span><br><span class=\"line\">258</span><br><span class=\"line\">259</span><br><span class=\"line\">260</span><br><span class=\"line\">261</span><br><span class=\"line\">262</span><br><span class=\"line\">263</span><br><span class=\"line\">264</span><br><span class=\"line\">265</span><br><span class=\"line\">266</span><br><span class=\"line\">267</span><br><span class=\"line\">268</span><br><span class=\"line\">269</span><br><span class=\"line\">270</span><br><span class=\"line\">271</span><br><span class=\"line\">272</span><br><span class=\"line\">273</span><br><span class=\"line\">274</span><br><span class=\"line\">275</span><br><span class=\"line\">276</span><br><span class=\"line\">277</span><br><span class=\"line\">278</span><br><span class=\"line\">279</span><br><span class=\"line\">280</span><br><span class=\"line\">281</span><br><span class=\"line\">282</span><br><span class=\"line\">283</span><br><span class=\"line\">284</span><br><span class=\"line\">285</span><br><span class=\"line\">286</span><br><span class=\"line\">287</span><br><span class=\"line\">288</span><br><span class=\"line\">289</span><br><span class=\"line\">290</span><br><span class=\"line\">291</span><br><span class=\"line\">292</span><br><span class=\"line\">293</span><br><span class=\"line\">294</span><br><span class=\"line\">295</span><br><span class=\"line\">296</span><br><span class=\"line\">297</span><br><span class=\"line\">298</span><br><span class=\"line\">299</span><br><span class=\"line\">300</span><br><span class=\"line\">301</span><br><span class=\"line\">302</span><br><span class=\"line\">303</span><br><span class=\"line\">304</span><br><span class=\"line\">305</span><br><span class=\"line\">306</span><br><span class=\"line\">307</span><br><span class=\"line\">308</span><br><span class=\"line\">309</span><br><span class=\"line\">310</span><br><span class=\"line\">311</span><br><span class=\"line\">312</span><br><span class=\"line\">313</span><br><span class=\"line\">314</span><br><span class=\"line\">315</span><br><span class=\"line\">316</span><br><span class=\"line\">317</span><br><span class=\"line\">318</span><br><span class=\"line\">319</span><br><span class=\"line\">320</span><br><span class=\"line\">321</span><br><span class=\"line\">322</span><br><span class=\"line\">323</span><br><span class=\"line\">324</span><br><span class=\"line\">325</span><br><span class=\"line\">326</span><br><span class=\"line\">327</span><br><span class=\"line\">328</span><br><span class=\"line\">329</span><br><span class=\"line\">330</span><br><span class=\"line\">331</span><br><span class=\"line\">332</span><br><span class=\"line\">333</span><br><span class=\"line\">334</span><br><span class=\"line\">335</span><br><span class=\"line\">336</span><br><span class=\"line\">337</span><br><span class=\"line\">338</span><br><span class=\"line\">339</span><br><span class=\"line\">340</span><br><span class=\"line\">341</span><br><span class=\"line\">342</span><br><span class=\"line\">343</span><br><span class=\"line\">344</span><br><span class=\"line\">345</span><br><span class=\"line\">346</span><br><span class=\"line\">347</span><br><span class=\"line\">348</span><br><span class=\"line\">349</span><br><span class=\"line\">350</span><br><span class=\"line\">351</span><br><span class=\"line\">352</span><br><span class=\"line\">353</span><br><span class=\"line\">354</span><br><span class=\"line\">355</span><br><span class=\"line\">356</span><br><span class=\"line\">357</span><br><span class=\"line\">358</span><br><span class=\"line\">359</span><br><span class=\"line\">360</span><br><span class=\"line\">361</span><br><span class=\"line\">362</span><br><span class=\"line\">363</span><br><span class=\"line\">364</span><br><span class=\"line\">365</span><br><span class=\"line\">366</span><br><span class=\"line\">367</span><br><span class=\"line\">368</span><br><span class=\"line\">369</span><br><span class=\"line\">370</span><br><span class=\"line\">371</span><br><span class=\"line\">372</span><br><span class=\"line\">373</span><br><span class=\"line\">374</span><br><span class=\"line\">375</span><br><span class=\"line\">376</span><br><span class=\"line\">377</span><br><span class=\"line\">378</span><br><span class=\"line\">379</span><br><span class=\"line\">380</span><br><span class=\"line\">381</span><br><span class=\"line\">382</span><br><span class=\"line\">383</span><br><span class=\"line\">384</span><br><span class=\"line\">385</span><br><span class=\"line\">386</span><br><span class=\"line\">387</span><br><span class=\"line\">388</span><br><span class=\"line\">389</span><br><span class=\"line\">390</span><br><span class=\"line\">391</span><br><span class=\"line\">392</span><br><span class=\"line\">393</span><br><span class=\"line\">394</span><br><span class=\"line\">395</span><br><span class=\"line\">396</span><br><span class=\"line\">397</span><br><span class=\"line\">398</span><br><span class=\"line\">399</span><br><span class=\"line\">400</span><br><span class=\"line\">401</span><br><span class=\"line\">402</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FutureTask</span>&lt;<span class=\"title\">V</span>&gt; <span class=\"keyword\">implements</span> <span class=\"title\">RunnableFuture</span>&lt;<span class=\"title\">V</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * stateFutureTask7</span></span><br><span class=\"line\"><span class=\"comment\">     * NEW:</span></span><br><span class=\"line\"><span class=\"comment\">     * COMPLETING:outcome(outcome)NEWCOMPLETING</span></span><br><span class=\"line\"><span class=\"comment\">     * NORMAL:outcomeCOMPLETINGNORMAL</span></span><br><span class=\"line\"><span class=\"comment\">     * EXCEPTIONAL:outcomeCOMPLETINGEXCEPTIONAL</span></span><br><span class=\"line\"><span class=\"comment\">     * CANCELLED:cancel(false)NEWCANCELLED</span></span><br><span class=\"line\"><span class=\"comment\">     * INTERRUPTING: cancel(true)NEWINTERRUPTING</span></span><br><span class=\"line\"><span class=\"comment\">     * INTERRUPTED:interrupt()INTERRUPTINGINTERRUPTED</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; COMPLETING -&gt; NORMAL </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; COMPLETING -&gt; EXCEPTIONAL </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; CANCELLED </span></span><br><span class=\"line\"><span class=\"comment\">     * NEW -&gt; INTERRUPTING -&gt; INTERRUPTED </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> <span class=\"keyword\">int</span> state;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> NEW          = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> COMPLETING   = <span class=\"number\">1</span>;<span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> NORMAL       = <span class=\"number\">2</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> EXCEPTIONAL  = <span class=\"number\">3</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> CANCELLED    = <span class=\"number\">4</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> INTERRUPTING = <span class=\"number\">5</span>;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">int</span> INTERRUPTED  = <span class=\"number\">6</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/** The underlying callable; nulled out after running */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Callable&lt;V&gt; callable;</span><br><span class=\"line\">    <span class=\"comment\">/** The result to return or exception to throw from get() */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> Object outcome; <span class=\"comment\">// non-volatile, protected by state reads/writes</span></span><br><span class=\"line\">    <span class=\"comment\">/** callable **/</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> Thread runner;</span><br><span class=\"line\">    <span class=\"comment\">/** TreiberStack */</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">volatile</span> WaitNode waiters;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@SuppressWarnings</span>(<span class=\"string\">\"unchecked\"</span>)</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> V <span class=\"title\">report</span><span class=\"params\">(<span class=\"keyword\">int</span> s)</span> <span class=\"keyword\">throws</span> ExecutionException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Object x = outcome;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == NORMAL)</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">return</span> (V)x;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s &gt;= CANCELLED)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> CancellationException();</span><br><span class=\"line\">        <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> ExecutionException((Throwable)x);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">FutureTask</span><span class=\"params\">(Callable&lt;V&gt; callable)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (callable == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.callable = callable;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.state = NEW;       <span class=\"comment\">// ensure visibility of callable</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * RunnableCallablecallableresult</span></span><br><span class=\"line\"><span class=\"comment\">     * null</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">FutureTask</span><span class=\"params\">(Runnable runnable, V result)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.callable = Executors.callable(runnable, result);</span><br><span class=\"line\">        <span class=\"keyword\">this</span>.state = NEW;       <span class=\"comment\">// ensure visibility of callable</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isCancelled</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state &gt;= CANCELLED;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"comment\">//</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">isDone</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> state != NEW;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">boolean</span> <span class=\"title\">cancel</span><span class=\"params\">(<span class=\"keyword\">boolean</span> mayInterruptIfRunning)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// 1. new  mayInterruptIfRunningNEWINTERRUPTINGCANCELLED </span></span><br><span class=\"line\">        <span class=\"comment\">// false</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (!(state == NEW &amp;&amp;</span><br><span class=\"line\">              UNSAFE.compareAndSwapInt(<span class=\"keyword\">this</span>, stateOffset, NEW,</span><br><span class=\"line\">                  mayInterruptIfRunning ? INTERRUPTING : CANCELLED)))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;    </span><br><span class=\"line\">        <span class=\"comment\">// 2. </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (mayInterruptIfRunning) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// runner</span></span><br><span class=\"line\">                    Thread t = runner;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                        <span class=\"comment\">//</span></span><br><span class=\"line\">                        t.interrupt();</span><br><span class=\"line\">                &#125; <span class=\"keyword\">finally</span> &#123; <span class=\"comment\">// final state</span></span><br><span class=\"line\">                    <span class=\"comment\">// INTERRUPTED</span></span><br><span class=\"line\">                    UNSAFE.putOrderedInt(<span class=\"keyword\">this</span>, stateOffset, INTERRUPTED);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            finishCompletion();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">get</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> InterruptedException, ExecutionException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">        <span class=\"comment\">// state &lt;= COMPLETING</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s &lt;= COMPLETING)</span><br><span class=\"line\">            <span class=\"comment\">// ()</span></span><br><span class=\"line\">            <span class=\"comment\">// awaitDone()</span></span><br><span class=\"line\">            s = awaitDone(<span class=\"keyword\">false</span>, <span class=\"number\">0L</span>);</span><br><span class=\"line\">        <span class=\"comment\">// report()</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> report(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> V <span class=\"title\">get</span><span class=\"params\">(<span class=\"keyword\">long</span> timeout, TimeUnit unit)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> InterruptedException, ExecutionException, TimeoutException </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (unit == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> NullPointerException();</span><br><span class=\"line\">        <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">        <span class=\"comment\">// awaitDone()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s &lt;= COMPLETING &amp;&amp;</span><br><span class=\"line\">            (s = awaitDone(<span class=\"keyword\">true</span>, unit.toNanos(timeout))) &lt;= COMPLETING)</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> TimeoutException();</span><br><span class=\"line\">        <span class=\"keyword\">return</span> report(s);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">done</span><span class=\"params\">()</span> </span>&#123; &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">set</span><span class=\"params\">(V v)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// CASNEWCOMPLETING()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (UNSAFE.compareAndSwapInt(<span class=\"keyword\">this</span>, stateOffset, NEW, COMPLETING)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// outcome</span></span><br><span class=\"line\">            outcome = v;</span><br><span class=\"line\">            <span class=\"comment\">// CASCOMPLETINGNORMAL</span></span><br><span class=\"line\">            UNSAFE.putOrderedInt(<span class=\"keyword\">this</span>, stateOffset, NORMAL); <span class=\"comment\">// final state</span></span><br><span class=\"line\">            finishCompletion();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">setException</span><span class=\"params\">(Throwable t)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// CASNEWCOMPLETING()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (UNSAFE.compareAndSwapInt(<span class=\"keyword\">this</span>, stateOffset, NEW, COMPLETING)) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// outcomeoutcome</span></span><br><span class=\"line\">            outcome = t;</span><br><span class=\"line\">            <span class=\"comment\">// CASCOMPLETINGEXCEPTIONAL</span></span><br><span class=\"line\">            UNSAFE.putOrderedInt(<span class=\"keyword\">this</span>, stateOffset, EXCEPTIONAL); <span class=\"comment\">// final state</span></span><br><span class=\"line\">            finishCompletion();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// NEW</span></span><br><span class=\"line\">        <span class=\"comment\">// NEWrunner(runnerOffset)</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state != NEW ||</span><br><span class=\"line\">            !UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, runnerOffset,</span><br><span class=\"line\">                                         <span class=\"keyword\">null</span>, Thread.currentThread()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span>;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Callable&lt;V&gt; c = callable;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"keyword\">null</span> &amp;&amp; state == NEW) &#123;</span><br><span class=\"line\">                V result;</span><br><span class=\"line\">                <span class=\"keyword\">boolean</span> ran;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">//   </span></span><br><span class=\"line\">                    result = c.call();</span><br><span class=\"line\">                    ran = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">                    result = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                    ran = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    setException(ex);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (ran)</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    set(result);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">// runnernull</span></span><br><span class=\"line\">            runner = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            <span class=\"comment\">// state must be re-read after nulling runner to prevent</span></span><br><span class=\"line\">            <span class=\"comment\">// leaked interrupts</span></span><br><span class=\"line\">            <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (s &gt;= INTERRUPTING)</span><br><span class=\"line\">                handlePossibleCancellationInterrupt(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * run</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> &#123;<span class=\"doctag\">@code</span> true&#125; if successfully run and reset</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">boolean</span> <span class=\"title\">runAndReset</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (state != NEW ||</span><br><span class=\"line\">            !UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, runnerOffset,</span><br><span class=\"line\">                                         <span class=\"keyword\">null</span>, Thread.currentThread()))</span><br><span class=\"line\">            <span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> ran = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            Callable&lt;V&gt; c = callable;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (c != <span class=\"keyword\">null</span> &amp;&amp; s == NEW) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    c.call(); <span class=\"comment\">// don't set result</span></span><br><span class=\"line\">                    ran = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (Throwable ex) &#123;</span><br><span class=\"line\">                    setException(ex);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            runner = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            s = state;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (s &gt;= INTERRUPTING)</span><br><span class=\"line\">                handlePossibleCancellationInterrupt(s);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> ran &amp;&amp; s == NEW;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">handlePossibleCancellationInterrupt</span><span class=\"params\">(<span class=\"keyword\">int</span> s)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (s == INTERRUPTING)</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (state == INTERRUPTING)</span><br><span class=\"line\">                Thread.yield(); <span class=\"comment\">// wait out pending interrupt</span></span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// cancel(true)runrunAndReset</span></span><br><span class=\"line\">        <span class=\"comment\">//Thread.yield()cancelINTERRUPTED</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Simple linked list nodes to record waiting threads in a Treiber</span></span><br><span class=\"line\"><span class=\"comment\">     * stack.  See other classes such as Phaser and SynchronousQueue</span></span><br><span class=\"line\"><span class=\"comment\">     * for more detailed explanation.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">WaitNode</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">volatile</span> Thread thread;</span><br><span class=\"line\">        <span class=\"keyword\">volatile</span> WaitNode next;</span><br><span class=\"line\">        WaitNode() &#123; thread = Thread.currentThread(); &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Removes and signals all waiting threads, invokes done(), and</span></span><br><span class=\"line\"><span class=\"comment\">     * nulls out callable.</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">finishCompletion</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// assert state &gt; COMPLETING;</span></span><br><span class=\"line\">        <span class=\"comment\">// stateCOMPLETING</span></span><br><span class=\"line\">        <span class=\"comment\">// waiters</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> (WaitNode q; (q = waiters) != <span class=\"keyword\">null</span>;) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// null</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, waitersOffset, q, <span class=\"keyword\">null</span>)) &#123;</span><br><span class=\"line\">                <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">                    Thread t = q.thread;</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (t != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        q.thread = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                        <span class=\"comment\">// </span></span><br><span class=\"line\">                        LockSupport.unpark(t);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    WaitNode next = q.next;</span><br><span class=\"line\">                    <span class=\"comment\">// next</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (next == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                        <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// gc</span></span><br><span class=\"line\">                    q.next = <span class=\"keyword\">null</span>; </span><br><span class=\"line\">                    <span class=\"comment\">// node</span></span><br><span class=\"line\">                    q = next;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        done();</span><br><span class=\"line\"></span><br><span class=\"line\">        callable = <span class=\"keyword\">null</span>;        <span class=\"comment\">// to reduce footprint</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * Awaits completion or aborts on interrupt or timeout.</span></span><br><span class=\"line\"><span class=\"comment\">     *</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> timed true if use timed waits</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> nanos time to wait, if timed</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@return</span> state upon completion</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">int</span> <span class=\"title\">awaitDone</span><span class=\"params\">(<span class=\"keyword\">boolean</span> timed, <span class=\"keyword\">long</span> nanos)</span></span></span><br><span class=\"line\"><span class=\"function\">        <span class=\"keyword\">throws</span> InterruptedException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> deadline = timed ? System.nanoTime() + nanos : <span class=\"number\">0L</span>;</span><br><span class=\"line\">        WaitNode q = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">        <span class=\"keyword\">boolean</span> queued = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (;;) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// 1. </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (Thread.interrupted()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                removeWaiter(q);</span><br><span class=\"line\">                <span class=\"comment\">// InterruptedException</span></span><br><span class=\"line\">                <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> InterruptedException();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"keyword\">int</span> s = state;</span><br><span class=\"line\">            <span class=\"comment\">// 2. COMPLETING</span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (s &gt; COMPLETING) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// ()</span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (q != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                    <span class=\"comment\">// thread</span></span><br><span class=\"line\">                    q.thread = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">return</span> s;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 3. COMPLETING</span></span><br><span class=\"line\">            <span class=\"comment\">// outcome</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (s == COMPLETING) <span class=\"comment\">// cannot time out yet</span></span><br><span class=\"line\">                Thread.yield();<span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"comment\">// 4. </span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (q == <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                q = <span class=\"keyword\">new</span> WaitNode();</span><br><span class=\"line\">            <span class=\"comment\">// 5. waiterswaiters</span></span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!queued)</span><br><span class=\"line\">                queued = UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, waitersOffset,</span><br><span class=\"line\">                                                     q.next = waiters, q);</span><br><span class=\"line\">            <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (timed) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                nanos = deadline - System.nanoTime();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (nanos &lt;= <span class=\"number\">0L</span>) &#123;</span><br><span class=\"line\">                    removeWaiter(q);</span><br><span class=\"line\">                    <span class=\"keyword\">return</span> state;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// 6. </span></span><br><span class=\"line\">                LockSupport.parkNanos(<span class=\"keyword\">this</span>, nanos);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// 6. </span></span><br><span class=\"line\">            <span class=\"keyword\">else</span></span><br><span class=\"line\">                LockSupport.park(<span class=\"keyword\">this</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">removeWaiter</span><span class=\"params\">(WaitNode node)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (node != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// threadnullthreadnullnode</span></span><br><span class=\"line\">            node.thread = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            retry:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> (;;) &#123;          <span class=\"comment\">// restart on removeWaiter race</span></span><br><span class=\"line\">                <span class=\"keyword\">for</span> (WaitNode pred = <span class=\"keyword\">null</span>, q = waiters, s; q != <span class=\"keyword\">null</span>; q = s) &#123;</span><br><span class=\"line\">                    s = q.next;</span><br><span class=\"line\">                    <span class=\"comment\">// q.thread != nullq</span></span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (q.thread != <span class=\"keyword\">null</span>)</span><br><span class=\"line\">                        pred = q;</span><br><span class=\"line\">                    <span class=\"comment\">// q.thread == nullpred != nullq</span></span><br><span class=\"line\">                    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (pred != <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                        <span class=\"comment\">// q</span></span><br><span class=\"line\">                        pred.next = s;</span><br><span class=\"line\">                         <span class=\"comment\">// pred.thread == null</span></span><br><span class=\"line\">                         <span class=\"comment\">// for</span></span><br><span class=\"line\">                        <span class=\"keyword\">if</span> (pred.thread == <span class=\"keyword\">null</span>) <span class=\"comment\">// check for race</span></span><br><span class=\"line\">                            <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                     <span class=\"comment\">// q.thread != nullpred == nullq</span></span><br><span class=\"line\">                     <span class=\"comment\">// s</span></span><br><span class=\"line\">                    <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (!UNSAFE.compareAndSwapObject(<span class=\"keyword\">this</span>, waitersOffset,</span><br><span class=\"line\">                                                          q, s))</span><br><span class=\"line\">                        <span class=\"keyword\">continue</span> retry;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">break</span>;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// Unsafe mechanics</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> sun.misc.Unsafe UNSAFE;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> stateOffset;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> runnerOffset;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> <span class=\"keyword\">final</span> <span class=\"keyword\">long</span> waitersOffset;</span><br><span class=\"line\">    <span class=\"keyword\">static</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            UNSAFE = sun.misc.Unsafe.getUnsafe();</span><br><span class=\"line\">            Class&lt;?&gt; k = FutureTask.class;</span><br><span class=\"line\">            stateOffset = UNSAFE.objectFieldOffset</span><br><span class=\"line\">                (k.getDeclaredField(<span class=\"string\">\"state\"</span>));</span><br><span class=\"line\">            runnerOffset = UNSAFE.objectFieldOffset</span><br><span class=\"line\">                (k.getDeclaredField(<span class=\"string\">\"runner\"</span>));</span><br><span class=\"line\">            waitersOffset = UNSAFE.objectFieldOffset</span><br><span class=\"line\">                (k.getDeclaredField(<span class=\"string\">\"waiters\"</span>));</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">throw</span> <span class=\"keyword\">new</span> Error(e);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<ul>\n<li>prestartCoreThread()</li>\n<li>prestartAllCoreThreads()</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p>ThreadPoolExecutor</p>\n<ul>\n<li>shutdown()</li>\n<li>shutdownNow()</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li><ol>\n<li>CPUCPU NCPU+1</li>\n<li>IO2*NCPU</li>\n</ol>\n</li>\n<li>(+CPU/CPU * CPU</li>\n<li></li>\n</ol>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><strong>workQueue</strong>BlockingQueue BlockingQueuejava.util.concurrent BlockingQueue </p>\n<ul>\n<li>ArrayBlockingQueueArrayBlockingQueue ()</li>\n<li>LinkedBlockingQueueLinkedBlockingQueue () Integer.MAX_VALUE </li>\n<li>DelayQueueDelayQueue  java.util.concurrent.Delayed </li>\n<li>PriorityBlockingQueuePriorityBlockingQueue  java.util.PriorityQueue  null  PriorityBlockingQueue  java.lang.Comparable  Comparable </li>\n<li>SynchronousQueueSynchronousQueue </li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><ol>\n<li></li>\n<li> execute() <ol>\n<li> corePoolSize</li>\n<li> corePoolSize</li>\n<li> maximumPoolSize</li>\n<li> maximumPoolSizeRejectExecutionException</li>\n<li></li>\n<li>keepAliveTime corePoolSize corePoolSize </li>\n</ol>\n</li>\n</ol>"}],"PostAsset":[{"_id":"source/_posts/Github-Pages-Blog/setting.png","slug":"setting.png","post":"ck4859y93003lt0fyvlndcm24","modified":1,"renderable":0},{"_id":"source/_posts/Github-Pages-Blog/valine.png","slug":"valine.png","post":"ck4859y93003lt0fyvlndcm24","modified":1,"renderable":0},{"_id":"source/_posts/Mysql01/01.jpg","slug":"01.jpg","post":"ck4859y3e000ut0fyts0xzyjh","modified":1,"renderable":0},{"_id":"source/_posts/Design-Pattern-Strategy/1.png","slug":"1.png","post":"ck4859y2u0009t0fy5cbsap0e","modified":1,"renderable":0},{"_id":"source/_posts/Design-Pattern-Strategy/2.png","slug":"2.png","post":"ck4859y2u0009t0fy5cbsap0e","modified":1,"renderable":0},{"_id":"source/_posts/Design-Pattern-Observer/2.png","slug":"2.png","post":"ck4859y92003kt0fym8za61n9","modified":1,"renderable":0},{"_id":"source/_posts/Github-Pages-Blog/create-repository.png","slug":"create-repository.png","post":"ck4859y93003lt0fyvlndcm24","modified":1,"renderable":0},{"_id":"source/_posts/Kafka-Background/4.jpg","slug":"4.jpg","post":"ck4859yb4004kt0fyeb9xqpka","modified":1,"renderable":0},{"_id":"source/_posts/C++-02/1.png","slug":"1.png","post":"ck4859y2s0008t0fy3l37j2fz","modified":1,"renderable":0},{"_id":"source/_posts/Mysql-LSN/LOG.png","slug":"LOG.png","post":"ck4859y35000pt0fyylafrkhm","modified":1,"renderable":0},{"_id":"source/_posts/Kafka-Producer/cert_override.png","post":"ck4859y34000ot0fynih21mp8","slug":"cert_override.png","modified":1,"renderable":1},{"_id":"source/_posts/Kafka-Producer/producer.png","post":"ck4859y34000ot0fynih21mp8","slug":"producer.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql-RedoAndUndo/redo-buffer.png","post":"ck4859y3j000xt0fy4lky1513","slug":"redo-buffer.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql-RedoAndUndo/undo-Segment.png","post":"ck4859y3j000xt0fy4lky1513","slug":"undo-Segment.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BBT1.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BBT1.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BBT2.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BBT2.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BBT3.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BBT3.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BBT4.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BBT4.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BST_delete1.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BST_delete1.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BST_delete2.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BST_delete2.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BST_insert.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BST_insert.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql05/BST_linked.png","post":"ck4859y3q0013t0fyyxk4qmtl","slug":"BST_linked.png","modified":1,"renderable":1},{"_id":"source/_posts/Thailand-Raiders/1.png","post":"ck4859y3s0017t0fyzc60sa62","slug":"1.png","modified":1,"renderable":1},{"_id":"source/_posts/Thailand-Raiders/10.jpeg","post":"ck4859y3s0017t0fyzc60sa62","slug":"10.jpeg","modified":1,"renderable":1},{"_id":"source/_posts/Thailand-Raiders/11.png","slug":"11.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/2.png","slug":"2.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/3.png","slug":"3.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/4.png","slug":"4.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/455-2.jpeg","slug":"455-2.jpeg","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/455-3.jpeg","slug":"455-3.jpeg","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/455.jpeg","slug":"455.jpeg","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/5.png","post":"ck4859y3s0017t0fyzc60sa62","slug":"5.png","modified":1,"renderable":1},{"_id":"source/_posts/Thailand-Raiders/6.png","slug":"6.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/7.png","slug":"7.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/8.png","slug":"8.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/9.png","slug":"9.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-45-53-237_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-11-45-53-237_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-45-57-687_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-11-45-57-687_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-46-00-652_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-11-46-00-652_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-46-03-072_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-11-46-03-072_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-11-46-08-364_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-11-46-08-364_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-14-972_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-12-05-14-972_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-18-389_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-12-05-18-389_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-20-912_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-12-05-20-912_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-23-188_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-12-05-23-188_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-25-297_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-12-05-25-297_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-12-05-30-499_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-12-05-30-499_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-13-11-50-782_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-13-11-50-782_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-13-11-56-133_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-13-11-56-133_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-13-12-27-105_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-13-12-27-105_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-14-05-58-003_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-14-05-58-003_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Screenshot_2019-08-31-14-25-04-833_com.xingin.xhs.png","slug":"Screenshot_2019-08-31-14-25-04-833_com.xingin.xhs.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/Tiffany.png","slug":"Tiffany.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/WechatIMG38.jpeg","slug":"WechatIMG38.jpeg","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Thailand-Raiders/WechatIMG39.png","post":"ck4859y3s0017t0fyzc60sa62","slug":"WechatIMG39.png","modified":1,"renderable":1},{"_id":"source/_posts/Thailand-Raiders/WechatIMG40.png","post":"ck4859y3s0017t0fyzc60sa62","slug":"WechatIMG40.png","modified":1,"renderable":1},{"_id":"source/_posts/Thailand-Raiders/tianjin-airport.png","slug":"tianjin-airport.png","post":"ck4859y3s0017t0fyzc60sa62","modified":1,"renderable":0},{"_id":"source/_posts/Github-Pages-Blog/copy-url.png","slug":"copy-url.png","post":"ck4859y93003lt0fyvlndcm24","modified":1,"renderable":0},{"_id":"source/_posts/Project-Module/4.png","slug":"4.png","post":"ck4859yb5004lt0fy34mg0llc","modified":1,"renderable":0},{"_id":"source/_posts/Redis-sds/sdshdr.png","post":"ck4859y99003tt0fyqzh5afwk","slug":"sdshdr.png","modified":1,"renderable":1},{"_id":"source/_posts/Redis-adlist/list.png","post":"ck4859y9a003vt0fywpon18c5","slug":"list.png","modified":1,"renderable":1},{"_id":"source/_posts/Design-Pattern-Observer/1.png","slug":"1.png","post":"ck4859y92003kt0fym8za61n9","modified":1,"renderable":0},{"_id":"source/_posts/Github-Pages-Blog/blog-icon.png","post":"ck4859y93003lt0fyvlndcm24","slug":"blog-icon.png","modified":1,"renderable":1},{"_id":"source/_posts/Github-Pages-Blog/categories.png","post":"ck4859y93003lt0fyvlndcm24","slug":"categories.png","modified":1,"renderable":1},{"_id":"source/_posts/Github-Pages-Blog/change-theme.png","post":"ck4859y93003lt0fyvlndcm24","slug":"change-theme.png","modified":1,"renderable":1},{"_id":"source/_posts/Github-Pages-Blog/comment-delete.png","post":"ck4859y93003lt0fyvlndcm24","slug":"comment-delete.png","modified":1,"renderable":1},{"_id":"source/_posts/Github-Pages-Blog/create-project.png","post":"ck4859y93003lt0fyvlndcm24","slug":"create-project.png","modified":1,"renderable":1},{"_id":"source/_posts/Github-Pages-Blog/deploy-position.png","post":"ck4859y93003lt0fyvlndcm24","slug":"deploy-position.png","modified":1,"renderable":1},{"_id":"source/_posts/Github-Pages-Blog/github-pages.png","post":"ck4859y93003lt0fyvlndcm24","slug":"github-pages.png","modified":1,"renderable":1},{"_id":"source/_posts/Github-Pages-Blog/select-theme.png","slug":"select-theme.png","post":"ck4859y93003lt0fyvlndcm24","modified":1,"renderable":0},{"_id":"source/_posts/Github-Pages-Blog/tags.png","post":"ck4859y93003lt0fyvlndcm24","slug":"tags.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/1.png","slug":"1.png","post":"ck4859yb5004lt0fy34mg0llc","modified":1,"renderable":0},{"_id":"source/_posts/Kafka-Background/1.png","post":"ck4859yb4004kt0fyeb9xqpka","slug":"1.png","modified":1,"renderable":1},{"_id":"source/_posts/Kafka-Background/2.png","post":"ck4859yb4004kt0fyeb9xqpka","slug":"2.png","modified":1,"renderable":1},{"_id":"source/_posts/Kafka-Background/3.jpg","post":"ck4859yb4004kt0fyeb9xqpka","slug":"3.jpg","modified":1,"renderable":1},{"_id":"source/_posts/Kafka-Background/5.jpeg","post":"ck4859yb4004kt0fyeb9xqpka","slug":"5.jpeg","modified":1,"renderable":1},{"_id":"source/_posts/Kafka-Background/6.png","slug":"6.png","post":"ck4859yb4004kt0fyeb9xqpka","modified":1,"renderable":0},{"_id":"source/_posts/Project-Module/10.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"10.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/11.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"11.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/12.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"12.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/17.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"17.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/19.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"19.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/2.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"2.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/24.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"24.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/3.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"3.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/30.1.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"30.1.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/30.2.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"30.2.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/32.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"32.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/5.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"5.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/6.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"6.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/7.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"7.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/8.png","post":"ck4859yb5004lt0fy34mg0llc","slug":"8.png","modified":1,"renderable":1},{"_id":"source/_posts/Project-Module/9.png","slug":"9.png","post":"ck4859yb5004lt0fy34mg0llc","modified":1,"renderable":0},{"_id":"source/_posts/Mysql-storage/640.png","post":"ck4859yd3004vt0fyo8ktt58x","slug":"640.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/1.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"1.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/2.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"2.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/IO.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"IO.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/Insert-Buffer.svg","post":"ck4859yd5004wt0fyazelh5h3","slug":"Insert-Buffer.svg","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/doublewrite.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"doublewrite.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/index-update.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"index-update.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/innodb-Architecture.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"innodb-Architecture.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/innodb-buffer-pool-list.jpg","post":"ck4859yd5004wt0fyazelh5h3","slug":"innodb-buffer-pool-list.jpg","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/insert-buffer.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"insert-buffer.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/read.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"read.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/read.svg","post":"ck4859yd5004wt0fyazelh5h3","slug":"read.svg","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/redo-buffer.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"redo-buffer.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/three-list.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"three-list.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/three-list2.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"three-list2.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/write.png","post":"ck4859yd5004wt0fyazelh5h3","slug":"write.png","modified":1,"renderable":1},{"_id":"source/_posts/Mysql02/write.svg","post":"ck4859yd5004wt0fyazelh5h3","slug":"write.svg","modified":1,"renderable":1}],"PostCategory":[{"post_id":"ck4859y2a0000t0fydtstsw7o","category_id":"ck4859y2p0004t0fyvq59ozee","_id":"ck4859y2z000et0fyq79kyvwj"},{"post_id":"ck4859y2n0002t0fyras55fxe","category_id":"ck4859y2v000at0fy97kyjs0v","_id":"ck4859y32000lt0fyc1q44p65"},{"post_id":"ck4859y2q0006t0fyn4wm021x","category_id":"ck4859y2z000ft0fy7qa2n5cz","_id":"ck4859y39000rt0fytk20de93"},{"post_id":"ck4859y2s0008t0fy3l37j2fz","category_id":"ck4859y2z000ft0fy7qa2n5cz","_id":"ck4859y3i000vt0fy3gf8utw0"},{"post_id":"ck4859y2u0009t0fy5cbsap0e","category_id":"ck4859y39000qt0fytruffvv0","_id":"ck4859y3q0011t0fy7hvh95us"},{"post_id":"ck4859y2v000ct0fy3uk7y04f","category_id":"ck4859y3j000wt0fyc0m7pryq","_id":"ck4859y3t0019t0fyur368907"},{"post_id":"ck4859y2w000dt0fyewnpn50g","category_id":"ck4859y3r0014t0fyjyfuw2m7","_id":"ck4859y3u001dt0fy8pgxdfif"},{"post_id":"ck4859y30000ht0fyhsbmm1di","category_id":"ck4859y3t001at0fyfz8ufpd7","_id":"ck4859y3v001it0fyaku9u2bo"},{"post_id":"ck4859y31000jt0fymae8x1as","category_id":"ck4859y3t001at0fyfz8ufpd7","_id":"ck4859y3v001kt0fyek8eijqy"},{"post_id":"ck4859y34000ot0fynih21mp8","category_id":"ck4859y3v001ht0fy67xd10v9","_id":"ck4859y3w001ot0fyfjch7vm3"},{"post_id":"ck4859y35000pt0fyylafrkhm","category_id":"ck4859y3v001lt0fy1691rvmm","_id":"ck4859y3w001tt0fyura12vz6"},{"post_id":"ck4859y3a000tt0fycscho9bt","category_id":"ck4859y3v001ht0fy67xd10v9","_id":"ck4859y3x001xt0fywrx2rhq2"},{"post_id":"ck4859y3e000ut0fyts0xzyjh","category_id":"ck4859y3v001lt0fy1691rvmm","_id":"ck4859y3y0021t0fyntbrqvbb"},{"post_id":"ck4859y3j000xt0fy4lky1513","category_id":"ck4859y3v001lt0fy1691rvmm","_id":"ck4859y3z0024t0fyefocg8rw"},{"post_id":"ck4859y3m0010t0fyihbt1gcj","category_id":"ck4859y3v001lt0fy1691rvmm","_id":"ck4859y3z0027t0fy7wv0nlpf"},{"post_id":"ck4859y3q0013t0fyyxk4qmtl","category_id":"ck4859y3v001lt0fy1691rvmm","_id":"ck4859y40002at0fy303ww73r"},{"post_id":"ck4859y3s0017t0fyzc60sa62","category_id":"ck4859y3z0026t0fybz4smcrg","_id":"ck4859y41002et0fy9rf223jf"},{"post_id":"ck4859y92003kt0fym8za61n9","category_id":"ck4859y39000qt0fytruffvv0","_id":"ck4859y98003rt0fyhcdnxx24"},{"post_id":"ck4859y95003nt0fy0uoxgqzp","category_id":"ck4859y3t001at0fyfz8ufpd7","_id":"ck4859y9b003wt0fyod1hhtd7"},{"post_id":"ck4859y99003tt0fyqzh5afwk","category_id":"ck4859y2p0004t0fyvq59ozee","_id":"ck4859y9d0041t0fycn2fiwjd"},{"post_id":"ck4859y93003lt0fyvlndcm24","category_id":"ck4859y97003ot0fyk2w5e503","_id":"ck4859y9d0043t0fy6f12zp96"},{"post_id":"ck4859y9a003vt0fywpon18c5","category_id":"ck4859y2p0004t0fyvq59ozee","_id":"ck4859y9e0044t0fy6q42hte3"},{"post_id":"ck4859y97003qt0fyx99lwk3g","category_id":"ck4859y9b003xt0fy9y6jho6y","_id":"ck4859y9f0046t0fyxbif1p3l"},{"post_id":"ck4859yb4004kt0fyeb9xqpka","category_id":"ck4859y3v001ht0fy67xd10v9","_id":"ck4859yb6004pt0fy99joy991"},{"post_id":"ck4859yb5004lt0fy34mg0llc","category_id":"ck4859y3j000wt0fyc0m7pryq","_id":"ck4859yba004rt0fyxrjns0pz"},{"post_id":"ck4859yd3004vt0fyo8ktt58x","category_id":"ck4859y3v001lt0fy1691rvmm","_id":"ck4859yd7004zt0fykkd1f1v6"},{"post_id":"ck4859yd5004wt0fyazelh5h3","category_id":"ck4859y3v001lt0fy1691rvmm","_id":"ck4859yd80051t0fytw7yrkce"},{"post_id":"ck4859yg20053t0fy2bdu8e0b","category_id":"ck4859y9b003xt0fy9y6jho6y","_id":"ck4859yg50055t0fyit4zvuyu"}],"PostTag":[{"post_id":"ck4859y2a0000t0fydtstsw7o","tag_id":"ck4859y2q0005t0fy06prz4lx","_id":"ck4859y31000it0fyor4mn0lv"},{"post_id":"ck4859y2a0000t0fydtstsw7o","tag_id":"ck4859y2v000bt0fy9hi8pa73","_id":"ck4859y32000kt0fy1ymr43qq"},{"post_id":"ck4859y2n0002t0fyras55fxe","tag_id":"ck4859y2z000gt0fy0r9twitc","_id":"ck4859y3m000zt0fy3smkpmag"},{"post_id":"ck4859y2n0002t0fyras55fxe","tag_id":"ck4859y32000nt0fyf3hpr4pu","_id":"ck4859y3q0012t0fyf3dne6rl"},{"post_id":"ck4859y2n0002t0fyras55fxe","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y3s0016t0fyqp44qw0l"},{"post_id":"ck4859y2q0006t0fyn4wm021x","tag_id":"ck4859y3j000yt0fyk9olhtf0","_id":"ck4859y3t0018t0fyhbjs49h5"},{"post_id":"ck4859y2s0008t0fy3l37j2fz","tag_id":"ck4859y3j000yt0fyk9olhtf0","_id":"ck4859y3u001ct0fyoqv0zav9"},{"post_id":"ck4859y2u0009t0fy5cbsap0e","tag_id":"ck4859y3t001bt0fyjc24hwye","_id":"ck4859y3u001gt0fylzx7cqcq"},{"post_id":"ck4859y2v000ct0fy3uk7y04f","tag_id":"ck4859y3u001ft0fyc7xvremp","_id":"ck4859y3w001nt0fyj24z765g"},{"post_id":"ck4859y2v000ct0fy3uk7y04f","tag_id":"ck4859y3v001jt0fypudr19nl","_id":"ck4859y3w001pt0fyd5a8latp"},{"post_id":"ck4859y2w000dt0fyewnpn50g","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859y3x001vt0fyfrw5kik0"},{"post_id":"ck4859y2w000dt0fyewnpn50g","tag_id":"ck4859y3w001rt0fyvbtw5vw0","_id":"ck4859y3x001yt0fy2rmkf3fj"},{"post_id":"ck4859y30000ht0fyhsbmm1di","tag_id":"ck4859y3x001ut0fyqyyt87zk","_id":"ck4859y400029t0fyubykxkda"},{"post_id":"ck4859y30000ht0fyhsbmm1di","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859y40002bt0fye324ftzh"},{"post_id":"ck4859y30000ht0fyhsbmm1di","tag_id":"ck4859y3y0022t0fyey0wvjm6","_id":"ck4859y41002dt0fyur1eg2df"},{"post_id":"ck4859y30000ht0fyhsbmm1di","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y41002ft0fydnzljzzc"},{"post_id":"ck4859y31000jt0fymae8x1as","tag_id":"ck4859y3x001ut0fyqyyt87zk","_id":"ck4859y42002jt0fyigmufcs0"},{"post_id":"ck4859y31000jt0fymae8x1as","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859y42002kt0fy6jujxgfa"},{"post_id":"ck4859y31000jt0fymae8x1as","tag_id":"ck4859y3y0022t0fyey0wvjm6","_id":"ck4859y42002mt0fyyoapedvg"},{"post_id":"ck4859y31000jt0fymae8x1as","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y42002nt0fym0gf2ozk"},{"post_id":"ck4859y34000ot0fynih21mp8","tag_id":"ck4859y42002it0fylv186y1o","_id":"ck4859y43002qt0fylfygcsd4"},{"post_id":"ck4859y34000ot0fynih21mp8","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859y43002rt0fybr4chhrh"},{"post_id":"ck4859y34000ot0fynih21mp8","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y43002tt0fyk3aztt4m"},{"post_id":"ck4859y35000pt0fyylafrkhm","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y44002vt0fy1rdcc7q6"},{"post_id":"ck4859y35000pt0fyylafrkhm","tag_id":"ck4859y43002st0fyzk6ou1a5","_id":"ck4859y44002wt0fykautz36d"},{"post_id":"ck4859y3a000tt0fycscho9bt","tag_id":"ck4859y42002it0fylv186y1o","_id":"ck4859y450030t0fydhn62fua"},{"post_id":"ck4859y3a000tt0fycscho9bt","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859y450031t0fy6rtpdlw7"},{"post_id":"ck4859y3a000tt0fycscho9bt","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y450033t0fycnvoc52n"},{"post_id":"ck4859y3e000ut0fyts0xzyjh","tag_id":"ck4859y43002st0fyzk6ou1a5","_id":"ck4859y450034t0fyuqnn7kvd"},{"post_id":"ck4859y3e000ut0fyts0xzyjh","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y460036t0fyh7zwdlya"},{"post_id":"ck4859y3j000xt0fy4lky1513","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y460037t0fyly97hcln"},{"post_id":"ck4859y3j000xt0fy4lky1513","tag_id":"ck4859y43002st0fyzk6ou1a5","_id":"ck4859y470039t0fy2as52tsk"},{"post_id":"ck4859y3m0010t0fyihbt1gcj","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y48003bt0fybg0x6iw5"},{"post_id":"ck4859y3m0010t0fyihbt1gcj","tag_id":"ck4859y43002st0fyzk6ou1a5","_id":"ck4859y48003ct0fysnrn0fdw"},{"post_id":"ck4859y3m0010t0fyihbt1gcj","tag_id":"ck4859y460038t0fyfqemw6q5","_id":"ck4859y48003et0fyw4y9d43w"},{"post_id":"ck4859y3q0013t0fyyxk4qmtl","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y49003gt0fywmq7n98y"},{"post_id":"ck4859y3q0013t0fyyxk4qmtl","tag_id":"ck4859y43002st0fyzk6ou1a5","_id":"ck4859y49003ht0fyti7wtlt4"},{"post_id":"ck4859y3q0013t0fyyxk4qmtl","tag_id":"ck4859y460038t0fyfqemw6q5","_id":"ck4859y49003it0fypgz7d4o6"},{"post_id":"ck4859y3s0017t0fyzc60sa62","tag_id":"ck4859y48003ft0fyed7mewnm","_id":"ck4859y49003jt0fyek6h1f28"},{"post_id":"ck4859y92003kt0fym8za61n9","tag_id":"ck4859y3t001bt0fyjc24hwye","_id":"ck4859y95003mt0fy4k4bcia7"},{"post_id":"ck4859y95003nt0fy0uoxgqzp","tag_id":"ck4859y3x001ut0fyqyyt87zk","_id":"ck4859y99003st0fy0xf6uxjh"},{"post_id":"ck4859y95003nt0fy0uoxgqzp","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859y9a003ut0fy0ajiiv7q"},{"post_id":"ck4859y95003nt0fy0uoxgqzp","tag_id":"ck4859y3y0022t0fyey0wvjm6","_id":"ck4859y9c003zt0fyqcgn6xuf"},{"post_id":"ck4859y95003nt0fy0uoxgqzp","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y9c0040t0fyzou8ef3a"},{"post_id":"ck4859y93003lt0fyvlndcm24","tag_id":"ck4859y97003pt0fygdizdf4v","_id":"ck4859y9f0047t0fyuf19xybc"},{"post_id":"ck4859y93003lt0fyvlndcm24","tag_id":"ck4859y9b003yt0fygvwfcjib","_id":"ck4859y9g0048t0fyuyvor3lr"},{"post_id":"ck4859y93003lt0fyvlndcm24","tag_id":"ck4859y3v001jt0fypudr19nl","_id":"ck4859y9h004at0fy89cd7yvj"},{"post_id":"ck4859y93003lt0fyvlndcm24","tag_id":"ck4859y9d0042t0fynd1dub37","_id":"ck4859y9h004bt0fy4gz2bpqw"},{"post_id":"ck4859y97003qt0fyx99lwk3g","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859y9i004dt0fy405g4o5z"},{"post_id":"ck4859y97003qt0fyx99lwk3g","tag_id":"ck4859y9e0045t0fypebspl6g","_id":"ck4859y9i004et0fymuy9x3pt"},{"post_id":"ck4859y97003qt0fyx99lwk3g","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859y9i004ft0fyixjyzh31"},{"post_id":"ck4859y99003tt0fyqzh5afwk","tag_id":"ck4859y2q0005t0fy06prz4lx","_id":"ck4859y9j004gt0fyamht609q"},{"post_id":"ck4859y99003tt0fyqzh5afwk","tag_id":"ck4859y9g0049t0fyjil4i4lc","_id":"ck4859y9j004ht0fy3ggom1p3"},{"post_id":"ck4859y9a003vt0fywpon18c5","tag_id":"ck4859y2q0005t0fy06prz4lx","_id":"ck4859y9j004it0fyh7omsm17"},{"post_id":"ck4859y9a003vt0fywpon18c5","tag_id":"ck4859y9g0049t0fyjil4i4lc","_id":"ck4859y9j004jt0fypjhit389"},{"post_id":"ck4859yb4004kt0fyeb9xqpka","tag_id":"ck4859y42002it0fylv186y1o","_id":"ck4859yb6004mt0fyeeqfqubj"},{"post_id":"ck4859yb4004kt0fyeb9xqpka","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859yb6004ot0fyavmir77g"},{"post_id":"ck4859yb4004kt0fyeb9xqpka","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859yba004qt0fyil84da98"},{"post_id":"ck4859yb5004lt0fy34mg0llc","tag_id":"ck4859y2z000gt0fy0r9twitc","_id":"ck4859ybh004st0fy0c9vb2bp"},{"post_id":"ck4859yb5004lt0fy34mg0llc","tag_id":"ck4859y3v001jt0fypudr19nl","_id":"ck4859ybl004tt0fykjp8r8cq"},{"post_id":"ck4859yb5004lt0fy34mg0llc","tag_id":"ck4859yb6004nt0fyczm84wgy","_id":"ck4859ybo004ut0fynvpe0sq9"},{"post_id":"ck4859yd3004vt0fyo8ktt58x","tag_id":"ck4859y43002st0fyzk6ou1a5","_id":"ck4859yd6004xt0fygl50zl1f"},{"post_id":"ck4859yd5004wt0fyazelh5h3","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859yd7004yt0fy8vnwdf2u"},{"post_id":"ck4859yd5004wt0fyazelh5h3","tag_id":"ck4859y43002st0fyzk6ou1a5","_id":"ck4859yd80050t0fy6qyenohr"},{"post_id":"ck4859yd5004wt0fyazelh5h3","tag_id":"ck4859y460038t0fyfqemw6q5","_id":"ck4859yd80052t0fyt2in19dz"},{"post_id":"ck4859yg20053t0fy2bdu8e0b","tag_id":"ck4859y3v001mt0fy980eyotp","_id":"ck4859yg70056t0fymuuxt765"},{"post_id":"ck4859yg20053t0fy2bdu8e0b","tag_id":"ck4859yg40054t0fy9naheq48","_id":"ck4859yg70057t0fyeb5h73l1"},{"post_id":"ck4859yg20053t0fy2bdu8e0b","tag_id":"ck4859y3a000st0fy86sxl2he","_id":"ck4859yg80058t0fyj22lrrlq"}],"Tag":[{"name":"redis","_id":"ck4859y2q0005t0fy06prz4lx"},{"name":"","_id":"ck4859y2v000bt0fy9hi8pa73"},{"name":"MyBatis","_id":"ck4859y2z000gt0fy0r9twitc"},{"name":"","_id":"ck4859y32000nt0fyf3hpr4pu"},{"name":"","_id":"ck4859y3a000st0fy86sxl2he"},{"name":"C++","_id":"ck4859y3j000yt0fyk9olhtf0"},{"name":"","_id":"ck4859y3t001bt0fyjc24hwye"},{"name":"git","_id":"ck4859y3u001ft0fyc7xvremp"},{"name":"","_id":"ck4859y3v001jt0fypudr19nl"},{"name":"JAVA","_id":"ck4859y3v001mt0fy980eyotp"},{"name":"GUAVA","_id":"ck4859y3w001rt0fyvbtw5vw0"},{"name":"JVM","_id":"ck4859y3x001ut0fyqyyt87zk"},{"name":"GO","_id":"ck4859y3y0022t0fyey0wvjm6"},{"name":"Kafka","_id":"ck4859y42002it0fylv186y1o"},{"name":"MySql","_id":"ck4859y43002st0fyzk6ou1a5"},{"name":"InnoDB","_id":"ck4859y460038t0fyfqemw6q5"},{"name":"","_id":"ck4859y48003ft0fyed7mewnm"},{"name":"github","_id":"ck4859y97003pt0fygdizdf4v"},{"name":"hexo","_id":"ck4859y9b003yt0fygvwfcjib"},{"name":"blog","_id":"ck4859y9d0042t0fynd1dub37"},{"name":"CAS","_id":"ck4859y9e0045t0fypebspl6g"},{"name":"","_id":"ck4859y9g0049t0fyjil4i4lc"},{"name":"Spring Boot","_id":"ck4859yb6004nt0fyczm84wgy"},{"name":"","_id":"ck4859yg40054t0fy9naheq48"}]}}